
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>geotecha.beam_on_foundation.specbeam &#8212; geotecha 0.2.1 documentation</title>
    <link rel="stylesheet" href="../../../_static/default.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    <script type="text/javascript" src="../../../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../../_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
   
  <link rel="stylesheet" href="../../../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>

<div style="background-color: white; text-align: left; padding: 10px 10px 15px 15px">
<a href="../../../index.html"><img src="../../../_static/logo.png" border="0" alt="py4sci"/></a>
</div>



      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper"><div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../../../index.html">Documentation overview</a><ul>
  <li><a href="../../index.html">Module code</a><ul>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <h1>Source code for geotecha.beam_on_foundation.specbeam</h1><div class="highlight"><pre>
<span></span><span class="ch">#!/usr/bin/env python</span>
<span class="c1"># geotecha - A software suite for geotechncial engineering</span>
<span class="c1"># Copyright (C) 2018  Rohan T. Walker (rtrwalker@gmail.com)</span>
<span class="c1">#</span>
<span class="c1"># This program is free software: you can redistribute it and/or modify</span>
<span class="c1"># it under the terms of the GNU General Public License as published by</span>
<span class="c1"># the Free Software Foundation, either version 3 of the License, or</span>
<span class="c1"># (at your option) any later version.</span>
<span class="c1">#</span>
<span class="c1"># This program is distributed in the hope that it will be useful,</span>
<span class="c1"># but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<span class="c1"># MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span>
<span class="c1"># GNU General Public License for more details.</span>
<span class="c1">#</span>
<span class="c1"># You should have received a copy of the GNU General Public License</span>
<span class="c1"># along with this program.  If not, see http://www.gnu.org/licenses/gpl.html.</span>

<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Finite elastic Euler-Bernoulli beam resting on viscoelastic foundation</span>
<span class="sd">with piecewise-linear properties, subjected to multiple moving point loads.</span>


<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">from</span> <span class="nn">__future__</span> <span class="k">import</span> <span class="n">division</span><span class="p">,</span> <span class="n">print_function</span>


<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">matplotlib.animation</span> <span class="k">as</span> <span class="nn">animation</span>
<span class="kn">import</span> <span class="nn">matplotlib</span>
<span class="kn">from</span> <span class="nn">geotecha.mathematics.root_finding</span> <span class="k">import</span> <span class="n">find_n_roots</span>
<span class="kn">from</span> <span class="nn">scipy</span> <span class="k">import</span> <span class="n">integrate</span>
<span class="kn">from</span> <span class="nn">scipy.integrate</span> <span class="k">import</span> <span class="n">odeint</span>
<span class="kn">import</span> <span class="nn">matplotlib.style</span>
<span class="kn">import</span> <span class="nn">matplotlib</span> <span class="k">as</span> <span class="nn">mpl</span>

<span class="kn">import</span> <span class="nn">time</span>
<span class="kn">from</span> <span class="nn">datetime</span>  <span class="k">import</span> <span class="n">timedelta</span>
<span class="kn">import</span> <span class="nn">datetime</span>
<span class="kn">from</span> <span class="nn">collections</span> <span class="k">import</span> <span class="n">OrderedDict</span>
<span class="kn">import</span> <span class="nn">os</span>

<span class="kn">import</span> <span class="nn">geotecha.speccon.speccon1d</span> <span class="k">as</span> <span class="nn">speccon1d</span>
<span class="kn">import</span> <span class="nn">geotecha.piecewise.piecewise_linear_1d</span> <span class="k">as</span> <span class="nn">pwise</span>
<span class="kn">from</span> <span class="nn">geotecha.piecewise.piecewise_linear_1d</span> <span class="k">import</span> <span class="n">PolyLine</span>
<span class="kn">import</span> <span class="nn">geotecha.speccon.integrals</span> <span class="k">as</span> <span class="nn">integ</span>
<span class="kn">import</span> <span class="nn">geotecha.inputoutput.inputoutput</span> <span class="k">as</span> <span class="nn">inputoutput</span>
<span class="kn">from</span> <span class="nn">geotecha.inputoutput.inputoutput</span> <span class="k">import</span> <span class="n">SimpleTimer</span>

<span class="kn">from</span> <span class="nn">geotecha.plotting.one_d</span> <span class="k">import</span> <span class="n">save_figure</span>

<span class="kn">from</span> <span class="nn">numpy.testing</span> <span class="k">import</span> <span class="n">assert_allclose</span>
<span class="kn">from</span> <span class="nn">geotecha.plotting.one_d</span> <span class="k">import</span> <span class="n">MarkersDashesColors</span>

<span class="n">DEBUG</span><span class="o">=</span><span class="kc">True</span>


<div class="viewcode-block" id="SpecBeam"><a class="viewcode-back" href="../../../api/geotecha.beam_on_foundation.specbeam.html#geotecha.beam_on_foundation.specbeam.SpecBeam">[docs]</a><span class="k">class</span> <span class="nc">SpecBeam</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Finite elastic Euler-Bernoulli beam resting on</span>
<span class="sd">    viscoelastic foundation subjected to a moving load, piecewise-linear</span>
<span class="sd">    properties.</span>

<span class="sd">    An extension of Ding et al. (2012) [1]_ with piecewise linear</span>
<span class="sd">    material properties and non-linear foundation stiffness k3=0 in k3*w**3.</span>


<span class="sd">    You don&#39;t need all the parameters.  Basically if normalised values are</span>
<span class="sd">    &#39;None&#39; (i.e. default) then those properties will be calculated from</span>
<span class="sd">    the non normalised quantities.  All calculations are done in normalised</span>
<span class="sd">    space.  You only need the non-normalised variables if you want</span>
<span class="sd">    non-normalised output.</span>


<span class="sd">    Note: some of the code is a relic of</span>
<span class="sd">    geotecha.beam_on_foundation.dingetal2012 which is a straight up</span>
<span class="sd">    implementation of [1]_ .  Sorry for any confusion.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    BC : [&quot;SS&quot;,&quot;CC&quot;,&quot;FF&quot;], optional</span>
<span class="sd">        Boundary condition. Can only have Simply Supported (SS).</span>
<span class="sd">        Clamped Clamped (CC) and Free Free (FF) are a relic from a differnet</span>
<span class="sd">        program.  Default BC=&quot;SS&quot;.</span>
<span class="sd">    nterms : integer, optional</span>
<span class="sd">        Number of terms for Galerkin truncation. Default nterms=50</span>
<span class="sd">    E : float, optional</span>
<span class="sd">        Young&#39;s modulus of beam.(E in [1]_).</span>
<span class="sd">    rho : float, optional</span>
<span class="sd">        Mass density of beam.</span>
<span class="sd">    I : float, optional</span>
<span class="sd">        Second moment of area of beam (I in [1]_).</span>
<span class="sd">    A : float, optional</span>
<span class="sd">        Cross sectional area of beam</span>
<span class="sd">    L : float, optional</span>
<span class="sd">        Length of beam. (L in [1]_).</span>
<span class="sd">    k1 : float, optional</span>
<span class="sd">        Mean stiffness of foundation.</span>
<span class="sd">    k3 : float, optional</span>
<span class="sd">        Non linear stiffness of foundation.</span>
<span class="sd">    mu : float, optional</span>
<span class="sd">        Viscous damping of foundation.</span>
<span class="sd">#    Fz : float, optional</span>
<span class="sd">#        Load.  This is a relic; loads now specified with moving_loads_...</span>

<span class="sd">    v : list of float, optional</span>
<span class="sd">        Velocity of each group of moving point loads.</span>
<span class="sd">    moving_loads_x : list of lists of floats, optional</span>
<span class="sd">        Each sublist contains x-coords of each point load in the moving load</span>
<span class="sd">        group.  The coords are relative to a reference point which will</span>
<span class="sd">        enter the beam at the corresponding time value in `moving_loads_t0`.</span>
<span class="sd">        Coords are usually negative for vehicle facing left to right.</span>
<span class="sd">    moving_loads_Fz : list of lists of floats, optional</span>
<span class="sd">        Each sublist contains magnitude of of each point load in moving load</span>
<span class="sd">        group.</span>
<span class="sd">    moving_loads_v : list of float, optional</span>
<span class="sd">        Velocity of each moving point load group.  When velocity is negative</span>
<span class="sd">        the x-coords in the corresponding member of `moving_loads_x` will</span>
<span class="sd">        be multiplied by -1 before the beam enters the beam from the right.</span>
<span class="sd">    moving_loads_offset : list of float, optional</span>
<span class="sd">        An initial distance by which the corresponding `moving_loads_x` is</span>
<span class="sd">        offset. Will default to zero if not inputted.</span>
<span class="sd">    moving_loads_t0 : list of lists, optional</span>
<span class="sd">        Time that moving load group enters the beam (strictyly speaking it</span>
<span class="sd">        is when the 0 coord in `moving_loads_x` enters the beam). If v&gt;0</span>
<span class="sd">        moving load group starts at x=0, t=0 and moves to the right.</span>
<span class="sd">        If v&lt;0 then moving load group starts at x=L,t=0 and moves to the</span>
<span class="sd">        left.  Defaults to 0.</span>
<span class="sd">    moving_loads_x0 : list of float, optional</span>
<span class="sd">        Position where moving load group appears on the beam.  Defaults to</span>
<span class="sd">        zero if ommited.</span>
<span class="sd">    moving_loads_L : list of float, optional</span>
<span class="sd">        Distance the load group travels on beam.  Defaults to L if omitted.</span>
<span class="sd">        Used in conjunction with moving loads_x0.</span>
<span class="sd">    tvals : 1d array of float, optional</span>
<span class="sd">        Output times</span>
<span class="sd">    xvals : 1d array of float, optional</span>
<span class="sd">        Output x-coord</span>

<span class="sd">    v_norm : list of float, optional</span>
<span class="sd">        normalised velocity = V * sqrt(rho / E) for each group of moving</span>
<span class="sd">        point loads. An example of a consistent</span>
<span class="sd">        set of units to get the correct v_norm is rho in kg/m^3, L in m, and</span>
<span class="sd">        E in Pa.</span>
<span class="sd">    moving_loads_x_norm : list of lists of floats, optional</span>
<span class="sd">        As per `moving_loads_x` but nomalised.</span>
<span class="sd">        x_norm = x / L</span>
<span class="sd">    moving_loads_Fz_norm : list of lists of floats, optional</span>
<span class="sd">        As per `moving_loads_Fz` but nomalised.</span>
<span class="sd">        Fz_norm = Fz / (E * A).</span>
<span class="sd">    moving_loads_v_norm : list of float, optional</span>
<span class="sd">        As per `moving_loads_v` but nomalised.</span>
<span class="sd">        v_norm= v * sqrt(rho / E) for each group of moving</span>
<span class="sd">        point loads. An example of a consistent</span>
<span class="sd">        set of units to get the correct v_norm is rho in kg/m^3, L in m, and</span>
<span class="sd">        E in Pa.</span>
<span class="sd">    moving_loads_offset_norm : list of float, optional</span>
<span class="sd">        As per `moving_loads_offset` but nomalised.</span>
<span class="sd">        offset_norm = offet / L</span>
<span class="sd">    moving_loads_t0_norm : list of lists, optional</span>
<span class="sd">        As per `moving_loads_t0` but nomalised.</span>
<span class="sd">        t0_norm = t0 / L * np.sqrt(E / rho)</span>
<span class="sd">    moving_loads_x0_norm : list of float, optional</span>
<span class="sd">        As per `moving_loads_x0`. x0_norm=x0/L.</span>
<span class="sd">    moving_loads_L_norm : list of float, optional</span>
<span class="sd">        As per `moving_loads_L_norm` but normalised.L_norm = L&#39; / L</span>

<span class="sd">    tvals_norm : 1d array of float, optional</span>
<span class="sd">        Normalised output times.</span>
<span class="sd">        t_norm = t / L * np.sqrt(E / rho)</span>
<span class="sd">    xvals_norm : 1d array of float, optional</span>
<span class="sd">        Normalised output coords.</span>
<span class="sd">        x_norm = x / L</span>


<span class="sd">    stationary_loads_x : list of float, optional</span>
<span class="sd">        Location of stationary point loads.</span>
<span class="sd">    stationary_loads_vs_t : list of Polyline, optional</span>
<span class="sd">        Stationary load magnitude variation with time. PolyLine(time, magnitude).</span>
<span class="sd">    stationary_loads_omega_phase : list of 2 element tuples, optional</span>
<span class="sd">        (omega, phase) to define cyclic variation of stationary point loads. i.e.</span>
<span class="sd">        mag_vs_time * cos(omega*t + phase). If stationary_loads_omega_phase is None</span>
<span class="sd">        then cyclic component will be ignored.  If stationary_loads_omega_phase is a</span>
<span class="sd">        list then if any member is None then cyclic component will not be</span>
<span class="sd">        applied for that load combo.</span>

<span class="sd">    stationary_loads_x_norm : list of float, optional</span>
<span class="sd">        As per stationary_loads_x but normalised</span>
<span class="sd">    stationary_loads_vs_t_norm : list of Polyline, optional</span>
<span class="sd">        As per stationary_loads_vs_t but normalised</span>
<span class="sd">    stationary_loads_omega_phase_norm : list of 2 element tuples, optional</span>
<span class="sd">        As per stationary_loads_omega_phase but normalised.</span>


<span class="sd">    kf : float, optional</span>
<span class="sd">        Normalised modulus of elasticity = 1 / L * sqrt(I / A).</span>
<span class="sd">#    Fz_norm : float, optional</span>
<span class="sd">#        Normalised load = Fz / (E * A). This is a relic; loads now specified</span>
<span class="sd">#        with moving_loads_...</span>
<span class="sd">    mu_norm : float, optional</span>
<span class="sd">        Normalised damping = mu / A * sqrt(L**2 / (rho * E)).</span>
<span class="sd">    k1_norm : float, optional</span>
<span class="sd">        Normalised mean stiffness = k1 * L**2 / (E * A).</span>
<span class="sd">    k3_norm : float, optional</span>
<span class="sd">        Normalised non-linear stiffness = k3 * L**4 / (E * A)</span>
<span class="sd">    nquad : integer, optional</span>
<span class="sd">        Number of quadrature points for numerical integration of non-linear</span>
<span class="sd">        k3*w**3*w_ term.  Default nquad=30.  Note I&#39;ve had errors when n&gt;35.</span>
<span class="sd">        For the special case of nquad=None then integration will be performed</span>
<span class="sd">        using scipy.integrate.quad; this is slower.</span>
<span class="sd">    Ebar : PolyLine, optional</span>
<span class="sd">        PolyLine object representing piecewise linear E/Eref vs x.</span>
<span class="sd">        Default Ebar = PolyLine([0],[1],[1],[1]) i.e. uniform.</span>
<span class="sd">    rhobar : PolyLine, optional</span>
<span class="sd">        PolyLine object representing piecewise linear rho/rhoref vs x.</span>
<span class="sd">        Default rhobar = PolyLine([0],[1],[1],[1]) i.e. uniform.</span>
<span class="sd">    Ibar : PolyLine, optional</span>
<span class="sd">        PolyLine object representing piecewise linear I/Iref vs x.</span>
<span class="sd">        Default Ibar = PolyLine([0],[1],[1],[1]) i.e. uniform.</span>
<span class="sd">    Abar : PolyLine, optional</span>
<span class="sd">        PolyLine object representing piecewise linear A/Aref vs x.</span>
<span class="sd">        Default Abar = PolyLine([0],[1],[1],[1]) i.e. uniform.</span>
<span class="sd">    k1bar : PolyLine, optional</span>
<span class="sd">        PolyLine object representing piecewise linear k1/k1ref vs x.</span>
<span class="sd">        Default k1bar = PolyLine([0],[1],[1],[1]) i.e. uniform.</span>
<span class="sd">    k3bar : PolyLine, optional</span>
<span class="sd">        PolyLine object representing piecewise linear k3/k3ref vs x.</span>
<span class="sd">        Default k3bar = PolyLine([0],[1],[1],[1]) i.e. uniform.</span>
<span class="sd">    mubar : PolyLine, optional</span>
<span class="sd">        PolyLine object representing piecewise linear mu/muref vs x.</span>
<span class="sd">        Default mubar = PolyLine([0],[1],[1],[1]) i.e. uniform.</span>
<span class="sd">    use_analytical : [False,true]</span>
<span class="sd">        If true then system of second order ode resulting from spectral</span>
<span class="sd">        galerkin method will be solved analytically.  If False then the</span>
<span class="sd">        ode system will be solved numerically (potentially very slow).</span>
<span class="sd">        analytical approach is only avaialble when BC=&#39;SS&#39; and</span>
<span class="sd">        k3=0 (or k3_norm=0).</span>
<span class="sd">    file_stem : string, optional</span>
<span class="sd">        File stem for saving deflection data.  Default file_stem=&quot;specbeam_&quot;.</span>
<span class="sd">    force_calc : [False, True]</span>
<span class="sd">        If True then calcualtion will happen regardless of presence of output</span>
<span class="sd">        file (file_stem)</span>

<span class="sd">    Attributes</span>
<span class="sd">    ----------</span>
<span class="sd">    phi : function</span>
<span class="sd">        Relevant Galerkin trial function.  Depends on `BC`.  See [1]_ for</span>
<span class="sd">        details.</span>
<span class="sd">    beta : 1d ndarray of `nterms` float</span>
<span class="sd">        beta terms in Galerkin trial function.</span>
<span class="sd">    xj : 1d ndarray of `nquad` float</span>
<span class="sd">        Quadrature integration points.</span>
<span class="sd">    Ij : 1d ndarray of `nquad` float</span>
<span class="sd">        Weighting coefficients for numerical integration.</span>
<span class="sd">    BC_coeff : int</span>
<span class="sd">        I don&#39;t think this is relevant anymore.</span>
<span class="sd">        Coefficent  to multiply the Fz and k3 terms in the ode.</span>
<span class="sd">        For `BC`=&quot;SS&quot; BC_coeff=2, for `BC`=&quot;CC&quot; or &quot;FF&quot; BC_coeff=2.</span>
<span class="sd">        See [1]_ Equation (31) and (32).</span>
<span class="sd">    t : 1d ndarray of float</span>
<span class="sd">        Raw time values. Only valid after running calulate_qk.</span>
<span class="sd">    t_norm : 1d ndarray of float</span>
<span class="sd">        Normlised time values = t / L * sqrt(E / rho).</span>
<span class="sd">        Only valid after running calulate_qk.</span>
<span class="sd">    qsol : 2d ndarray of shape(len(`t`), 2* `nterms`) float</span>
<span class="sd">        Values of Galerkin coefficients at each time i.e. qk(t) in [1]_.</span>
<span class="sd">        w(x) = sum(qk * phi_k(x)).</span>
<span class="sd">        Only valid after running calulate_qk.</span>
<span class="sd">    lam_qdotdot : 2d array of shape (nterms, nterms)</span>
<span class="sd">        spectral coefficeient matrix for qdotdot</span>
<span class="sd">    psi_q : 2d array of shape (nterms, nterms)</span>
<span class="sd">        spectral coefficeient matrix for q</span>
<span class="sd">    psi_qdot : 2d array of shape (nterms, nterms)</span>
<span class="sd">        spectral coefficeient matrix for qdot.</span>
<span class="sd">    k3barj : 1d array of float with len(nquad)</span>
<span class="sd">        value of k3 interpolated from k3bar at the quadrature points. Used</span>
<span class="sd">        in the  k3*w**3 term.</span>
<span class="sd">    L_norm : float</span>
<span class="sd">        Normalised length.  Always =1.</span>
<span class="sd">    defl_norm : array of float, size (len(xvals_norm), len(tvals_norm))</span>
<span class="sd">        normalised defelction at xval,tval</span>
<span class="sd">    defl : array of float, size (len(xvals_norm), len(tvals_norm))</span>
<span class="sd">        deflection at xval,tval.  ONly if self.L is not None.</span>
<span class="sd">    beta_block : 1d array float with size (2*nterms)</span>
<span class="sd">        Block column vector of repeated beta values.</span>
<span class="sd">    has_moving_loads : boolean</span>
<span class="sd">        If True then there are moving point loads.</span>
<span class="sd">    has_stationary_loads : boolean</span>
<span class="sd">        If True then there are stationary loads.</span>
<span class="sd">    moving_load_w_norm : list of ndarray</span>
<span class="sd">        Normalised deflections under each moving load at each time value.</span>
<span class="sd">        Each element of the list corresponds to each moving load.  The array</span>
<span class="sd">        is of size (len(mvpl.x), len(tvals))  i.e. for each axle in the moving</span>
<span class="sd">        load group.</span>
<span class="sd">    moving_load_w : list of ndarray</span>
<span class="sd">        Non normalised deflections under each moving load.</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    defl and def_norm will be 1d arrays if len(xvals)=1.</span>

<span class="sd">    References</span>
<span class="sd">    ----------</span>
<span class="sd">    .. [1] Ding, H., Chen, L.-Q., and Yang, S.-P. (2012).</span>
<span class="sd">           &quot;Convergence of Galerkin truncation for dynamic response of</span>
<span class="sd">           finite beams on nonlinear foundations under a moving load.&quot;</span>
<span class="sd">           Journal of Sound and Vibration, 331(10), 2426-2442.</span>
<span class="sd">    .. [2] Walker, R.T.R. and Indraratna, B, (in press) &quot;Moving loads on a</span>
<span class="sd">           viscoelastic foundation with special reference to railway</span>
<span class="sd">           transition zones&quot;. International Journal of Geomechanics.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                    <span class="n">BC</span><span class="o">=</span><span class="s2">&quot;SS&quot;</span><span class="p">,</span>
                    <span class="n">nterms</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span>
                    <span class="n">E</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                    <span class="n">I</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                    <span class="n">rho</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                    <span class="n">A</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                    <span class="n">L</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                    <span class="n">k1</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                    <span class="n">k3</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                    <span class="n">mu</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
<span class="c1">#                    Fz=None, #This is a relic; loads now specified with moving_loads_...</span>
<span class="c1">#                    v=None, #This is a relic; loads now specified with moving_loads_...</span>
<span class="c1">#                    v_norm=None,</span>

                    <span class="n">moving_loads_x</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                    <span class="n">moving_loads_Fz</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                    <span class="n">moving_loads_v</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                    <span class="n">moving_loads_offset</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                    <span class="n">moving_loads_t0</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                    <span class="n">moving_loads_x0</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                    <span class="n">moving_loads_L</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>

                    <span class="n">tvals</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                    <span class="n">xvals</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                    <span class="n">v_norm</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                    <span class="n">moving_loads_x_norm</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                    <span class="n">moving_loads_Fz_norm</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                    <span class="n">moving_loads_v_norm</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                    <span class="n">moving_loads_offset_norm</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                    <span class="n">moving_loads_t0_norm</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                    <span class="n">moving_loads_x0_norm</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                    <span class="n">moving_loads_L_norm</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                    <span class="n">tvals_norm</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                    <span class="n">xvals_norm</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>

                    <span class="n">stationary_loads_x</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                    <span class="n">stationary_loads_vs_t</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                    <span class="n">stationary_loads_omega_phase</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                    <span class="n">stationary_loads_x_norm</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                    <span class="n">stationary_loads_vs_t_norm</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                    <span class="n">stationary_loads_omega_phase_norm</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>



                    <span class="n">kf</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
<span class="c1">#                    Fz_norm=None, #This is a relic; loads now specified with moving_loads_...</span>
                    <span class="n">mu_norm</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                    <span class="n">k1_norm</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                    <span class="n">k3_norm</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                    <span class="n">nquad</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span>
                    <span class="n">Ebar</span><span class="o">=</span><span class="n">PolyLine</span><span class="p">([</span><span class="mi">0</span><span class="p">],[</span><span class="mi">1</span><span class="p">],[</span><span class="mi">1</span><span class="p">],[</span><span class="mi">1</span><span class="p">]),</span>
                    <span class="n">rhobar</span><span class="o">=</span><span class="n">PolyLine</span><span class="p">([</span><span class="mi">0</span><span class="p">],[</span><span class="mi">1</span><span class="p">],[</span><span class="mi">1</span><span class="p">],[</span><span class="mi">1</span><span class="p">]),</span>
                    <span class="n">Ibar</span><span class="o">=</span><span class="n">PolyLine</span><span class="p">([</span><span class="mi">0</span><span class="p">],[</span><span class="mi">1</span><span class="p">],[</span><span class="mi">1</span><span class="p">],[</span><span class="mi">1</span><span class="p">]),</span>
                    <span class="n">Abar</span><span class="o">=</span><span class="n">PolyLine</span><span class="p">([</span><span class="mi">0</span><span class="p">],[</span><span class="mi">1</span><span class="p">],[</span><span class="mi">1</span><span class="p">],[</span><span class="mi">1</span><span class="p">]),</span>
                    <span class="n">k1bar</span><span class="o">=</span><span class="n">PolyLine</span><span class="p">([</span><span class="mi">0</span><span class="p">],[</span><span class="mi">1</span><span class="p">],[</span><span class="mi">1</span><span class="p">],[</span><span class="mi">1</span><span class="p">]),</span>
                    <span class="n">k3bar</span><span class="o">=</span><span class="n">PolyLine</span><span class="p">([</span><span class="mi">0</span><span class="p">],[</span><span class="mi">1</span><span class="p">],[</span><span class="mi">1</span><span class="p">],[</span><span class="mi">1</span><span class="p">]),</span>
                    <span class="n">mubar</span><span class="o">=</span><span class="n">PolyLine</span><span class="p">([</span><span class="mi">0</span><span class="p">],[</span><span class="mi">1</span><span class="p">],[</span><span class="mi">1</span><span class="p">],[</span><span class="mi">1</span><span class="p">]),</span>
                    <span class="n">implementation</span><span class="o">=</span><span class="s2">&quot;vectorized&quot;</span><span class="p">,</span>
                    <span class="n">use_analytical</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                    <span class="n">file_stem</span><span class="o">=</span><span class="s2">&quot;specbeam_&quot;</span><span class="p">,</span>
                    <span class="n">force_calc</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>


        <span class="bp">self</span><span class="o">.</span><span class="n">BC</span> <span class="o">=</span> <span class="n">BC</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nterms</span> <span class="o">=</span> <span class="n">nterms</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">E</span> <span class="o">=</span> <span class="n">E</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">I</span> <span class="o">=</span> <span class="n">I</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rho</span> <span class="o">=</span> <span class="n">rho</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">I</span> <span class="o">=</span> <span class="n">I</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">A</span> <span class="o">=</span> <span class="n">A</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">L</span> <span class="o">=</span> <span class="n">L</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">k1</span> <span class="o">=</span> <span class="n">k1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">k3</span> <span class="o">=</span> <span class="n">k3</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mu</span> <span class="o">=</span> <span class="n">mu</span>
<span class="c1">#        self.Fz = #Fz This is a relic; loads now specified with moving_loads_...</span>
<span class="c1">#        self.v = v #This is a relic; loads now specified with moving_loads_...</span>
<span class="c1">#        self.v_norm = v_norm #This is a relic; loads now specified with moving_loads_...</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">moving_loads_x</span><span class="o">=</span><span class="n">moving_loads_x</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">moving_loads_Fz</span><span class="o">=</span><span class="n">moving_loads_Fz</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">moving_loads_v</span><span class="o">=</span><span class="n">moving_loads_v</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">moving_loads_offset</span><span class="o">=</span><span class="n">moving_loads_offset</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">moving_loads_t0</span><span class="o">=</span><span class="n">moving_loads_t0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">moving_loads_x0</span><span class="o">=</span><span class="n">moving_loads_x0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">moving_loads_L</span><span class="o">=</span><span class="n">moving_loads_L</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tvals</span><span class="o">=</span><span class="n">tvals</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">xvals</span><span class="o">=</span><span class="n">xvals</span>
        <span class="c1">#self.v_norm=v_norm #This is a relic; loads now specified with moving_loads_...</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">moving_loads_x_norm</span><span class="o">=</span><span class="n">moving_loads_x_norm</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">moving_loads_Fz_norm</span><span class="o">=</span><span class="n">moving_loads_Fz_norm</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">moving_loads_v_norm</span><span class="o">=</span><span class="n">moving_loads_v_norm</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">moving_loads_offset_norm</span><span class="o">=</span><span class="n">moving_loads_offset_norm</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">moving_loads_t0_norm</span><span class="o">=</span><span class="n">moving_loads_t0_norm</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">moving_loads_x0_norm</span><span class="o">=</span><span class="n">moving_loads_x0_norm</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">moving_loads_L_norm</span><span class="o">=</span><span class="n">moving_loads_L_norm</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tvals_norm</span><span class="o">=</span><span class="n">tvals_norm</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">xvals_norm</span><span class="o">=</span><span class="n">xvals_norm</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">stationary_loads_x</span><span class="o">=</span><span class="n">stationary_loads_x</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stationary_loads_vs_t</span><span class="o">=</span><span class="n">stationary_loads_vs_t</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stationary_loads_omega_phase</span><span class="o">=</span><span class="n">stationary_loads_omega_phase</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stationary_loads_x_norm</span><span class="o">=</span><span class="n">stationary_loads_x_norm</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stationary_loads_vs_t_norm</span><span class="o">=</span><span class="n">stationary_loads_vs_t_norm</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stationary_loads_omega_phase_norm</span><span class="o">=</span><span class="n">stationary_loads_omega_phase_norm</span>


        <span class="bp">self</span><span class="o">.</span><span class="n">kf</span> <span class="o">=</span> <span class="n">kf</span>
<span class="c1">#        self.Fz_norm = Fz_norm</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mu_norm</span> <span class="o">=</span> <span class="n">mu_norm</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">k1_norm</span> <span class="o">=</span> <span class="n">k1_norm</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">k3_norm</span> <span class="o">=</span> <span class="n">k3_norm</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nquad</span> <span class="o">=</span> <span class="n">nquad</span>


        <span class="bp">self</span><span class="o">.</span><span class="n">Ebar</span> <span class="o">=</span> <span class="n">Ebar</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Ibar</span> <span class="o">=</span> <span class="n">Ibar</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Abar</span> <span class="o">=</span> <span class="n">Abar</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">k1bar</span> <span class="o">=</span> <span class="n">k1bar</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">k3bar</span> <span class="o">=</span> <span class="n">k3bar</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mubar</span> <span class="o">=</span> <span class="n">mubar</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rhobar</span> <span class="o">=</span> <span class="n">rhobar</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">implementation</span> <span class="o">=</span> <span class="n">implementation</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">use_analytical</span><span class="o">=</span><span class="n">use_analytical</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">file_stem</span><span class="o">=</span><span class="n">file_stem</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">force_calc</span><span class="o">=</span><span class="n">force_calc</span>

        <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">k3_norm</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">k3</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">k3</span><span class="o">=</span><span class="mi">0</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">k3_norm</span><span class="o">=</span><span class="mi">0</span>

        <span class="k">if</span> <span class="p">(((</span><span class="bp">self</span><span class="o">.</span><span class="n">BC</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;CC&quot;</span><span class="p">,</span><span class="s2">&quot;FF&quot;</span><span class="p">])</span> <span class="ow">or</span>
            <span class="p">(</span><span class="nb">sum</span><span class="p">([</span><span class="n">v</span><span class="o">==</span><span class="mi">0</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">k3</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">k3_norm</span><span class="p">]])</span> <span class="o">!=</span> <span class="mi">2</span><span class="p">))</span>
            <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">use_analytical</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span> <span class="p">(</span><span class="s2">&quot;If use_analytical=True, cannot have BC=&#39;CC, BC=&#39;FF&#39;, or either k3!=None or k3_norm!=None&quot;</span><span class="p">)</span>

        <span class="c1"># normalised parameters</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">L_norm</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="k">if</span> <span class="n">kf</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">kf</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">L</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">I</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">A</span><span class="p">)</span>
<span class="c1">#        if v_norm is None: #This is a relic; loads now specified with moving_loads_...</span>
<span class="c1">#            self.v_norm = self.v * np.sqrt(self.rho / self.E) #This is a relic; loads now specified with moving_loads_...</span>


        <span class="k">if</span> <span class="nb">all</span><span class="p">([</span><span class="n">v</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span>
                <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">moving_loads_x_norm</span><span class="p">,</span>
                 <span class="bp">self</span><span class="o">.</span><span class="n">moving_loads_Fz_norm</span><span class="p">,</span>
                 <span class="bp">self</span><span class="o">.</span><span class="n">moving_loads_v_norm</span><span class="p">,</span>
                 <span class="bp">self</span><span class="o">.</span><span class="n">moving_loads_x</span><span class="p">,</span>
                 <span class="bp">self</span><span class="o">.</span><span class="n">moving_loads_Fz</span><span class="p">,</span>
                 <span class="bp">self</span><span class="o">.</span><span class="n">moving_loads_v</span><span class="p">]</span>
                <span class="p">]):</span>
            <span class="c1">#no moving loads</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">has_moving_loads</span><span class="o">=</span><span class="kc">False</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># at least one moving loads</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">has_moving_loads</span><span class="o">=</span><span class="kc">True</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">moving_loads_x_norm</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">moving_loads_x_norm</span> <span class="o">=</span> <span class="p">[[</span><span class="n">vv</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">L</span> <span class="k">for</span> <span class="n">vv</span> <span class="ow">in</span> <span class="n">v</span><span class="p">]</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">moving_loads_x</span><span class="p">]</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">moving_loads_Fz_norm</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">moving_loads_Fz_norm</span> <span class="o">=</span> <span class="p">[[</span><span class="n">vv</span> <span class="o">/</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">E</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">A</span><span class="p">)</span> <span class="k">for</span> <span class="n">vv</span> <span class="ow">in</span> <span class="n">v</span><span class="p">]</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">moving_loads_Fz</span><span class="p">]</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">moving_loads_v_norm</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">moving_loads_v_norm</span> <span class="o">=</span> <span class="p">[</span><span class="n">v</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rho</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">E</span><span class="p">)</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">moving_loads_v</span><span class="p">]</span>

            <span class="c1">#optional moving load variables</span>
            <span class="c1">###################</span>
            <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">moving_loads_offset</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">):</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">moving_loads_x</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="c1">#raw input values used:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">moving_loads_offset</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">moving_loads_x</span><span class="p">))</span>
                <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">moving_loads_offset_norm</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="c1">#nomalised values unsed but default behaviour</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">moving_loads_offset_norm</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">moving_loads_x_norm</span><span class="p">))</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">moving_loads_offset_norm</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">moving_loads_offset_norm</span> <span class="o">=</span> <span class="p">[</span><span class="n">v</span> <span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">L</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">moving_loads_offset</span><span class="p">]</span>
            <span class="c1">###################</span>
            <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">moving_loads_t0</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">):</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">moving_loads_x</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="c1">#raw input values used:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">moving_loads_t0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">moving_loads_x</span><span class="p">))</span>
                <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">moving_loads_t0_norm</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="c1">#nomalised values used but default behaviour</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">moving_loads_t0_norm</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">moving_loads_x_norm</span><span class="p">))</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">moving_loads_t0_norm</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">moving_loads_t0_norm</span> <span class="o">=</span> <span class="p">[</span><span class="n">v</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">L</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">E</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">rho</span><span class="p">)</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">moving_loads_t0</span><span class="p">]</span>
            <span class="c1">###################</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">moving_loads_x0</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">moving_loads_x</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="c1">#raw input values used for moving loads but default for x</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">moving_loads_x0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">moving_loads_x</span><span class="p">))</span>
                <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">moving_loads_x0_norm</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="c1">#nomalised values used but default behaviour</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">moving_loads_x0_norm</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">moving_loads_x_norm</span><span class="p">))</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">moving_loads_x0_norm</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">moving_loads_x0_norm</span> <span class="o">=</span> <span class="p">[</span><span class="n">v</span> <span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">L</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">moving_loads_x0</span><span class="p">]</span>
            <span class="c1">###################</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">moving_loads_L</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">moving_loads_x</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="c1">#raw input values used for moving loads but default for x</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">moving_loads_L</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">L</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">moving_loads_x</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
                <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">moving_loads_L_norm</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="c1">#nomalised values used but default behaviour</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">moving_loads_L_norm</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">moving_loads_x_norm</span><span class="p">),</span><span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">moving_loads_L_norm</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">moving_loads_L_norm</span> <span class="o">=</span> <span class="p">[</span><span class="n">v</span> <span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">L</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">moving_loads_L</span><span class="p">]</span>
            <span class="c1">###################</span>


            <span class="bp">self</span><span class="o">.</span><span class="n">moving_loads_norm</span> <span class="o">=</span> <span class="p">[</span><span class="n">MovingPointLoads</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">xv</span><span class="p">,</span>
                                                       <span class="n">p</span><span class="o">=</span><span class="n">pv</span><span class="p">,</span>
                                                       <span class="n">offset</span><span class="o">=</span><span class="n">offv</span><span class="p">,</span>
                                                       <span class="n">v</span><span class="o">=</span><span class="n">vv</span><span class="p">,</span>
                                                       <span class="n">t0</span><span class="o">=</span><span class="n">t0v</span><span class="p">,</span>
                                                       <span class="n">L</span><span class="o">=</span><span class="n">Lv</span><span class="p">,</span>
                                                       <span class="n">x0</span><span class="o">=</span><span class="n">x0v</span><span class="p">)</span>
                                        <span class="k">for</span> <span class="n">xv</span><span class="p">,</span><span class="n">pv</span><span class="p">,</span><span class="n">offv</span><span class="p">,</span><span class="n">vv</span><span class="p">,</span><span class="n">t0v</span><span class="p">,</span><span class="n">Lv</span><span class="p">,</span><span class="n">x0v</span> <span class="ow">in</span>
                                        <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">moving_loads_x_norm</span><span class="p">,</span>
                                            <span class="bp">self</span><span class="o">.</span><span class="n">moving_loads_Fz_norm</span><span class="p">,</span>
                                            <span class="bp">self</span><span class="o">.</span><span class="n">moving_loads_offset_norm</span><span class="p">,</span>
                                            <span class="bp">self</span><span class="o">.</span><span class="n">moving_loads_v_norm</span><span class="p">,</span>
                                            <span class="bp">self</span><span class="o">.</span><span class="n">moving_loads_t0_norm</span><span class="p">,</span>
                                            <span class="bp">self</span><span class="o">.</span><span class="n">moving_loads_L_norm</span><span class="p">,</span>
                                            <span class="bp">self</span><span class="o">.</span><span class="n">moving_loads_x0_norm</span><span class="p">)]</span>




            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">moving_loads_x</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">moving_loads</span> <span class="o">=</span> <span class="p">[</span><span class="n">MovingPointLoads</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">xv</span><span class="p">,</span>
                                                       <span class="n">p</span><span class="o">=</span><span class="n">pv</span><span class="p">,</span>
                                                       <span class="n">offset</span><span class="o">=</span><span class="n">offv</span><span class="p">,</span>
                                                       <span class="n">v</span><span class="o">=</span><span class="n">vv</span><span class="p">,</span>
                                                       <span class="n">t0</span><span class="o">=</span><span class="n">t0v</span><span class="p">,</span>
                                                       <span class="n">L</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">L</span><span class="p">)</span>
                                        <span class="k">for</span> <span class="n">xv</span><span class="p">,</span><span class="n">pv</span><span class="p">,</span><span class="n">offv</span><span class="p">,</span><span class="n">vv</span><span class="p">,</span><span class="n">t0v</span> <span class="ow">in</span>
                                        <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">moving_loads_x</span><span class="p">,</span>
                                            <span class="bp">self</span><span class="o">.</span><span class="n">moving_loads_Fz</span><span class="p">,</span>
                                            <span class="bp">self</span><span class="o">.</span><span class="n">moving_loads_offset</span><span class="p">,</span>
                                            <span class="bp">self</span><span class="o">.</span><span class="n">moving_loads_v</span><span class="p">,</span>
                                            <span class="bp">self</span><span class="o">.</span><span class="n">moving_loads_t0</span><span class="p">)]</span>





        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">tvals_norm</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">tvals_norm</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tvals</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">L</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">E</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">rho</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">xvals_norm</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">xvals_norm</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">xvals</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">L</span>


        <span class="k">if</span> <span class="nb">all</span><span class="p">([</span><span class="n">v</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span>
                <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">stationary_loads_x_norm</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">stationary_loads_omega_phase_norm</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">stationary_loads_vs_t_norm</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">stationary_loads_x</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">stationary_loads_omega_phase</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">stationary_loads_vs_t_norm</span><span class="p">,]</span>
               <span class="p">]):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">has_stationary_loads</span><span class="o">=</span><span class="kc">False</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">has_stationary_loads</span><span class="o">=</span><span class="kc">True</span>
            <span class="c1">#check if stationary loads omega phase is missing</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">stationary_loads_omega_phase</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">stationary_loads_x</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="c1">#use default omega_phase i.e. NONE</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">stationary_loads_omega_phase</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">stationary_loads_x</span><span class="p">)</span> <span class="o">*</span> <span class="p">[</span><span class="kc">None</span><span class="p">]</span>



            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">stationary_loads_x_norm</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">stationary_loads_x_norm</span> <span class="o">=</span> <span class="p">[</span><span class="n">v</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">L</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">stationary_loads_x</span><span class="p">]</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">stationary_loads_vs_t_norm</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="c1">#PolyLine(time, mag)</span>
                <span class="c1">#what if</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">stationary_loads_vs_t_norm</span> <span class="o">=</span> <span class="p">(</span>
                    <span class="p">[</span><span class="n">PolyLine</span><span class="p">(</span><span class="n">v</span><span class="o">.</span><span class="n">x</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">L</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">E</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">rho</span><span class="p">),</span> <span class="n">v</span><span class="o">.</span><span class="n">y</span> <span class="o">/</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">E</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">A</span><span class="p">))</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">stationary_loads_vs_t</span><span class="p">])</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">stationary_loads_omega_phase_norm</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">stationary_loads_omega_phase</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="c1">#use default omega_phase_norm, i.e. None</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">stationary_loads_omega_phase_norm</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">stationary_loads_x_norm</span><span class="p">)</span> <span class="o">*</span> <span class="p">[</span><span class="kc">None</span><span class="p">]</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="c1">#only omega is effected, phase remains unchanged</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">stationary_loads_omega_phase_norm</span> <span class="o">=</span> <span class="p">(</span>
                        <span class="p">[(</span><span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">L</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">E</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">rho</span><span class="p">),</span><span class="n">v</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">/</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">E</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">A</span><span class="p">))</span>
                            <span class="k">if</span> <span class="ow">not</span> <span class="n">v</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="kc">None</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">stationary_loads_omega_phase</span><span class="p">])</span>







        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kf</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">kf</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">L</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">I</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">A</span><span class="p">)</span>
<span class="c1">#        if Fz_norm is None: #This is a relic; loads now specified with moving_loads_...</span>
<span class="c1">#            self.Fz_norm = self.Fz / (self.E * self.A) #This is a relic; loads now specified with moving_loads_...</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mu_norm</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mu_norm</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mu</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">A</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">L</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rho</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">E</span><span class="p">))</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">k1_norm</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">k1_norm</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">k1</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">L</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">E</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">A</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">k3_norm</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">k3_norm</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">k3</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">L</span><span class="o">**</span><span class="mi">4</span> <span class="o">/</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">E</span><span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">A</span><span class="p">)</span>



        <span class="c1"># phi, beta, and quadrature points</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">BC</span> <span class="o">==</span> <span class="s2">&quot;SS&quot;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">phi</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">phiSS</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">beta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nterms</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
            <span class="c1">#note self.beta is the same as rtrwalker&#39;s more usual self.m</span>

            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">nquad</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">xj</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nquad</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nquad</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)))</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">BC_coeff</span> <span class="o">=</span> <span class="mi">1</span><span class="c1"># for DingEtal2012 it is two but it is not relevant anymore because i don&#39;t multiply the whole equation by 2.</span>

        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">BC</span> <span class="o">==</span> <span class="s2">&quot;CC&quot;</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">BC</span> <span class="o">==</span> <span class="s2">&quot;FF&quot;</span><span class="p">:</span>
            <span class="c1">#This is a relic; can only have &quot;SS&quot;</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;&#39;BC&#39; can only be &#39;SS&#39;&quot;</span><span class="p">)</span>
            <span class="k">def</span> <span class="nf">_f</span><span class="p">(</span><span class="n">beta</span><span class="p">):</span>
                <span class="k">return</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">beta</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cosh</span><span class="p">(</span><span class="n">beta</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">beta</span> <span class="o">=</span> <span class="n">find_n_roots</span><span class="p">(</span><span class="n">_f</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">nterms</span><span class="p">,</span> <span class="n">x0</span><span class="o">=</span><span class="mf">0.001</span><span class="p">,</span> <span class="n">dx</span><span class="o">=</span><span class="mf">3.14159</span> <span class="o">/</span> <span class="mi">10</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="mf">1.1</span><span class="p">)</span>

            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">nquad</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">xj</span> <span class="o">=</span> <span class="mf">0.5</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nquad</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nquad</span> <span class="o">-</span> <span class="mi">3</span><span class="p">)))</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">xj</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">xj</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.0001</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">xj</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.0001</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">xj</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">BC_coeff</span> <span class="o">=</span> <span class="mi">1</span> <span class="c1"># Coefficeint to multiply Fz(vt) and k3*Integral terms by</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">BC</span> <span class="o">==</span> <span class="s2">&quot;CC&quot;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">phi</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">phiCC</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">BC</span> <span class="o">==</span> <span class="s2">&quot;FF&quot;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">phi</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">phiFF</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">beta</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">beta</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">beta</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.0</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;only BC=&#39;SS&#39;, &#39;CC&#39; and &#39;FF&#39; have been implemented, you have </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">BC</span><span class="p">))</span>


        <span class="c1"># quadrature weighting</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">nquad</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">rhs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">reciprocal</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nquad</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
            <span class="n">lhs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">xj</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">,</span> <span class="p">:]</span> <span class="o">**</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nquad</span><span class="p">)[:,</span> <span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">]</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">Ij</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">lhs</span><span class="p">,</span> <span class="n">rhs</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">vsvdot</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">nterms</span><span class="p">)</span> <span class="c1">#vector of state values for odeint</span>


<div class="viewcode-block" id="SpecBeam.phiSS"><a class="viewcode-back" href="../../../api/geotecha.beam_on_foundation.specbeam.html#geotecha.beam_on_foundation.specbeam.SpecBeam.phiSS">[docs]</a>    <span class="k">def</span> <span class="nf">phiSS</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">beta</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">beta</span> <span class="o">*</span> <span class="n">x</span><span class="p">)</span></div>


<div class="viewcode-block" id="SpecBeam.phiCC"><a class="viewcode-back" href="../../../api/geotecha.beam_on_foundation.specbeam.html#geotecha.beam_on_foundation.specbeam.SpecBeam.phiCC">[docs]</a>    <span class="k">def</span> <span class="nf">phiCC</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">beta</span><span class="p">):</span>

        <span class="k">def</span> <span class="nf">_xi</span><span class="p">(</span><span class="n">beta</span><span class="p">):</span>
            <span class="k">return</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">cosh</span><span class="p">(</span><span class="n">beta</span><span class="p">)</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">beta</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sinh</span><span class="p">(</span><span class="n">beta</span><span class="p">)</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">beta</span><span class="p">))</span>

        <span class="k">return</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">cosh</span><span class="p">(</span><span class="n">beta</span> <span class="o">*</span> <span class="n">x</span><span class="p">)</span>
                <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">beta</span> <span class="o">*</span> <span class="n">x</span><span class="p">)</span>
                <span class="o">+</span> <span class="n">_xi</span><span class="p">(</span><span class="n">beta</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">beta</span> <span class="o">*</span> <span class="n">x</span><span class="p">)</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">sinh</span><span class="p">(</span><span class="n">beta</span> <span class="o">*</span> <span class="n">x</span><span class="p">))</span>
                <span class="p">)</span></div>


<div class="viewcode-block" id="SpecBeam.phiFF"><a class="viewcode-back" href="../../../api/geotecha.beam_on_foundation.specbeam.html#geotecha.beam_on_foundation.specbeam.SpecBeam.phiFF">[docs]</a>    <span class="k">def</span> <span class="nf">phiFF</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">beta</span><span class="p">):</span>

        <span class="k">def</span> <span class="nf">_xi</span><span class="p">(</span><span class="n">beta</span><span class="p">):</span>

            <span class="k">return</span> <span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">beta</span><span class="p">)</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">cosh</span><span class="p">(</span><span class="n">beta</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">beta</span><span class="p">)</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">sinh</span><span class="p">(</span><span class="n">beta</span><span class="p">)))</span>

        <span class="k">return</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">beta</span> <span class="o">*</span> <span class="n">x</span><span class="p">)</span>
                <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">cosh</span><span class="p">(</span><span class="n">beta</span> <span class="o">*</span> <span class="n">x</span><span class="p">)</span>
                <span class="o">+</span> <span class="n">_xi</span><span class="p">(</span><span class="n">beta</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">beta</span> <span class="o">*</span> <span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">sinh</span><span class="p">(</span><span class="n">beta</span> <span class="o">*</span> <span class="n">x</span><span class="p">))</span>
                <span class="p">)</span></div>


<div class="viewcode-block" id="SpecBeam.w"><a class="viewcode-back" href="../../../api/geotecha.beam_on_foundation.specbeam.html#geotecha.beam_on_foundation.specbeam.SpecBeam.w">[docs]</a>    <span class="k">def</span> <span class="nf">w</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">qk</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Nomalised vertcal deformation at x.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        qk : 1d ndarray of nterm floats</span>
<span class="sd">            Galerkin coefficients.</span>
<span class="sd">        x : float</span>
<span class="sd">            nomalised distances to calculate deflection at.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        w : float</span>
<span class="sd">            vertical deformation at x value.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">qk</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">phi</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">beta</span><span class="p">))</span></div>


<div class="viewcode-block" id="SpecBeam.vectorfield"><a class="viewcode-back" href="../../../api/geotecha.beam_on_foundation.specbeam.html#geotecha.beam_on_foundation.specbeam.SpecBeam.vectorfield">[docs]</a>    <span class="k">def</span> <span class="nf">vectorfield</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">vsv</span><span class="p">,</span> <span class="n">tnow</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="p">()):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        vsv :  float</span>
<span class="sd">            Vector of the state variables.</span>
<span class="sd">            vsv = [q1, q2, ...qk, q1dot, q2dot, ..., qkdot]</span>
<span class="sd">            where qk is the kth galerkin coefficient and qkdot is the time</span>
<span class="sd">            derivative of the kth Galerkin coefficient.</span>
<span class="sd">        tnow : float</span>
<span class="sd">            Current time.</span>
<span class="sd">        p : various</span>
<span class="sd">            Vector of parameters</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        vsvdot : vector of state variables first derivatives</span>
<span class="sd">            vsvdot = [q1dot, q2dot, ...qkdot, q1dotdot, q2dotdot, ..., qkdotdot]</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">q</span> <span class="o">=</span> <span class="n">vsv</span><span class="p">[:</span><span class="bp">self</span><span class="o">.</span><span class="n">nterms</span><span class="p">]</span>
        <span class="n">qdot</span> <span class="o">=</span> <span class="n">vsv</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">nterms</span><span class="p">:]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">vsvdot</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">nterms</span><span class="p">:]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">psi_q</span><span class="p">,</span> <span class="n">q</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vsvdot</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">nterms</span><span class="p">:]</span> <span class="o">+=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">psi_qdot</span><span class="p">,</span> <span class="n">qdot</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nterms</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">vsvdot</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">qdot</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
<span class="c1">#            self.vsvdot[self.nterms + i] = - self.mu_norm * qdot[i]</span>
<span class="c1">#</span>
<span class="c1">#            self.vsvdot[self.nterms + i] -= (self.k1_norm + self.kf**2 * self.beta[i]**4) * q[i]</span>
<span class="c1">#</span>

<span class="c1">#TODO: this is where the moving loads need to go</span>
<span class="c1">#            self.vsvdot[self.nterms + i] += self.BC_coeff * self.Fz_norm * self.phi(self.v_norm * tnow, self.beta[i])</span>
            <span class="k">if</span> <span class="n">tnow</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span>
                <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">()</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">has_moving_loads</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">mvl</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">moving_loads_norm</span><span class="p">:</span>
                    <span class="n">mvl_x</span><span class="p">,</span> <span class="n">mvl_p</span> <span class="o">=</span> <span class="n">mvl</span><span class="o">.</span><span class="n">point_loads_on_beam</span><span class="p">(</span><span class="n">t</span><span class="o">=</span><span class="n">tnow</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">vsvdot</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">nterms</span> <span class="o">+</span> <span class="n">i</span><span class="p">]</span> <span class="o">+=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">BC_coeff</span> <span class="o">*</span> <span class="n">mvl_p</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">phi</span><span class="p">(</span><span class="n">mvl_x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">beta</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">has_stationary_loads</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">stationary_loads_x_norm</span><span class="p">)):</span>
                    <span class="n">x</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">stationary_loads_x_norm</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>
                    <span class="n">mag_vs_time</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">stationary_loads_vs_t_norm</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>
                    <span class="n">mag</span> <span class="o">=</span> <span class="n">pwise</span><span class="o">.</span><span class="n">pinterp_x_y</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="n">mag_vs_time</span><span class="p">,</span><span class="n">xi</span><span class="o">=</span><span class="n">tnow</span><span class="p">)</span>
                    <span class="n">omega_phase</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">stationary_loads_omega_phase_norm</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>
                    <span class="k">if</span> <span class="n">omega_phase</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">vsvdot</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">nterms</span> <span class="o">+</span> <span class="n">i</span><span class="p">]</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">BC_coeff</span> <span class="o">*</span> <span class="n">mag</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">beta</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">omega</span><span class="p">,</span><span class="n">phase</span> <span class="o">=</span> <span class="n">omega_phase</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">vsvdot</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">nterms</span> <span class="o">+</span> <span class="n">i</span><span class="p">]</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">BC_coeff</span> <span class="o">*</span> <span class="n">mag</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">beta</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">tnow</span><span class="o">+</span><span class="n">phase</span><span class="p">)</span>
            <span class="k">if</span> <span class="mi">1</span><span class="p">:</span>
                <span class="c1"># DIY quadrature</span>


                <span class="n">Fj</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">q</span><span class="p">[:,</span><span class="kc">None</span><span class="p">]</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">phi</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">xj</span><span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="p">:],</span> <span class="bp">self</span><span class="o">.</span><span class="n">beta</span><span class="p">[:,</span><span class="kc">None</span><span class="p">]),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">**</span><span class="mi">3</span>
                <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Ij</span> <span class="o">*</span> <span class="n">Fj</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">k3barj</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">phi</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">xj</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">beta</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Haven&#39;t checked this yet&quot;</span><span class="p">)</span>
                <span class="c1"># scipy</span>
<span class="c1">#                print(&quot;yquad = {:12.2g}&quot;.format(y))</span>
                <span class="n">y</span><span class="p">,</span> <span class="n">err</span> <span class="o">=</span> <span class="n">integrate</span><span class="o">.</span><span class="n">quad</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">w_cubed_wi</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">q</span><span class="p">,</span><span class="n">i</span><span class="p">))</span>
<span class="c1">#                print(&quot;yscip = {:12.2g}&quot;.format(y))</span>
            <span class="c1">#maybe the quad integrate is not great for the oscillating function</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">vsvdot</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">nterms</span> <span class="o">+</span> <span class="n">i</span><span class="p">]</span> <span class="o">-=</span> <span class="bp">self</span><span class="o">.</span><span class="n">BC_coeff</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">k3_norm</span> <span class="o">*</span> <span class="n">y</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">vsvdot</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">nterms</span><span class="p">:]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lam_qdotdot</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">vsvdot</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">nterms</span><span class="p">:])</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">vsvdot</span></div>


<div class="viewcode-block" id="SpecBeam.w_cubed_wi"><a class="viewcode-back" href="../../../api/geotecha.beam_on_foundation.specbeam.html#geotecha.beam_on_foundation.specbeam.SpecBeam.w_cubed_wi">[docs]</a>    <span class="k">def</span> <span class="nf">w_cubed_wi</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">q</span><span class="p">,</span> <span class="n">i</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Non-linear cube term for numerical integration&quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">w</span><span class="p">(</span><span class="n">q</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span><span class="o">**</span><span class="mi">3</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">phi</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">beta</span><span class="p">[</span><span class="n">i</span><span class="p">])</span></div>


<div class="viewcode-block" id="SpecBeam.calulate_qk"><a class="viewcode-back" href="../../../api/geotecha.beam_on_foundation.specbeam.html#geotecha.beam_on_foundation.specbeam.SpecBeam.calulate_qk">[docs]</a>    <span class="k">def</span> <span class="nf">calulate_qk</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">t</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">t_norm</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">odeint_kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Calculate the nterm Galerkin coefficients qk at each time value</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        t : float or array of float, optional</span>
<span class="sd">            Raw time values.</span>
<span class="sd">        t_norm : float or array of float, optional</span>
<span class="sd">            Normalised time values. If t_norm==None then it will be</span>
<span class="sd">            calculated from raw t values and other params</span>
<span class="sd">            t_norm = t / L * sqrt(E / rho).</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        This method determines initializes self.t and self.t_norm and</span>
<span class="sd">        calculates `self.qsol`.</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">t_norm</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">t_norm</span> <span class="o">=</span> <span class="n">t</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">L</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">E</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">rho</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">t_norm</span> <span class="o">=</span> <span class="n">t_norm</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">t</span> <span class="o">=</span> <span class="n">t</span>

        <span class="n">vsv0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">nterms</span><span class="p">)</span> <span class="c1"># initial conditions</span>


        <span class="bp">self</span><span class="o">.</span><span class="n">time_independant_matrices</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">qsol</span> <span class="o">=</span> <span class="n">odeint</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">vectorfield</span><span class="p">,</span>
                      <span class="n">vsv0</span><span class="p">,</span>
                      <span class="bp">self</span><span class="o">.</span><span class="n">t_norm</span><span class="p">,</span>
                      <span class="n">args</span><span class="o">=</span><span class="p">(),</span>
                      <span class="o">**</span><span class="n">odeint_kwargs</span><span class="p">)</span></div>

<div class="viewcode-block" id="SpecBeam.time_independant_matrices"><a class="viewcode-back" href="../../../api/geotecha.beam_on_foundation.specbeam.html#geotecha.beam_on_foundation.specbeam.SpecBeam.time_independant_matrices">[docs]</a>    <span class="k">def</span> <span class="nf">time_independant_matrices</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Make all time independent matrices&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lam_qdotdot</span> <span class="o">=</span> <span class="n">integ</span><span class="o">.</span><span class="n">pdim1sin_abf_linear</span><span class="p">(</span><span class="n">m</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">beta</span><span class="p">,</span>
                                                   <span class="n">a</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">rhobar</span><span class="p">,</span>
                                                   <span class="n">b</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">Abar</span><span class="p">,</span>
                                                   <span class="n">implementation</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">implementation</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">psi_q</span> <span class="o">=</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">kf</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="n">integ</span><span class="o">.</span><span class="n">pdim1sin_DD_abDDf_linear</span><span class="p">(</span>
                                            <span class="n">m</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">beta</span><span class="p">,</span>
                                            <span class="n">a</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Ebar</span><span class="p">,</span>
                                            <span class="n">b</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Ibar</span><span class="p">,</span>
                                            <span class="n">implementation</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">implementation</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">psi_q</span> <span class="o">-=</span> <span class="bp">self</span><span class="o">.</span><span class="n">k1_norm</span> <span class="o">*</span> <span class="n">integ</span><span class="o">.</span><span class="n">pdim1sin_af_linear</span><span class="p">(</span>
                                            <span class="n">m</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">beta</span><span class="p">,</span>
                                            <span class="n">a</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">k1bar</span><span class="p">,</span>
                                            <span class="n">implementation</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">implementation</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">psi_qdot</span> <span class="o">=</span> <span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">mu_norm</span> <span class="o">*</span> <span class="n">integ</span><span class="o">.</span><span class="n">pdim1sin_af_linear</span><span class="p">(</span>
                                            <span class="n">m</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">beta</span><span class="p">,</span>
                                            <span class="n">a</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">mubar</span><span class="p">,</span>
                                            <span class="n">implementation</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">implementation</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">k3barj</span> <span class="o">=</span> <span class="n">pwise</span><span class="o">.</span><span class="n">pinterp_x_y</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">k1bar</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">xj</span><span class="p">)</span></div>


<div class="viewcode-block" id="SpecBeam.wofx"><a class="viewcode-back" href="../../../api/geotecha.beam_on_foundation.specbeam.html#geotecha.beam_on_foundation.specbeam.SpecBeam.wofx">[docs]</a>    <span class="k">def</span> <span class="nf">wofx</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">x_norm</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">tslice</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span> <span class="n">normalise_w</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Deflection at distance x, and times t[tslice]</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        x : float or ndarray of float, optional</span>
<span class="sd">            Raw values of x to calculate deflection at. Default x=None.</span>
<span class="sd">        x_norm : float or array of float, optional</span>
<span class="sd">            Normalised x values to calc deflection at.  If x_norm==None then</span>
<span class="sd">            it will be calculated frm `x` and other properties : x_norm = x / L.</span>
<span class="sd">            Default x_norm=None.</span>
<span class="sd">        tslice : slice object, optional</span>
<span class="sd">            slice to select subset of time values.  Default</span>
<span class="sd">            tslice=slice(None, None, None) i.e. all time values.</span>
<span class="sd">            Note the array of time values is already in the object (it was</span>
<span class="sd">            used to calc the qk galerkin coefficients).</span>
<span class="sd">        normalise_w : True/False, optional</span>
<span class="sd">            If True then output is normalised deflection.  Default nomalise_w=True.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        w : array of float, shape(len(x),len(t))</span>
<span class="sd">            Deflections at x and self.t_norm[tslice]</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">x_norm</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">x_norm</span> <span class="o">=</span> <span class="n">x</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">L</span>

        <span class="n">x_norm</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">atleast_1d</span><span class="p">(</span><span class="n">x_norm</span><span class="p">)</span>

        <span class="n">v</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">x_norm</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tvals_norm</span><span class="p">[</span><span class="n">tslice</span><span class="p">])))</span>

        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">xx</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">x_norm</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="n">qq</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">qsol</span><span class="p">[</span><span class="n">tslice</span><span class="p">,</span> <span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">nterms</span><span class="p">]):</span>
                <span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">w</span><span class="p">(</span><span class="n">qq</span><span class="p">,</span> <span class="n">xx</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">normalise_w</span><span class="p">:</span>
            <span class="n">v</span> <span class="o">*=</span> <span class="bp">self</span><span class="o">.</span><span class="n">L</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">x_norm</span><span class="p">)</span><span class="o">==</span><span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">v</span></div>


<div class="viewcode-block" id="SpecBeam.runme"><a class="viewcode-back" href="../../../api/geotecha.beam_on_foundation.specbeam.html#geotecha.beam_on_foundation.specbeam.SpecBeam.runme">[docs]</a>    <span class="k">def</span> <span class="nf">runme</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

        <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">force_calc</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">load_defl</span><span class="p">()):</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">use_analytical</span><span class="p">:</span>

                <span class="bp">self</span><span class="o">.</span><span class="n">time_independant_matrices</span><span class="p">()</span>



                <span class="c1">#adjust matrices so that thaey are all onthe left hand side of the</span>
                <span class="c1"># equation.  i.e. analytical equation is arranged differently to</span>
                <span class="c1"># numerical equations (and I did the numerical formulation before</span>
                <span class="c1"># the analyitcal).</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">lam_qdotdot</span><span class="o">*=</span><span class="mi">1</span>  <span class="c1"># rho*A</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">psi_q</span><span class="o">*=-</span><span class="mi">1</span> <span class="c1">#kf**2 * E*I +++++ k1</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">psi_qdot</span><span class="o">*=-</span><span class="mi">1</span> <span class="c1">#mu</span>


                <span class="c1"># make the block beta.  ONly the second nterms elements will be relevant in calcs.</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">beta_block</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">nterms</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">beta_block</span><span class="p">[:</span><span class="bp">self</span><span class="o">.</span><span class="n">nterms</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">beta</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">beta_block</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">nterms</span><span class="p">:]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">beta</span>

                <span class="bp">self</span><span class="o">.</span><span class="n">_make_gam</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_make_psi</span><span class="p">()</span>

                <span class="bp">self</span><span class="o">.</span><span class="n">_make_eigs_and_v</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">make_time_dependent_arrays</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">make_output</span><span class="p">()</span>


            <span class="k">else</span><span class="p">:</span>
                <span class="c1">#using numerical answer</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">calulate_qk</span><span class="p">(</span><span class="n">t_norm</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">tvals_norm</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">defl_norm</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">wofx</span><span class="p">(</span><span class="n">x_norm</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">xvals_norm</span><span class="p">,</span> <span class="n">normalise_w</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                <span class="c1">#Should be array of shape (len(self.xvals_norm), len(self.tvals_norm))</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">L</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">defl</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">defl_norm</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">L</span></div>


    <span class="k">def</span> <span class="nf">_make_gam</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Make the 2n =*2n block gamma matrix</span>


<span class="sd">        Used with `use_analytical`=True</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1">#self.m_block = np.empty(2 * self.neig, dtype=float)</span>
        <span class="c1">#self.m_block[:self.neig] = self.m</span>
        <span class="c1">#self.m_block[self.neig:] = self.m</span>


        <span class="bp">self</span><span class="o">.</span><span class="n">gam</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">2</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">nterms</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">nterms</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>


        <span class="bp">self</span><span class="o">.</span><span class="n">gam</span><span class="p">[:</span><span class="bp">self</span><span class="o">.</span><span class="n">nterms</span><span class="p">,</span> <span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">nterms</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nterms</span><span class="p">)</span> <span class="c1">#top left</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gam</span><span class="p">[:</span><span class="bp">self</span><span class="o">.</span><span class="n">nterms</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">nterms</span><span class="p">:]</span> <span class="o">=</span>  <span class="mi">0</span> <span class="c1">#top right</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gam</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">nterms</span><span class="p">:,</span> <span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">nterms</span><span class="p">]</span> <span class="o">=</span>  <span class="mi">0</span> <span class="c1">#bottom left</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gam</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">nterms</span><span class="p">:,</span> <span class="bp">self</span><span class="o">.</span><span class="n">nterms</span><span class="p">:]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">lam_qdotdot</span><span class="p">[:,:]</span><span class="c1">#botom right</span>


        <span class="c1">#self.gam[np.abs(self.gam)&lt;1e-8] = 0.0</span>

<span class="c1">#        self.lam_qdotdot #+ve</span>
<span class="c1">#</span>
<span class="c1">#        self.psi_q #-ve</span>
<span class="c1">#</span>
<span class="c1">#        self.psi_qdot*=1 #-ve</span>

        <span class="k">return</span>

    <span class="k">def</span> <span class="nf">_make_psi</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Make the 2n =*2n block psi matrix</span>

<span class="sd">        Used with `use_analytical`=True&quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">psi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">2</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">nterms</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">nterms</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">psi</span><span class="p">[:</span><span class="bp">self</span><span class="o">.</span><span class="n">nterms</span><span class="p">,</span> <span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">nterms</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span> <span class="c1">#top left</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">psi</span><span class="p">[:</span><span class="bp">self</span><span class="o">.</span><span class="n">nterms</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">nterms</span><span class="p">:]</span> <span class="o">=</span>  <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nterms</span><span class="p">)</span> <span class="c1">#top right</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">psi</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">nterms</span><span class="p">:,</span> <span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">nterms</span><span class="p">]</span> <span class="o">=</span>  <span class="bp">self</span><span class="o">.</span><span class="n">psi_q</span> <span class="c1">#bottom left</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">psi</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">nterms</span><span class="p">:,</span> <span class="bp">self</span><span class="o">.</span><span class="n">nterms</span><span class="p">:]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">psi_qdot</span><span class="c1">#botom right</span>


        <span class="c1">#self.psi[np.abs(self.psi)&lt;1e-8] = 0.0</span>
        <span class="k">return</span>

    <span class="k">def</span> <span class="nf">_make_eigs_and_v</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;make Igam_psi, v and eigs, and Igamv</span>

<span class="sd">#TODO: make sure this is all still relevatn after copyint from speccon1d_unsat</span>


<span class="sd">        Finds the eigenvalues, `self.eigs`, and eigenvectors, `self.v` of</span>
<span class="sd">        inverse(gam)*psi.  Once found the matrix inverse(gamma*v), `self.Igamv`</span>
<span class="sd">        is determined.</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        From the original equation</span>

<span class="sd">        .. math:: \\mathbf{\\Gamma}\\mathbf{A}&#39;=\\mathbf{\\Psi A}+loading\\:terms</span>

<span class="sd">        `self.eigs` and `self.v` are the eigenvalues and eigenvegtors of the matrix `self.Igam_psi`</span>

<span class="sd">        .. math:: \\left(\\mathbf{\\Gamma}^{-1}\\mathbf{\\Psi}\\right)</span>

<span class="sd">        &quot;&quot;&quot;</span>

<span class="c1">#        self.psi[np.abs(self.psi) &lt; 1e-8] = 0.0</span>
        <span class="n">Igam_psi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">inv</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gam</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">psi</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">eigs</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">v</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">eig</span><span class="p">(</span><span class="n">Igam_psi</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">v</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">v</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Igamv</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">inv</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gam</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">v</span><span class="p">))</span>

        <span class="k">if</span> <span class="kc">False</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">eig</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">eigs</span><span class="p">):</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{:s}</span><span class="s2">, </span><span class="si">{:12.6f}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">zfill</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="n">eig</span><span class="p">))</span>

<div class="viewcode-block" id="SpecBeam.make_time_dependent_arrays"><a class="viewcode-back" href="../../../api/geotecha.beam_on_foundation.specbeam.html#geotecha.beam_on_foundation.specbeam.SpecBeam.make_time_dependent_arrays">[docs]</a>    <span class="k">def</span> <span class="nf">make_time_dependent_arrays</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;make all time dependent arrays</span>

<span class="sd">        See Also</span>
<span class="sd">        --------</span>
<span class="sd">        self.make_E_Igamv_the()</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">make_E_Igamv_the</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">v_E_Igamv_the</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">v</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">E_Igamv_the</span><span class="p">)</span></div>



<div class="viewcode-block" id="SpecBeam.make_E_Igamv_the"><a class="viewcode-back" href="../../../api/geotecha.beam_on_foundation.specbeam.html#geotecha.beam_on_foundation.specbeam.SpecBeam.make_E_Igamv_the">[docs]</a>    <span class="k">def</span> <span class="nf">make_E_Igamv_the</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;sum contributions from all loads</span>

<span class="sd">        Calculates all contributions to E*inverse(gam*v)*theta part of solution</span>
<span class="sd">        defl=phi*vE*inverse(gam*v)*theta. i.e. surcharge, vacuum, top and bottom</span>
<span class="sd">        pore pressure boundary conditions. `make_E_Igamv_the` will create</span>
<span class="sd">        `self.E_Igamv_the`.  `self.E_Igamv_the`  is an array</span>
<span class="sd">        of size (nterms, len(tvals)). So the columns are the column array</span>
<span class="sd">        E*inverse(gam*v)*theta calculated at each output time.  This will allow</span>
<span class="sd">        us later to do defl = phi*v*self.E_Igamv_the</span>

<span class="sd">        See Also</span>
<span class="sd">        --------</span>
<span class="sd">        _make_E_Igamv_the_mvl :  moiving point load contribution</span>

<span class="sd">        &quot;&quot;&quot;</span>


        <span class="bp">self</span><span class="o">.</span><span class="n">E_Igamv_the</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">2</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">nterms</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tvals_norm</span><span class="p">)),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">complex</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">has_moving_loads</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_make_E_Igamv_the_mvpl</span><span class="p">()</span> <span class="c1">#moving point loads</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">E_Igamv_the</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">E_Igamv_the_mvpl</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">has_stationary_loads</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_make_E_Igamv_the_stationary</span><span class="p">()</span> <span class="c1">#moving point loads</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">E_Igamv_the</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">E_Igamv_the_stationary</span>

        <span class="k">return</span></div>

    <span class="k">def</span> <span class="nf">_make_E_Igamv_the_mvpl</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Moving point load contribution to self.E_Igam_the</span>

<span class="sd">        Makes `self.E_Igamv_mvpl`  which is an array</span>
<span class="sd">        of size (nterms, len(tvals))</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">E_Igamv_the_mvpl</span> <span class="o">=</span> <span class="n">speccon1d</span><span class="o">.</span><span class="n">dim1sin_E_Igamv_the_mvpl</span><span class="p">(</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">beta_block</span><span class="p">,</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">eigs</span><span class="p">,</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">tvals_norm</span><span class="p">,</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">Igamv</span><span class="p">,</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">moving_loads_norm</span><span class="p">,</span>
                            <span class="n">dT</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span>
                            <span class="n">theta_zero_indexes</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">nterms</span><span class="p">),</span>
                            <span class="n">implementation</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">implementation</span><span class="p">)</span>

        <span class="k">return</span>

    <span class="k">def</span> <span class="nf">_make_E_Igamv_the_stationary</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Stationary point load contribution to self.E_Igam_the</span>

<span class="sd">        Makes `self.E_Igamv_stationary`  which is an array</span>
<span class="sd">        of size (nterms, len(tvals))</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">pseudo_k</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">stationary_loads_x_norm</span><span class="p">]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">E_Igamv_the_stationary</span> <span class="o">=</span> <span class="n">speccon1d</span><span class="o">.</span><span class="n">dim1sin_E_Igamv_the_deltamag_linear</span><span class="p">(</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">beta_block</span><span class="p">,</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">eigs</span><span class="p">,</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">tvals_norm</span><span class="p">,</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">Igamv</span><span class="p">,</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">stationary_loads_x_norm</span><span class="p">,</span>
                            <span class="n">pseudo_k</span><span class="p">,</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">stationary_loads_vs_t_norm</span><span class="p">,</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">stationary_loads_omega_phase_norm</span><span class="p">,</span>
                            <span class="n">dT</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                            <span class="n">theta_zero_indexes</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">nterms</span><span class="p">),</span>
                            <span class="n">implementation</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">implementation</span><span class="p">)</span>
        <span class="k">return</span>

<div class="viewcode-block" id="SpecBeam.make_output"><a class="viewcode-back" href="../../../api/geotecha.beam_on_foundation.specbeam.html#geotecha.beam_on_foundation.specbeam.SpecBeam.make_output">[docs]</a>    <span class="k">def</span> <span class="nf">make_output</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;make all output&quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_make_defl</span><span class="p">()</span></div>

    <span class="k">def</span> <span class="nf">_make_defl</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="s2">&quot;Make deflection and deflection rate&quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">defl_norm</span> <span class="o">=</span> <span class="n">speccon1d</span><span class="o">.</span><span class="n">dim1sin_f</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">beta</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">xvals_norm</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">tvals_norm</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">v_E_Igamv_the</span><span class="p">[:</span><span class="bp">self</span><span class="o">.</span><span class="n">nterms</span><span class="p">,</span> <span class="p">:],</span>
            <span class="n">drn</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">defl_norm</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">atleast_2d</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">defl_norm</span><span class="p">)</span>

        <span class="c1">#check if complex part is small</span>
        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">imag</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">defl_norm</span><span class="p">),</span><span class="mi">0</span><span class="p">,</span><span class="n">atol</span><span class="o">=</span><span class="mf">1e-12</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">defl_norm</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">defl_norm</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Imaginary parts of self.defl are &gt; 1e-12&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">L</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">defl</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">defl_norm</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">L</span>




        <span class="k">return</span>

<div class="viewcode-block" id="SpecBeam.saveme"><a class="viewcode-back" href="../../../api/geotecha.beam_on_foundation.specbeam.html#geotecha.beam_on_foundation.specbeam.SpecBeam.saveme">[docs]</a>    <span class="k">def</span> <span class="nf">saveme</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Save deflection vs time to file</span>

<span class="sd">        Deflection will be saved to :</span>
<span class="sd">        &#39;self.file_stem + &quot;_defl.csv&#39;</span>
<span class="sd">        Normalised deflection will be saved to:</span>
<span class="sd">        &#39;self.file_stem + &quot;_defl_norm.csv&quot;</span>

<span class="sd">        Notes:</span>
<span class="sd">        -----</span>
<span class="sd">        Might not handle singel x value and single t vlue.</span>

<span class="sd">        &quot;&quot;&quot;</span>
<span class="c1">#TODO: Need to account for single xvalue and single y value</span>

        <span class="n">two_d_defl_norm</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">atleast_2d</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">defl_norm</span><span class="p">)</span>


        <span class="n">inputoutput</span><span class="o">.</span><span class="n">save_grid_data_to_file</span><span class="p">(</span><span class="n">data_dicts</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
                                               <span class="n">name</span><span class="o">=</span><span class="s2">&quot;_defl_norm&quot;</span><span class="p">,</span>
                                               <span class="n">data</span><span class="o">=</span><span class="n">two_d_defl_norm</span><span class="p">,</span><span class="c1">#self.defl_norm,</span>
                                               <span class="n">row_labels</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">xvals_norm</span><span class="p">,</span>
                                               <span class="n">row_labels_label</span><span class="o">=</span><span class="s2">&quot;x_norm&quot;</span><span class="p">,</span>
                                               <span class="n">column_labels</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">tvals_norm</span><span class="p">),</span>
                                           <span class="n">file_stem</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">file_stem</span><span class="p">,</span>
                                           <span class="n">create_directory</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">L</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">two_d_defl</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">atleast_2d</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">defl</span><span class="p">)</span>
            <span class="n">inputoutput</span><span class="o">.</span><span class="n">save_grid_data_to_file</span><span class="p">(</span><span class="n">data_dicts</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
                                               <span class="n">name</span><span class="o">=</span><span class="s2">&quot;_defl&quot;</span><span class="p">,</span>
                                               <span class="n">data</span><span class="o">=</span><span class="n">two_d_defl</span><span class="p">,</span><span class="c1">#self.defl,</span>
                                               <span class="n">row_labels</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">xvals</span><span class="p">,</span>
                                               <span class="n">row_labels_label</span><span class="o">=</span><span class="s2">&quot;xvals&quot;</span><span class="p">,</span>
                                               <span class="n">column_labels</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">tvals</span><span class="p">),</span>
                                           <span class="n">file_stem</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">file_stem</span><span class="p">,</span>
                                           <span class="n">create_directory</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></div>

<div class="viewcode-block" id="SpecBeam.load_defl"><a class="viewcode-back" href="../../../api/geotecha.beam_on_foundation.specbeam.html#geotecha.beam_on_foundation.specbeam.SpecBeam.load_defl">[docs]</a>    <span class="k">def</span> <span class="nf">load_defl</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Loads defl_norm from txt file if it exists</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Loaded : boolean</span>
<span class="sd">            If True then self.defl either already exists or has been</span>
<span class="sd">            successfully loaded.</span>


<span class="sd">        &quot;&quot;&quot;</span>

<span class="c1">#        fname = self.file_stem + &quot;_defl_norm.csv&quot;</span>

        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;defl_norm&quot;</span><span class="p">):</span>
            <span class="c1">#defl_norm already exists in memory</span>
            <span class="k">return</span> <span class="kc">True</span>


        <span class="c1">#check if out file exists</span>
        <span class="n">fname</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">file_stem</span> <span class="o">+</span> <span class="s2">&quot;_defl_norm.csv&quot;</span>



        <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">fname</span><span class="p">):</span>
            <span class="k">return</span> <span class="kc">False</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">fname</span><span class="p">,</span><span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
                <span class="n">lines</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span>


            <span class="n">t_norm</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="nb">float</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">lines</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">)[</span><span class="mi">2</span><span class="p">:]])</span>
            <span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">atleast_2d</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">genfromtxt</span><span class="p">(</span><span class="n">fname</span><span class="o">=</span><span class="n">fname</span><span class="p">,</span><span class="n">skip_header</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">,</span><span class="n">delimiter</span><span class="o">=</span><span class="s2">&quot;,&quot;</span><span class="p">))</span>
            <span class="n">x_norm</span> <span class="o">=</span> <span class="n">a</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span>
            <span class="n">defl_norm</span> <span class="o">=</span> <span class="n">a</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">:]</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">defl_norm</span> <span class="o">=</span> <span class="n">defl_norm</span>

            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">L</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">defl</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">defl_norm</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">L</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">xvals</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">xvals_norm</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">L</span>

            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;loaded it&#39;</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">True</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span></div>
<div class="viewcode-block" id="SpecBeam.onClick"><a class="viewcode-back" href="../../../api/geotecha.beam_on_foundation.specbeam.html#geotecha.beam_on_foundation.specbeam.SpecBeam.onClick">[docs]</a>    <span class="k">def</span> <span class="nf">onClick</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">pause</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ani</span><span class="o">.</span><span class="n">event_source</span><span class="o">.</span><span class="n">stop</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ani</span><span class="o">.</span><span class="n">event_source</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pause</span> <span class="o">^=</span> <span class="kc">True</span></div>

<div class="viewcode-block" id="SpecBeam.plot_w_vs_x_overtime"><a class="viewcode-back" href="../../../api/geotecha.beam_on_foundation.specbeam.html#geotecha.beam_on_foundation.specbeam.SpecBeam.plot_w_vs_x_overtime">[docs]</a>    <span class="k">def</span> <span class="nf">plot_w_vs_x_overtime</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Plot the normalised deflection vs distance for all times</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">ax</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
            <span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">load_defl</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">norm</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">t</span><span class="p">,</span> <span class="n">defl</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tvals_norm</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">defl_norm</span><span class="o">.</span><span class="n">T</span><span class="p">):</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">xvals_norm</span><span class="p">,</span> <span class="n">defl</span><span class="p">,</span>
                        <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;t=</span><span class="si">{:5.2g}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">t</span><span class="p">))</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;x_norm&quot;</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;w_norm&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">t</span><span class="p">,</span> <span class="n">defl</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tvals</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">defl</span><span class="o">.</span><span class="n">T</span><span class="p">):</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">xvals</span><span class="p">,</span> <span class="n">defl</span><span class="p">,</span>
                        <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;t=</span><span class="si">{:5.2g}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">t</span><span class="p">))</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;w&quot;</span><span class="p">)</span>

        <span class="n">leg</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
        <span class="n">leg</span><span class="o">.</span><span class="n">draggable</span><span class="p">()</span>


        <span class="k">return</span> <span class="n">ax</span></div>


<div class="viewcode-block" id="SpecBeam.animateme"><a class="viewcode-back" href="../../../api/geotecha.beam_on_foundation.specbeam.html#geotecha.beam_on_foundation.specbeam.SpecBeam.animateme">[docs]</a>    <span class="k">def</span> <span class="nf">animateme</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">xlim</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ylim</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">saveme</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">interval</span><span class="o">=</span><span class="mi">50</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Animate the deflection vs distance over time plot</span>

<span class="sd">        Will display beam osciallations and evolving max and min deflection</span>
<span class="sd">        envelopes.  Position and magnitude of load will also be shown.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        xlim : tuple of 2 floats, optional</span>
<span class="sd">            Limits of x-axis , default xlim=None, i.e. use Beam ends</span>
<span class="sd">        ylim : tuple of 2 floats, optional</span>
<span class="sd">            Limits of y-axis , default ylim=None, i.e. limits will be</span>
<span class="sd">            calculated ylim=(1.5*defl_min,1.1*defl_max)</span>
<span class="sd">        norm : True/False, optional</span>
<span class="sd">            If norm=True normalised values will be plotted. Default norm=True.</span>
<span class="sd">        saveme : False/True</span>
<span class="sd">            Whether to save the animation to disk. Default saveme=False.</span>
<span class="sd">        interval : float</span>
<span class="sd">            Number of miliseconds for each frame.  Default interval=50.</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">pause</span> <span class="o">=</span> <span class="kc">False</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">load_defl</span><span class="p">()</span>

        <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
        <span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>
        <span class="n">ax2</span> <span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">twinx</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">norm</span><span class="p">:</span>
            <span class="n">xx</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">xvals_norm</span>
            <span class="n">tt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tvals_norm</span>
            <span class="n">defl</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">defl_norm</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">has_moving_loads</span><span class="p">:</span>
                <span class="n">moving_loads</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">moving_loads_norm</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">has_stationary_loads</span><span class="p">:</span>
                <span class="n">stationary_loads_x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">stationary_loads_x_norm</span>
                <span class="n">stationary_loads_vs_t</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">stationary_loads_vs_t_norm</span>
                <span class="n">stationary_loads_omega_phase</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">stationary_loads_omega_phase_norm</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;x_norm&quot;</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;w_norm&quot;</span><span class="p">)</span>
            <span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Fz_norm&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">xx</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">xvals</span>
            <span class="n">tt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tvals</span>
            <span class="n">defl</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">defl</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">has_moving_loads</span><span class="p">:</span>
                <span class="n">moving_loads</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">moving_loads</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">has_stationary_loads</span><span class="p">:</span>
                <span class="n">stationary_loads_x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">stationary_loads_x_norm</span>
                <span class="n">stationary_loads_vs_t</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">stationary_loads_vs_t_norm</span>
                <span class="n">stationary_loads_omega_phase</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">stationary_loads_omega_phase_norm</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;w&quot;</span><span class="p">)</span>
            <span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Fz&quot;</span><span class="p">)</span>

        <span class="n">defl_min</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">defl</span><span class="p">)</span>
        <span class="n">defl_max</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">defl</span><span class="p">)</span>

        <span class="n">x_min</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">xx</span><span class="p">)</span>
        <span class="n">x_max</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">xx</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">xlim</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">xlim</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">x_min</span><span class="p">,</span><span class="n">x_max</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">ylim</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">ylim</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">defl_min</span><span class="p">,</span><span class="mf">1.5</span><span class="o">*</span><span class="n">defl_max</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mf">1.5</span><span class="o">*</span><span class="n">defl_min</span><span class="p">,</span><span class="mf">1.1</span><span class="o">*</span><span class="n">defl_max</span><span class="p">)</span>



        <span class="n">max_defl_evolve</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">defl</span><span class="p">)</span>
        <span class="n">min_defl_evolve</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">defl</span><span class="p">)</span>


        <span class="n">max_defl_evolve</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">defl</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">min_defl_evolve</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">defl</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">tt</span><span class="p">)):</span>
            <span class="k">if</span> <span class="n">i</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span>
                <span class="k">continue</span>
            <span class="n">max_defl_evolve</span><span class="p">[:,</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">maximum</span><span class="p">(</span><span class="n">defl</span><span class="p">[:,</span><span class="n">i</span><span class="p">,],</span> <span class="n">max_defl_evolve</span><span class="p">[:,</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
            <span class="n">min_defl_evolve</span><span class="p">[:,</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">minimum</span><span class="p">(</span><span class="n">defl</span><span class="p">[:,</span><span class="n">i</span><span class="p">,],</span> <span class="n">min_defl_evolve</span><span class="p">[:,</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>


        <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">invert_yaxis</span><span class="p">()</span>
        <span class="c1">#moving point load</span>



        <span class="n">data_line</span><span class="p">,</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">),(</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">),</span>
                            <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;-&quot;</span><span class="p">,</span>
                            <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>

        <span class="n">min_line</span><span class="p">,</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">),(</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">),</span>
                            <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;-&quot;</span><span class="p">,</span>
                            <span class="n">color</span><span class="o">=</span><span class="s1">&#39;orange&#39;</span><span class="p">)</span>
        <span class="n">max_line</span><span class="p">,</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">),(</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">),</span>
                            <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;-&quot;</span><span class="p">,</span>
                            <span class="n">color</span><span class="o">=</span><span class="s1">&#39;cyan&#39;</span><span class="p">)</span>

        <span class="n">pmax</span><span class="o">=</span><span class="mf">1e-50</span>
        <span class="n">pmin</span><span class="o">=</span><span class="mf">1e50</span>




        <span class="n">p_scale_mvl</span><span class="o">=</span><span class="mf">1e-50</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">has_moving_loads</span><span class="p">:</span>
            <span class="c1"># mvpl1_line1,mvpl1_line2,..., mvpl2_line1, mvpl2_line2, mvpl_line3, ...</span>
            <span class="n">mvpl_lines</span> <span class="o">=</span> <span class="p">[</span><span class="n">ax2</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">),</span> <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">),</span>
                             <span class="n">arrowprops</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">shrink</span><span class="o">=</span><span class="mf">0.0</span><span class="p">)</span>
                                             <span class="c1">#arrowstyle=&quot;-&gt;&quot;,</span>
                                             <span class="c1">#edgecolor=&#39;red&#39;,</span>
                                             <span class="c1">#shrinkline=0</span>
                                             <span class="c1">#)</span>
                             <span class="p">)</span> <span class="k">for</span> <span class="n">mvpl</span> <span class="ow">in</span> <span class="n">moving_loads</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">mvpl</span><span class="o">.</span><span class="n">xt</span><span class="p">]</span>

            <span class="n">p_scale_mvl</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="nb">max</span><span class="p">([</span><span class="n">p</span> <span class="k">for</span> <span class="n">mvpl</span> <span class="ow">in</span> <span class="n">moving_loads</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">mvpl</span><span class="o">.</span><span class="n">p</span><span class="p">]))</span>
            <span class="n">pmax</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">pmax</span><span class="p">,</span><span class="nb">max</span><span class="p">([</span><span class="n">p</span> <span class="k">for</span> <span class="n">mvpl</span> <span class="ow">in</span> <span class="n">moving_loads</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">mvpl</span><span class="o">.</span><span class="n">p</span><span class="p">]))</span>
            <span class="n">pmin</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">pmin</span><span class="p">,</span><span class="nb">min</span><span class="p">([</span><span class="n">p</span> <span class="k">for</span> <span class="n">mvpl</span> <span class="ow">in</span> <span class="n">moving_loads</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">mvpl</span><span class="o">.</span><span class="n">p</span><span class="p">]))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">mvpl_lines</span><span class="o">=</span><span class="p">[]</span>


        <span class="n">p_scale_stationary</span><span class="o">=</span><span class="mf">1e-50</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">has_stationary_loads</span><span class="p">:</span>


            <span class="n">x_map</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">stationary_loads_x</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
            <span class="n">x_map</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>


            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">stationary_loads_x</span><span class="p">)):</span>
                <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
                    <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">isclose</span><span class="p">(</span><span class="n">stationary_loads_x</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">stationary_loads_x</span><span class="p">[</span><span class="n">j</span><span class="p">]):</span>
                        <span class="n">x_map</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="n">j</span>
                        <span class="k">break</span>


            <span class="n">stationary_lines</span><span class="o">=</span><span class="p">[</span><span class="n">ax2</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">),</span> <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">),</span>
                             <span class="n">arrowprops</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">,</span> <span class="n">shrink</span><span class="o">=</span><span class="mf">0.0</span><span class="p">)</span>
                                             <span class="c1">#arrowstyle=&quot;-&gt;&quot;,</span>
                                             <span class="c1">#edgecolor=&#39;red&#39;,</span>
                                             <span class="c1">#shrinkline=0</span>
                                             <span class="c1">#)</span>
                             <span class="p">)</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="n">x_map</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">)]</span><span class="c1">#stationary_loads_x]</span>
            <span class="n">p_scale_stationary</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="nb">max</span><span class="p">([</span><span class="n">p</span> <span class="k">for</span> <span class="n">mag_vs_time</span> <span class="ow">in</span> <span class="n">stationary_loads_vs_t</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">mag_vs_time</span><span class="o">.</span><span class="n">y</span><span class="p">]))</span>

            <span class="n">pmin_temp</span><span class="o">=</span><span class="p">[]</span>
            <span class="n">pmax_temp</span><span class="o">=</span><span class="p">[]</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="n">x_map</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
                <span class="n">sum_mag_max</span><span class="o">=</span><span class="mi">0</span>
                <span class="n">sum_mag_min</span><span class="o">=</span><span class="mi">0</span>
                <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">stationary_loads_x</span><span class="p">)):</span>
                    <span class="k">if</span> <span class="n">x_map</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">!=</span><span class="n">i</span><span class="p">:</span>
                        <span class="k">continue</span>
                    <span class="n">mag_max</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">stationary_loads_vs_t</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">y</span><span class="p">)</span>
                    <span class="n">mag_min</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">stationary_loads_vs_t</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">y</span><span class="p">)</span>
                    <span class="n">sum_mag_max</span> <span class="o">+=</span><span class="n">mag_max</span>
                    <span class="n">sum_mag_min</span> <span class="o">+=</span><span class="n">mag_min</span>
                <span class="n">pmin_temp</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">sum_mag_min</span><span class="p">)</span>
                <span class="n">pmax_temp</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">sum_mag_max</span><span class="p">)</span>

            <span class="n">pmax</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">pmax</span><span class="p">,</span> <span class="nb">max</span><span class="p">(</span><span class="n">pmax_temp</span><span class="p">))</span>
            <span class="n">pmin</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">pmin</span><span class="p">,</span> <span class="nb">min</span><span class="p">(</span><span class="n">pmin_temp</span><span class="p">))</span>

        <span class="k">else</span><span class="p">:</span>
             <span class="n">stationary_lines</span><span class="o">=</span><span class="p">[]</span>



        <span class="n">ax2</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="nb">max</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">pmin</span><span class="p">)</span> <span class="p">,</span> <span class="nb">abs</span><span class="p">(</span><span class="n">pmax</span><span class="p">)),</span><span class="mf">1.5</span><span class="o">*</span><span class="nb">max</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">pmin</span><span class="p">)</span> <span class="p">,</span> <span class="nb">abs</span><span class="p">(</span><span class="n">pmax</span><span class="p">)))</span>

<span class="c1">#        align_yaxis(ax, 0, ax2, 0)</span>
        <span class="n">align_yaxis</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span><span class="n">ax2</span><span class="p">)</span>



        <span class="n">p_scale</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">p_scale_mvl</span><span class="p">,</span> <span class="n">p_scale_stationary</span><span class="p">)</span>
        <span class="n">p_scale</span> <span class="o">*=</span><span class="mi">2</span><span class="o">/</span><span class="nb">abs</span><span class="p">(</span><span class="n">defl_min</span><span class="p">)</span><span class="o">/</span><span class="mi">3</span> <span class="c1"># max load will plot to half the scale</span>

        <span class="n">time_template</span> <span class="o">=</span> <span class="s1">&#39;time = </span><span class="si">{:.4f}</span><span class="s1">&#39;</span>
        <span class="n">time_text</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">transAxes</span><span class="p">)</span>

        <span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>

        <span class="k">def</span> <span class="nf">init</span><span class="p">():</span>
            <span class="n">i</span><span class="o">=</span><span class="mi">0</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">has_moving_loads</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">mvpl</span> <span class="ow">in</span> <span class="n">moving_loads</span><span class="p">:</span>
                    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">mvpl</span><span class="o">.</span><span class="n">xt</span><span class="p">)):</span>
                        <span class="n">mvpl_lines</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">xy</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span>
                        <span class="n">mvpl_lines</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">xyann</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span>
                        <span class="n">i</span><span class="o">=</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">has_stationary_loads</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="n">x_map</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span><span class="c1">#len(stationary_loads_x)):</span>
                    <span class="n">stationary_lines</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">xy</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span>
                    <span class="n">stationary_lines</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">xyann</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span>

            <span class="n">data_line</span><span class="o">.</span><span class="n">set_data</span><span class="p">([],</span> <span class="p">[])</span>
            <span class="n">min_line</span><span class="o">.</span><span class="n">set_data</span><span class="p">([],</span> <span class="p">[])</span>
            <span class="n">max_line</span><span class="o">.</span><span class="n">set_data</span><span class="p">([],</span> <span class="p">[])</span>
            <span class="n">time_text</span><span class="o">.</span><span class="n">set_text</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>

            <span class="k">return</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">stationary_lines</span><span class="p">)</span> <span class="o">+</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">mvpl_lines</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">data_line</span><span class="p">,)</span> <span class="o">+</span> <span class="p">(</span><span class="n">time_text</span><span class="p">,)</span> <span class="o">+</span> <span class="p">(</span><span class="n">min_line</span><span class="p">,)</span><span class="o">+</span><span class="p">(</span><span class="n">max_line</span><span class="p">,)</span>


        <span class="k">def</span> <span class="nf">animate</span><span class="p">(</span><span class="n">frame</span><span class="p">):</span>
            <span class="n">i</span><span class="o">=</span><span class="mi">0</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">has_moving_loads</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">mvpl</span> <span class="ow">in</span> <span class="n">moving_loads</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">mvpl</span><span class="o">.</span><span class="n">v</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">:</span>
                        <span class="n">x0</span> <span class="o">=</span> <span class="n">mvpl</span><span class="o">.</span><span class="n">x0</span> <span class="o">+</span> <span class="n">mvpl</span><span class="o">.</span><span class="n">L</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">x0</span> <span class="o">=</span> <span class="n">mvpl</span><span class="o">.</span><span class="n">x0</span>
                    <span class="n">thisx</span> <span class="o">=</span> <span class="n">mvpl</span><span class="o">.</span><span class="n">axle_positions</span><span class="p">(</span><span class="n">x0</span><span class="o">=</span><span class="n">x0</span><span class="p">,</span> <span class="n">t</span><span class="o">=</span><span class="n">tt</span><span class="p">[</span><span class="n">frame</span><span class="p">],</span><span class="n">v0</span><span class="o">=</span><span class="n">mvpl</span><span class="o">.</span><span class="n">v</span><span class="p">,</span><span class="n">t0</span><span class="o">=</span><span class="n">mvpl</span><span class="o">.</span><span class="n">t0</span><span class="p">)</span>
                    <span class="c1">#thisy = -mvpl.p / p_scale#defl_max/5</span>
                    <span class="n">thisy</span><span class="o">=</span><span class="n">mvpl</span><span class="o">.</span><span class="n">p</span>
                    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">mvpl</span><span class="o">.</span><span class="n">xt</span><span class="p">)):</span>
                        <span class="n">mvpl_lines</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">xy</span> <span class="o">=</span> <span class="p">(</span><span class="n">thisx</span><span class="p">[</span><span class="n">j</span><span class="p">],</span><span class="mi">0</span><span class="p">)</span>
                        <span class="n">mvpl_lines</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">xyann</span> <span class="o">=</span> <span class="p">(</span><span class="n">thisx</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">thisy</span><span class="p">[</span><span class="n">j</span><span class="p">])</span>
                        <span class="n">i</span><span class="o">=</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">has_stationary_loads</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="n">x_map</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span><span class="c1">#len(stationary_loads_x)):</span>
                    <span class="n">sum_mag</span> <span class="o">=</span> <span class="mi">0</span>
                    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">stationary_loads_x</span><span class="p">)):</span>
                        <span class="k">if</span> <span class="n">x_map</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">!=</span> <span class="n">j</span><span class="p">:</span>
                            <span class="k">continue</span>

                        <span class="n">mag</span> <span class="o">=</span> <span class="n">pwise</span><span class="o">.</span><span class="n">pinterp_x_y</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="n">stationary_loads_vs_t</span><span class="p">[</span><span class="n">k</span><span class="p">],</span><span class="n">xi</span><span class="o">=</span><span class="n">tt</span><span class="p">[</span><span class="n">frame</span><span class="p">])</span>
                        <span class="k">if</span> <span class="n">stationary_loads_omega_phase</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                            <span class="k">pass</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="n">omega</span><span class="p">,</span> <span class="n">phase</span> <span class="o">=</span> <span class="n">stationary_loads_omega_phase</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
                            <span class="n">mag</span><span class="o">*=</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">tt</span><span class="p">[</span><span class="n">frame</span><span class="p">]</span><span class="o">+</span><span class="n">phase</span><span class="p">)</span>
                        <span class="n">sum_mag</span> <span class="o">+=</span><span class="n">mag</span>
                    <span class="n">stationary_lines</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">xy</span> <span class="o">=</span> <span class="p">(</span><span class="n">stationary_loads_x</span><span class="p">[</span><span class="n">j</span><span class="p">],</span><span class="mi">0</span><span class="p">)</span>
                    <span class="c1">#stationary_lines[j].xyann = (stationary_loads_x[j], -mag/p_scale)</span>
                    <span class="n">stationary_lines</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">xyann</span> <span class="o">=</span> <span class="p">(</span><span class="n">stationary_loads_x</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">sum_mag</span><span class="p">)</span>



            <span class="n">min_line</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">xx</span><span class="p">,</span> <span class="n">min_defl_evolve</span><span class="p">[:,</span><span class="n">frame</span><span class="p">])</span>
            <span class="n">max_line</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">xx</span><span class="p">,</span> <span class="n">max_defl_evolve</span><span class="p">[:,</span><span class="n">frame</span><span class="p">])</span>

            <span class="n">data_line</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">xx</span><span class="p">,</span> <span class="n">defl</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="n">frame</span><span class="p">])</span>
            <span class="n">time_text</span><span class="o">.</span><span class="n">set_text</span><span class="p">(</span><span class="n">time_template</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">tt</span><span class="p">[</span><span class="n">frame</span><span class="p">]))</span>
            <span class="k">return</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">stationary_lines</span><span class="p">)</span> <span class="o">+</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">mvpl_lines</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">data_line</span><span class="p">,)</span> <span class="o">+</span> <span class="p">(</span><span class="n">time_text</span><span class="p">,)</span> <span class="o">+</span> <span class="p">(</span><span class="n">min_line</span><span class="p">,)</span><span class="o">+</span><span class="p">(</span><span class="n">max_line</span><span class="p">,)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">ani</span> <span class="o">=</span> <span class="n">animation</span><span class="o">.</span><span class="n">FuncAnimation</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="n">animate</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">tt</span><span class="p">),</span>
                                      <span class="n">interval</span><span class="o">=</span><span class="n">interval</span><span class="p">,</span> <span class="n">blit</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">init_func</span><span class="o">=</span><span class="n">init</span><span class="p">,</span><span class="n">repeat</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">mpl_connect</span><span class="p">(</span><span class="s1">&#39;button_press_event&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">onClick</span><span class="p">)</span>
<span class="c1">#        anim_running = True</span>
<span class="c1">#</span>
<span class="c1">#        def onClick(event):</span>
<span class="c1">#            nonlocal anim_running</span>
<span class="c1">#            if anim_running:</span>
<span class="c1">#                ani.event_source.stop()</span>
<span class="c1">#                anim_running = False</span>
<span class="c1">#            else:</span>
<span class="c1">#                ani.event_source.start()</span>
<span class="c1">#                anim_running = True</span>



        <span class="k">if</span> <span class="n">saveme</span><span class="p">:</span>
            <span class="k">pass</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ani</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">file_stem</span><span class="o">+</span><span class="s2">&quot;_anim.mp4&quot;</span><span class="p">,</span> <span class="n">fps</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span><span class="n">codec</span><span class="o">=</span><span class="s2">&quot;libx264&quot;</span><span class="p">)</span><span class="c1">#changing the codec seems to work for me.</span>
<span class="c1">#            ani.save(self.file_stem+&quot;_anim&quot;, fps=15)#changing the codec seems to work for me.</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">ani</span></div>

<div class="viewcode-block" id="SpecBeam.defl_vs_time_under_loads"><a class="viewcode-back" href="../../../api/geotecha.beam_on_foundation.specbeam.html#geotecha.beam_on_foundation.specbeam.SpecBeam.defl_vs_time_under_loads">[docs]</a>    <span class="k">def</span> <span class="nf">defl_vs_time_under_loads</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">xlim_norm</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)):</span>
        <span class="sd">&quot;&quot;&quot;Deflection vs time under each moving load</span>

<span class="sd">        i.e. What is deflection under each axle</span>

<span class="sd">        Creates and populates self.moving_load_w_norm .</span>
<span class="sd">        Normalised deflections under each moving load at each time value.</span>
<span class="sd">        Each element of the list corresponds to each moving load.  The array</span>
<span class="sd">        is of size (len(mvpl.x), len(tvals))  i.e. for each axle in the moving</span>
<span class="sd">        load group.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        xlim_norm : tuple, optional</span>
<span class="sd">            won&#39;t show defelction untill within these normalised bounds</span>
<span class="sd">            Default xlim_norm=(0,1)</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">moving_load_w_norm</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">mvpl</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">moving_loads_norm</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">mvpl</span><span class="o">.</span><span class="n">v</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">:</span>
                <span class="n">x0</span> <span class="o">=</span> <span class="n">mvpl</span><span class="o">.</span><span class="n">x0</span> <span class="o">+</span> <span class="n">mvpl</span><span class="o">.</span><span class="n">L</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">x0</span> <span class="o">=</span> <span class="n">mvpl</span><span class="o">.</span><span class="n">x0</span>

            <span class="n">wvals</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">mvpl</span><span class="o">.</span><span class="n">x</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tvals_norm</span><span class="p">)))</span>

            <span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tvals_norm</span><span class="p">):</span>
                <span class="n">xnow</span> <span class="o">=</span> <span class="n">mvpl</span><span class="o">.</span><span class="n">axle_positions</span><span class="p">(</span><span class="n">x0</span><span class="o">=</span><span class="n">x0</span><span class="p">,</span> <span class="n">t</span><span class="o">=</span><span class="n">t</span><span class="p">,</span><span class="n">v0</span><span class="o">=</span><span class="n">mvpl</span><span class="o">.</span><span class="n">v</span><span class="p">,</span> <span class="n">t0</span><span class="o">=</span><span class="n">mvpl</span><span class="o">.</span><span class="n">t0</span><span class="p">)</span>
                <span class="n">wnow</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">interp</span><span class="p">(</span><span class="n">xnow</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">xvals_norm</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">defl_norm</span><span class="p">[:,</span><span class="n">j</span><span class="p">])</span>

                <span class="c1">#remove points where load is not on beam.</span>
                <span class="n">wnow</span><span class="p">[</span><span class="n">xnow</span><span class="o">&lt;</span><span class="n">xlim_norm</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
                <span class="n">wnow</span><span class="p">[</span><span class="n">xnow</span><span class="o">&gt;</span><span class="n">xlim_norm</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>

                <span class="n">wvals</span><span class="p">[:,</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">wnow</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">moving_load_w_norm</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">wvals</span><span class="p">)</span>


        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">L</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">moving_load_w</span> <span class="o">=</span> <span class="p">[</span><span class="n">v</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">L</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">moving_load_w_norm</span><span class="p">]</span>

        <span class="k">return</span></div></div>

<div class="viewcode-block" id="MovingPointLoads"><a class="viewcode-back" href="../../../api/geotecha.beam_on_foundation.specbeam.html#geotecha.beam_on_foundation.specbeam.MovingPointLoads">[docs]</a><span class="k">class</span> <span class="nc">MovingPointLoads</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Multi-axle vehicle represented by point loads in a line</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    x : 1d array or list</span>
<span class="sd">        x-coord of point loads.  Vehicle assumed to start at 0.</span>
<span class="sd">    p : 1d array or list</span>
<span class="sd">        Magnitude of point loads at corresponding x value.</span>
<span class="sd">    offset : float, optional</span>
<span class="sd">        x-coords will be offset by this distance.  Positive values will move</span>
<span class="sd">        x to the right (i.e. increase in x).</span>
<span class="sd">    v : float, optional</span>
<span class="sd">        Velocity.  Default v = None, i.e. you&#39;ll need to enter in various</span>
<span class="sd">        functions.</span>
<span class="sd">    L : float, optional</span>
<span class="sd">        Length of Beam.  Default L=None i.e. you&#39;ll need to explicitly</span>
<span class="sd">        enter in various functions. You can use a psuedo L with x0 to have the</span>
<span class="sd">        loads begin and end midspan.</span>
<span class="sd">    t0 : float, optional</span>
<span class="sd">        Time the point loads begin at x0 on the beam. default t0=0 ie. you&#39;ll</span>
<span class="sd">        have to explicitly enter in various functions.</span>
<span class="sd">    x0 : float, optional</span>
<span class="sd">        Start position of loads on beam. Defualt x0=0.0 .</span>

<span class="sd">    Attributes</span>
<span class="sd">    ----------</span>
<span class="sd">    xt : 1d array</span>
<span class="sd">        transformed x coords after mirror and offset are applied.</span>
<span class="sd">    start_time, end_time : 1d array</span>
<span class="sd">        start and end time for each point load traversing length L.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">offset</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">v</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">L</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">t0</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">x0</span><span class="o">=</span><span class="mf">0.0</span><span class="p">):</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span><span class="c1">#array(x.copy())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">p</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span><span class="c1">#np.asarray(p.copy())</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">offset</span> <span class="o">=</span> <span class="n">offset</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">xt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">xt</span> <span class="o">+=</span> <span class="n">offset</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">L</span> <span class="o">=</span> <span class="n">L</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">t0</span> <span class="o">=</span> <span class="n">t0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">v</span> <span class="o">=</span> <span class="n">v</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">x0</span> <span class="o">=</span> <span class="n">x0</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">xnow</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">xt</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pnow</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">xt</span><span class="p">)</span>

        <span class="k">return</span>


<div class="viewcode-block" id="MovingPointLoads.setv"><a class="viewcode-back" href="../../../api/geotecha.beam_on_foundation.specbeam.html#geotecha.beam_on_foundation.specbeam.MovingPointLoads.setv">[docs]</a>    <span class="k">def</span> <span class="nf">setv</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">v</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set the vehicle&#39;s velocity, then calc start_time and end_time when</span>
<span class="sd">        vehicle&#39;s axles enter and leave the beam&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_v</span> <span class="o">=</span> <span class="n">v</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">v</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">v</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">start_time</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">t0</span> <span class="o">+</span> <span class="p">(</span><span class="mi">0</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">xt</span><span class="p">)</span> <span class="o">/</span> <span class="n">v</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">end_time</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">t0</span> <span class="o">+</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">L</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">xt</span><span class="p">)</span> <span class="o">/</span> <span class="n">v</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1">#train is travelling in negative direction</span>
                <span class="c1"># the (-1) is to mirror around reference point</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">start_time</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">t0</span> <span class="o">-</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">xt</span> <span class="o">/</span> <span class="n">v</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">end_time</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">t0</span> <span class="o">-</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">L</span> <span class="o">+</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">xt</span><span class="p">)</span> <span class="o">/</span> <span class="n">v</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">start_time</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">end_time</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="k">return</span></div>

<div class="viewcode-block" id="MovingPointLoads.getv"><a class="viewcode-back" href="../../../api/geotecha.beam_on_foundation.specbeam.html#geotecha.beam_on_foundation.specbeam.MovingPointLoads.getv">[docs]</a>    <span class="k">def</span> <span class="nf">getv</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_v</span></div>

<div class="viewcode-block" id="MovingPointLoads.delv"><a class="viewcode-back" href="../../../api/geotecha.beam_on_foundation.specbeam.html#geotecha.beam_on_foundation.specbeam.MovingPointLoads.delv">[docs]</a>    <span class="k">def</span> <span class="nf">delv</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">_v</span>
        <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">start_time</span>
        <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">end_time</span>
        <span class="k">return</span></div>

    <span class="n">v</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">getv</span><span class="p">,</span> <span class="n">setv</span><span class="p">,</span> <span class="n">delv</span><span class="p">,</span> <span class="s2">&quot;Velocity&quot;</span><span class="p">)</span>

<div class="viewcode-block" id="MovingPointLoads.point_loads_on_beam"><a class="viewcode-back" href="../../../api/geotecha.beam_on_foundation.specbeam.html#geotecha.beam_on_foundation.specbeam.MovingPointLoads.point_loads_on_beam">[docs]</a>    <span class="k">def</span> <span class="nf">point_loads_on_beam</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">t</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Position and magnitude of point loads between [0, L] at time t</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        t : float</span>
<span class="sd">            Current time.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        x : 1d array of float</span>
<span class="sd">            position of each load at time t.</span>
<span class="sd">        p : 1d array of float</span>
<span class="sd">            Load at time t.  Will be set to zero if load is not beteen</span>
<span class="sd">            0 and L.</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        Position can be offset by self.x0</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">v</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">xnow</span><span class="p">[:]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">axle_positions</span><span class="p">(</span><span class="n">t</span><span class="o">=</span><span class="n">t</span><span class="p">,</span> <span class="n">v0</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">v</span><span class="p">,</span> <span class="n">x0</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">x0</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">xnow</span><span class="p">[:]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">axle_positions</span><span class="p">(</span><span class="n">t</span><span class="o">=</span><span class="n">t</span><span class="p">,</span> <span class="n">v0</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">v</span><span class="p">,</span> <span class="n">x0</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">L</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">pnow</span><span class="p">[:]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">p</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">pnow</span><span class="p">[((</span><span class="n">t</span><span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">start_time</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="n">t</span><span class="o">&gt;</span><span class="bp">self</span><span class="o">.</span><span class="n">end_time</span><span class="p">))]</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">xnow</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">pnow</span></div>


<div class="viewcode-block" id="MovingPointLoads.convert_to_specbeam"><a class="viewcode-back" href="../../../api/geotecha.beam_on_foundation.specbeam.html#geotecha.beam_on_foundation.specbeam.MovingPointLoads.convert_to_specbeam">[docs]</a>    <span class="k">def</span> <span class="nf">convert_to_specbeam</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">v</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">L</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">t0</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">x0</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Convert vehicle at velocity v into</span>
<span class="sd">        surcharge_vs_time and surcharge_omega_phase PolyLines for use with</span>
<span class="sd">        spectral method.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        v : float, optional</span>
<span class="sd">            Velocity of vehicle.  Default v=None in which case the v used</span>
<span class="sd">            during object initialization will be uses</span>
<span class="sd">        L : float, optional</span>
<span class="sd">            Length of beam.  Default L=None in which case the L used</span>
<span class="sd">            during object initialization will be uses</span>
<span class="sd">        t0 : float, optional</span>
<span class="sd">            time when vehicle reference point begins entering the beam. Default t0=0.</span>
<span class="sd">            If v&gt;0 vehicle will enter from the right.  If v&lt;0 vehicle</span>
<span class="sd">            will enter from the right. v=0 will result in an error.</span>
<span class="sd">        x0 : float, optional</span>
<span class="sd">            Position where loads start.  Default x0=none, i.e. value used</span>
<span class="sd">            during initialization will be used.</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>

<span class="sd">        Vehicle is made up of axles at a relative distance dxi from a</span>
<span class="sd">        reference point.  dxi should be negative.  If velocity v is positive</span>
<span class="sd">        then the reference point enters the beam (at x=x0) at time t0.  The</span>
<span class="sd">        position of the ith axle is:</span>
<span class="sd">            xi = x0 + dxi + v * (t - t0)</span>
<span class="sd">        The ith axle enters the beam at position x0 at time</span>
<span class="sd">            tstarti = t0 - dxi / v</span>
<span class="sd">        and leaves the beam (x = x0 + L) at time</span>
<span class="sd">            tendi = t0+(L-dxi)/v</span>


<span class="sd">        If v is negative then the reference point enters the beam from</span>
<span class="sd">        the right, then we first flip the vehicle by making dx_i=-dxi.  The</span>
<span class="sd">        positiion and times entering and leaving the beam are</span>
<span class="sd">            xi = x0 + L + dx_i + v * (t - t0)</span>

<span class="sd">        and</span>
<span class="sd">            tstart = t0 - dx_i / v</span>
<span class="sd">            tend = t0 - (L + dx_i)/v</span>

<span class="sd">        For use in spec beam we will need sin(M*xi) in a form</span>
<span class="sd">        sin(omega*t+phase).</span>

<span class="sd">        for v&gt;0</span>
<span class="sd">        xi = v * t + (x0 + dxi - v * t0)</span>
<span class="sd">        so omega/M = v and phase/M = x0 + dxi-v*t0</span>

<span class="sd">        for v&lt;0</span>
<span class="sd">        xi = v * t + (x0 + L + dx_i - v * t0)</span>
<span class="sd">        so omega/M = v and phase/M = x0 + L + dx_i - v*t0</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        plines : list of PolyLine</span>
<span class="sd">        omega_phase : list of two element tuples</span>
<span class="sd">            frequency and phase angle for use in spec beam.  as per the notes</span>
<span class="sd">            above will need to multiply both omega and phase by M for use</span>
<span class="sd">            in specbeam.</span>


<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">v</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">v</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">v</span>
        <span class="k">if</span> <span class="n">L</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">L</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">L</span>
        <span class="k">if</span> <span class="n">t0</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">t0</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">t0</span>
        <span class="k">if</span> <span class="n">x0</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">x0</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">x0</span>

        <span class="n">plines</span><span class="o">=</span><span class="p">[]</span>
        <span class="n">omega_phase</span><span class="o">=</span><span class="p">[]</span>
        <span class="k">if</span> <span class="n">v</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Can not have v=0 i.e. no static loads.&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">v</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">xi</span><span class="p">,</span> <span class="n">p</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">xt</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="p">):</span>
                <span class="n">start_time</span> <span class="o">=</span> <span class="n">t0</span> <span class="o">+</span> <span class="p">(</span><span class="mi">0</span> <span class="o">-</span> <span class="n">xi</span><span class="p">)</span> <span class="o">/</span> <span class="n">v</span>
                <span class="n">end_time</span> <span class="o">=</span> <span class="n">t0</span> <span class="o">+</span> <span class="p">(</span><span class="n">L</span> <span class="o">-</span> <span class="n">xi</span><span class="p">)</span> <span class="o">/</span> <span class="n">v</span>
                <span class="n">plines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">PolyLine</span><span class="p">([</span><span class="n">start_time</span><span class="p">,</span><span class="n">start_time</span><span class="p">,</span><span class="n">end_time</span><span class="p">,</span><span class="n">end_time</span><span class="p">],</span>
                                       <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span><span class="mi">0</span><span class="p">]))</span>
                <span class="n">omega_phase</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">v</span><span class="p">,</span> <span class="n">xi</span> <span class="o">+</span> <span class="n">x0</span> <span class="o">-</span> <span class="n">v</span> <span class="o">*</span> <span class="n">t0</span><span class="p">))</span>



        <span class="k">else</span><span class="p">:</span>
            <span class="c1">#train is travelling in negative direction</span>
            <span class="k">for</span> <span class="n">xi</span><span class="p">,</span> <span class="n">p</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">xt</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="p">):</span>
                <span class="n">xi</span> <span class="o">*=</span> <span class="o">-</span><span class="mi">1</span> <span class="c1">#mirror around reference point.</span>
                <span class="n">start_time</span> <span class="o">=</span> <span class="n">t0</span> <span class="o">-</span> <span class="n">xi</span> <span class="o">/</span> <span class="n">v</span>
                <span class="n">end_time</span> <span class="o">=</span> <span class="n">t0</span> <span class="o">-</span> <span class="p">(</span><span class="n">L</span> <span class="o">+</span> <span class="n">xi</span><span class="p">)</span> <span class="o">/</span> <span class="n">v</span>
                <span class="n">plines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">PolyLine</span><span class="p">([</span><span class="n">start_time</span><span class="p">,</span><span class="n">start_time</span><span class="p">,</span><span class="n">end_time</span><span class="p">,</span><span class="n">end_time</span><span class="p">],</span>
                                       <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="mi">0</span><span class="p">]))</span>
                <span class="n">omega_phase</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">v</span><span class="p">,</span> <span class="n">x0</span> <span class="o">+</span> <span class="n">L</span> <span class="o">+</span> <span class="n">xi</span> <span class="o">-</span> <span class="n">v</span><span class="o">*</span><span class="n">t0</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">plines</span><span class="p">,</span> <span class="n">omega_phase</span></div>

<div class="viewcode-block" id="MovingPointLoads.plot_specbeam_PolyLines"><a class="viewcode-back" href="../../../api/geotecha.beam_on_foundation.specbeam.html#geotecha.beam_on_foundation.specbeam.MovingPointLoads.plot_specbeam_PolyLines">[docs]</a>    <span class="k">def</span> <span class="nf">plot_specbeam_PolyLines</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">v</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">L</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">t0</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">x0</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Plot load_vs_time for each vehicle axis.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        ax : Matplotlib.Axes, optional</span>
<span class="sd">            Axes to plot on.  Default ax=None i.e. a new fig and ax will be</span>
<span class="sd">            created.</span>
<span class="sd">        v : float, optional</span>
<span class="sd">            velocity, default v=1.</span>
<span class="sd">        L : float, optional</span>
<span class="sd">            Lenght of beam default L=1</span>
<span class="sd">        x0, t0 : float, optional</span>
<span class="sd">            Vehicle starts at positon x0 at time t0. Default x0=0, t0=0</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">plines</span><span class="p">,</span> <span class="n">omega_phases</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">convert_to_specbeam</span><span class="p">(</span><span class="n">v</span><span class="o">=</span><span class="n">v</span><span class="p">,</span> <span class="n">L</span><span class="o">=</span><span class="n">L</span><span class="p">,</span> <span class="n">t0</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">x0</span><span class="o">=</span><span class="n">x0</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">ax</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">plines</span><span class="p">)):</span>
            <span class="n">omega</span><span class="p">,</span><span class="n">phase</span> <span class="o">=</span> <span class="n">omega_phases</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="n">xx</span> <span class="o">=</span> <span class="n">plines</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">x</span>
            <span class="n">yy</span><span class="o">=</span><span class="n">plines</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">y</span>
            <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;$i=</span><span class="si">{}</span><span class="s2">,</span><span class="se">\\</span><span class="s2">omega=</span><span class="si">{}</span><span class="s2">,</span><span class="se">\\</span><span class="s2">phi=</span><span class="si">{}</span><span class="s2">$&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">omega</span><span class="p">,</span><span class="n">phase</span><span class="p">)</span>
            <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;$</span><span class="si">{}</span><span class="s2">,</span><span class="si">{}</span><span class="s2">,</span><span class="si">{}</span><span class="s2">$&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">omega</span><span class="p">,</span><span class="n">phase</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xx</span><span class="p">,</span><span class="n">yy</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="n">label</span><span class="p">)</span>

        <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;L=</span><span class="si">{}</span><span class="s2">,v=</span><span class="si">{}</span><span class="s2">,t0=</span><span class="si">{}</span><span class="s2">,x0=</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="n">v</span><span class="p">,</span><span class="n">t0</span><span class="p">,</span><span class="n">x0</span><span class="p">))</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;time&quot;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;magnitude&quot;</span><span class="p">)</span>
        <span class="n">leg</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">title</span> <span class="o">=</span><span class="s2">&quot;$i,</span><span class="se">\\</span><span class="s2">omega,</span><span class="se">\\</span><span class="s2">phi$&quot;</span><span class="p">,</span>
                        <span class="n">labelspacing</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">leg</span><span class="o">.</span><span class="n">draggable</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">ax</span></div>

<div class="viewcode-block" id="MovingPointLoads.axle_positions"><a class="viewcode-back" href="../../../api/geotecha.beam_on_foundation.specbeam.html#geotecha.beam_on_foundation.specbeam.MovingPointLoads.axle_positions">[docs]</a>    <span class="k">def</span> <span class="nf">axle_positions</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">t</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">v0</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">t0</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">x0</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Positions of axles at given time</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        t : float</span>
<span class="sd">            Time of interest</span>
<span class="sd">        v0 : float, optional</span>
<span class="sd">            Initial speed of vehicle.  Default v0=0.</span>
<span class="sd">            If v0&lt;0 then axle coords will be multiplied by -1 before moving.</span>
<span class="sd">        t0 : float, optional</span>
<span class="sd">            Time when vehicle starts moving at velocity v0. Default t0=0</span>
<span class="sd">        x0 : float, optional</span>
<span class="sd">            Start postion of vehicle</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        xnew : 1d array</span>
<span class="sd">            xcoords of axles at time t.</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">xnow</span><span class="p">[:]</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">xt</span><span class="p">[:]</span><span class="c1">#xnew = self.xt.copy()</span>
        <span class="k">if</span> <span class="n">v0</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">xnow</span><span class="o">*=-</span><span class="mi">1</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">xnow</span><span class="o">+=</span> <span class="n">x0</span> <span class="o">+</span> <span class="n">v0</span><span class="o">*</span><span class="p">(</span><span class="n">t</span><span class="o">-</span><span class="n">t0</span><span class="p">)</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">xnow</span></div>

<div class="viewcode-block" id="MovingPointLoads.plotme"><a class="viewcode-back" href="../../../api/geotecha.beam_on_foundation.specbeam.html#geotecha.beam_on_foundation.specbeam.MovingPointLoads.plotme">[docs]</a>    <span class="k">def</span> <span class="nf">plotme</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">t</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">v0</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">t0</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">x0</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">xlim</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ylim</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Plot the load at time t</span>

<span class="sd">        Each axle load is represented by an arrow, with head at 0 and tail</span>
<span class="sd">        at the load magnitude.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        ax : pyplot.Axes, optional</span>
<span class="sd">            Axes object to plot on.  Default ax=None i.e. new figure and</span>
<span class="sd">            axes will be created.</span>
<span class="sd">        t : float, optional</span>
<span class="sd">            Time at which to plot the vehicle positoin. Default t=0.</span>
<span class="sd">        v0 : float, optional</span>
<span class="sd">            Initial velocity of vehicle.  default v0=0.  If v0&lt;0 then</span>
<span class="sd">            positions will be multiplied by -1 before adjusting position.</span>
<span class="sd">        t0 : float, optional</span>
<span class="sd">            Time the vehicle starts moving. Default t0=0.</span>
<span class="sd">        x0 : float, optional</span>
<span class="sd">            Start position of vehicle</span>
<span class="sd">        xlim, ylim : tuple of size 2, default xlim=ylim=None.</span>
<span class="sd">            axes limits.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        ax : pyplot.Axes opbect</span>
<span class="sd">           Axes object with plotted vehicle position.</span>


<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">ax</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
            <span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>

        <span class="n">xnew</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">axle_positions</span><span class="p">(</span><span class="n">t</span><span class="o">=</span><span class="n">t</span><span class="p">,</span> <span class="n">v0</span><span class="o">=</span><span class="n">v0</span><span class="p">,</span> <span class="n">t0</span><span class="o">=</span><span class="n">t0</span><span class="p">,</span> <span class="n">x0</span><span class="o">=</span><span class="n">x0</span><span class="p">)</span>

        <span class="n">lines</span> <span class="o">=</span> <span class="p">[</span><span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="n">xnew</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="mi">0</span><span class="p">),</span> <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="n">xnew</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span>
                             <span class="n">arrowprops</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">shrink</span><span class="o">=</span><span class="mf">0.0</span><span class="p">)</span>
                                             <span class="c1">#arrowstyle=&quot;-&gt;&quot;,</span>
                                             <span class="c1">#edgecolor=&#39;red&#39;,</span>
                                             <span class="c1">#shrinkline=0</span>
                                             <span class="c1">#)</span>
                             <span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">xt</span><span class="p">))]</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">xlim</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">xlim</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">ylim</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">ylim</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">ax</span></div>

<div class="viewcode-block" id="MovingPointLoads.animateme"><a class="viewcode-back" href="../../../api/geotecha.beam_on_foundation.specbeam.html#geotecha.beam_on_foundation.specbeam.MovingPointLoads.animateme">[docs]</a>    <span class="k">def</span> <span class="nf">animateme</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x0</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">t0</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">tf</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">v0</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">xlim</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ylim</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Animate moving vehicle</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        x0 : float, optional</span>
<span class="sd">            Start position of vehicle, default=0.</span>
<span class="sd">        t0 : float, optional</span>
<span class="sd">            Start time of animation. Default t0=0.</span>
<span class="sd">        tf : float, optional</span>
<span class="sd">            End time of animation. Default tf=1.</span>
<span class="sd">        v0 : float, optional</span>
<span class="sd">            Initial velocity of vehicle.  Default v0=1.  If v0&lt;0 then</span>
<span class="sd">            positions will be multiplied by -1 before adjusting position.</span>
<span class="sd">        xlim, ylim : tuple of size 2, default xlim=ylim=None.</span>
<span class="sd">            axes limits.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        ani : matplotlib animation</span>
<span class="sd">           Animation of moving vehicle</span>


<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1">#http://stackoverflow.com/questions/15887820/animation-by-using-matplotlib-errorbar</span>

        <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
        <span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">xlim</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">xlim</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">ylim</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">ylim</span><span class="p">)</span>


        <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>


        <span class="n">lines</span> <span class="o">=</span> <span class="p">[</span><span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">),</span> <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">),</span>
                             <span class="n">arrowprops</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">shrink</span><span class="o">=</span><span class="mf">0.0</span><span class="p">)</span>
                                             <span class="c1">#arrowstyle=&quot;-&gt;&quot;,</span>
                                             <span class="c1">#edgecolor=&#39;red&#39;,</span>
                                             <span class="c1">#shrinkline=0</span>
                                             <span class="c1">#)</span>
                             <span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">xt</span><span class="p">))]</span>


        <span class="n">time_template</span> <span class="o">=</span> <span class="s1">&#39;time = </span><span class="si">{:.1f}</span><span class="s1">&#39;</span>
        <span class="n">time_text</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">transAxes</span><span class="p">)</span>


        <span class="k">def</span> <span class="nf">init</span><span class="p">():</span>

            <span class="n">time_text</span><span class="o">.</span><span class="n">set_text</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">xt</span><span class="p">)):</span>
                <span class="n">lines</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">xy</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span>
                <span class="n">lines</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">xyann</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span>

            <span class="n">time_text</span><span class="o">.</span><span class="n">set_text</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
            <span class="k">return</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">lines</span><span class="p">)</span><span class="o">+</span><span class="p">(</span><span class="n">time_text</span><span class="p">,)</span>


        <span class="k">def</span> <span class="nf">animate</span><span class="p">(</span><span class="n">t</span><span class="p">):</span>

            <span class="n">thisx</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">axle_positions</span><span class="p">(</span><span class="n">t</span><span class="o">=</span><span class="n">t</span><span class="p">,</span><span class="n">v0</span><span class="o">=</span><span class="n">v0</span><span class="p">,</span><span class="n">t0</span><span class="o">=</span><span class="n">t0</span><span class="p">,</span><span class="n">x0</span><span class="o">=</span><span class="n">x0</span><span class="p">)</span>
            <span class="n">thisy</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">p</span>

            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">xt</span><span class="p">)):</span>
                <span class="n">lines</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">xy</span> <span class="o">=</span> <span class="p">(</span><span class="n">thisx</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="mi">0</span><span class="p">)</span>
                <span class="n">lines</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">xyann</span> <span class="o">=</span> <span class="p">(</span><span class="n">thisx</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">thisy</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>

            <span class="n">time_text</span><span class="o">.</span><span class="n">set_text</span><span class="p">(</span><span class="n">time_template</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">t</span><span class="p">))</span>
            <span class="k">return</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">lines</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">time_text</span><span class="p">,)</span>

        <span class="n">ani</span> <span class="o">=</span> <span class="n">animation</span><span class="o">.</span><span class="n">FuncAnimation</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="n">animate</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">t0</span><span class="p">,</span><span class="n">tf</span><span class="p">,</span><span class="mi">100</span><span class="p">),</span>
                                      <span class="n">interval</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">blit</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">init_func</span><span class="o">=</span><span class="n">init</span><span class="p">,</span><span class="n">repeat</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">ani</span></div>

<div class="viewcode-block" id="MovingPointLoads.time_axles_pass_point"><a class="viewcode-back" href="../../../api/geotecha.beam_on_foundation.specbeam.html#geotecha.beam_on_foundation.specbeam.MovingPointLoads.time_axles_pass_point">[docs]</a>    <span class="k">def</span> <span class="nf">time_axles_pass_point</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">v0</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">t0</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">x0</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;time values when each moving load passes a certain point</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        x : float</span>
<span class="sd">            x-coord of interest</span>
<span class="sd">        v0 : float, optional</span>
<span class="sd">            Initial speed of vehicle.  Default v0=0.</span>
<span class="sd">            If v0&lt;0 then axle coords will be multiplied by -1 before moving.</span>
<span class="sd">        t0 : float, optional</span>
<span class="sd">            Time when vehicle starts moving at velocity v0. Default t0=0</span>
<span class="sd">        x0 : float, optional</span>
<span class="sd">            Start postion of vehicle</span>
<span class="sd">        L : float, optional</span>
<span class="sd">            Length of beam.  Default L=None in which case the L used</span>
<span class="sd">            during object initialization will be uses.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        t_pass : 1d array of float</span>
<span class="sd">            list of times corresponding to when each axle passes the given</span>
<span class="sd">            x value.</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">xnow</span><span class="p">[:]</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">xt</span><span class="p">[:]</span>
        <span class="k">if</span> <span class="n">v0</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">xnow</span><span class="o">*=-</span><span class="mi">1</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">xnow</span><span class="o">-</span><span class="n">x0</span><span class="p">)</span><span class="o">/</span><span class="n">v0</span> <span class="o">+</span> <span class="n">t0</span></div>

<div class="viewcode-block" id="MovingPointLoads.time_axles_pass_beam_point"><a class="viewcode-back" href="../../../api/geotecha.beam_on_foundation.specbeam.html#geotecha.beam_on_foundation.specbeam.MovingPointLoads.time_axles_pass_beam_point">[docs]</a>    <span class="k">def</span> <span class="nf">time_axles_pass_beam_point</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">x</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Time values when each axle passes a particular point on a beam</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        x : float</span>
<span class="sd">            x coord of interest</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        t_pass : 1d aray of float</span>
<span class="sd">            time values when each axle passes the particualr point</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        If self.v &lt; 0 then loads enter beam from the left, i.e. at time</span>
<span class="sd">        t0 axles will be at L+x0+xt</span>

<span class="sd">        Not really sure if I&#39;ve accountered for self.x0!=0 for the</span>
<span class="sd">        negative velocity.  Just make self.x0 =0 for simplicity</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">v</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span>
            <span class="n">t_pass</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">time_axles_pass_point</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">v0</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">v</span><span class="p">,</span> <span class="n">t0</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">t0</span><span class="p">,</span> <span class="n">x0</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">x0</span><span class="p">)</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">v</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">:</span>
            <span class="n">t_pass</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">time_axles_pass_point</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">v0</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">v</span><span class="p">,</span> <span class="n">t0</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">t0</span><span class="p">,</span> <span class="n">x0</span><span class="o">=</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">L</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">x0</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;v can&#39;t be zero&quot;</span><span class="p">)</span>


        <span class="k">return</span> <span class="n">t_pass</span></div></div>





<span class="c1">##***Don&#39;t think I need this combo of align_yaxis &amp; adjust_yaxis, I use a</span>
<span class="c1">##***simpler version of align_yaxis that is hardcoded to align at y=0 on both</span>
<span class="c1">##***axes</span>
<span class="c1">#def align_yaxis(ax1, v1, ax2, v2):</span>
<span class="c1">#    &quot;&quot;&quot;Adjust y-axis bounds so that value v1 in ax1 is aligned to value v2</span>
<span class="c1">#    in ax2.</span>
<span class="c1">#</span>
<span class="c1">#    Should keep keep all data visible.</span>
<span class="c1">#</span>
<span class="c1">#    Parameters</span>
<span class="c1">#    ----------</span>
<span class="c1">#    ax1, ax2 : matplotlib.Axes</span>
<span class="c1">#        Axes objects in which to align particular y-axis values</span>
<span class="c1">#    v1, v2 : float</span>
<span class="c1">#        y-axis values on which to align.</span>
<span class="c1">#</span>
<span class="c1">#    See Also</span>
<span class="c1">#    --------</span>
<span class="c1">#    adjust_yaxis : helper routine to move shift yaxis</span>
<span class="c1">#</span>
<span class="c1">#    Notes</span>
<span class="c1">#    -----</span>
<span class="c1">#    Copied from http://stackoverflow.com/questions/10481990/matplotlib-axis-with-two-scales-shared-origin</span>
<span class="c1">#</span>
<span class="c1">#    &quot;&quot;&quot;</span>
<span class="c1">#</span>
<span class="c1">#    _, y1 = ax1.transData.transform((0, v1))</span>
<span class="c1">#    _, y2 = ax2.transData.transform((0, v2))</span>
<span class="c1">#    adjust_yaxis(ax2,(y1-y2)/2,v2)</span>
<span class="c1">#    adjust_yaxis(ax1,(y2-y1)/2,v1)</span>
<span class="c1">#</span>
<span class="c1">#    return</span>
<span class="c1">#</span>
<span class="c1">#</span>
<span class="c1">#def adjust_yaxis(ax, ydif, v):</span>
<span class="c1">#    &quot;&quot;&quot;Adjust y-axis bounds by shifting ydif but keeping value v in the same</span>
<span class="c1">#    visual location.</span>
<span class="c1">#</span>
<span class="c1">#    Parameters</span>
<span class="c1">#    ----------</span>
<span class="c1">#    ax : Matplotlib.Axes</span>
<span class="c1">#        Axes object to change</span>
<span class="c1">#    ydif : float</span>
<span class="c1">#</span>
<span class="c1">#    See Also</span>
<span class="c1">#    --------</span>
<span class="c1">#    align_yaxis : parent routine</span>
<span class="c1">#</span>
<span class="c1">#    Notes</span>
<span class="c1">#    -----</span>
<span class="c1">#    Copied from: http://stackoverflow.com/questions/10481990/matplotlib-axis-with-two-scales-shared-origin</span>
<span class="c1">#</span>
<span class="c1">#    &quot;&quot;&quot;</span>
<span class="c1">#</span>
<span class="c1">#    inv = ax.transData.inverted()</span>
<span class="c1">#    _, dy = inv.transform((0, 0)) - inv.transform((0, ydif))</span>
<span class="c1">#    miny, maxy = ax.get_ylim()</span>
<span class="c1">#    miny, maxy = miny - v, maxy - v</span>
<span class="c1">#    if -miny&gt;maxy or (-miny==maxy and dy &gt; 0):</span>
<span class="c1">#        nminy = miny</span>
<span class="c1">#        nmaxy = miny*(maxy+dy)/(miny+dy)</span>
<span class="c1">#    else:</span>
<span class="c1">#        nmaxy = maxy</span>
<span class="c1">#        nminy = maxy*(miny+dy)/(maxy+dy)</span>
<span class="c1">#    ax.set_ylim(nminy+v, nmaxy+v)</span>
<span class="c1">#</span>
<span class="c1">#    return</span>


<div class="viewcode-block" id="align_yaxis"><a class="viewcode-back" href="../../../api/geotecha.beam_on_foundation.specbeam.html#geotecha.beam_on_foundation.specbeam.align_yaxis">[docs]</a><span class="k">def</span> <span class="nf">align_yaxis</span><span class="p">(</span><span class="n">ax1</span><span class="p">,</span> <span class="n">ax2</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Adjust y-axis limits so zeros of the two axes align, zooming them out</span>
<span class="sd">    by same ratio.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    ax1, ax2 : matpolotlib.Axes</span>
<span class="sd">        Axes to align.</span>

<span class="sd">    &quot;&quot;&quot;</span>


    <span class="n">axes</span> <span class="o">=</span> <span class="p">(</span><span class="n">ax1</span><span class="p">,</span> <span class="n">ax2</span><span class="p">)</span>
    <span class="n">extrema</span> <span class="o">=</span> <span class="p">[</span><span class="n">ax</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">()</span> <span class="k">for</span> <span class="n">ax</span> <span class="ow">in</span> <span class="n">axes</span><span class="p">]</span>
    <span class="n">tops</span> <span class="o">=</span> <span class="p">[</span><span class="n">extr</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">/</span> <span class="p">(</span><span class="n">extr</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">extr</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="k">for</span> <span class="n">extr</span> <span class="ow">in</span> <span class="n">extrema</span><span class="p">]</span>
    <span class="c1"># Ensure that plots (intervals) are ordered bottom to top:</span>
    <span class="k">if</span> <span class="n">tops</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">tops</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span>
        <span class="n">axes</span><span class="p">,</span> <span class="n">extrema</span><span class="p">,</span> <span class="n">tops</span> <span class="o">=</span> <span class="p">[</span><span class="nb">list</span><span class="p">(</span><span class="nb">reversed</span><span class="p">(</span><span class="n">l</span><span class="p">))</span> <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="p">(</span><span class="n">axes</span><span class="p">,</span> <span class="n">extrema</span><span class="p">,</span> <span class="n">tops</span><span class="p">)]</span>

    <span class="c1"># How much would the plot overflow if we kept current zoom levels?</span>
    <span class="n">tot_span</span> <span class="o">=</span> <span class="n">tops</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">tops</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

    <span class="n">b_new_t</span> <span class="o">=</span> <span class="n">extrema</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">tot_span</span> <span class="o">*</span> <span class="p">(</span><span class="n">extrema</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">extrema</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
    <span class="n">t_new_b</span> <span class="o">=</span> <span class="n">extrema</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">tot_span</span> <span class="o">*</span> <span class="p">(</span><span class="n">extrema</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">extrema</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">extrema</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">b_new_t</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">t_new_b</span><span class="p">,</span> <span class="n">extrema</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span></div>


<div class="viewcode-block" id="DAFrelative"><a class="viewcode-back" href="../../../api/geotecha.beam_on_foundation.specbeam.html#geotecha.beam_on_foundation.specbeam.DAFrelative">[docs]</a><span class="k">def</span> <span class="nf">DAFrelative</span><span class="p">(</span><span class="n">alp</span><span class="p">,</span> <span class="n">bet</span><span class="p">,</span> <span class="n">k2_k1</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Relative Dynamic Amplification Factor, based on ratio of beam</span>
<span class="sd">    stiffness to some reference beam stiffness.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    alp : float</span>
<span class="sd">        velocity ratio. alp=v/vcr; vcr= SQRT(2*SQRT(k*EI)/(rho*A))</span>
<span class="sd">    bet : float</span>
<span class="sd">        damping ratio.  bet=c/ccr; ccr=2*SQRT(rho*A*k)</span>
<span class="sd">    k2_k1 : float</span>
<span class="sd">        stiffness ratio of beam to current beam</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    DAF : float</span>
<span class="sd">        Relative Dynamic Amplification Factor</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    DAFrelative is a terse implementation for an appendix of code in</span>
<span class="sd">    Walker, R.T.R. and Indraratna, B, (in press) &quot;Moving loads on a</span>
<span class="sd">    viscoelastic foundation with special reference to railway</span>
<span class="sd">    transition zones&quot;. International Journal of Geomechanics.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
    <span class="n">alp</span> <span class="o">/=</span> <span class="n">k2_k1</span><span class="o">**</span><span class="p">(</span><span class="mf">0.25</span><span class="p">)</span>
    <span class="n">bet</span> <span class="o">*=</span> <span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">k2_k1</span><span class="p">)</span><span class="o">**</span><span class="mf">0.5</span>

    <span class="n">gam</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">roots</span><span class="p">([</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">4.0</span> <span class="o">*</span> <span class="n">alp</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">8</span> <span class="o">*</span> <span class="n">alp</span> <span class="o">*</span> <span class="n">bet</span><span class="p">,</span> <span class="mi">4</span><span class="p">])</span>
    <span class="n">cmat</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">complex</span><span class="p">)</span>
    <span class="n">cmat</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">cmat</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="p">[</span><span class="n">gam</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">gam</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="o">-</span><span class="n">gam</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="o">-</span><span class="n">gam</span><span class="p">[</span><span class="mi">3</span><span class="p">]]</span>
    <span class="n">cmat</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="p">[</span><span class="n">gam</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span> <span class="n">gam</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="n">gam</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="n">gam</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="p">]</span>
    <span class="n">cmat</span><span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="p">[</span><span class="n">gam</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">**</span><span class="mi">3</span><span class="p">,</span> <span class="n">gam</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">**</span><span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="n">gam</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">**</span><span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="n">gam</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">**</span><span class="mi">3</span><span class="p">]</span>

    <span class="n">rhs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">8.0</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">complex</span><span class="p">)</span>
    <span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">cmat</span><span class="p">,</span> <span class="n">rhs</span><span class="p">)</span>
    <span class="n">s</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">8</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">1001</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">complex</span><span class="p">)</span>
    <span class="n">disp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">s</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">complex</span><span class="p">)</span>

    <span class="n">s_neg</span> <span class="o">=</span> <span class="n">s</span><span class="p">[</span><span class="n">s</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">s_pos</span> <span class="o">=</span> <span class="n">s</span><span class="p">[</span><span class="n">s</span><span class="o">&gt;=</span><span class="mi">0</span><span class="p">]</span>

    <span class="n">disp</span><span class="p">[</span><span class="n">s</span><span class="o">&gt;=</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">A</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">s_pos</span><span class="o">*</span><span class="n">gam</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">+</span><span class="n">A</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">s_pos</span><span class="o">*</span><span class="n">gam</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">disp</span><span class="p">[</span><span class="n">s</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">A</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">s_neg</span><span class="o">*</span><span class="n">gam</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span><span class="o">+</span><span class="n">A</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">s_neg</span><span class="o">*</span><span class="n">gam</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>

    <span class="n">DAF</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">disp</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="n">k2_k1</span><span class="p">)</span><span class="o">**</span><span class="mf">0.75</span><span class="p">)</span>

    <span class="k">return</span>  <span class="n">DAF</span></div>


<div class="viewcode-block" id="point_load_static_defl_shape_function"><a class="viewcode-back" href="../../../api/geotecha.beam_on_foundation.specbeam.html#geotecha.beam_on_foundation.specbeam.point_load_static_defl_shape_function">[docs]</a><span class="k">def</span> <span class="nf">point_load_static_defl_shape_function</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">L</span><span class="p">,</span> <span class="n">xc</span><span class="o">=</span><span class="mf">0.0</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Deflection shape function for static point load on beam on foundation.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    x : float</span>
<span class="sd">        x value</span>
<span class="sd">    L : float</span>
<span class="sd">        Characteristc length (1/lam)</span>
<span class="sd">    x0 : float, optional</span>
<span class="sd">        position of load.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    nu : float</span>
<span class="sd">        shape function at x</span>

<span class="sd">    &quot;&quot;&quot;</span>


    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="n">xc</span><span class="p">)</span><span class="o">/</span><span class="n">L</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="n">xc</span><span class="p">)</span><span class="o">/</span><span class="n">L</span><span class="p">)</span><span class="o">+</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="n">xc</span><span class="p">)</span><span class="o">/</span><span class="n">L</span><span class="p">))</span></div>


<div class="viewcode-block" id="multi_static"><a class="viewcode-back" href="../../../api/geotecha.beam_on_foundation.specbeam.html#geotecha.beam_on_foundation.specbeam.multi_static">[docs]</a><span class="k">def</span> <span class="nf">multi_static</span><span class="p">(</span><span class="n">xc</span><span class="p">,</span> <span class="n">frel</span><span class="p">,</span> <span class="n">wsingle</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">xlim</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">),</span> <span class="n">n</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span> <span class="n">L</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Deflection shape for multiple static point loads</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    xc : float</span>
<span class="sd">        x-coord of each point load</span>
<span class="sd">    frel : float</span>
<span class="sd">        relative magnitude of each point load</span>
<span class="sd">    wsingle : float, optional</span>
<span class="sd">        maximum deflection under unit load</span>
<span class="sd">    xlim : tuple with two values</span>
<span class="sd">        xmin, xmax of evaluation</span>
<span class="sd">    L : float, optional</span>
<span class="sd">        Characterisic length</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    x,w : 1d ndarray</span>
<span class="sd">        x coords, and static deflection</span>

<span class="sd">    See Also</span>
<span class="sd">    --------</span>
<span class="sd">    point_load_static_defl_shape_function : single load function</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">xlim</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">xlim</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">n</span><span class="p">)</span>
    <span class="n">w</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">xc_</span><span class="p">,</span><span class="n">frel_</span><span class="p">)</span> <span class="ow">in</span>  <span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">xc</span><span class="p">,</span> <span class="n">frel</span><span class="p">)):</span>
        <span class="n">w</span><span class="o">+=</span> <span class="n">frel_</span><span class="o">*</span><span class="n">point_load_static_defl_shape_function</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">,</span> <span class="n">L</span><span class="o">=</span><span class="n">L</span><span class="p">,</span> <span class="n">xc</span><span class="o">=</span><span class="n">xc_</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">x</span><span class="p">,</span> <span class="n">w</span><span class="o">*</span><span class="n">wsingle</span></div>


<div class="viewcode-block" id="dingetal_figure_8"><a class="viewcode-back" href="../../../api/geotecha.beam_on_foundation.specbeam.html#geotecha.beam_on_foundation.specbeam.dingetal_figure_8">[docs]</a><span class="k">def</span> <span class="nf">dingetal_figure_8</span><span class="p">(</span><span class="n">v_nterms</span><span class="o">=</span><span class="p">(</span><span class="mi">50</span><span class="p">,</span><span class="mi">75</span><span class="p">,</span><span class="mi">150</span><span class="p">,</span><span class="mi">200</span><span class="p">)):</span>
    <span class="sd">&quot;&quot;&quot;Reproduce Ding Et Al 2012 Figure 8 (might take a while).</span>

<span class="sd">    Note that a plot will be be saved to disk in current working directory</span>
<span class="sd">    as well as a timing file.&quot;&quot;&quot;</span>

    <span class="n">start_time0</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
    <span class="n">ftime</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">fromtimestamp</span><span class="p">(</span><span class="n">start_time0</span><span class="p">)</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s1">&#39;%Y-%m-</span><span class="si">%d</span><span class="s1"> %H%M%S&#39;</span><span class="p">)</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">ftime</span> <span class="o">+</span> <span class="s2">&quot;.txt&quot;</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">ftime</span> <span class="o">+</span> <span class="n">os</span><span class="o">.</span><span class="n">linesep</span><span class="p">)</span>

        <span class="n">fig</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
        <span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="s2">&quot;111&quot;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;time, s&quot;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;w, m&quot;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mf">3.5</span><span class="p">,</span> <span class="mf">4.5</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">v_nterms</span><span class="p">:</span>
            <span class="n">vstr</span><span class="o">=</span><span class="s2">&quot;nterms&quot;</span>
            <span class="n">vfmt</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2">&quot;</span>
            <span class="n">start_time1</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>

            <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;*&quot;</span> <span class="o">*</span> <span class="mi">70</span> <span class="o">+</span> <span class="n">os</span><span class="o">.</span><span class="n">linesep</span><span class="p">)</span>
            <span class="n">vequals</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{}</span><span class="s2">=</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">vstr</span><span class="p">,</span> <span class="n">vfmt</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">v</span><span class="p">))</span>
            <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">vequals</span> <span class="o">+</span> <span class="n">os</span><span class="o">.</span><span class="n">linesep</span><span class="p">);</span> <span class="nb">print</span><span class="p">(</span><span class="n">vequals</span><span class="p">)</span>

            <span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">4.5</span><span class="p">,</span> <span class="mi">400</span><span class="p">)</span>
            <span class="n">pdict</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">(</span>
                <span class="n">E</span> <span class="o">=</span> <span class="mf">6.998</span><span class="o">*</span><span class="mf">1e9</span><span class="p">,</span> <span class="c1">#Pa</span>
                <span class="n">rho</span> <span class="o">=</span> <span class="mi">2373</span><span class="p">,</span> <span class="c1">#kg/m3</span>
                <span class="n">L</span> <span class="o">=</span> <span class="mi">160</span><span class="p">,</span> <span class="c1">#m</span>
                <span class="c1">#v_norm=0.01165,</span>
                <span class="n">kf</span><span class="o">=</span><span class="mf">5.41e-4</span><span class="p">,</span>
                <span class="c1">#Fz_norm=1.013e-4,</span>
                <span class="n">mu_norm</span><span class="o">=</span><span class="mf">39.263</span><span class="p">,</span>
                <span class="n">k1_norm</span><span class="o">=</span><span class="mf">97.552</span><span class="p">,</span>
                <span class="n">k3_norm</span><span class="o">=</span><span class="mf">2.497e6</span><span class="p">,</span>
                <span class="n">nterms</span><span class="o">=</span><span class="n">v</span><span class="p">,</span>
                <span class="n">BC</span><span class="o">=</span><span class="s2">&quot;CC&quot;</span><span class="p">,</span>
                <span class="n">nquad</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span>
                <span class="n">moving_loads_x_norm</span><span class="o">=</span><span class="p">[[</span><span class="mi">0</span><span class="p">]],</span>
                <span class="n">moving_loads_Fz_norm</span><span class="o">=</span><span class="p">[[</span><span class="mf">1.013e-4</span><span class="p">]],</span>
                <span class="n">moving_loads_v_norm</span><span class="o">=</span><span class="p">[</span><span class="mf">0.01165</span><span class="p">,],</span>
                <span class="n">tvals</span><span class="o">=</span><span class="n">t</span><span class="p">,</span>
                <span class="n">xvals_norm</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">.</span><span class="mi">5</span><span class="p">]))</span>



            <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="n">pdict</span><span class="p">)</span> <span class="o">+</span> <span class="n">os</span><span class="o">.</span><span class="n">linesep</span><span class="p">)</span>

            <span class="k">for</span> <span class="n">BC</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;SS&quot;</span><span class="p">]:</span><span class="c1"># &quot;CC&quot;, &quot;FF&quot;]:</span>
                <span class="n">pdict</span><span class="p">[</span><span class="s2">&quot;BC&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">BC</span>

                <span class="n">a</span> <span class="o">=</span> <span class="n">SpecBeam</span><span class="p">(</span><span class="o">**</span><span class="n">pdict</span><span class="p">)</span>
                <span class="n">a</span><span class="o">.</span><span class="n">calulate_qk</span><span class="p">(</span><span class="n">t</span><span class="o">=</span><span class="n">t</span><span class="p">)</span>

                <span class="n">x</span> <span class="o">=</span> <span class="n">t</span>
                <span class="n">y</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">wofx</span><span class="p">(</span><span class="n">x_norm</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">normalise_w</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

                <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;x=0.5, </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">vequals</span><span class="p">))</span>

            <span class="n">end_time1</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
            <span class="n">elapsed_time</span> <span class="o">=</span> <span class="p">(</span><span class="n">end_time1</span> <span class="o">-</span> <span class="n">start_time1</span><span class="p">);</span> <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Run time=</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">timedelta</span><span class="p">(</span><span class="n">seconds</span><span class="o">=</span><span class="n">elapsed_time</span><span class="p">))))</span>

            <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;Run time=</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">timedelta</span><span class="p">(</span><span class="n">seconds</span><span class="o">=</span><span class="n">elapsed_time</span><span class="p">)))</span> <span class="o">+</span> <span class="n">os</span><span class="o">.</span><span class="n">linesep</span><span class="p">)</span>

        <span class="n">leg</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
        <span class="n">leg</span><span class="o">.</span><span class="n">draggable</span><span class="p">()</span>

        <span class="n">end_time0</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
        <span class="n">elapsed_time</span> <span class="o">=</span> <span class="p">(</span><span class="n">end_time0</span> <span class="o">-</span> <span class="n">start_time0</span><span class="p">);</span> <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Total run time=</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">timedelta</span><span class="p">(</span><span class="n">seconds</span><span class="o">=</span><span class="n">elapsed_time</span><span class="p">))))</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;Total run time=</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">timedelta</span><span class="p">(</span><span class="n">seconds</span><span class="o">=</span><span class="n">elapsed_time</span><span class="p">)))</span> <span class="o">+</span> <span class="n">os</span><span class="o">.</span><span class="n">linesep</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">ftime</span><span class="o">+</span><span class="s2">&quot;.pdf&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span></div>




<div class="viewcode-block" id="SpecBeam_const_mat_midpoint_defl_runme_analytical_play"><a class="viewcode-back" href="../../../api/geotecha.beam_on_foundation.specbeam.html#geotecha.beam_on_foundation.specbeam.SpecBeam_const_mat_midpoint_defl_runme_analytical_play">[docs]</a><span class="k">def</span> <span class="nf">SpecBeam_const_mat_midpoint_defl_runme_analytical_play</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;Test SpecBeam for constant mat: close to Ding et al Figure 8, displacement vs time at</span>
<span class="sd">    beam midpoint (using the runme method) but with k3=0&quot;&quot;&quot;</span>

    <span class="n">start_time0</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
    <span class="n">ftime</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">fromtimestamp</span><span class="p">(</span><span class="n">start_time0</span><span class="p">)</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s1">&#39;%Y-%m-</span><span class="si">%d</span><span class="s1"> %H%M%S&#39;</span><span class="p">)</span>

    <span class="c1"># expected values are digitised from Ding et al 2012.</span>
    <span class="n">expected_50terms_t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
      <span class="p">[</span> <span class="mf">3.511</span><span class="p">,</span>  <span class="mf">3.553</span><span class="p">,</span>  <span class="mf">3.576</span><span class="p">,</span>  <span class="mf">3.605</span><span class="p">,</span>  <span class="mf">3.621</span><span class="p">,</span>  <span class="mf">3.637</span><span class="p">,</span>  <span class="mf">3.651</span><span class="p">,</span>  <span class="mf">3.661</span><span class="p">,</span>
        <span class="mf">3.676</span><span class="p">,</span>  <span class="mf">3.693</span><span class="p">,</span>  <span class="mf">3.701</span><span class="p">,</span>  <span class="mf">3.717</span><span class="p">,</span>  <span class="mf">3.733</span><span class="p">,</span>  <span class="mf">3.743</span><span class="p">,</span>  <span class="mf">3.761</span><span class="p">,</span>  <span class="mf">3.777</span><span class="p">,</span>
        <span class="mf">3.79</span> <span class="p">,</span>  <span class="mf">3.804</span><span class="p">,</span>  <span class="mf">3.822</span><span class="p">,</span>  <span class="mf">3.833</span><span class="p">,</span>  <span class="mf">3.848</span><span class="p">,</span>  <span class="mf">3.862</span><span class="p">,</span>  <span class="mf">3.877</span><span class="p">,</span>  <span class="mf">3.899</span><span class="p">,</span>
        <span class="mf">3.919</span><span class="p">,</span>  <span class="mf">3.94</span> <span class="p">,</span>  <span class="mf">3.956</span><span class="p">,</span>  <span class="mf">3.97</span> <span class="p">,</span>  <span class="mf">3.978</span><span class="p">,</span>  <span class="mf">3.99</span> <span class="p">,</span>  <span class="mf">4.001</span><span class="p">,</span>  <span class="mf">4.014</span><span class="p">,</span>
        <span class="mf">4.025</span><span class="p">,</span>  <span class="mf">4.041</span><span class="p">,</span>  <span class="mf">4.052</span><span class="p">,</span>  <span class="mf">4.064</span><span class="p">,</span>  <span class="mf">4.076</span><span class="p">,</span>  <span class="mf">4.086</span><span class="p">,</span>  <span class="mf">4.094</span><span class="p">,</span>  <span class="mf">4.104</span><span class="p">,</span>
        <span class="mf">4.112</span><span class="p">,</span>  <span class="mf">4.123</span><span class="p">,</span>  <span class="mf">4.134</span><span class="p">,</span>  <span class="mf">4.146</span><span class="p">,</span>  <span class="mf">4.159</span><span class="p">,</span>  <span class="mf">4.172</span><span class="p">,</span>  <span class="mf">4.18</span> <span class="p">,</span>  <span class="mf">4.192</span><span class="p">,</span>
        <span class="mf">4.212</span><span class="p">,</span>  <span class="mf">4.221</span><span class="p">,</span>  <span class="mf">4.234</span><span class="p">,</span>  <span class="mf">4.255</span><span class="p">,</span>  <span class="mf">4.273</span><span class="p">,</span>  <span class="mf">4.292</span><span class="p">,</span>  <span class="mf">4.324</span><span class="p">,</span>  <span class="mf">4.357</span><span class="p">,</span>
        <span class="mf">4.373</span><span class="p">,</span>  <span class="mf">4.399</span><span class="p">,</span>  <span class="mf">4.418</span><span class="p">,</span>  <span class="mf">4.445</span><span class="p">])</span>

    <span class="c1">#old values for k3~=0</span>
<span class="c1">#    expected_50terms_displacement = np.array(</span>
<span class="c1">#      [ -1.30900000e-04,   8.85900000e-05,   2.63900000e-04,</span>
<span class="c1">#         3.30200000e-04,   3.30500000e-04,   2.87100000e-04,</span>
<span class="c1">#         2.00000000e-04,   9.09500000e-05,  -8.36000000e-05,</span>
<span class="c1">#        -3.01800000e-04,  -4.32800000e-04,  -6.07300000e-04,</span>
<span class="c1">#        -7.59900000e-04,  -8.90900000e-04,  -9.99800000e-04,</span>
<span class="c1">#        -1.02100000e-03,  -9.99100000e-04,  -8.67700000e-04,</span>
<span class="c1">#        -5.61300000e-04,  -2.11300000e-04,   2.04300000e-04,</span>
<span class="c1">#         7.29200000e-04,   1.42900000e-03,   2.41300000e-03,</span>
<span class="c1">#         3.46300000e-03,   4.29400000e-03,   5.08100000e-03,</span>
<span class="c1">#         5.62800000e-03,   5.86800000e-03,   6.19600000e-03,</span>
<span class="c1">#         6.39300000e-03,   6.52500000e-03,   6.59100000e-03,</span>
<span class="c1">#         6.48200000e-03,   6.32900000e-03,   6.02300000e-03,</span>
<span class="c1">#         5.69600000e-03,   5.45500000e-03,   5.06200000e-03,</span>
<span class="c1">#         4.75600000e-03,   4.40700000e-03,   3.90400000e-03,</span>
<span class="c1">#         3.35800000e-03,   2.87800000e-03,   2.35300000e-03,</span>
<span class="c1">#         1.82900000e-03,   1.52300000e-03,   9.98700000e-04,</span>
<span class="c1">#         5.18300000e-04,   2.12500000e-04,  -4.95200000e-05,</span>
<span class="c1">#        -2.67600000e-04,  -3.76500000e-04,  -3.76100000e-04,</span>
<span class="c1">#        -2.00600000e-04,   1.87300000e-05,   1.06500000e-04,</span>
<span class="c1">#         1.94500000e-04,   1.94900000e-04,   1.30000000e-04])</span>


    <span class="n">expected_50terms_displacement</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
      <span class="p">[</span> <span class="o">-</span><span class="mf">1.74400116e-05</span><span class="p">,</span>   <span class="mf">2.56595529e-04</span><span class="p">,</span>   <span class="mf">3.64963938e-04</span><span class="p">,</span>
         <span class="mf">3.96163257e-04</span><span class="p">,</span>   <span class="mf">3.52239419e-04</span><span class="p">,</span>   <span class="mf">2.55908617e-04</span><span class="p">,</span>
         <span class="mf">1.36296573e-04</span><span class="p">,</span>   <span class="mf">3.12193756e-05</span><span class="p">,</span>  <span class="o">-</span><span class="mf">1.48035583e-04</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">3.73050108e-04</span><span class="p">,</span>  <span class="o">-</span><span class="mf">4.80427236e-04</span><span class="p">,</span>  <span class="o">-</span><span class="mf">6.84847774e-04</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">8.61705766e-04</span><span class="p">,</span>  <span class="o">-</span><span class="mf">9.44268811e-04</span><span class="p">,</span>  <span class="o">-</span><span class="mf">1.02333177e-03</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.00753661e-03</span><span class="p">,</span>  <span class="o">-</span><span class="mf">9.18192599e-04</span><span class="p">,</span>  <span class="o">-</span><span class="mf">7.32771117e-04</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">3.72382730e-04</span><span class="p">,</span>  <span class="o">-</span><span class="mf">7.79760498e-05</span><span class="p">,</span>   <span class="mf">4.06998900e-04</span><span class="p">,</span>
         <span class="mf">9.37679667e-04</span><span class="p">,</span>   <span class="mf">1.57072235e-03</span><span class="p">,</span>   <span class="mf">2.58323632e-03</span><span class="p">,</span>
         <span class="mf">3.52928135e-03</span><span class="p">,</span>   <span class="mf">4.47726082e-03</span><span class="p">,</span>   <span class="mf">5.12406706e-03</span><span class="p">,</span>
         <span class="mf">5.61329890e-03</span><span class="p">,</span>   <span class="mf">5.84231170e-03</span><span class="p">,</span>   <span class="mf">6.13309619e-03</span><span class="p">,</span>
         <span class="mf">6.32505191e-03</span><span class="p">,</span>   <span class="mf">6.46203546e-03</span><span class="p">,</span>   <span class="mf">6.49032925e-03</span><span class="p">,</span>
         <span class="mf">6.39329339e-03</span><span class="p">,</span>   <span class="mf">6.23960924e-03</span><span class="p">,</span>   <span class="mf">5.99242067e-03</span><span class="p">,</span>
         <span class="mf">5.67177967e-03</span><span class="p">,</span>   <span class="mf">5.35598822e-03</span><span class="p">,</span>   <span class="mf">5.07919623e-03</span><span class="p">,</span>
         <span class="mf">4.69552191e-03</span><span class="p">,</span>   <span class="mf">4.37030991e-03</span><span class="p">,</span>   <span class="mf">3.90678952e-03</span><span class="p">,</span>
         <span class="mf">3.43034780e-03</span><span class="p">,</span>   <span class="mf">2.90774639e-03</span><span class="p">,</span>   <span class="mf">2.35231514e-03</span><span class="p">,</span>
         <span class="mf">1.82145021e-03</span><span class="p">,</span>   <span class="mf">1.51724930e-03</span><span class="p">,</span>   <span class="mf">1.09014092e-03</span><span class="p">,</span>
         <span class="mf">4.86434682e-04</span><span class="p">,</span>   <span class="mf">2.61200867e-04</span><span class="p">,</span>  <span class="o">-</span><span class="mf">5.02752907e-06</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">2.99906282e-04</span><span class="p">,</span>  <span class="o">-</span><span class="mf">4.26188536e-04</span><span class="p">,</span>  <span class="o">-</span><span class="mf">4.46910518e-04</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">3.09328219e-04</span><span class="p">,</span>  <span class="o">-</span><span class="mf">6.53887601e-05</span><span class="p">,</span>   <span class="mf">4.77786782e-05</span><span class="p">,</span>
         <span class="mf">1.84483472e-04</span><span class="p">,</span>   <span class="mf">2.30390682e-04</span><span class="p">,</span>   <span class="mf">2.18090273e-04</span><span class="p">])</span>

    <span class="n">expected_200terms_t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
      <span class="p">[</span> <span class="mf">3.503</span><span class="p">,</span>  <span class="mf">3.519</span><span class="p">,</span>  <span class="mf">3.539</span><span class="p">,</span>  <span class="mf">3.556</span><span class="p">,</span>  <span class="mf">3.576</span><span class="p">,</span>  <span class="mf">3.595</span><span class="p">,</span>  <span class="mf">3.613</span><span class="p">,</span>  <span class="mf">3.632</span><span class="p">,</span>
        <span class="mf">3.651</span><span class="p">,</span>  <span class="mf">3.667</span><span class="p">,</span>  <span class="mf">3.69</span> <span class="p">,</span>  <span class="mf">3.708</span><span class="p">,</span>  <span class="mf">3.727</span><span class="p">,</span>  <span class="mf">3.746</span><span class="p">,</span>  <span class="mf">3.766</span><span class="p">,</span>  <span class="mf">3.782</span><span class="p">,</span>
        <span class="mf">3.801</span><span class="p">,</span>  <span class="mf">3.822</span><span class="p">,</span>  <span class="mf">3.84</span> <span class="p">,</span>  <span class="mf">3.856</span><span class="p">,</span>  <span class="mf">3.878</span><span class="p">,</span>  <span class="mf">3.896</span><span class="p">,</span>  <span class="mf">3.915</span><span class="p">,</span>  <span class="mf">3.933</span><span class="p">,</span>
        <span class="mf">3.951</span><span class="p">,</span>  <span class="mf">3.97</span> <span class="p">,</span>  <span class="mf">3.99</span> <span class="p">,</span>  <span class="mf">4.009</span><span class="p">,</span>  <span class="mf">4.027</span><span class="p">,</span>  <span class="mf">4.046</span><span class="p">,</span>  <span class="mf">4.067</span><span class="p">,</span>  <span class="mf">4.085</span><span class="p">,</span>
        <span class="mf">4.102</span><span class="p">,</span>  <span class="mf">4.122</span><span class="p">,</span>  <span class="mf">4.141</span><span class="p">,</span>  <span class="mf">4.159</span><span class="p">,</span>  <span class="mf">4.178</span><span class="p">,</span>  <span class="mf">4.197</span><span class="p">,</span>  <span class="mf">4.217</span><span class="p">,</span>  <span class="mf">4.234</span><span class="p">,</span>
        <span class="mf">4.252</span><span class="p">,</span>  <span class="mf">4.273</span><span class="p">,</span>  <span class="mf">4.291</span><span class="p">,</span>  <span class="mf">4.31</span> <span class="p">,</span>  <span class="mf">4.329</span><span class="p">,</span>  <span class="mf">4.347</span><span class="p">,</span>  <span class="mf">4.368</span><span class="p">,</span>  <span class="mf">4.386</span><span class="p">,</span>
        <span class="mf">4.405</span><span class="p">,</span>  <span class="mf">4.423</span><span class="p">,</span>  <span class="mf">4.442</span><span class="p">,</span>  <span class="mf">4.46</span> <span class="p">,</span>  <span class="mf">4.479</span><span class="p">,</span>  <span class="mf">4.495</span><span class="p">])</span>

    <span class="c1">#wrong : displ are with k3~=0</span>
    <span class="n">expected_200terms_displacement</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
      <span class="p">[</span>  <span class="mf">7.04000000e-08</span><span class="p">,</span>   <span class="mf">2.22800000e-05</span><span class="p">,</span>   <span class="mf">2.27000000e-05</span><span class="p">,</span>
         <span class="mf">1.23200000e-06</span><span class="p">,</span>   <span class="mf">2.35100000e-05</span><span class="p">,</span>   <span class="mf">2.39300000e-05</span><span class="p">,</span>
         <span class="mf">2.46400000e-06</span><span class="p">,</span>  <span class="o">-</span><span class="mf">1.89700000e-05</span><span class="p">,</span>  <span class="o">-</span><span class="mf">6.22700000e-05</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.27500000e-04</span><span class="p">,</span>  <span class="o">-</span><span class="mf">1.70700000e-04</span><span class="p">,</span>  <span class="o">-</span><span class="mf">2.57800000e-04</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">3.44800000e-04</span><span class="p">,</span>  <span class="o">-</span><span class="mf">4.53600000e-04</span><span class="p">,</span>  <span class="o">-</span><span class="mf">5.40600000e-04</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">5.84000000e-04</span><span class="p">,</span>  <span class="o">-</span><span class="mf">5.61700000e-04</span><span class="p">,</span>  <span class="o">-</span><span class="mf">4.73800000e-04</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">2.54900000e-04</span><span class="p">,</span>   <span class="mf">1.17100000e-04</span><span class="p">,</span>   <span class="mf">6.85900000e-04</span><span class="p">,</span>
         <span class="mf">1.51700000e-03</span><span class="p">,</span>   <span class="mf">2.50100000e-03</span><span class="p">,</span>   <span class="mf">3.70300000e-03</span><span class="p">,</span>
         <span class="mf">5.01500000e-03</span><span class="p">,</span>   <span class="mf">6.26200000e-03</span><span class="p">,</span>   <span class="mf">7.20200000e-03</span><span class="p">,</span>
         <span class="mf">7.61800000e-03</span><span class="p">,</span>   <span class="mf">7.39900000e-03</span><span class="p">,</span>   <span class="mf">6.74400000e-03</span><span class="p">,</span>
         <span class="mf">5.91400000e-03</span><span class="p">,</span>   <span class="mf">5.01800000e-03</span><span class="p">,</span>   <span class="mf">4.10100000e-03</span><span class="p">,</span>
         <span class="mf">3.22700000e-03</span><span class="p">,</span>   <span class="mf">2.50600000e-03</span><span class="p">,</span>   <span class="mf">1.85000000e-03</span><span class="p">,</span>
         <span class="mf">1.32600000e-03</span><span class="p">,</span>   <span class="mf">9.11400000e-04</span><span class="p">,</span>   <span class="mf">5.84000000e-04</span><span class="p">,</span>
         <span class="mf">3.00200000e-04</span><span class="p">,</span>   <span class="mf">1.47600000e-04</span><span class="p">,</span>   <span class="mf">3.87500000e-05</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">4.82900000e-05</span><span class="p">,</span>  <span class="o">-</span><span class="mf">1.13400000e-04</span><span class="p">,</span>  <span class="o">-</span><span class="mf">1.13000000e-04</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.34500000e-04</span><span class="p">,</span>  <span class="o">-</span><span class="mf">1.34000000e-04</span><span class="p">,</span>  <span class="o">-</span><span class="mf">1.33600000e-04</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.11400000e-04</span><span class="p">,</span>  <span class="o">-</span><span class="mf">6.72600000e-05</span><span class="p">,</span>  <span class="o">-</span><span class="mf">6.68400000e-05</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">6.64500000e-05</span><span class="p">,</span>  <span class="o">-</span><span class="mf">4.41700000e-05</span><span class="p">,</span>  <span class="o">-</span><span class="mf">4.38200000e-05</span><span class="p">])</span>

    <span class="n">vfact</span><span class="o">=</span><span class="mi">2</span>
    <span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">4.5</span><span class="o">*</span><span class="mf">2.5</span><span class="o">/</span><span class="n">vfact</span><span class="p">,</span> <span class="mi">500</span><span class="p">)</span>
    <span class="n">x_norm</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2001</span><span class="p">)</span>
    <span class="c1">#see Dingetal2012 Table 2 for material properties</span>
    <span class="n">pdict</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">(</span>
            <span class="n">E</span> <span class="o">=</span> <span class="mf">6.998</span><span class="o">*</span><span class="mf">1e9</span><span class="p">,</span> <span class="c1">#Pa</span>
            <span class="n">rho</span> <span class="o">=</span> <span class="mi">2373</span><span class="p">,</span> <span class="c1">#kg/m3</span>
            <span class="n">L</span> <span class="o">=</span> <span class="mi">160</span><span class="p">,</span> <span class="c1">#m</span>
            <span class="c1">#v_norm=0.01165,</span>
            <span class="n">kf</span><span class="o">=</span><span class="mf">5.41e-4</span><span class="p">,</span>
            <span class="c1">#Fz_norm=1.013e-4,</span>
            <span class="n">mu_norm</span><span class="o">=</span><span class="mf">39.263</span><span class="p">,</span>
            <span class="n">k1_norm</span><span class="o">=</span><span class="mf">97.552</span><span class="p">,</span>
<span class="c1">#            k3_norm=2.497e6,</span>
            <span class="n">nterms</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span>
            <span class="n">BC</span><span class="o">=</span><span class="s2">&quot;SS&quot;</span><span class="p">,</span>
            <span class="n">nquad</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span>
<span class="c1">#            k1bar=PolyLine([0,0.5],[0.5,1],[1,1],[1,.25]),</span>
<span class="c1">#            k1bar=PolyLine([0,0.25,.75,1],[1.0,1,4,4]),</span>
<span class="c1">#            k1bar=PolyLine([0,0.4,.6,1],[1.0,1,.25,.25]),</span>
            <span class="n">k1bar</span><span class="o">=</span><span class="n">PolyLine</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mf">0.4</span><span class="p">,</span><span class="o">.</span><span class="mi">6</span><span class="p">,</span><span class="mi">1</span><span class="p">],[</span><span class="mf">1.0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">]),</span>
<span class="c1">#            k1bar=PolyLine([0,0.5],[0.5,1],[2,1],[2,1]),</span>
            <span class="n">moving_loads_x_norm</span><span class="o">=</span><span class="p">[[</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mf">0.05</span><span class="p">,</span><span class="o">-</span><span class="mf">0.1</span><span class="p">]],</span>
            <span class="n">moving_loads_Fz_norm</span><span class="o">=</span><span class="p">[</span><span class="mi">3</span><span class="o">*</span><span class="p">[</span><span class="mf">1.013e-4</span><span class="p">]],</span>
            <span class="n">moving_loads_v_norm</span><span class="o">=</span><span class="p">[</span><span class="mf">0.01165</span><span class="o">*</span><span class="n">vfact</span><span class="p">],</span>
            <span class="n">tvals</span><span class="o">=</span><span class="n">t</span><span class="p">,</span>
<span class="c1">#            tvals=np.array([4.0]),</span>
<span class="c1">#            xvals_norm=np.array([0.5]),</span>
            <span class="n">xvals_norm</span><span class="o">=</span><span class="n">x_norm</span><span class="p">,</span>

            <span class="n">use_analytical</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="c1">#            implementation=&quot;vectorized&quot;,</span>
            <span class="n">implementation</span><span class="o">=</span><span class="s2">&quot;fortran&quot;</span><span class="p">,</span>
            <span class="n">file_stem</span><span class="o">=</span><span class="s2">&quot;specbeam200moving_soft_to_stiff&quot;</span><span class="p">,</span>
            <span class="n">force_calc</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="p">)</span>



    <span class="n">a</span> <span class="o">=</span> <span class="n">SpecBeam</span><span class="p">(</span><span class="o">**</span><span class="n">pdict</span><span class="p">)</span>
    <span class="n">a</span><span class="o">.</span><span class="n">runme</span><span class="p">()</span>
    <span class="n">a</span><span class="o">.</span><span class="n">saveme</span><span class="p">()</span>
    <span class="n">a</span><span class="o">.</span><span class="n">animateme</span><span class="p">(</span><span class="n">norm</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">saveme</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">interval</span><span class="o">=</span><span class="mi">18</span><span class="p">)</span>
<span class="c1">#    a.plot_w_vs_x_overtime(norm=True)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="c1">#    a.calulate_qk(t=t)</span>
<span class="c1">#</span>
<span class="c1">#    yall = a.wofx(x_norm=0.5, normalise_w=False)</span>
    <span class="n">ycompare</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">interp</span><span class="p">(</span><span class="n">expected_50terms_t</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">a</span><span class="o">.</span><span class="n">defl</span><span class="p">)</span>


    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;n=&quot;</span><span class="p">,</span> <span class="n">pdict</span><span class="p">[</span><span class="s1">&#39;nterms&#39;</span><span class="p">])</span>
    <span class="n">end_time0</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
    <span class="n">elapsed_time</span> <span class="o">=</span> <span class="p">(</span><span class="n">end_time0</span> <span class="o">-</span> <span class="n">start_time0</span><span class="p">);</span> <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Total run time=</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">timedelta</span><span class="p">(</span><span class="n">seconds</span><span class="o">=</span><span class="n">elapsed_time</span><span class="p">))))</span>

    <span class="k">if</span> <span class="n">DEBUG</span><span class="p">:</span>


        <span class="n">title</span> <span class="o">=</span><span class="s1">&#39;SpecBeam, const mat prop vs Ding et al (2012) </span><span class="se">\n</span><span class="s1">Figure 8 Displacement at Midpoint of beam but with k3=0&#39;</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">title</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="s1">&#39;</span><span class="si">{:&gt;9s}</span><span class="s1">&#39;</span><span class="p">]</span><span class="o">*</span><span class="mi">4</span><span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;t&#39;</span><span class="p">,</span> <span class="s1">&#39;expect&#39;</span><span class="p">,</span> <span class="s1">&#39;calc&#39;</span><span class="p">,</span> <span class="s1">&#39;diff&#39;</span><span class="p">))</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">expected_50terms_t</span><span class="p">,</span> <span class="n">expected_50terms_displacement</span><span class="p">,</span> <span class="n">ycompare</span><span class="p">):</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="s1">&#39;</span><span class="si">{:9.4f}</span><span class="s1">&#39;</span><span class="p">]</span><span class="o">*</span><span class="mi">4</span><span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">j</span><span class="o">-</span><span class="n">k</span><span class="p">))</span>
        <span class="nb">print</span><span class="p">()</span>




        <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
        <span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="s2">&quot;111&quot;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;time, s&quot;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;w, m&quot;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mf">3.5</span><span class="p">,</span> <span class="mf">4.5</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">title</span><span class="p">)</span>

        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">expected_50terms_t</span><span class="p">,</span> <span class="n">expected_50terms_displacement</span><span class="p">,</span>
                <span class="n">label</span><span class="o">=</span><span class="s2">&quot;expect n=50&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">expected_200terms_t</span><span class="p">,</span> <span class="n">expected_200terms_displacement</span><span class="p">,</span>
                <span class="n">label</span><span class="o">=</span><span class="s2">&quot;expect n=200&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">)</span>


        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">a</span><span class="o">.</span><span class="n">defl</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;calc n=50&quot;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">expected_50terms_t</span><span class="p">,</span> <span class="n">ycompare</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;calc, n=50 (compare)&quot;</span><span class="p">,</span>
                <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;s&#39;</span><span class="p">,</span> <span class="n">ms</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;:&#39;</span><span class="p">)</span>

        <span class="n">leg</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper left&#39;</span><span class="p">)</span>
        <span class="n">leg</span><span class="o">.</span><span class="n">draggable</span><span class="p">()</span>

        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

    <span class="n">assert_allclose</span><span class="p">(</span><span class="n">expected_50terms_displacement</span><span class="p">,</span> <span class="n">ycompare</span><span class="p">,</span> <span class="n">atol</span><span class="o">=</span><span class="mf">2.4e-4</span><span class="p">)</span></div>



<div class="viewcode-block" id="SpecBeam_stationary_load_const_mat_midpoint_defl_runme_analytical_play"><a class="viewcode-back" href="../../../api/geotecha.beam_on_foundation.specbeam.html#geotecha.beam_on_foundation.specbeam.SpecBeam_stationary_load_const_mat_midpoint_defl_runme_analytical_play">[docs]</a><span class="k">def</span> <span class="nf">SpecBeam_stationary_load_const_mat_midpoint_defl_runme_analytical_play</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;Test SpecBeam for constant mat: close to Ding et al Figure 8, displacement vs time at</span>
<span class="sd">    beam midpoint (using the runme method) but with k3=0&quot;&quot;&quot;</span>

    <span class="n">start_time0</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
    <span class="n">ftime</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">fromtimestamp</span><span class="p">(</span><span class="n">start_time0</span><span class="p">)</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s1">&#39;%Y-%m-</span><span class="si">%d</span><span class="s1"> %H%M%S&#39;</span><span class="p">)</span>

    <span class="c1"># expected values are digitised from Ding et al 2012.</span>
    <span class="n">expected_50terms_t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
      <span class="p">[</span> <span class="mf">3.511</span><span class="p">,</span>  <span class="mf">3.553</span><span class="p">,</span>  <span class="mf">3.576</span><span class="p">,</span>  <span class="mf">3.605</span><span class="p">,</span>  <span class="mf">3.621</span><span class="p">,</span>  <span class="mf">3.637</span><span class="p">,</span>  <span class="mf">3.651</span><span class="p">,</span>  <span class="mf">3.661</span><span class="p">,</span>
        <span class="mf">3.676</span><span class="p">,</span>  <span class="mf">3.693</span><span class="p">,</span>  <span class="mf">3.701</span><span class="p">,</span>  <span class="mf">3.717</span><span class="p">,</span>  <span class="mf">3.733</span><span class="p">,</span>  <span class="mf">3.743</span><span class="p">,</span>  <span class="mf">3.761</span><span class="p">,</span>  <span class="mf">3.777</span><span class="p">,</span>
        <span class="mf">3.79</span> <span class="p">,</span>  <span class="mf">3.804</span><span class="p">,</span>  <span class="mf">3.822</span><span class="p">,</span>  <span class="mf">3.833</span><span class="p">,</span>  <span class="mf">3.848</span><span class="p">,</span>  <span class="mf">3.862</span><span class="p">,</span>  <span class="mf">3.877</span><span class="p">,</span>  <span class="mf">3.899</span><span class="p">,</span>
        <span class="mf">3.919</span><span class="p">,</span>  <span class="mf">3.94</span> <span class="p">,</span>  <span class="mf">3.956</span><span class="p">,</span>  <span class="mf">3.97</span> <span class="p">,</span>  <span class="mf">3.978</span><span class="p">,</span>  <span class="mf">3.99</span> <span class="p">,</span>  <span class="mf">4.001</span><span class="p">,</span>  <span class="mf">4.014</span><span class="p">,</span>
        <span class="mf">4.025</span><span class="p">,</span>  <span class="mf">4.041</span><span class="p">,</span>  <span class="mf">4.052</span><span class="p">,</span>  <span class="mf">4.064</span><span class="p">,</span>  <span class="mf">4.076</span><span class="p">,</span>  <span class="mf">4.086</span><span class="p">,</span>  <span class="mf">4.094</span><span class="p">,</span>  <span class="mf">4.104</span><span class="p">,</span>
        <span class="mf">4.112</span><span class="p">,</span>  <span class="mf">4.123</span><span class="p">,</span>  <span class="mf">4.134</span><span class="p">,</span>  <span class="mf">4.146</span><span class="p">,</span>  <span class="mf">4.159</span><span class="p">,</span>  <span class="mf">4.172</span><span class="p">,</span>  <span class="mf">4.18</span> <span class="p">,</span>  <span class="mf">4.192</span><span class="p">,</span>
        <span class="mf">4.212</span><span class="p">,</span>  <span class="mf">4.221</span><span class="p">,</span>  <span class="mf">4.234</span><span class="p">,</span>  <span class="mf">4.255</span><span class="p">,</span>  <span class="mf">4.273</span><span class="p">,</span>  <span class="mf">4.292</span><span class="p">,</span>  <span class="mf">4.324</span><span class="p">,</span>  <span class="mf">4.357</span><span class="p">,</span>
        <span class="mf">4.373</span><span class="p">,</span>  <span class="mf">4.399</span><span class="p">,</span>  <span class="mf">4.418</span><span class="p">,</span>  <span class="mf">4.445</span><span class="p">])</span>

    <span class="c1">#old values for k3~=0</span>
<span class="c1">#    expected_50terms_displacement = np.array(</span>
<span class="c1">#      [ -1.30900000e-04,   8.85900000e-05,   2.63900000e-04,</span>
<span class="c1">#         3.30200000e-04,   3.30500000e-04,   2.87100000e-04,</span>
<span class="c1">#         2.00000000e-04,   9.09500000e-05,  -8.36000000e-05,</span>
<span class="c1">#        -3.01800000e-04,  -4.32800000e-04,  -6.07300000e-04,</span>
<span class="c1">#        -7.59900000e-04,  -8.90900000e-04,  -9.99800000e-04,</span>
<span class="c1">#        -1.02100000e-03,  -9.99100000e-04,  -8.67700000e-04,</span>
<span class="c1">#        -5.61300000e-04,  -2.11300000e-04,   2.04300000e-04,</span>
<span class="c1">#         7.29200000e-04,   1.42900000e-03,   2.41300000e-03,</span>
<span class="c1">#         3.46300000e-03,   4.29400000e-03,   5.08100000e-03,</span>
<span class="c1">#         5.62800000e-03,   5.86800000e-03,   6.19600000e-03,</span>
<span class="c1">#         6.39300000e-03,   6.52500000e-03,   6.59100000e-03,</span>
<span class="c1">#         6.48200000e-03,   6.32900000e-03,   6.02300000e-03,</span>
<span class="c1">#         5.69600000e-03,   5.45500000e-03,   5.06200000e-03,</span>
<span class="c1">#         4.75600000e-03,   4.40700000e-03,   3.90400000e-03,</span>
<span class="c1">#         3.35800000e-03,   2.87800000e-03,   2.35300000e-03,</span>
<span class="c1">#         1.82900000e-03,   1.52300000e-03,   9.98700000e-04,</span>
<span class="c1">#         5.18300000e-04,   2.12500000e-04,  -4.95200000e-05,</span>
<span class="c1">#        -2.67600000e-04,  -3.76500000e-04,  -3.76100000e-04,</span>
<span class="c1">#        -2.00600000e-04,   1.87300000e-05,   1.06500000e-04,</span>
<span class="c1">#         1.94500000e-04,   1.94900000e-04,   1.30000000e-04])</span>


    <span class="n">expected_50terms_displacement</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
      <span class="p">[</span> <span class="o">-</span><span class="mf">1.74400116e-05</span><span class="p">,</span>   <span class="mf">2.56595529e-04</span><span class="p">,</span>   <span class="mf">3.64963938e-04</span><span class="p">,</span>
         <span class="mf">3.96163257e-04</span><span class="p">,</span>   <span class="mf">3.52239419e-04</span><span class="p">,</span>   <span class="mf">2.55908617e-04</span><span class="p">,</span>
         <span class="mf">1.36296573e-04</span><span class="p">,</span>   <span class="mf">3.12193756e-05</span><span class="p">,</span>  <span class="o">-</span><span class="mf">1.48035583e-04</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">3.73050108e-04</span><span class="p">,</span>  <span class="o">-</span><span class="mf">4.80427236e-04</span><span class="p">,</span>  <span class="o">-</span><span class="mf">6.84847774e-04</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">8.61705766e-04</span><span class="p">,</span>  <span class="o">-</span><span class="mf">9.44268811e-04</span><span class="p">,</span>  <span class="o">-</span><span class="mf">1.02333177e-03</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.00753661e-03</span><span class="p">,</span>  <span class="o">-</span><span class="mf">9.18192599e-04</span><span class="p">,</span>  <span class="o">-</span><span class="mf">7.32771117e-04</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">3.72382730e-04</span><span class="p">,</span>  <span class="o">-</span><span class="mf">7.79760498e-05</span><span class="p">,</span>   <span class="mf">4.06998900e-04</span><span class="p">,</span>
         <span class="mf">9.37679667e-04</span><span class="p">,</span>   <span class="mf">1.57072235e-03</span><span class="p">,</span>   <span class="mf">2.58323632e-03</span><span class="p">,</span>
         <span class="mf">3.52928135e-03</span><span class="p">,</span>   <span class="mf">4.47726082e-03</span><span class="p">,</span>   <span class="mf">5.12406706e-03</span><span class="p">,</span>
         <span class="mf">5.61329890e-03</span><span class="p">,</span>   <span class="mf">5.84231170e-03</span><span class="p">,</span>   <span class="mf">6.13309619e-03</span><span class="p">,</span>
         <span class="mf">6.32505191e-03</span><span class="p">,</span>   <span class="mf">6.46203546e-03</span><span class="p">,</span>   <span class="mf">6.49032925e-03</span><span class="p">,</span>
         <span class="mf">6.39329339e-03</span><span class="p">,</span>   <span class="mf">6.23960924e-03</span><span class="p">,</span>   <span class="mf">5.99242067e-03</span><span class="p">,</span>
         <span class="mf">5.67177967e-03</span><span class="p">,</span>   <span class="mf">5.35598822e-03</span><span class="p">,</span>   <span class="mf">5.07919623e-03</span><span class="p">,</span>
         <span class="mf">4.69552191e-03</span><span class="p">,</span>   <span class="mf">4.37030991e-03</span><span class="p">,</span>   <span class="mf">3.90678952e-03</span><span class="p">,</span>
         <span class="mf">3.43034780e-03</span><span class="p">,</span>   <span class="mf">2.90774639e-03</span><span class="p">,</span>   <span class="mf">2.35231514e-03</span><span class="p">,</span>
         <span class="mf">1.82145021e-03</span><span class="p">,</span>   <span class="mf">1.51724930e-03</span><span class="p">,</span>   <span class="mf">1.09014092e-03</span><span class="p">,</span>
         <span class="mf">4.86434682e-04</span><span class="p">,</span>   <span class="mf">2.61200867e-04</span><span class="p">,</span>  <span class="o">-</span><span class="mf">5.02752907e-06</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">2.99906282e-04</span><span class="p">,</span>  <span class="o">-</span><span class="mf">4.26188536e-04</span><span class="p">,</span>  <span class="o">-</span><span class="mf">4.46910518e-04</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">3.09328219e-04</span><span class="p">,</span>  <span class="o">-</span><span class="mf">6.53887601e-05</span><span class="p">,</span>   <span class="mf">4.77786782e-05</span><span class="p">,</span>
         <span class="mf">1.84483472e-04</span><span class="p">,</span>   <span class="mf">2.30390682e-04</span><span class="p">,</span>   <span class="mf">2.18090273e-04</span><span class="p">])</span>

    <span class="n">expected_200terms_t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
      <span class="p">[</span> <span class="mf">3.503</span><span class="p">,</span>  <span class="mf">3.519</span><span class="p">,</span>  <span class="mf">3.539</span><span class="p">,</span>  <span class="mf">3.556</span><span class="p">,</span>  <span class="mf">3.576</span><span class="p">,</span>  <span class="mf">3.595</span><span class="p">,</span>  <span class="mf">3.613</span><span class="p">,</span>  <span class="mf">3.632</span><span class="p">,</span>
        <span class="mf">3.651</span><span class="p">,</span>  <span class="mf">3.667</span><span class="p">,</span>  <span class="mf">3.69</span> <span class="p">,</span>  <span class="mf">3.708</span><span class="p">,</span>  <span class="mf">3.727</span><span class="p">,</span>  <span class="mf">3.746</span><span class="p">,</span>  <span class="mf">3.766</span><span class="p">,</span>  <span class="mf">3.782</span><span class="p">,</span>
        <span class="mf">3.801</span><span class="p">,</span>  <span class="mf">3.822</span><span class="p">,</span>  <span class="mf">3.84</span> <span class="p">,</span>  <span class="mf">3.856</span><span class="p">,</span>  <span class="mf">3.878</span><span class="p">,</span>  <span class="mf">3.896</span><span class="p">,</span>  <span class="mf">3.915</span><span class="p">,</span>  <span class="mf">3.933</span><span class="p">,</span>
        <span class="mf">3.951</span><span class="p">,</span>  <span class="mf">3.97</span> <span class="p">,</span>  <span class="mf">3.99</span> <span class="p">,</span>  <span class="mf">4.009</span><span class="p">,</span>  <span class="mf">4.027</span><span class="p">,</span>  <span class="mf">4.046</span><span class="p">,</span>  <span class="mf">4.067</span><span class="p">,</span>  <span class="mf">4.085</span><span class="p">,</span>
        <span class="mf">4.102</span><span class="p">,</span>  <span class="mf">4.122</span><span class="p">,</span>  <span class="mf">4.141</span><span class="p">,</span>  <span class="mf">4.159</span><span class="p">,</span>  <span class="mf">4.178</span><span class="p">,</span>  <span class="mf">4.197</span><span class="p">,</span>  <span class="mf">4.217</span><span class="p">,</span>  <span class="mf">4.234</span><span class="p">,</span>
        <span class="mf">4.252</span><span class="p">,</span>  <span class="mf">4.273</span><span class="p">,</span>  <span class="mf">4.291</span><span class="p">,</span>  <span class="mf">4.31</span> <span class="p">,</span>  <span class="mf">4.329</span><span class="p">,</span>  <span class="mf">4.347</span><span class="p">,</span>  <span class="mf">4.368</span><span class="p">,</span>  <span class="mf">4.386</span><span class="p">,</span>
        <span class="mf">4.405</span><span class="p">,</span>  <span class="mf">4.423</span><span class="p">,</span>  <span class="mf">4.442</span><span class="p">,</span>  <span class="mf">4.46</span> <span class="p">,</span>  <span class="mf">4.479</span><span class="p">,</span>  <span class="mf">4.495</span><span class="p">])</span>

    <span class="c1">#wrong : displ are with k3~=0</span>
    <span class="n">expected_200terms_displacement</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
      <span class="p">[</span>  <span class="mf">7.04000000e-08</span><span class="p">,</span>   <span class="mf">2.22800000e-05</span><span class="p">,</span>   <span class="mf">2.27000000e-05</span><span class="p">,</span>
         <span class="mf">1.23200000e-06</span><span class="p">,</span>   <span class="mf">2.35100000e-05</span><span class="p">,</span>   <span class="mf">2.39300000e-05</span><span class="p">,</span>
         <span class="mf">2.46400000e-06</span><span class="p">,</span>  <span class="o">-</span><span class="mf">1.89700000e-05</span><span class="p">,</span>  <span class="o">-</span><span class="mf">6.22700000e-05</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.27500000e-04</span><span class="p">,</span>  <span class="o">-</span><span class="mf">1.70700000e-04</span><span class="p">,</span>  <span class="o">-</span><span class="mf">2.57800000e-04</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">3.44800000e-04</span><span class="p">,</span>  <span class="o">-</span><span class="mf">4.53600000e-04</span><span class="p">,</span>  <span class="o">-</span><span class="mf">5.40600000e-04</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">5.84000000e-04</span><span class="p">,</span>  <span class="o">-</span><span class="mf">5.61700000e-04</span><span class="p">,</span>  <span class="o">-</span><span class="mf">4.73800000e-04</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">2.54900000e-04</span><span class="p">,</span>   <span class="mf">1.17100000e-04</span><span class="p">,</span>   <span class="mf">6.85900000e-04</span><span class="p">,</span>
         <span class="mf">1.51700000e-03</span><span class="p">,</span>   <span class="mf">2.50100000e-03</span><span class="p">,</span>   <span class="mf">3.70300000e-03</span><span class="p">,</span>
         <span class="mf">5.01500000e-03</span><span class="p">,</span>   <span class="mf">6.26200000e-03</span><span class="p">,</span>   <span class="mf">7.20200000e-03</span><span class="p">,</span>
         <span class="mf">7.61800000e-03</span><span class="p">,</span>   <span class="mf">7.39900000e-03</span><span class="p">,</span>   <span class="mf">6.74400000e-03</span><span class="p">,</span>
         <span class="mf">5.91400000e-03</span><span class="p">,</span>   <span class="mf">5.01800000e-03</span><span class="p">,</span>   <span class="mf">4.10100000e-03</span><span class="p">,</span>
         <span class="mf">3.22700000e-03</span><span class="p">,</span>   <span class="mf">2.50600000e-03</span><span class="p">,</span>   <span class="mf">1.85000000e-03</span><span class="p">,</span>
         <span class="mf">1.32600000e-03</span><span class="p">,</span>   <span class="mf">9.11400000e-04</span><span class="p">,</span>   <span class="mf">5.84000000e-04</span><span class="p">,</span>
         <span class="mf">3.00200000e-04</span><span class="p">,</span>   <span class="mf">1.47600000e-04</span><span class="p">,</span>   <span class="mf">3.87500000e-05</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">4.82900000e-05</span><span class="p">,</span>  <span class="o">-</span><span class="mf">1.13400000e-04</span><span class="p">,</span>  <span class="o">-</span><span class="mf">1.13000000e-04</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.34500000e-04</span><span class="p">,</span>  <span class="o">-</span><span class="mf">1.34000000e-04</span><span class="p">,</span>  <span class="o">-</span><span class="mf">1.33600000e-04</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.11400000e-04</span><span class="p">,</span>  <span class="o">-</span><span class="mf">6.72600000e-05</span><span class="p">,</span>  <span class="o">-</span><span class="mf">6.68400000e-05</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">6.64500000e-05</span><span class="p">,</span>  <span class="o">-</span><span class="mf">4.41700000e-05</span><span class="p">,</span>  <span class="o">-</span><span class="mf">4.38200000e-05</span><span class="p">])</span>

    <span class="n">vfact</span><span class="o">=</span><span class="mi">2</span>
    <span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">4.5</span><span class="o">*</span><span class="mi">3</span><span class="o">/</span><span class="n">vfact</span><span class="p">,</span> <span class="mi">200</span><span class="p">)</span>
    <span class="n">x_norm</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2001</span><span class="p">)</span>
    <span class="c1">#see Dingetal2012 Table 2 for material properties</span>
    <span class="n">pdict</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">(</span>
            <span class="n">E</span> <span class="o">=</span> <span class="mf">6.998</span><span class="o">*</span><span class="mf">1e9</span><span class="p">,</span> <span class="c1">#Pa</span>
            <span class="n">rho</span> <span class="o">=</span> <span class="mi">2373</span><span class="p">,</span> <span class="c1">#kg/m3</span>
            <span class="n">L</span> <span class="o">=</span> <span class="mi">160</span><span class="p">,</span> <span class="c1">#m</span>
            <span class="c1">#v_norm=0.01165,</span>
            <span class="n">kf</span><span class="o">=</span><span class="mf">5.41e-4</span><span class="p">,</span>
            <span class="c1">#Fz_norm=1.013e-4,</span>
            <span class="n">mu_norm</span><span class="o">=</span><span class="mf">39.263</span><span class="p">,</span>
            <span class="n">k1_norm</span><span class="o">=</span><span class="mf">97.552</span><span class="p">,</span>
<span class="c1">#            k3_norm=2.497e6,</span>
            <span class="n">nterms</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span>
            <span class="n">BC</span><span class="o">=</span><span class="s2">&quot;SS&quot;</span><span class="p">,</span>
            <span class="n">nquad</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span>
<span class="c1">#            k1bar=PolyLine([0,0.5],[0.5,1],[1,1],[1,.25]),</span>
<span class="c1">#            k1bar=PolyLine([0,0.25,.75,1],[1.0,1,4,4]),</span>
            <span class="n">k1bar</span><span class="o">=</span><span class="n">PolyLine</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mf">0.4</span><span class="p">,</span><span class="o">.</span><span class="mi">6</span><span class="p">,</span><span class="mi">1</span><span class="p">],[</span><span class="mf">1.0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">.</span><span class="mi">25</span><span class="p">,</span><span class="o">.</span><span class="mi">25</span><span class="p">]),</span>
<span class="c1">#            k1bar=PolyLine([0,0.5],[0.5,1],[2,1],[2,1]),</span>

<span class="c1">#            moving_loads_x_norm=[[0,-0.05,-0.1]],</span>
<span class="c1">#            moving_loads_Fz_norm=[3*[1.013e-4]],</span>
<span class="c1">#            moving_loads_v_norm=[0.01165*vfact],</span>

<span class="c1">#            stationary_loads_x=None,</span>
<span class="c1">#            stationary_loads_vs_t=None,</span>
<span class="c1">#            stationary_loads_omega_phase=None,</span>
            <span class="n">stationary_loads_x_norm</span><span class="o">=</span><span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">],</span>
            <span class="n">stationary_loads_vs_t_norm</span><span class="o">=</span><span class="mi">2</span><span class="o">*</span><span class="p">[</span><span class="n">PolyLine</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="n">t</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="mi">160</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mf">6.998</span><span class="o">*</span><span class="mf">1e9</span><span class="o">/</span><span class="mf">2373.</span><span class="p">)],[</span><span class="mf">0.5</span><span class="o">*</span><span class="mf">1.013e-4</span><span class="p">,</span><span class="mf">0.5</span><span class="o">*</span><span class="mf">1.013e-4</span><span class="p">])],</span>
            <span class="n">stationary_loads_omega_phase_norm</span><span class="o">=</span><span class="p">[(</span><span class="o">.</span><span class="mi">5</span><span class="p">,</span><span class="mi">0</span><span class="p">),(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)],</span><span class="c1">#None,</span>
            <span class="n">tvals</span><span class="o">=</span><span class="n">t</span><span class="p">,</span>
<span class="c1">#            tvals=np.array([4.0]),</span>
<span class="c1">#            xvals_norm=np.array([0.5]),</span>
            <span class="n">xvals_norm</span><span class="o">=</span><span class="n">x_norm</span><span class="p">,</span>

            <span class="n">use_analytical</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="c1">#            implementation=&quot;vectorized&quot;,</span>
            <span class="n">implementation</span><span class="o">=</span><span class="s2">&quot;fortran&quot;</span><span class="p">,</span>
            <span class="n">file_stem</span><span class="o">=</span><span class="s2">&quot;specbeam200stationary&quot;</span><span class="p">,</span>
            <span class="n">force_calc</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="p">)</span>



    <span class="n">a</span> <span class="o">=</span> <span class="n">SpecBeam</span><span class="p">(</span><span class="o">**</span><span class="n">pdict</span><span class="p">)</span>
    <span class="n">a</span><span class="o">.</span><span class="n">runme</span><span class="p">()</span>
    <span class="n">a</span><span class="o">.</span><span class="n">saveme</span><span class="p">()</span>
    <span class="n">a</span><span class="o">.</span><span class="n">animateme</span><span class="p">(</span><span class="n">norm</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="c1">#    a.plot_w_vs_x_overtime(norm=True)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span></div>







<div class="viewcode-block" id="FIGURE_verify_against_DingEtAl2012_fig8"><a class="viewcode-back" href="../../../api/geotecha.beam_on_foundation.specbeam.html#geotecha.beam_on_foundation.specbeam.FIGURE_verify_against_DingEtAl2012_fig8">[docs]</a><span class="k">def</span> <span class="nf">FIGURE_verify_against_DingEtAl2012_fig8</span><span class="p">(</span><span class="n">v_nterms</span><span class="o">=</span><span class="p">(</span><span class="mi">50</span><span class="p">,</span><span class="mi">75</span><span class="p">,</span><span class="mi">150</span><span class="p">,</span><span class="mi">200</span><span class="p">),</span> <span class="n">saveas</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Ding et al Figure 8, displacement vs time at</span>
<span class="sd">    beam midpoint (using the runme method) (50 and 200 terms)&quot;&quot;&quot;</span>

    <span class="n">expected</span><span class="o">=</span><span class="nb">dict</span><span class="p">()</span>
    <span class="c1"># expected values are digitised from Ding et al 2012.</span>
    <span class="n">expected_50terms_t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
      <span class="p">[</span> <span class="mf">3.511</span><span class="p">,</span>  <span class="mf">3.553</span><span class="p">,</span>  <span class="mf">3.576</span><span class="p">,</span>  <span class="mf">3.605</span><span class="p">,</span>  <span class="mf">3.621</span><span class="p">,</span>  <span class="mf">3.637</span><span class="p">,</span>  <span class="mf">3.651</span><span class="p">,</span>  <span class="mf">3.661</span><span class="p">,</span>
        <span class="mf">3.676</span><span class="p">,</span>  <span class="mf">3.693</span><span class="p">,</span>  <span class="mf">3.701</span><span class="p">,</span>  <span class="mf">3.717</span><span class="p">,</span>  <span class="mf">3.733</span><span class="p">,</span>  <span class="mf">3.743</span><span class="p">,</span>  <span class="mf">3.761</span><span class="p">,</span>  <span class="mf">3.777</span><span class="p">,</span>
        <span class="mf">3.79</span> <span class="p">,</span>  <span class="mf">3.804</span><span class="p">,</span>  <span class="mf">3.822</span><span class="p">,</span>  <span class="mf">3.833</span><span class="p">,</span>  <span class="mf">3.848</span><span class="p">,</span>  <span class="mf">3.862</span><span class="p">,</span>  <span class="mf">3.877</span><span class="p">,</span>  <span class="mf">3.899</span><span class="p">,</span>
        <span class="mf">3.919</span><span class="p">,</span>  <span class="mf">3.94</span> <span class="p">,</span>  <span class="mf">3.956</span><span class="p">,</span>  <span class="mf">3.97</span> <span class="p">,</span>  <span class="mf">3.978</span><span class="p">,</span>  <span class="mf">3.99</span> <span class="p">,</span>  <span class="mf">4.001</span><span class="p">,</span>  <span class="mf">4.014</span><span class="p">,</span>
        <span class="mf">4.025</span><span class="p">,</span>  <span class="mf">4.041</span><span class="p">,</span>  <span class="mf">4.052</span><span class="p">,</span>  <span class="mf">4.064</span><span class="p">,</span>  <span class="mf">4.076</span><span class="p">,</span>  <span class="mf">4.086</span><span class="p">,</span>  <span class="mf">4.094</span><span class="p">,</span>  <span class="mf">4.104</span><span class="p">,</span>
        <span class="mf">4.112</span><span class="p">,</span>  <span class="mf">4.123</span><span class="p">,</span>  <span class="mf">4.134</span><span class="p">,</span>  <span class="mf">4.146</span><span class="p">,</span>  <span class="mf">4.159</span><span class="p">,</span>  <span class="mf">4.172</span><span class="p">,</span>  <span class="mf">4.18</span> <span class="p">,</span>  <span class="mf">4.192</span><span class="p">,</span>
        <span class="mf">4.212</span><span class="p">,</span>  <span class="mf">4.221</span><span class="p">,</span>  <span class="mf">4.234</span><span class="p">,</span>  <span class="mf">4.255</span><span class="p">,</span>  <span class="mf">4.273</span><span class="p">,</span>  <span class="mf">4.292</span><span class="p">,</span>  <span class="mf">4.324</span><span class="p">,</span>  <span class="mf">4.357</span><span class="p">,</span>
        <span class="mf">4.373</span><span class="p">,</span>  <span class="mf">4.399</span><span class="p">,</span>  <span class="mf">4.418</span><span class="p">,</span>  <span class="mf">4.445</span><span class="p">])</span>

    <span class="c1">#old values for k3~=0</span>
<span class="c1">#    expected_50terms_displacement = np.array(</span>
<span class="c1">#      [ -1.30900000e-04,   8.85900000e-05,   2.63900000e-04,</span>
<span class="c1">#         3.30200000e-04,   3.30500000e-04,   2.87100000e-04,</span>
<span class="c1">#         2.00000000e-04,   9.09500000e-05,  -8.36000000e-05,</span>
<span class="c1">#        -3.01800000e-04,  -4.32800000e-04,  -6.07300000e-04,</span>
<span class="c1">#        -7.59900000e-04,  -8.90900000e-04,  -9.99800000e-04,</span>
<span class="c1">#        -1.02100000e-03,  -9.99100000e-04,  -8.67700000e-04,</span>
<span class="c1">#        -5.61300000e-04,  -2.11300000e-04,   2.04300000e-04,</span>
<span class="c1">#         7.29200000e-04,   1.42900000e-03,   2.41300000e-03,</span>
<span class="c1">#         3.46300000e-03,   4.29400000e-03,   5.08100000e-03,</span>
<span class="c1">#         5.62800000e-03,   5.86800000e-03,   6.19600000e-03,</span>
<span class="c1">#         6.39300000e-03,   6.52500000e-03,   6.59100000e-03,</span>
<span class="c1">#         6.48200000e-03,   6.32900000e-03,   6.02300000e-03,</span>
<span class="c1">#         5.69600000e-03,   5.45500000e-03,   5.06200000e-03,</span>
<span class="c1">#         4.75600000e-03,   4.40700000e-03,   3.90400000e-03,</span>
<span class="c1">#         3.35800000e-03,   2.87800000e-03,   2.35300000e-03,</span>
<span class="c1">#         1.82900000e-03,   1.52300000e-03,   9.98700000e-04,</span>
<span class="c1">#         5.18300000e-04,   2.12500000e-04,  -4.95200000e-05,</span>
<span class="c1">#        -2.67600000e-04,  -3.76500000e-04,  -3.76100000e-04,</span>
<span class="c1">#        -2.00600000e-04,   1.87300000e-05,   1.06500000e-04,</span>
<span class="c1">#         1.94500000e-04,   1.94900000e-04,   1.30000000e-04])</span>


    <span class="n">expected_50terms_displacement</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
      <span class="p">[</span> <span class="o">-</span><span class="mf">1.74400116e-05</span><span class="p">,</span>   <span class="mf">2.56595529e-04</span><span class="p">,</span>   <span class="mf">3.64963938e-04</span><span class="p">,</span>
         <span class="mf">3.96163257e-04</span><span class="p">,</span>   <span class="mf">3.52239419e-04</span><span class="p">,</span>   <span class="mf">2.55908617e-04</span><span class="p">,</span>
         <span class="mf">1.36296573e-04</span><span class="p">,</span>   <span class="mf">3.12193756e-05</span><span class="p">,</span>  <span class="o">-</span><span class="mf">1.48035583e-04</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">3.73050108e-04</span><span class="p">,</span>  <span class="o">-</span><span class="mf">4.80427236e-04</span><span class="p">,</span>  <span class="o">-</span><span class="mf">6.84847774e-04</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">8.61705766e-04</span><span class="p">,</span>  <span class="o">-</span><span class="mf">9.44268811e-04</span><span class="p">,</span>  <span class="o">-</span><span class="mf">1.02333177e-03</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.00753661e-03</span><span class="p">,</span>  <span class="o">-</span><span class="mf">9.18192599e-04</span><span class="p">,</span>  <span class="o">-</span><span class="mf">7.32771117e-04</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">3.72382730e-04</span><span class="p">,</span>  <span class="o">-</span><span class="mf">7.79760498e-05</span><span class="p">,</span>   <span class="mf">4.06998900e-04</span><span class="p">,</span>
         <span class="mf">9.37679667e-04</span><span class="p">,</span>   <span class="mf">1.57072235e-03</span><span class="p">,</span>   <span class="mf">2.58323632e-03</span><span class="p">,</span>
         <span class="mf">3.52928135e-03</span><span class="p">,</span>   <span class="mf">4.47726082e-03</span><span class="p">,</span>   <span class="mf">5.12406706e-03</span><span class="p">,</span>
         <span class="mf">5.61329890e-03</span><span class="p">,</span>   <span class="mf">5.84231170e-03</span><span class="p">,</span>   <span class="mf">6.13309619e-03</span><span class="p">,</span>
         <span class="mf">6.32505191e-03</span><span class="p">,</span>   <span class="mf">6.46203546e-03</span><span class="p">,</span>   <span class="mf">6.49032925e-03</span><span class="p">,</span>
         <span class="mf">6.39329339e-03</span><span class="p">,</span>   <span class="mf">6.23960924e-03</span><span class="p">,</span>   <span class="mf">5.99242067e-03</span><span class="p">,</span>
         <span class="mf">5.67177967e-03</span><span class="p">,</span>   <span class="mf">5.35598822e-03</span><span class="p">,</span>   <span class="mf">5.07919623e-03</span><span class="p">,</span>
         <span class="mf">4.69552191e-03</span><span class="p">,</span>   <span class="mf">4.37030991e-03</span><span class="p">,</span>   <span class="mf">3.90678952e-03</span><span class="p">,</span>
         <span class="mf">3.43034780e-03</span><span class="p">,</span>   <span class="mf">2.90774639e-03</span><span class="p">,</span>   <span class="mf">2.35231514e-03</span><span class="p">,</span>
         <span class="mf">1.82145021e-03</span><span class="p">,</span>   <span class="mf">1.51724930e-03</span><span class="p">,</span>   <span class="mf">1.09014092e-03</span><span class="p">,</span>
         <span class="mf">4.86434682e-04</span><span class="p">,</span>   <span class="mf">2.61200867e-04</span><span class="p">,</span>  <span class="o">-</span><span class="mf">5.02752907e-06</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">2.99906282e-04</span><span class="p">,</span>  <span class="o">-</span><span class="mf">4.26188536e-04</span><span class="p">,</span>  <span class="o">-</span><span class="mf">4.46910518e-04</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">3.09328219e-04</span><span class="p">,</span>  <span class="o">-</span><span class="mf">6.53887601e-05</span><span class="p">,</span>   <span class="mf">4.77786782e-05</span><span class="p">,</span>
         <span class="mf">1.84483472e-04</span><span class="p">,</span>   <span class="mf">2.30390682e-04</span><span class="p">,</span>   <span class="mf">2.18090273e-04</span><span class="p">])</span>

    <span class="n">expected_200terms_t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
      <span class="p">[</span> <span class="mf">3.503</span><span class="p">,</span>  <span class="mf">3.519</span><span class="p">,</span>  <span class="mf">3.539</span><span class="p">,</span>  <span class="mf">3.556</span><span class="p">,</span>  <span class="mf">3.576</span><span class="p">,</span>  <span class="mf">3.595</span><span class="p">,</span>  <span class="mf">3.613</span><span class="p">,</span>  <span class="mf">3.632</span><span class="p">,</span>
        <span class="mf">3.651</span><span class="p">,</span>  <span class="mf">3.667</span><span class="p">,</span>  <span class="mf">3.69</span> <span class="p">,</span>  <span class="mf">3.708</span><span class="p">,</span>  <span class="mf">3.727</span><span class="p">,</span>  <span class="mf">3.746</span><span class="p">,</span>  <span class="mf">3.766</span><span class="p">,</span>  <span class="mf">3.782</span><span class="p">,</span>
        <span class="mf">3.801</span><span class="p">,</span>  <span class="mf">3.822</span><span class="p">,</span>  <span class="mf">3.84</span> <span class="p">,</span>  <span class="mf">3.856</span><span class="p">,</span>  <span class="mf">3.878</span><span class="p">,</span>  <span class="mf">3.896</span><span class="p">,</span>  <span class="mf">3.915</span><span class="p">,</span>  <span class="mf">3.933</span><span class="p">,</span>
        <span class="mf">3.951</span><span class="p">,</span>  <span class="mf">3.97</span> <span class="p">,</span>  <span class="mf">3.99</span> <span class="p">,</span>  <span class="mf">4.009</span><span class="p">,</span>  <span class="mf">4.027</span><span class="p">,</span>  <span class="mf">4.046</span><span class="p">,</span>  <span class="mf">4.067</span><span class="p">,</span>  <span class="mf">4.085</span><span class="p">,</span>
        <span class="mf">4.102</span><span class="p">,</span>  <span class="mf">4.122</span><span class="p">,</span>  <span class="mf">4.141</span><span class="p">,</span>  <span class="mf">4.159</span><span class="p">,</span>  <span class="mf">4.178</span><span class="p">,</span>  <span class="mf">4.197</span><span class="p">,</span>  <span class="mf">4.217</span><span class="p">,</span>  <span class="mf">4.234</span><span class="p">,</span>
        <span class="mf">4.252</span><span class="p">,</span>  <span class="mf">4.273</span><span class="p">,</span>  <span class="mf">4.291</span><span class="p">,</span>  <span class="mf">4.31</span> <span class="p">,</span>  <span class="mf">4.329</span><span class="p">,</span>  <span class="mf">4.347</span><span class="p">,</span>  <span class="mf">4.368</span><span class="p">,</span>  <span class="mf">4.386</span><span class="p">,</span>
        <span class="mf">4.405</span><span class="p">,</span>  <span class="mf">4.423</span><span class="p">,</span>  <span class="mf">4.442</span><span class="p">,</span>  <span class="mf">4.46</span> <span class="p">,</span>  <span class="mf">4.479</span><span class="p">,</span>  <span class="mf">4.495</span><span class="p">])</span>

    <span class="n">expected_200terms_displacement</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
      <span class="p">[</span>  <span class="mf">7.04000000e-08</span><span class="p">,</span>   <span class="mf">2.22800000e-05</span><span class="p">,</span>   <span class="mf">2.27000000e-05</span><span class="p">,</span>
         <span class="mf">1.23200000e-06</span><span class="p">,</span>   <span class="mf">2.35100000e-05</span><span class="p">,</span>   <span class="mf">2.39300000e-05</span><span class="p">,</span>
         <span class="mf">2.46400000e-06</span><span class="p">,</span>  <span class="o">-</span><span class="mf">1.89700000e-05</span><span class="p">,</span>  <span class="o">-</span><span class="mf">6.22700000e-05</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.27500000e-04</span><span class="p">,</span>  <span class="o">-</span><span class="mf">1.70700000e-04</span><span class="p">,</span>  <span class="o">-</span><span class="mf">2.57800000e-04</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">3.44800000e-04</span><span class="p">,</span>  <span class="o">-</span><span class="mf">4.53600000e-04</span><span class="p">,</span>  <span class="o">-</span><span class="mf">5.40600000e-04</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">5.84000000e-04</span><span class="p">,</span>  <span class="o">-</span><span class="mf">5.61700000e-04</span><span class="p">,</span>  <span class="o">-</span><span class="mf">4.73800000e-04</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">2.54900000e-04</span><span class="p">,</span>   <span class="mf">1.17100000e-04</span><span class="p">,</span>   <span class="mf">6.85900000e-04</span><span class="p">,</span>
         <span class="mf">1.51700000e-03</span><span class="p">,</span>   <span class="mf">2.50100000e-03</span><span class="p">,</span>   <span class="mf">3.70300000e-03</span><span class="p">,</span>
         <span class="mf">5.01500000e-03</span><span class="p">,</span>   <span class="mf">6.26200000e-03</span><span class="p">,</span>   <span class="mf">7.20200000e-03</span><span class="p">,</span>
         <span class="mf">7.61800000e-03</span><span class="p">,</span>   <span class="mf">7.39900000e-03</span><span class="p">,</span>   <span class="mf">6.74400000e-03</span><span class="p">,</span>
         <span class="mf">5.91400000e-03</span><span class="p">,</span>   <span class="mf">5.01800000e-03</span><span class="p">,</span>   <span class="mf">4.10100000e-03</span><span class="p">,</span>
         <span class="mf">3.22700000e-03</span><span class="p">,</span>   <span class="mf">2.50600000e-03</span><span class="p">,</span>   <span class="mf">1.85000000e-03</span><span class="p">,</span>
         <span class="mf">1.32600000e-03</span><span class="p">,</span>   <span class="mf">9.11400000e-04</span><span class="p">,</span>   <span class="mf">5.84000000e-04</span><span class="p">,</span>
         <span class="mf">3.00200000e-04</span><span class="p">,</span>   <span class="mf">1.47600000e-04</span><span class="p">,</span>   <span class="mf">3.87500000e-05</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">4.82900000e-05</span><span class="p">,</span>  <span class="o">-</span><span class="mf">1.13400000e-04</span><span class="p">,</span>  <span class="o">-</span><span class="mf">1.13000000e-04</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.34500000e-04</span><span class="p">,</span>  <span class="o">-</span><span class="mf">1.34000000e-04</span><span class="p">,</span>  <span class="o">-</span><span class="mf">1.33600000e-04</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.11400000e-04</span><span class="p">,</span>  <span class="o">-</span><span class="mf">6.72600000e-05</span><span class="p">,</span>  <span class="o">-</span><span class="mf">6.68400000e-05</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">6.64500000e-05</span><span class="p">,</span>  <span class="o">-</span><span class="mf">4.41700000e-05</span><span class="p">,</span>  <span class="o">-</span><span class="mf">4.38200000e-05</span><span class="p">])</span>


    <span class="n">expected</span><span class="o">=</span><span class="nb">dict</span><span class="p">()</span>
    <span class="n">expected</span><span class="p">[</span><span class="mi">50</span><span class="p">]</span><span class="o">=</span><span class="p">(</span><span class="n">expected_50terms_t</span><span class="p">,</span> <span class="n">expected_50terms_displacement</span><span class="p">,</span><span class="s2">&quot;o&quot;</span><span class="p">)</span>
<span class="c1">#    expected[75]=(expected_200terms_t, expected_200terms_displacement,&quot;^&quot;)</span>
    <span class="n">expected</span><span class="p">[</span><span class="mi">200</span><span class="p">]</span><span class="o">=</span><span class="p">(</span><span class="n">expected_200terms_t</span><span class="p">,</span> <span class="n">expected_200terms_displacement</span><span class="p">,</span><span class="s2">&quot;s&quot;</span><span class="p">)</span>
    <span class="n">start_time0</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
    <span class="n">ftime</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">fromtimestamp</span><span class="p">(</span><span class="n">start_time0</span><span class="p">)</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s1">&#39;%Y-%m-</span><span class="si">%d</span><span class="s1"> %H%M%S&#39;</span><span class="p">)</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">ftime</span> <span class="o">+</span> <span class="s2">&quot;.txt&quot;</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">ftime</span> <span class="o">+</span> <span class="n">os</span><span class="o">.</span><span class="n">linesep</span><span class="p">)</span>


        <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mf">3.54</span><span class="p">,</span><span class="mf">3.54</span><span class="p">))</span>
        <span class="n">matplotlib</span><span class="o">.</span><span class="n">rcParams</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s1">&#39;font.size&#39;</span><span class="p">:</span> <span class="mi">11</span><span class="p">})</span>

        <span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="s2">&quot;111&quot;</span><span class="p">)</span>


        <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">v_nterms</span><span class="p">:</span>
            <span class="n">vstr</span><span class="o">=</span><span class="s2">&quot;nterms&quot;</span>
            <span class="n">vfmt</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2">&quot;</span>
            <span class="n">start_time1</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>

            <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;*&quot;</span> <span class="o">*</span> <span class="mi">70</span> <span class="o">+</span> <span class="n">os</span><span class="o">.</span><span class="n">linesep</span><span class="p">)</span>
<span class="c1">#            vequals = &quot;{}={}&quot;.format(vstr, vfmt.format(v))</span>
            <span class="n">vequals</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">vfmt</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">v</span><span class="p">))</span>
            <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">vequals</span> <span class="o">+</span> <span class="n">os</span><span class="o">.</span><span class="n">linesep</span><span class="p">);</span> <span class="nb">print</span><span class="p">(</span><span class="n">vequals</span><span class="p">)</span>

            <span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">4.5</span><span class="p">,</span> <span class="mi">400</span><span class="p">)</span>
            <span class="n">pdict</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">(</span>
                <span class="n">E</span> <span class="o">=</span> <span class="mf">6.998</span><span class="o">*</span><span class="mf">1e9</span><span class="p">,</span> <span class="c1">#Pa</span>
                <span class="n">rho</span> <span class="o">=</span> <span class="mi">2373</span><span class="p">,</span> <span class="c1">#kg/m3</span>
                <span class="n">L</span> <span class="o">=</span> <span class="mi">160</span><span class="p">,</span> <span class="c1">#m</span>
                <span class="c1">#v_norm=0.01165,</span>
                <span class="n">kf</span><span class="o">=</span><span class="mf">5.41e-4</span><span class="p">,</span>
                <span class="c1">#Fz_norm=1.013e-4,</span>
                <span class="n">mu_norm</span><span class="o">=</span><span class="mf">39.263</span><span class="p">,</span>
                <span class="n">k1_norm</span><span class="o">=</span><span class="mf">97.552</span><span class="p">,</span>
<span class="c1">#                k3_norm=2.497e6,</span>
                <span class="n">nterms</span><span class="o">=</span><span class="n">v</span><span class="p">,</span>
                <span class="n">BC</span><span class="o">=</span><span class="s2">&quot;CC&quot;</span><span class="p">,</span>
                <span class="n">nquad</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span>
                <span class="n">moving_loads_x_norm</span><span class="o">=</span><span class="p">[[</span><span class="mi">0</span><span class="p">]],</span>
                <span class="n">moving_loads_Fz_norm</span><span class="o">=</span><span class="p">[[</span><span class="mf">1.013e-4</span><span class="p">]],</span>
                <span class="n">moving_loads_v_norm</span><span class="o">=</span><span class="p">[</span><span class="mf">0.01165</span><span class="p">,],</span>
                <span class="n">tvals</span><span class="o">=</span><span class="n">t</span><span class="p">,</span>
                <span class="n">xvals_norm</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">.</span><span class="mi">5</span><span class="p">]),</span>
                <span class="n">use_analytical</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                <span class="n">implementation</span><span class="o">=</span><span class="s2">&quot;fortran&quot;</span><span class="p">,</span>
                <span class="n">force_calc</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                <span class="n">file_stem</span><span class="o">=</span><span class="s2">&quot;specbeam_fig_ding_</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">v</span><span class="p">))</span>



            <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="n">pdict</span><span class="p">)</span> <span class="o">+</span> <span class="n">os</span><span class="o">.</span><span class="n">linesep</span><span class="p">)</span>

            <span class="k">for</span> <span class="n">BC</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;SS&quot;</span><span class="p">]:</span><span class="c1"># &quot;CC&quot;, &quot;FF&quot;]:</span>
                <span class="n">pdict</span><span class="p">[</span><span class="s2">&quot;BC&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">BC</span>

                <span class="n">a</span> <span class="o">=</span> <span class="n">SpecBeam</span><span class="p">(</span><span class="o">**</span><span class="n">pdict</span><span class="p">)</span>
                <span class="n">a</span><span class="o">.</span><span class="n">runme</span><span class="p">()</span>
                <span class="n">a</span><span class="o">.</span><span class="n">saveme</span><span class="p">()</span>
<span class="c1">#                a.calulate_qk(t=t)</span>

                <span class="n">x</span> <span class="o">=</span> <span class="n">t</span>
                <span class="n">y</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">defl</span><span class="p">[</span><span class="mi">0</span><span class="p">,:]</span><span class="o">*</span><span class="mi">1000</span><span class="c1">#a.wofx(x_norm=0.5, normalise_w=False)</span>

<span class="c1">#                ax.plot(x, y, label=&quot;x=0.5, {}&quot;.format(vequals))</span>
                <span class="n">line</span><span class="p">,</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">vequals</span><span class="p">)</span>

                <span class="n">expect</span><span class="o">=</span><span class="n">expected</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">v</span><span class="p">,</span><span class="kc">None</span><span class="p">)</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">expect</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">expect_x</span><span class="p">,</span><span class="n">expect_y</span><span class="p">,</span> <span class="n">marker</span> <span class="o">=</span> <span class="n">expect</span>
                    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">expect_x</span><span class="p">,</span> <span class="n">expect_y</span><span class="o">*</span><span class="mi">1000</span><span class="p">,</span>
                            <span class="n">label</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2"> (Ding)&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">vequals</span><span class="p">),</span>
                            <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;None&quot;</span><span class="p">,</span>
                            <span class="n">marker</span><span class="o">=</span><span class="n">marker</span><span class="p">,</span>
                            <span class="n">markeredgecolor</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">get_color</span><span class="p">(),</span>
                            <span class="n">markerfacecolor</span><span class="o">=</span><span class="s1">&#39;None&#39;</span><span class="p">,</span>
                            <span class="n">markersize</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>

            <span class="n">end_time1</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
            <span class="n">elapsed_time</span> <span class="o">=</span> <span class="p">(</span><span class="n">end_time1</span> <span class="o">-</span> <span class="n">start_time1</span><span class="p">);</span> <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Run time=</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">timedelta</span><span class="p">(</span><span class="n">seconds</span><span class="o">=</span><span class="n">elapsed_time</span><span class="p">))))</span>

            <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;Run time=</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">timedelta</span><span class="p">(</span><span class="n">seconds</span><span class="o">=</span><span class="n">elapsed_time</span><span class="p">)))</span> <span class="o">+</span> <span class="n">os</span><span class="o">.</span><span class="n">linesep</span><span class="p">)</span>

        <span class="c1">#ax.set_title(&quot;$B=r_e,b_w=r_w,b_s=NA$&quot;)</span>
        <span class="c1">#ax.set_ylim(.6,1.05)</span>
        <span class="c1">#ax.xaxis.label.set_fontsize(30)</span>
        <span class="c1">#ax.yaxis.label.set_fontsize(30)</span>
        <span class="c1">#ax.set_ylabel(&quot;$\\frac{u_\\mathrm{a,max}}{u_\\mathrm{p,max}}$&quot;)</span>
<span class="c1">#        ax.set_ylabel(&quot;$u_\\mathrm{a,max}/u_\\mathrm{p,max}$&quot;)</span>
<span class="c1">#        ax.set_xlabel(&quot;$n_a=r_e/r_w$&quot;)</span>
    <span class="c1">#    ax.set_xscale(&quot;log&quot;)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Time (s)&quot;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Midpoint deflection (mm)&quot;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mf">3.5</span><span class="p">,</span> <span class="mf">4.5</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
        <span class="n">leg</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s2">&quot;$No.\.terms$&quot;</span><span class="p">,</span>
                        <span class="n">loc</span><span class="o">=</span><span class="s2">&quot;upper left&quot;</span><span class="p">,</span>
<span class="c1">#                        ncol=2,</span>
                        <span class="n">labelspacing</span><span class="o">=.</span><span class="mi">2</span><span class="p">,</span>
                        <span class="n">handlelength</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
                        <span class="n">fontsize</span><span class="o">=</span><span class="mi">8</span>
                        <span class="p">)</span>


        <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">labelpad</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">labelpad</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="n">fig</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">top</span><span class="o">=</span><span class="mf">0.95</span><span class="p">,</span> <span class="n">bottom</span><span class="o">=</span><span class="mf">0.13</span><span class="p">,</span> <span class="n">left</span><span class="o">=</span><span class="mf">0.14</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="mf">0.95</span><span class="p">)</span>


<span class="c1">#        leg = ax.legend()</span>
<span class="c1">#        leg.draggable()</span>

        <span class="n">end_time0</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
        <span class="n">elapsed_time</span> <span class="o">=</span> <span class="p">(</span><span class="n">end_time0</span> <span class="o">-</span> <span class="n">start_time0</span><span class="p">);</span> <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Total run time=</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">timedelta</span><span class="p">(</span><span class="n">seconds</span><span class="o">=</span><span class="n">elapsed_time</span><span class="p">))))</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;Total run time=</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">timedelta</span><span class="p">(</span><span class="n">seconds</span><span class="o">=</span><span class="n">elapsed_time</span><span class="p">)))</span> <span class="o">+</span> <span class="n">os</span><span class="o">.</span><span class="n">linesep</span><span class="p">)</span>
<span class="c1">#    plt.savefig(ftime+&quot;.pdf&quot;)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">saveas</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">save_figure</span><span class="p">(</span><span class="n">fig</span><span class="o">=</span><span class="n">fig</span><span class="p">,</span><span class="n">fname</span><span class="o">=</span><span class="n">saveas</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span></div>

<div class="viewcode-block" id="FIGURE_convergence_step_change"><a class="viewcode-back" href="../../../api/geotecha.beam_on_foundation.specbeam.html#geotecha.beam_on_foundation.specbeam.FIGURE_convergence_step_change">[docs]</a><span class="k">def</span> <span class="nf">FIGURE_convergence_step_change</span><span class="p">(</span><span class="n">v_nterms</span><span class="o">=</span><span class="p">(</span><span class="mi">50</span><span class="p">,</span><span class="mi">75</span><span class="p">,</span><span class="mi">150</span><span class="p">,</span><span class="mi">200</span><span class="p">),</span><span class="n">saveas</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Check convergence with step change in stiffness at midpoint&quot;&quot;&quot;</span>


    <span class="n">start_time0</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
    <span class="n">ftime</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">fromtimestamp</span><span class="p">(</span><span class="n">start_time0</span><span class="p">)</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s1">&#39;%Y-%m-</span><span class="si">%d</span><span class="s1"> %H%M%S&#39;</span><span class="p">)</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">ftime</span> <span class="o">+</span> <span class="s2">&quot;.txt&quot;</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">ftime</span> <span class="o">+</span> <span class="n">os</span><span class="o">.</span><span class="n">linesep</span><span class="p">)</span>


        <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mf">3.54</span><span class="p">,</span><span class="mf">3.54</span><span class="p">))</span>
        <span class="n">matplotlib</span><span class="o">.</span><span class="n">rcParams</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s1">&#39;font.size&#39;</span><span class="p">:</span> <span class="mi">11</span><span class="p">})</span>

        <span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="s2">&quot;111&quot;</span><span class="p">)</span>


        <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">v_nterms</span><span class="p">:</span>
            <span class="n">vstr</span><span class="o">=</span><span class="s2">&quot;&quot;</span>
            <span class="n">vfmt</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2">&quot;</span>
            <span class="n">start_time1</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>

            <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;*&quot;</span> <span class="o">*</span> <span class="mi">70</span> <span class="o">+</span> <span class="n">os</span><span class="o">.</span><span class="n">linesep</span><span class="p">)</span>
<span class="c1">#            vequals = &quot;{}={}&quot;.format(vstr, vfmt.format(v))</span>
            <span class="n">vequals</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">vfmt</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">v</span><span class="p">))</span>
            <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">vequals</span> <span class="o">+</span> <span class="n">os</span><span class="o">.</span><span class="n">linesep</span><span class="p">);</span> <span class="nb">print</span><span class="p">(</span><span class="n">vequals</span><span class="p">)</span>

            <span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">4.5</span><span class="p">,</span> <span class="mi">400</span><span class="p">)</span>
            <span class="n">pdict</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">(</span>
                <span class="n">E</span> <span class="o">=</span> <span class="mf">6.998</span><span class="o">*</span><span class="mf">1e9</span><span class="p">,</span> <span class="c1">#Pa</span>
                <span class="n">rho</span> <span class="o">=</span> <span class="mi">2373</span><span class="p">,</span> <span class="c1">#kg/m3</span>
                <span class="n">L</span> <span class="o">=</span> <span class="mi">160</span><span class="p">,</span> <span class="c1">#m</span>
                <span class="c1">#v_norm=0.01165,</span>
                <span class="n">kf</span><span class="o">=</span><span class="mf">5.41e-4</span><span class="p">,</span>
                <span class="c1">#Fz_norm=1.013e-4,</span>
                <span class="n">mu_norm</span><span class="o">=</span><span class="mf">39.263</span><span class="p">,</span>
                <span class="n">k1_norm</span><span class="o">=</span><span class="mf">97.552</span><span class="p">,</span>
                <span class="n">k1bar</span><span class="o">=</span><span class="n">PolyLine</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mf">0.5</span><span class="p">,</span><span class="o">.</span><span class="mi">5</span><span class="p">,</span><span class="mi">1</span><span class="p">],[</span><span class="mf">1.0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">.</span><span class="mi">01</span><span class="p">,</span><span class="o">.</span><span class="mi">01</span><span class="p">]),</span>
<span class="c1">#                k3_norm=2.497e6,</span>
                <span class="n">nterms</span><span class="o">=</span><span class="n">v</span><span class="p">,</span>
                <span class="n">BC</span><span class="o">=</span><span class="s2">&quot;CC&quot;</span><span class="p">,</span>
                <span class="n">nquad</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span>
                <span class="n">moving_loads_x_norm</span><span class="o">=</span><span class="p">[[</span><span class="mi">0</span><span class="p">]],</span>
                <span class="n">moving_loads_Fz_norm</span><span class="o">=</span><span class="p">[[</span><span class="mf">1.013e-4</span><span class="p">]],</span>
                <span class="n">moving_loads_v_norm</span><span class="o">=</span><span class="p">[</span><span class="mf">0.01165</span><span class="p">,],</span>
                <span class="n">tvals</span><span class="o">=</span><span class="n">t</span><span class="p">,</span>
                <span class="n">xvals_norm</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">.</span><span class="mi">5</span><span class="p">]),</span>
                <span class="n">use_analytical</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                <span class="n">implementation</span><span class="o">=</span><span class="s2">&quot;fortran&quot;</span><span class="p">,</span>
                <span class="n">force_calc</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                <span class="n">file_stem</span><span class="o">=</span><span class="s2">&quot;specbeam_fig_convergence_step</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">v</span><span class="p">))</span>



            <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="n">pdict</span><span class="p">)</span> <span class="o">+</span> <span class="n">os</span><span class="o">.</span><span class="n">linesep</span><span class="p">)</span>

            <span class="k">for</span> <span class="n">BC</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;SS&quot;</span><span class="p">]:</span><span class="c1"># &quot;CC&quot;, &quot;FF&quot;]:</span>
                <span class="n">pdict</span><span class="p">[</span><span class="s2">&quot;BC&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">BC</span>

                <span class="n">a</span> <span class="o">=</span> <span class="n">SpecBeam</span><span class="p">(</span><span class="o">**</span><span class="n">pdict</span><span class="p">)</span>
                <span class="n">a</span><span class="o">.</span><span class="n">runme</span><span class="p">()</span>
                <span class="n">a</span><span class="o">.</span><span class="n">saveme</span><span class="p">()</span>
<span class="c1">#                a.calulate_qk(t=t)</span>

                <span class="n">x</span> <span class="o">=</span> <span class="n">t</span>
                <span class="n">y</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">defl</span><span class="p">[</span><span class="mi">0</span><span class="p">,:]</span><span class="o">*</span><span class="mi">1000</span><span class="c1">#a.wofx(x_norm=0.5, normalise_w=False)</span>

<span class="c1">#                ax.plot(x, y, label=&quot;x=0.5, {}&quot;.format(vequals))</span>
                <span class="n">line</span><span class="p">,</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">vequals</span><span class="p">)</span>


            <span class="n">end_time1</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
            <span class="n">elapsed_time</span> <span class="o">=</span> <span class="p">(</span><span class="n">end_time1</span> <span class="o">-</span> <span class="n">start_time1</span><span class="p">);</span> <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Run time=</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">timedelta</span><span class="p">(</span><span class="n">seconds</span><span class="o">=</span><span class="n">elapsed_time</span><span class="p">))))</span>

            <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;Run time=</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">timedelta</span><span class="p">(</span><span class="n">seconds</span><span class="o">=</span><span class="n">elapsed_time</span><span class="p">)))</span> <span class="o">+</span> <span class="n">os</span><span class="o">.</span><span class="n">linesep</span><span class="p">)</span>

        <span class="c1">#ax.set_title(&quot;$B=r_e,b_w=r_w,b_s=NA$&quot;)</span>
        <span class="c1">#ax.set_ylim(.6,1.05)</span>
        <span class="c1">#ax.xaxis.label.set_fontsize(30)</span>
        <span class="c1">#ax.yaxis.label.set_fontsize(30)</span>
        <span class="c1">#ax.set_ylabel(&quot;$\\frac{u_\\mathrm{a,max}}{u_\\mathrm{p,max}}$&quot;)</span>
<span class="c1">#        ax.set_ylabel(&quot;$u_\\mathrm{a,max}/u_\\mathrm{p,max}$&quot;)</span>
<span class="c1">#        ax.set_xlabel(&quot;$n_a=r_e/r_w$&quot;)</span>
    <span class="c1">#    ax.set_xscale(&quot;log&quot;)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Time (s)&quot;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Midpoint deflection (mm)&quot;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mf">3.5</span><span class="p">,</span> <span class="mf">4.5</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
        <span class="n">leg</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s2">&quot;$No.\.terms$&quot;</span><span class="p">,</span>
                        <span class="n">loc</span><span class="o">=</span><span class="s2">&quot;upper left&quot;</span><span class="p">,</span>
<span class="c1">#                        ncol=2,</span>
                        <span class="n">labelspacing</span><span class="o">=.</span><span class="mi">2</span><span class="p">,</span>
                        <span class="n">handlelength</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
                        <span class="n">fontsize</span><span class="o">=</span><span class="mi">8</span>
                        <span class="p">)</span>


        <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">labelpad</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">labelpad</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="n">fig</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">top</span><span class="o">=</span><span class="mf">0.95</span><span class="p">,</span> <span class="n">bottom</span><span class="o">=</span><span class="mf">0.13</span><span class="p">,</span> <span class="n">left</span><span class="o">=</span><span class="mf">0.14</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="mf">0.95</span><span class="p">)</span>


<span class="c1">#        leg = ax.legend()</span>
<span class="c1">#        leg.draggable()</span>

        <span class="n">end_time0</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
        <span class="n">elapsed_time</span> <span class="o">=</span> <span class="p">(</span><span class="n">end_time0</span> <span class="o">-</span> <span class="n">start_time0</span><span class="p">);</span> <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Total run time=</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">timedelta</span><span class="p">(</span><span class="n">seconds</span><span class="o">=</span><span class="n">elapsed_time</span><span class="p">))))</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;Total run time=</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">timedelta</span><span class="p">(</span><span class="n">seconds</span><span class="o">=</span><span class="n">elapsed_time</span><span class="p">)))</span> <span class="o">+</span> <span class="n">os</span><span class="o">.</span><span class="n">linesep</span><span class="p">)</span>
<span class="c1">#    plt.savefig(ftime+&quot;.pdf&quot;)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">saveas</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">save_figure</span><span class="p">(</span><span class="n">fig</span><span class="o">=</span><span class="n">fig</span><span class="p">,</span><span class="n">fname</span><span class="o">=</span><span class="n">saveas</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span></div>

<div class="viewcode-block" id="FIGURE_defl_envelope_vary_velocity"><a class="viewcode-back" href="../../../api/geotecha.beam_on_foundation.specbeam.html#geotecha.beam_on_foundation.specbeam.FIGURE_defl_envelope_vary_velocity">[docs]</a><span class="k">def</span> <span class="nf">FIGURE_defl_envelope_vary_velocity</span><span class="p">(</span><span class="n">velocities_norm</span><span class="o">=</span><span class="p">(</span><span class="mf">0.01165</span><span class="p">,),</span><span class="n">saveas</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">nterms</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span><span class="n">force_calc</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">nx</span><span class="o">=</span><span class="mi">400</span><span class="p">,</span><span class="n">nt</span><span class="o">=</span><span class="mi">400</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Deflection envelopes with different velocities&quot;&quot;&quot;</span>


    <span class="n">start_time0</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
    <span class="n">ftime</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">fromtimestamp</span><span class="p">(</span><span class="n">start_time0</span><span class="p">)</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s1">&#39;%Y-%m-</span><span class="si">%d</span><span class="s1"> %H%M%S&#39;</span><span class="p">)</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">ftime</span> <span class="o">+</span> <span class="s2">&quot;.txt&quot;</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">ftime</span> <span class="o">+</span> <span class="n">os</span><span class="o">.</span><span class="n">linesep</span><span class="p">)</span>


        <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mf">3.54</span><span class="p">,</span><span class="mf">3.54</span><span class="p">))</span>
        <span class="n">matplotlib</span><span class="o">.</span><span class="n">rcParams</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s1">&#39;font.size&#39;</span><span class="p">:</span> <span class="mi">11</span><span class="p">})</span>

        <span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="s2">&quot;111&quot;</span><span class="p">)</span>


        <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">velocities_norm</span><span class="p">:</span>
            <span class="n">vstr</span><span class="o">=</span><span class="s2">&quot;&quot;</span>
            <span class="n">vfmt</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2">&quot;</span>
            <span class="n">start_time1</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>

            <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;*&quot;</span> <span class="o">*</span> <span class="mi">70</span> <span class="o">+</span> <span class="n">os</span><span class="o">.</span><span class="n">linesep</span><span class="p">)</span>
<span class="c1">#            vequals = &quot;{}={}&quot;.format(vstr, vfmt.format(v))</span>
            <span class="n">vequals</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">vfmt</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">v</span><span class="p">))</span>
            <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">vequals</span> <span class="o">+</span> <span class="n">os</span><span class="o">.</span><span class="n">linesep</span><span class="p">);</span> <span class="nb">print</span><span class="p">(</span><span class="n">vequals</span><span class="p">)</span>

            <span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">v</span><span class="o">/</span><span class="mf">0.01165</span><span class="o">*</span><span class="mi">4</span><span class="o">*</span><span class="mi">2</span><span class="p">,</span> <span class="n">nt</span><span class="p">)</span><span class="c1"># 4.5</span>

            <span class="n">pdict</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">(</span>
                <span class="n">E</span> <span class="o">=</span> <span class="mf">6.998</span><span class="o">*</span><span class="mf">1e9</span><span class="p">,</span> <span class="c1">#Pa</span>
                <span class="n">rho</span> <span class="o">=</span> <span class="mi">2373</span><span class="p">,</span> <span class="c1">#kg/m3</span>
                <span class="n">L</span> <span class="o">=</span> <span class="mi">160</span><span class="p">,</span> <span class="c1">#m</span>
                <span class="n">A</span> <span class="o">=</span> <span class="mf">0.3</span><span class="o">*</span><span class="mf">0.1</span><span class="p">,</span> <span class="c1"># m^2</span>
                <span class="c1">#v_norm=0.01165,</span>
                <span class="n">kf</span><span class="o">=</span><span class="mf">5.41e-4</span><span class="p">,</span>
                <span class="c1">#Fz_norm=1.013e-4,</span>
                <span class="n">mu_norm</span><span class="o">=</span><span class="mf">39.263</span><span class="o">/</span><span class="mi">4</span><span class="o">/</span><span class="mi">2</span><span class="o">/</span><span class="mi">1000</span><span class="p">,</span>
                <span class="n">mubar</span><span class="o">=</span><span class="n">PolyLine</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mf">0.05</span><span class="p">,</span><span class="mf">0.05</span><span class="p">,</span><span class="o">.</span><span class="mi">95</span><span class="p">,</span><span class="o">.</span><span class="mi">95</span><span class="p">,</span><span class="mi">1</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]),</span>
                <span class="n">k1_norm</span><span class="o">=</span><span class="mf">97.552</span><span class="p">,</span>
<span class="c1">#                k1bar=PolyLine([0,0.2,0.3,1],[1.0,1,0.1,0.1]),</span>
                <span class="n">k1bar</span><span class="o">=</span><span class="n">PolyLine</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mf">0.2</span><span class="p">,</span><span class="mf">0.2</span><span class="p">,</span><span class="mi">1</span><span class="p">],[</span><span class="mf">1.0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]),</span>

<span class="c1">#                k3_norm=2.497e6,</span>
                <span class="n">nterms</span><span class="o">=</span><span class="n">nterms</span><span class="p">,</span>
                <span class="n">BC</span><span class="o">=</span><span class="s2">&quot;SS&quot;</span><span class="p">,</span>
                <span class="n">nquad</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span>
                <span class="n">moving_loads_x_norm</span><span class="o">=</span><span class="p">[[</span><span class="mi">0</span><span class="p">]],</span>
                <span class="n">moving_loads_Fz_norm</span><span class="o">=</span><span class="p">[[</span><span class="mf">1.013e-4</span><span class="p">]],</span>
                <span class="n">moving_loads_v_norm</span><span class="o">=</span><span class="p">[</span><span class="n">v</span><span class="p">,],</span><span class="c1">#[0.01165,],</span>
                <span class="n">tvals</span><span class="o">=</span><span class="n">t</span><span class="p">,</span>
                <span class="n">xvals_norm</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">nx</span><span class="p">),</span><span class="c1">#np.array([.5]),</span>
                <span class="n">use_analytical</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                <span class="n">implementation</span><span class="o">=</span><span class="s2">&quot;fortran&quot;</span><span class="p">,</span>
                <span class="n">force_calc</span><span class="o">=</span><span class="n">force_calc</span><span class="p">,</span>
                <span class="n">file_stem</span><span class="o">=</span><span class="s2">&quot;specbeam_defl_envelope_velocity</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">v</span><span class="p">))</span>



            <span class="n">I_raw</span> <span class="o">=</span> <span class="p">(</span><span class="n">pdict</span><span class="p">[</span><span class="s2">&quot;kf&quot;</span><span class="p">]</span><span class="o">*</span><span class="n">pdict</span><span class="p">[</span><span class="s2">&quot;L&quot;</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">pdict</span><span class="p">[</span><span class="s2">&quot;A&quot;</span><span class="p">]</span>
            <span class="n">k_raw</span> <span class="o">=</span> <span class="n">pdict</span><span class="p">[</span><span class="s2">&quot;k1_norm&quot;</span><span class="p">]</span><span class="o">*</span><span class="n">pdict</span><span class="p">[</span><span class="s2">&quot;E&quot;</span><span class="p">]</span><span class="o">*</span><span class="n">pdict</span><span class="p">[</span><span class="s2">&quot;A&quot;</span><span class="p">]</span><span class="o">/</span><span class="n">pdict</span><span class="p">[</span><span class="s2">&quot;L&quot;</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span>

            <span class="n">c_raw</span> <span class="o">=</span> <span class="n">pdict</span><span class="p">[</span><span class="s2">&quot;mu_norm&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="n">pdict</span><span class="p">[</span><span class="s2">&quot;A&quot;</span><span class="p">]</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">pdict</span><span class="p">[</span><span class="s2">&quot;rho&quot;</span><span class="p">]</span><span class="o">*</span><span class="n">pdict</span><span class="p">[</span><span class="s2">&quot;E&quot;</span><span class="p">])</span><span class="o">/</span><span class="n">pdict</span><span class="p">[</span><span class="s2">&quot;L&quot;</span><span class="p">]</span>
            <span class="n">c_crit</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">4</span><span class="o">*</span><span class="n">pdict</span><span class="p">[</span><span class="s2">&quot;rho&quot;</span><span class="p">]</span><span class="o">*</span><span class="n">pdict</span><span class="p">[</span><span class="s2">&quot;A&quot;</span><span class="p">]</span><span class="o">*</span><span class="n">k_raw</span><span class="p">)</span>
            <span class="n">beta</span> <span class="o">=</span> <span class="n">c_raw</span><span class="o">/</span><span class="n">c_crit</span>

            <span class="n">v_raw</span> <span class="o">=</span> <span class="n">v</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">pdict</span><span class="p">[</span><span class="s2">&quot;rho&quot;</span><span class="p">]</span><span class="o">/</span><span class="n">pdict</span><span class="p">[</span><span class="s2">&quot;E&quot;</span><span class="p">])</span>
            <span class="n">v_crit</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="o">/</span><span class="n">pdict</span><span class="p">[</span><span class="s2">&quot;rho&quot;</span><span class="p">]</span><span class="o">/</span><span class="n">pdict</span><span class="p">[</span><span class="s2">&quot;A&quot;</span><span class="p">]</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">k_raw</span><span class="o">*</span><span class="n">pdict</span><span class="p">[</span><span class="s2">&quot;E&quot;</span><span class="p">]</span><span class="o">*</span><span class="n">I_raw</span><span class="p">))</span>
            <span class="n">alpha</span> <span class="o">=</span> <span class="n">v_raw</span><span class="o">/</span><span class="n">v_crit</span>

            <span class="c1">#tmax = pdict[&quot;L&quot;]/ (v/np.sqrt(pdict[&quot;rho&quot;]/pdict[&quot;E&quot;]))</span>
            <span class="n">tmax</span> <span class="o">=</span> <span class="n">pdict</span><span class="p">[</span><span class="s2">&quot;L&quot;</span><span class="p">]</span><span class="o">/</span> <span class="n">v_raw</span>
            <span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">tmax</span><span class="p">,</span> <span class="n">nt</span><span class="p">)</span>
            <span class="n">pdict</span><span class="p">[</span><span class="s2">&quot;tvals&quot;</span><span class="p">]</span><span class="o">=</span><span class="n">t</span>

            <span class="nb">print</span><span class="p">(</span><span class="n">I_raw</span><span class="p">,</span><span class="n">k_raw</span><span class="p">,</span><span class="n">v_raw</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;velocity=</span><span class="si">{:4.3g}</span><span class="s2"> km/hr&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">v_raw</span><span class="o">/</span><span class="mi">1000</span><span class="o">*</span><span class="p">(</span><span class="mi">60</span><span class="o">*</span><span class="mi">60</span><span class="p">)))</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;v/v_crit=</span><span class="si">{:2.3g}</span><span class="s2">, </span><span class="si">{:2.3g}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">alpha</span><span class="p">,</span> <span class="n">alpha</span><span class="o">/</span><span class="p">(</span><span class="mf">0.1</span><span class="o">**</span><span class="mf">0.25</span><span class="p">)))</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;c/c_crit=</span><span class="si">{:2.3g}</span><span class="s2">, </span><span class="si">{:2.3g}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">beta</span><span class="p">,</span> <span class="n">beta</span><span class="o">/</span><span class="p">(</span><span class="mf">0.1</span><span class="o">**</span><span class="mf">0.5</span><span class="p">)))</span>
            <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="n">pdict</span><span class="p">)</span> <span class="o">+</span> <span class="n">os</span><span class="o">.</span><span class="n">linesep</span><span class="p">)</span>

            <span class="k">for</span> <span class="n">BC</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;SS&quot;</span><span class="p">]:</span><span class="c1"># &quot;CC&quot;, &quot;FF&quot;]:</span>
                <span class="n">pdict</span><span class="p">[</span><span class="s2">&quot;BC&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">BC</span>

                <span class="n">a</span> <span class="o">=</span> <span class="n">SpecBeam</span><span class="p">(</span><span class="o">**</span><span class="n">pdict</span><span class="p">)</span>
                <span class="n">a</span><span class="o">.</span><span class="n">runme</span><span class="p">()</span>
                <span class="n">a</span><span class="o">.</span><span class="n">saveme</span><span class="p">()</span>
<span class="c1">#                a.calulate_qk(t=t)</span>

                <span class="n">x</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">xvals_norm</span> <span class="o">*</span> <span class="n">pdict</span><span class="p">[</span><span class="s2">&quot;L&quot;</span><span class="p">]</span>
                <span class="n">ymax</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">defl</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mi">1000</span>
                <span class="n">ymin</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">defl</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mi">1000</span>
<span class="c1">#                y = a.defl[0,:]*1000#a.wofx(x_norm=0.5, normalise_w=False)</span>

<span class="c1">#                ax.plot(x, y, label=&quot;x=0.5, {}&quot;.format(vequals))</span>
                <span class="n">line</span><span class="p">,</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">ymax</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">vequals</span><span class="p">)</span>
                <span class="n">line</span><span class="p">,</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">ymin</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">line</span><span class="o">.</span><span class="n">get_color</span><span class="p">())</span>


            <span class="n">end_time1</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
            <span class="n">elapsed_time</span> <span class="o">=</span> <span class="p">(</span><span class="n">end_time1</span> <span class="o">-</span> <span class="n">start_time1</span><span class="p">);</span> <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Run time=</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">timedelta</span><span class="p">(</span><span class="n">seconds</span><span class="o">=</span><span class="n">elapsed_time</span><span class="p">))))</span>

            <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;Run time=</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">timedelta</span><span class="p">(</span><span class="n">seconds</span><span class="o">=</span><span class="n">elapsed_time</span><span class="p">)))</span> <span class="o">+</span> <span class="n">os</span><span class="o">.</span><span class="n">linesep</span><span class="p">)</span>

        <span class="c1">#ax.set_title(&quot;$B=r_e,b_w=r_w,b_s=NA$&quot;)</span>
        <span class="c1">#ax.set_ylim(.6,1.05)</span>
        <span class="c1">#ax.xaxis.label.set_fontsize(30)</span>
        <span class="c1">#ax.yaxis.label.set_fontsize(30)</span>
        <span class="c1">#ax.set_ylabel(&quot;$\\frac{u_\\mathrm{a,max}}{u_\\mathrm{p,max}}$&quot;)</span>
<span class="c1">#        ax.set_ylabel(&quot;$u_\\mathrm{a,max}/u_\\mathrm{p,max}$&quot;)</span>
<span class="c1">#        ax.set_xlabel(&quot;$n_a=r_e/r_w$&quot;)</span>
    <span class="c1">#    ax.set_xscale(&quot;log&quot;)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Distance, x (m)&quot;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Max/min deflection experienced (mm)&quot;</span><span class="p">)</span>
<span class="c1">#        ax.set_xlim(3.5, 4.5)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
        <span class="n">leg</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s2">&quot;$v$&quot;</span><span class="p">,</span>
                        <span class="n">loc</span><span class="o">=</span><span class="s2">&quot;upper left&quot;</span><span class="p">,</span>
<span class="c1">#                        ncol=2,</span>
                        <span class="n">labelspacing</span><span class="o">=.</span><span class="mi">2</span><span class="p">,</span>
                        <span class="n">handlelength</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
                        <span class="n">fontsize</span><span class="o">=</span><span class="mi">8</span>
                        <span class="p">)</span>
        <span class="n">leg</span><span class="o">.</span><span class="n">draggable</span><span class="p">()</span>

        <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">labelpad</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">labelpad</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="n">fig</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">top</span><span class="o">=</span><span class="mf">0.95</span><span class="p">,</span> <span class="n">bottom</span><span class="o">=</span><span class="mf">0.13</span><span class="p">,</span> <span class="n">left</span><span class="o">=</span><span class="mf">0.14</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="mf">0.95</span><span class="p">)</span>


<span class="c1">#        leg = ax.legend()</span>
<span class="c1">#        leg.draggable()</span>

        <span class="n">end_time0</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
        <span class="n">elapsed_time</span> <span class="o">=</span> <span class="p">(</span><span class="n">end_time0</span> <span class="o">-</span> <span class="n">start_time0</span><span class="p">);</span> <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Total run time=</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">timedelta</span><span class="p">(</span><span class="n">seconds</span><span class="o">=</span><span class="n">elapsed_time</span><span class="p">))))</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;Total run time=</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">timedelta</span><span class="p">(</span><span class="n">seconds</span><span class="o">=</span><span class="n">elapsed_time</span><span class="p">)))</span> <span class="o">+</span> <span class="n">os</span><span class="o">.</span><span class="n">linesep</span><span class="p">)</span>
        <span class="n">a</span><span class="o">.</span><span class="n">animateme</span><span class="p">()</span>


<span class="c1">#    plt.savefig(ftime+&quot;.pdf&quot;)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">saveas</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">save_figure</span><span class="p">(</span><span class="n">fig</span><span class="o">=</span><span class="n">fig</span><span class="p">,</span><span class="n">fname</span><span class="o">=</span><span class="n">saveas</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span></div>

<div class="viewcode-block" id="FIGURE_DAF_constant_prop"><a class="viewcode-back" href="../../../api/geotecha.beam_on_foundation.specbeam.html#geotecha.beam_on_foundation.specbeam.FIGURE_DAF_constant_prop">[docs]</a><span class="k">def</span> <span class="nf">FIGURE_DAF_constant_prop</span><span class="p">(</span><span class="n">saveas</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">nterms</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span><span class="n">force_calc</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">prefix</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span>
                             <span class="n">alphas</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">betas</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">nt</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span><span class="n">nx</span><span class="o">=</span><span class="mi">55</span><span class="p">,</span> <span class="n">end_damp</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                             <span class="n">xwindow</span><span class="o">=</span><span class="p">(</span><span class="mf">0.3</span><span class="p">,</span><span class="mf">0.7</span><span class="p">),</span>
                             <span class="n">xeval</span><span class="o">=</span><span class="p">(</span><span class="mf">0.3</span><span class="p">,</span><span class="mf">0.7</span><span class="p">),</span> <span class="n">numerical_DAF</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                             <span class="n">article_formatting</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Dynamic amplification plot, esveld fig 6.18. p120&quot;&quot;&quot;</span>
    <span class="k">pass</span>

    <span class="n">start_time0</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
    <span class="n">ftime</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">fromtimestamp</span><span class="p">(</span><span class="n">start_time0</span><span class="p">)</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s1">&#39;%Y-%m-</span><span class="si">%d</span><span class="s1"> %H%M%S&#39;</span><span class="p">)</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">ftime</span> <span class="o">+</span> <span class="s2">&quot;.txt&quot;</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">ftime</span> <span class="o">+</span> <span class="n">os</span><span class="o">.</span><span class="n">linesep</span><span class="p">)</span>


        <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mf">3.54</span><span class="p">,</span><span class="mf">3.54</span><span class="p">))</span>
        <span class="n">matplotlib</span><span class="o">.</span><span class="n">rcParams</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s1">&#39;font.size&#39;</span><span class="p">:</span> <span class="mi">11</span><span class="p">})</span>

        <span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="s2">&quot;111&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">alphas</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">alphas</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">1e-5</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">betas</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">betas</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">]</span>


        <span class="n">pdict</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">(</span>
                    <span class="n">E</span> <span class="o">=</span> <span class="mf">6.998</span><span class="o">*</span><span class="mf">1e9</span><span class="p">,</span> <span class="c1">#Pa</span>
                    <span class="n">rho</span> <span class="o">=</span> <span class="mi">2373</span><span class="p">,</span> <span class="c1">#kg/m3</span>
                    <span class="n">L</span> <span class="o">=</span> <span class="mi">160</span><span class="p">,</span> <span class="c1">#m</span>
                    <span class="n">A</span> <span class="o">=</span> <span class="mf">0.3</span><span class="o">*</span><span class="mf">0.1</span><span class="p">,</span> <span class="c1"># m^2</span>
                    <span class="n">I</span> <span class="o">=</span> <span class="mf">0.00022477900799999998</span><span class="p">,</span>
                    <span class="n">k1</span> <span class="o">=</span> <span class="mf">800002.6125</span><span class="p">,</span>

<span class="c1">#                    kf=5.41e-4,</span>
                    <span class="c1">#Fz_norm=1.013e-4,</span>
<span class="c1">#                    mu_norm=39.263/4/2/1000,</span>
<span class="c1">#                    mubar=PolyLine([0,0.05,0.05,.95,.95,1],[1,1,1,1,1,1]),</span>
<span class="c1">#                    k1_norm=97.552,</span>
    <span class="c1">#                k1bar=PolyLine([0,0.2,0.3,1],[1.0,1,0.1,0.1]),</span>
<span class="c1">#                    k1bar=PolyLine([0,0.2,0.2,1],[1.0,1,1,1]),</span>

    <span class="c1">#                k3_norm=2.497e6,</span>
                    <span class="n">nterms</span><span class="o">=</span><span class="n">nterms</span><span class="p">,</span>
                    <span class="n">BC</span><span class="o">=</span><span class="s2">&quot;SS&quot;</span><span class="p">,</span>
<span class="c1">#                    nquad=20,</span>
                    <span class="n">moving_loads_x_norm</span><span class="o">=</span><span class="p">[[</span><span class="mi">0</span><span class="p">]],</span>
                    <span class="n">moving_loads_Fz_norm</span><span class="o">=</span><span class="p">[[</span><span class="mf">1.013e-4</span><span class="p">]],</span>
<span class="c1">#                    moving_loads_v_norm=[v,],#[0.01165,],</span>
<span class="c1">#                    tvals=t,</span>
                    <span class="n">xvals_norm</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">xeval</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">xeval</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">nx</span><span class="p">),</span>
                    <span class="n">use_analytical</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                    <span class="n">implementation</span><span class="o">=</span><span class="s2">&quot;fortran&quot;</span><span class="p">,</span>
                    <span class="n">force_calc</span><span class="o">=</span><span class="n">force_calc</span><span class="p">,</span>
                    <span class="p">)</span>


        <span class="n">iwindow</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">searchsorted</span><span class="p">(</span><span class="n">pdict</span><span class="p">[</span><span class="s1">&#39;xvals_norm&#39;</span><span class="p">],</span><span class="n">v</span><span class="p">)</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">xwindow</span><span class="p">]</span>

        <span class="k">if</span> <span class="n">article_formatting</span><span class="p">:</span>
            <span class="n">mdc</span> <span class="o">=</span> <span class="n">MarkersDashesColors</span><span class="p">(</span><span class="n">markersize</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
            <span class="n">mdc</span><span class="o">.</span><span class="n">construct_styles</span><span class="p">(</span><span class="n">markers</span><span class="o">=</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">11</span><span class="p">,</span><span class="mi">25</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">15</span><span class="p">],</span>
                               <span class="n">dashes</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                               <span class="n">marker_colors</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">],</span>
                               <span class="n">line_colors</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">])</span>

            <span class="n">styles</span><span class="o">=</span><span class="n">mdc</span><span class="p">(</span><span class="n">markers</span><span class="o">=</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">11</span><span class="p">,</span><span class="mi">25</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">15</span><span class="p">],</span>
                               <span class="n">dashes</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                               <span class="n">marker_colors</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">],</span>
                               <span class="n">line_colors</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">])</span>

        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">beta</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">betas</span><span class="p">):</span>
            <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">alphas</span><span class="p">))</span>
            <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">alphas</span><span class="p">))</span>
            <span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="n">alpha</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">alphas</span><span class="p">):</span>

                <span class="n">start_time1</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>

                <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;*&quot;</span> <span class="o">*</span> <span class="mi">70</span> <span class="o">+</span> <span class="n">os</span><span class="o">.</span><span class="n">linesep</span><span class="p">)</span>
<span class="c1">#                vequals = &quot;{}={}&quot;.format(vstr, vfmt.format(v))</span>
                <span class="n">vequals</span> <span class="o">=</span> <span class="s2">&quot;alpha=</span><span class="si">{}</span><span class="s2">, beta=</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">alpha</span><span class="p">,</span> <span class="n">beta</span><span class="p">)</span>
                <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">vequals</span> <span class="o">+</span> <span class="n">os</span><span class="o">.</span><span class="n">linesep</span><span class="p">);</span> <span class="nb">print</span><span class="p">(</span><span class="n">vequals</span><span class="p">)</span>


                <span class="n">v_crit</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="o">/</span><span class="n">pdict</span><span class="p">[</span><span class="s2">&quot;rho&quot;</span><span class="p">]</span><span class="o">/</span><span class="n">pdict</span><span class="p">[</span><span class="s2">&quot;A&quot;</span><span class="p">]</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">pdict</span><span class="p">[</span><span class="s2">&quot;k1&quot;</span><span class="p">]</span><span class="o">*</span><span class="n">pdict</span><span class="p">[</span><span class="s2">&quot;E&quot;</span><span class="p">]</span><span class="o">*</span><span class="n">pdict</span><span class="p">[</span><span class="s2">&quot;I&quot;</span><span class="p">]))</span>
                <span class="n">v_raw</span> <span class="o">=</span> <span class="n">v_crit</span><span class="o">*</span><span class="n">alpha</span>

                <span class="n">c_crit</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">4</span><span class="o">*</span><span class="n">pdict</span><span class="p">[</span><span class="s2">&quot;rho&quot;</span><span class="p">]</span><span class="o">*</span><span class="n">pdict</span><span class="p">[</span><span class="s2">&quot;A&quot;</span><span class="p">]</span><span class="o">*</span><span class="n">pdict</span><span class="p">[</span><span class="s2">&quot;k1&quot;</span><span class="p">])</span>
                <span class="n">c_raw</span> <span class="o">=</span> <span class="n">c_crit</span> <span class="o">*</span> <span class="n">beta</span>

                <span class="n">tmax</span> <span class="o">=</span> <span class="n">pdict</span><span class="p">[</span><span class="s2">&quot;L&quot;</span><span class="p">]</span> <span class="o">/</span> <span class="n">v_raw</span>

<span class="c1">#                end_damp = 0.05</span>

                <span class="k">if</span> <span class="n">end_damp</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span>
                    <span class="n">pdict</span><span class="p">[</span><span class="s2">&quot;mu&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">c_raw</span>
                    <span class="n">pdict</span><span class="p">[</span><span class="s2">&quot;mubar&quot;</span><span class="p">]</span><span class="o">=</span><span class="n">PolyLine</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">beta</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span>
                        <span class="n">pdict</span><span class="p">[</span><span class="s2">&quot;mu&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">c_crit</span>
                        <span class="n">pdict</span><span class="p">[</span><span class="s2">&quot;mubar&quot;</span><span class="p">]</span><span class="o">=</span><span class="n">PolyLine</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="n">end_damp</span><span class="p">,</span><span class="n">end_damp</span><span class="p">,</span><span class="mi">1</span><span class="o">-</span><span class="n">end_damp</span><span class="p">,</span><span class="mi">1</span><span class="o">-</span><span class="n">end_damp</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span>
                                            <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">pdict</span><span class="p">[</span><span class="s2">&quot;mu&quot;</span><span class="p">]</span><span class="o">=</span> <span class="n">c_raw</span>
                        <span class="n">pdict</span><span class="p">[</span><span class="s2">&quot;mubar&quot;</span><span class="p">]</span><span class="o">=</span><span class="n">PolyLine</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="n">end_damp</span><span class="p">,</span><span class="n">end_damp</span><span class="p">,</span><span class="mi">1</span><span class="o">-</span><span class="n">end_damp</span><span class="p">,</span><span class="mi">1</span><span class="o">-</span><span class="n">end_damp</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span>
                                            <span class="p">[</span><span class="n">c_crit</span><span class="o">/</span><span class="n">c_raw</span><span class="p">,</span><span class="n">c_crit</span><span class="o">/</span><span class="n">c_raw</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">c_crit</span><span class="o">/</span><span class="n">c_raw</span><span class="p">,</span><span class="n">c_crit</span><span class="o">/</span><span class="n">c_raw</span><span class="p">])</span>

<span class="c1">#                pdict[&quot;mu&quot;] = c_raw</span>
                <span class="n">pdict</span><span class="p">[</span><span class="s2">&quot;tvals&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">tmax</span><span class="o">*</span><span class="n">xeval</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">tmax</span><span class="o">*</span><span class="n">xeval</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">nt</span><span class="p">)</span>
                <span class="n">pdict</span><span class="p">[</span><span class="s2">&quot;moving_loads_v_norm&quot;</span><span class="p">]</span><span class="o">=</span><span class="p">[</span><span class="n">v_raw</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">pdict</span><span class="p">[</span><span class="s2">&quot;rho&quot;</span><span class="p">]</span><span class="o">/</span><span class="n">pdict</span><span class="p">[</span><span class="s2">&quot;E&quot;</span><span class="p">])]</span>
                <span class="n">pdict</span><span class="p">[</span><span class="s2">&quot;file_stem&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">prefix</span> <span class="o">+</span> <span class="s2">&quot;DAF_alp</span><span class="si">{:5.3f}</span><span class="s2">_bet</span><span class="si">{:5.3f}</span><span class="s2">_n</span><span class="si">{:d}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">alpha</span><span class="p">,</span><span class="n">beta</span><span class="p">,</span><span class="n">nterms</span><span class="p">)</span>

                <span class="n">a</span> <span class="o">=</span> <span class="n">SpecBeam</span><span class="p">(</span><span class="o">**</span><span class="n">pdict</span><span class="p">)</span>
                <span class="n">a</span><span class="o">.</span><span class="n">runme</span><span class="p">()</span>
                <span class="n">a</span><span class="o">.</span><span class="n">saveme</span><span class="p">()</span>

                <span class="n">jjj</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">searchsorted</span><span class="p">(</span><span class="n">alphas</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">i</span><span class="o">==</span><span class="mi">0</span> <span class="ow">and</span> <span class="n">j</span><span class="o">==</span><span class="n">jjj</span><span class="p">:</span>
                    <span class="n">a</span><span class="o">.</span><span class="n">animateme</span><span class="p">()</span>
                <span class="n">w_now</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">defl</span><span class="p">[</span><span class="n">iwindow</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span><span class="n">iwindow</span><span class="p">[</span><span class="mi">1</span><span class="p">],:])</span>

                <span class="k">if</span> <span class="n">j</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span>

                    <span class="k">if</span> <span class="n">numerical_DAF</span><span class="p">:</span>
                        <span class="n">w_0</span> <span class="o">=</span> <span class="n">w_now</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">lam</span> <span class="o">=</span> <span class="p">(</span><span class="n">pdict</span><span class="p">[</span><span class="s1">&#39;k1&#39;</span><span class="p">]</span> <span class="o">/</span><span class="p">(</span><span class="mi">4</span><span class="o">*</span><span class="n">pdict</span><span class="p">[</span><span class="s1">&#39;E&#39;</span><span class="p">]</span><span class="o">*</span><span class="n">pdict</span><span class="p">[</span><span class="s1">&#39;I&#39;</span><span class="p">]))</span><span class="o">**</span><span class="mf">0.25</span>
                        <span class="n">Q</span> <span class="o">=</span> <span class="n">pdict</span><span class="p">[</span><span class="s2">&quot;moving_loads_Fz_norm&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span> <span class="n">pdict</span><span class="p">[</span><span class="s1">&#39;E&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">pdict</span><span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">]</span>
                        <span class="n">w_0</span> <span class="o">=</span> <span class="n">Q</span> <span class="o">*</span> <span class="n">lam</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">pdict</span><span class="p">[</span><span class="s1">&#39;k1&#39;</span><span class="p">])</span>
                        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;analytical&quot;</span><span class="p">)</span>

                <span class="n">DAF</span> <span class="o">=</span> <span class="n">w_now</span><span class="o">/</span><span class="n">w_0</span>

                <span class="n">x</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">alpha</span>
                <span class="n">y</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">DAF</span>


                <span class="n">end_time1</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
                <span class="n">elapsed_time</span> <span class="o">=</span> <span class="p">(</span><span class="n">end_time1</span> <span class="o">-</span> <span class="n">start_time1</span><span class="p">);</span> <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Run time=</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">timedelta</span><span class="p">(</span><span class="n">seconds</span><span class="o">=</span><span class="n">elapsed_time</span><span class="p">))))</span>

            <span class="k">if</span> <span class="n">article_formatting</span><span class="p">:</span>
                <span class="n">line</span><span class="p">,</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span>
                          <span class="n">label</span><span class="o">=</span><span class="s2">&quot;$</span><span class="si">{}</span><span class="s2">$&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">beta</span><span class="p">),</span><span class="n">markevery</span><span class="o">=</span><span class="p">(</span><span class="n">i</span><span class="o">/</span><span class="mi">5</span><span class="o">*</span><span class="mf">0.09</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">),</span><span class="o">**</span><span class="n">styles</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">line</span><span class="p">,</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span>
                          <span class="n">label</span><span class="o">=</span><span class="s2">&quot;$</span><span class="si">{}</span><span class="s2">$&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">beta</span><span class="p">))</span>

        <span class="c1">######Analytical</span>
<span class="c1">#        figdum, axdum = plt.subplots(figsize=(6,8))</span>
        <span class="n">alpha</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">alphas</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">alphas</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="p">,</span><span class="mi">100</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="n">bet</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">betas</span><span class="p">):</span>
            <span class="n">DAF</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty_like</span><span class="p">(</span><span class="n">alpha</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">alp</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">alpha</span><span class="p">):</span>



<span class="c1">#                s, disp=moving_load_on_beam_on_elastic_foundation(alp=alp, bet=bet, ax=axdum)</span>
<span class="c1">#                axdum.cla()</span>
<span class="c1">#                mx = np.max(disp)</span>
                <span class="n">DAF</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">DAFinfinite</span><span class="p">(</span><span class="n">alp</span><span class="o">=</span><span class="n">alp</span><span class="p">,</span> <span class="n">bet</span><span class="o">=</span><span class="n">bet</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">j</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">alpha</span><span class="p">,</span> <span class="n">DAF</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;analytical</span><span class="se">\n</span><span class="s2">inf. beam&quot;</span><span class="p">,</span>
                        <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;+&quot;</span><span class="p">,</span><span class="n">ms</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span><span class="n">ls</span><span class="o">=</span><span class="s1">&#39;None&#39;</span><span class="p">,</span><span class="n">markevery</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">alpha</span><span class="p">,</span> <span class="n">DAF</span><span class="p">,</span>
                        <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;+&quot;</span><span class="p">,</span><span class="n">ms</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span><span class="n">ls</span><span class="o">=</span><span class="s1">&#39;None&#39;</span><span class="p">,</span><span class="n">markevery</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="c1">#        figdum.clf()</span>
        <span class="c1">#####end analytical</span>


        <span class="c1">#ax.set_title(&quot;$B=r_e,b_w=r_w,b_s=NA$&quot;)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
        <span class="c1">#ax.xaxis.label.set_fontsize(30)</span>
        <span class="c1">#ax.yaxis.label.set_fontsize(30)</span>
        <span class="c1">#ax.set_ylabel(&quot;$\\frac{u_\\mathrm{a,max}}{u_\\mathrm{p,max}}$&quot;)</span>
<span class="c1">#        ax.set_ylabel(&quot;$u_\\mathrm{a,max}/u_\\mathrm{p,max}$&quot;)</span>
<span class="c1">#        ax.set_xlabel(&quot;$n_a=r_e/r_w$&quot;)</span>
    <span class="c1">#    ax.set_xscale(&quot;log&quot;)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Velocity ratio, $</span><span class="se">\\</span><span class="s2">alpha$&quot;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Deflection amplification factor&quot;</span><span class="p">)</span>

<span class="c1">#        ax.set_xlim(3.5, 4.5)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
        <span class="n">leg</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s2">&quot;$</span><span class="se">\\</span><span class="s2">mathrm{Damping\ ratio,\ }</span><span class="se">\\</span><span class="s2">beta$&quot;</span><span class="p">,</span>
                        <span class="n">loc</span><span class="o">=</span><span class="s2">&quot;upper right&quot;</span><span class="p">,</span>
<span class="c1">#                        ncol=2,</span>
                        <span class="n">labelspacing</span><span class="o">=.</span><span class="mi">2</span><span class="p">,</span>
                        <span class="n">handlelength</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
                        <span class="n">fontsize</span><span class="o">=</span><span class="mi">8</span>
                        <span class="p">)</span>
        <span class="n">leg</span><span class="o">.</span><span class="n">draggable</span><span class="p">()</span>

        <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">labelpad</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">labelpad</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="n">fig</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">top</span><span class="o">=</span><span class="mf">0.95</span><span class="p">,</span> <span class="n">bottom</span><span class="o">=</span><span class="mf">0.13</span><span class="p">,</span> <span class="n">left</span><span class="o">=</span><span class="mf">0.14</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="mf">0.95</span><span class="p">)</span>




        <span class="n">end_time0</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
        <span class="n">elapsed_time</span> <span class="o">=</span> <span class="p">(</span><span class="n">end_time0</span> <span class="o">-</span> <span class="n">start_time0</span><span class="p">);</span> <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Total run time=</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">timedelta</span><span class="p">(</span><span class="n">seconds</span><span class="o">=</span><span class="n">elapsed_time</span><span class="p">))))</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;Total run time=</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">timedelta</span><span class="p">(</span><span class="n">seconds</span><span class="o">=</span><span class="n">elapsed_time</span><span class="p">)))</span> <span class="o">+</span> <span class="n">os</span><span class="o">.</span><span class="n">linesep</span><span class="p">)</span>
<span class="c1">#        a.animateme()</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">saveas</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">save_figure</span><span class="p">(</span><span class="n">fig</span><span class="o">=</span><span class="n">fig</span><span class="p">,</span> <span class="n">fname</span><span class="o">=</span><span class="n">saveas</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span></div>

<div class="viewcode-block" id="FIGURE_DAF_transition_length"><a class="viewcode-back" href="../../../api/geotecha.beam_on_foundation.specbeam.html#geotecha.beam_on_foundation.specbeam.FIGURE_DAF_transition_length">[docs]</a><span class="k">def</span> <span class="nf">FIGURE_DAF_transition_length</span><span class="p">(</span><span class="n">saveas</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">k_ratio</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span><span class="n">beta</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span><span class="n">nterms</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span><span class="n">force_calc</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Dynamic amplification factor length of transition&quot;&quot;&quot;</span>


    <span class="n">start_time0</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
    <span class="n">ftime</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">fromtimestamp</span><span class="p">(</span><span class="n">start_time0</span><span class="p">)</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s1">&#39;%Y-%m-</span><span class="si">%d</span><span class="s1"> %H%M%S&#39;</span><span class="p">)</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">ftime</span> <span class="o">+</span> <span class="s2">&quot;.txt&quot;</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">ftime</span> <span class="o">+</span> <span class="n">os</span><span class="o">.</span><span class="n">linesep</span><span class="p">)</span>


        <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mf">3.54</span><span class="p">,</span><span class="mf">3.54</span><span class="p">))</span>
        <span class="n">matplotlib</span><span class="o">.</span><span class="n">rcParams</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s1">&#39;font.size&#39;</span><span class="p">:</span> <span class="mi">11</span><span class="p">})</span>

        <span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="s2">&quot;111&quot;</span><span class="p">)</span>


        <span class="n">alphas</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">1e-5</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
        <span class="n">t_lengths</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mf">25.0</span><span class="p">,</span><span class="mi">10</span><span class="p">)</span>
        <span class="c1">#betas = [0, 0.05, 0.1, 0.3, 1.1, 2.0]</span>


        <span class="n">pdict</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">(</span>
                    <span class="n">E</span> <span class="o">=</span> <span class="mf">6.998</span><span class="o">*</span><span class="mf">1e9</span><span class="p">,</span> <span class="c1">#Pa</span>
                    <span class="n">rho</span> <span class="o">=</span> <span class="mi">2373</span><span class="p">,</span> <span class="c1">#kg/m3</span>
                    <span class="n">L</span> <span class="o">=</span> <span class="mi">160</span><span class="p">,</span> <span class="c1">#m</span>
                    <span class="n">A</span> <span class="o">=</span> <span class="mf">0.3</span><span class="o">*</span><span class="mf">0.1</span><span class="p">,</span> <span class="c1"># m^2</span>
                    <span class="n">I</span> <span class="o">=</span> <span class="mf">0.00022477900799999998</span><span class="p">,</span>
                    <span class="n">k1</span> <span class="o">=</span> <span class="mf">800002.6125</span><span class="p">,</span>

<span class="c1">#                    kf=5.41e-4,</span>
                    <span class="c1">#Fz_norm=1.013e-4,</span>
<span class="c1">#                    mu_norm=39.263/4/2/1000,</span>
<span class="c1">#                    mubar=PolyLine([0,0.05,0.05,.95,.95,1],[1,1,1,1,1,1]),</span>
<span class="c1">#                    k1_norm=97.552,</span>
    <span class="c1">#                k1bar=PolyLine([0,0.2,0.3,1],[1.0,1,0.1,0.1]),</span>
<span class="c1">#                    k1bar=PolyLine([0,0.2,0.2,1],[1.0,1,1,1]),</span>

    <span class="c1">#                k3_norm=2.497e6,</span>
                    <span class="n">nterms</span><span class="o">=</span><span class="n">nterms</span><span class="p">,</span>
                    <span class="n">BC</span><span class="o">=</span><span class="s2">&quot;SS&quot;</span><span class="p">,</span>
<span class="c1">#                    nquad=20,</span>
                    <span class="n">moving_loads_x_norm</span><span class="o">=</span><span class="p">[[</span><span class="mi">0</span><span class="p">]],</span>
                    <span class="n">moving_loads_Fz_norm</span><span class="o">=</span><span class="p">[[</span><span class="mf">1.013e-4</span><span class="p">]],</span>
<span class="c1">#                    moving_loads_v_norm=[v,],#[0.01165,],</span>
<span class="c1">#                    tvals=t,</span>
                    <span class="n">xvals_norm</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.15</span><span class="p">,</span><span class="mf">0.85</span><span class="p">,</span><span class="mi">100</span><span class="p">),</span>
                    <span class="n">use_analytical</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                    <span class="n">implementation</span><span class="o">=</span><span class="s2">&quot;fortran&quot;</span><span class="p">,</span>
                    <span class="n">force_calc</span><span class="o">=</span><span class="n">force_calc</span><span class="p">,</span>
                    <span class="p">)</span>


        <span class="n">z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">alphas</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">t_lengths</span><span class="p">)),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>



        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">t_length</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">t_lengths</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="n">alpha</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">alphas</span><span class="p">):</span>

                <span class="n">start_time1</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>

                <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;*&quot;</span> <span class="o">*</span> <span class="mi">70</span> <span class="o">+</span> <span class="n">os</span><span class="o">.</span><span class="n">linesep</span><span class="p">)</span>
<span class="c1">#                vequals = &quot;{}={}&quot;.format(vstr, vfmt.format(v))</span>
                <span class="n">vequals</span> <span class="o">=</span> <span class="s2">&quot;alpha=</span><span class="si">{}</span><span class="s2">, t_len=</span><span class="si">{}</span><span class="s2">, k_ratio=</span><span class="si">{}</span><span class="s2">, beta=</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">alpha</span><span class="p">,</span> <span class="n">t_length</span><span class="p">,</span> <span class="n">k_ratio</span><span class="p">,</span> <span class="n">beta</span><span class="p">)</span>
                <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">vequals</span> <span class="o">+</span> <span class="n">os</span><span class="o">.</span><span class="n">linesep</span><span class="p">);</span> <span class="nb">print</span><span class="p">(</span><span class="n">vequals</span><span class="p">)</span>


                <span class="n">v_crit</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="o">/</span><span class="n">pdict</span><span class="p">[</span><span class="s2">&quot;rho&quot;</span><span class="p">]</span><span class="o">/</span><span class="n">pdict</span><span class="p">[</span><span class="s2">&quot;A&quot;</span><span class="p">]</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">pdict</span><span class="p">[</span><span class="s2">&quot;k1&quot;</span><span class="p">]</span><span class="o">*</span><span class="n">pdict</span><span class="p">[</span><span class="s2">&quot;E&quot;</span><span class="p">]</span><span class="o">*</span><span class="n">pdict</span><span class="p">[</span><span class="s2">&quot;I&quot;</span><span class="p">]))</span>
                <span class="n">v_raw</span> <span class="o">=</span> <span class="n">v_crit</span><span class="o">*</span><span class="n">alpha</span>

                <span class="n">c_crit</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">4</span><span class="o">*</span><span class="n">pdict</span><span class="p">[</span><span class="s2">&quot;rho&quot;</span><span class="p">]</span><span class="o">*</span><span class="n">pdict</span><span class="p">[</span><span class="s2">&quot;A&quot;</span><span class="p">]</span><span class="o">*</span><span class="n">pdict</span><span class="p">[</span><span class="s2">&quot;k1&quot;</span><span class="p">])</span>
                <span class="n">c_raw</span> <span class="o">=</span> <span class="n">c_crit</span><span class="o">*</span><span class="n">beta</span>

                <span class="n">tmax</span> <span class="o">=</span> <span class="n">pdict</span><span class="p">[</span><span class="s2">&quot;L&quot;</span><span class="p">]</span> <span class="o">/</span> <span class="n">v_raw</span>


                <span class="n">pdict</span><span class="p">[</span><span class="s2">&quot;mu&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">c_raw</span>
                <span class="n">pdict</span><span class="p">[</span><span class="s2">&quot;tvals&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">tmax</span><span class="o">*</span><span class="mf">0.3</span><span class="p">,</span><span class="n">tmax</span><span class="o">*</span><span class="mf">0.80</span><span class="p">,</span><span class="mi">100</span><span class="p">)</span>
                <span class="n">pdict</span><span class="p">[</span><span class="s2">&quot;moving_loads_v_norm&quot;</span><span class="p">]</span><span class="o">=</span><span class="p">[</span><span class="n">v_raw</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">pdict</span><span class="p">[</span><span class="s2">&quot;rho&quot;</span><span class="p">]</span><span class="o">/</span><span class="n">pdict</span><span class="p">[</span><span class="s2">&quot;E&quot;</span><span class="p">])]</span>
                <span class="n">pdict</span><span class="p">[</span><span class="s2">&quot;file_stem&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;DAF_alp</span><span class="si">{:5.3f}</span><span class="s2">_bet</span><span class="si">{:5.3f}</span><span class="s2">_tlen</span><span class="si">{:5.3f}</span><span class="s2">_krat</span><span class="si">{:5.3f}</span><span class="s2">_n</span><span class="si">{:d}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">alpha</span><span class="p">,</span><span class="n">beta</span><span class="p">,</span><span class="n">t_length</span><span class="p">,</span><span class="n">k_ratio</span><span class="p">,</span><span class="n">nterms</span><span class="p">)</span>
                <span class="n">pdict</span><span class="p">[</span><span class="s2">&quot;k1bar&quot;</span><span class="p">]</span><span class="o">=</span><span class="n">PolyLine</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">,</span> <span class="mf">0.4</span><span class="o">+</span><span class="n">t_length</span><span class="o">/</span><span class="n">pdict</span><span class="p">[</span><span class="s2">&quot;L&quot;</span><span class="p">],</span><span class="mi">1</span><span class="p">],[</span><span class="mf">1.0</span><span class="p">,</span><span class="mf">1.0</span><span class="p">,</span><span class="n">k_ratio</span><span class="p">,</span><span class="n">k_ratio</span><span class="p">])</span>

                <span class="n">a</span> <span class="o">=</span> <span class="n">SpecBeam</span><span class="p">(</span><span class="o">**</span><span class="n">pdict</span><span class="p">)</span>
                <span class="n">a</span><span class="o">.</span><span class="n">runme</span><span class="p">()</span>
                <span class="n">a</span><span class="o">.</span><span class="n">saveme</span><span class="p">()</span>

                <span class="n">w_now</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">defl</span><span class="p">)</span>

                <span class="k">if</span> <span class="n">j</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span>
                    <span class="n">w_0</span> <span class="o">=</span> <span class="n">w_now</span>

                <span class="n">DAF</span> <span class="o">=</span> <span class="n">w_now</span><span class="o">/</span><span class="n">w_0</span>

                <span class="n">z</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="n">DAF</span>



                <span class="n">end_time1</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
                <span class="n">elapsed_time</span> <span class="o">=</span> <span class="p">(</span><span class="n">end_time1</span> <span class="o">-</span> <span class="n">start_time1</span><span class="p">);</span> <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Run time=</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">timedelta</span><span class="p">(</span><span class="n">seconds</span><span class="o">=</span><span class="n">elapsed_time</span><span class="p">))))</span>

                <span class="k">if</span> <span class="n">i</span><span class="o">==</span><span class="mi">0</span> <span class="ow">and</span> <span class="n">j</span><span class="o">==</span><span class="mi">2</span><span class="p">:</span>
                    <span class="n">a</span><span class="o">.</span><span class="n">animateme</span><span class="p">()</span>

        <span class="c1">#contourv = np.linspace(.1,10,10)</span>
        <span class="n">CS</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">contour</span><span class="p">(</span><span class="n">alphas</span><span class="p">,</span> <span class="n">t_lengths</span><span class="p">,</span> <span class="n">z</span> <span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">clabel</span><span class="p">(</span><span class="n">CS</span><span class="p">,</span><span class="n">inline</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span><span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">%.1f</span><span class="s1">&#39;</span><span class="p">)</span>





        <span class="c1">#ax.set_title(&quot;$B=r_e,b_w=r_w,b_s=NA$&quot;)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">25</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
        <span class="c1">#ax.xaxis.label.set_fontsize(30)</span>
        <span class="c1">#ax.yaxis.label.set_fontsize(30)</span>
        <span class="c1">#ax.set_ylabel(&quot;$\\frac{u_\\mathrm{a,max}}{u_\\mathrm{p,max}}$&quot;)</span>
<span class="c1">#        ax.set_ylabel(&quot;$u_\\mathrm{a,max}/u_\\mathrm{p,max}$&quot;)</span>
<span class="c1">#        ax.set_xlabel(&quot;$n_a=r_e/r_w$&quot;)</span>
    <span class="c1">#    ax.set_xscale(&quot;log&quot;)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Velocity ratio, $</span><span class="se">\\</span><span class="s2">alpha$&quot;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Transition length&quot;</span><span class="p">)</span>

<span class="c1">#        ax.set_xlim(3.5, 4.5)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="c1">#        leg = ax.legend(title=&quot;$\\mathrm{Damping\ ratio,\ }\\beta$&quot;,</span>
<span class="c1">#                        loc=&quot;upper right&quot;,</span>
<span class="c1">##                        ncol=2,</span>
<span class="c1">#                        labelspacing=.2,</span>
<span class="c1">#                        handlelength=2,</span>
<span class="c1">#                        fontsize=8</span>
<span class="c1">#                        )</span>
<span class="c1">#        leg.draggable()</span>

        <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">labelpad</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">labelpad</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="n">fig</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">top</span><span class="o">=</span><span class="mf">0.95</span><span class="p">,</span> <span class="n">bottom</span><span class="o">=</span><span class="mf">0.13</span><span class="p">,</span> <span class="n">left</span><span class="o">=</span><span class="mf">0.14</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="mf">0.95</span><span class="p">)</span>




        <span class="n">end_time0</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
        <span class="n">elapsed_time</span> <span class="o">=</span> <span class="p">(</span><span class="n">end_time0</span> <span class="o">-</span> <span class="n">start_time0</span><span class="p">);</span> <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Total run time=</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">timedelta</span><span class="p">(</span><span class="n">seconds</span><span class="o">=</span><span class="n">elapsed_time</span><span class="p">))))</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;Total run time=</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">timedelta</span><span class="p">(</span><span class="n">seconds</span><span class="o">=</span><span class="n">elapsed_time</span><span class="p">)))</span> <span class="o">+</span> <span class="n">os</span><span class="o">.</span><span class="n">linesep</span><span class="p">)</span>
<span class="c1">#        a.animateme()</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">saveas</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">save_figure</span><span class="p">(</span><span class="n">fig</span><span class="o">=</span><span class="n">fig</span><span class="p">,</span> <span class="n">fname</span><span class="o">=</span><span class="n">saveas</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span></div>


<div class="viewcode-block" id="FIGURE_DAF_transition_length_esveld"><a class="viewcode-back" href="../../../api/geotecha.beam_on_foundation.specbeam.html#geotecha.beam_on_foundation.specbeam.FIGURE_DAF_transition_length_esveld">[docs]</a><span class="k">def</span> <span class="nf">FIGURE_DAF_transition_length_esveld</span><span class="p">(</span><span class="n">saveas</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">k_ratio</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span><span class="n">beta</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span><span class="n">nterms</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span><span class="n">force_calc</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Dynamic amplification factor length of transition, reproduce esveld figure&quot;&quot;&quot;</span>


    <span class="n">start_time0</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
    <span class="n">ftime</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">fromtimestamp</span><span class="p">(</span><span class="n">start_time0</span><span class="p">)</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s1">&#39;%Y-%m-</span><span class="si">%d</span><span class="s1"> %H%M%S&#39;</span><span class="p">)</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">ftime</span> <span class="o">+</span> <span class="s2">&quot;.txt&quot;</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">ftime</span> <span class="o">+</span> <span class="n">os</span><span class="o">.</span><span class="n">linesep</span><span class="p">)</span>


        <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mf">3.54</span><span class="p">,</span><span class="mf">3.54</span><span class="p">))</span>
        <span class="n">matplotlib</span><span class="o">.</span><span class="n">rcParams</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s1">&#39;font.size&#39;</span><span class="p">:</span> <span class="mi">11</span><span class="p">})</span>

        <span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="s2">&quot;111&quot;</span><span class="p">)</span>

        <span class="n">fig2</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mf">3.54</span><span class="p">,</span><span class="mf">3.54</span><span class="p">))</span>
        <span class="n">ax2</span> <span class="o">=</span> <span class="n">fig2</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="s2">&quot;111&quot;</span><span class="p">)</span>

        <span class="n">alphas</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.0001</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">]</span>
        <span class="n">t_lengths</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mf">25.0</span><span class="p">,</span><span class="mi">6</span><span class="p">)</span>
        <span class="c1">#betas = [0, 0.05, 0.1, 0.3, 1.1, 2.0]</span>


        <span class="n">pdict</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">(</span>
                    <span class="n">E</span> <span class="o">=</span> <span class="mf">6.998</span><span class="o">*</span><span class="mf">1e9</span><span class="p">,</span> <span class="c1">#Pa</span>
                    <span class="n">rho</span> <span class="o">=</span> <span class="mi">2373</span><span class="p">,</span> <span class="c1">#kg/m3</span>
                    <span class="n">L</span> <span class="o">=</span> <span class="mi">200</span><span class="p">,</span><span class="c1">#160, #m</span>
                    <span class="n">A</span> <span class="o">=</span> <span class="mf">0.3</span><span class="o">*</span><span class="mf">0.1</span><span class="p">,</span> <span class="c1"># m^2</span>
                    <span class="n">I</span> <span class="o">=</span> <span class="mf">0.00022477900799999998</span><span class="p">,</span>
                    <span class="n">k1</span> <span class="o">=</span> <span class="mf">800002.6125</span><span class="p">,</span>

<span class="c1">#                    kf=5.41e-4,</span>
                    <span class="c1">#Fz_norm=1.013e-4,</span>
<span class="c1">#                    mu_norm=39.263/4/2/1000,</span>
<span class="c1">#                    mubar=PolyLine([0,0.05,0.05,.95,.95,1],[1,1,1,1,1,1]),</span>
<span class="c1">#                    k1_norm=97.552,</span>
    <span class="c1">#                k1bar=PolyLine([0,0.2,0.3,1],[1.0,1,0.1,0.1]),</span>
<span class="c1">#                    k1bar=PolyLine([0,0.2,0.2,1],[1.0,1,1,1]),</span>

    <span class="c1">#                k3_norm=2.497e6,</span>
                    <span class="n">nterms</span><span class="o">=</span><span class="n">nterms</span><span class="p">,</span>
                    <span class="n">BC</span><span class="o">=</span><span class="s2">&quot;SS&quot;</span><span class="p">,</span>
<span class="c1">#                    nquad=20,</span>
                    <span class="n">moving_loads_x_norm</span><span class="o">=</span><span class="p">[[</span><span class="mi">0</span><span class="p">]],</span>
                    <span class="n">moving_loads_Fz_norm</span><span class="o">=</span><span class="p">[[</span><span class="mf">1.013e-4</span><span class="p">]],</span>
<span class="c1">#                    moving_loads_v_norm=[v,],#[0.01165,],</span>
<span class="c1">#                    tvals=t,</span>
                    <span class="c1">#xvals_norm=np.linspace(0.15,0.85,100)</span>
                    <span class="n">use_analytical</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                    <span class="n">implementation</span><span class="o">=</span><span class="s2">&quot;fortran&quot;</span><span class="p">,</span>
                    <span class="n">force_calc</span><span class="o">=</span><span class="n">force_calc</span><span class="p">,</span>
                    <span class="p">)</span>


        <span class="n">z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">alphas</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">t_lengths</span><span class="p">)),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>



        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">t_length</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">t_lengths</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="n">alpha</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">alphas</span><span class="p">):</span>

                <span class="n">start_time1</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>

                <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;*&quot;</span> <span class="o">*</span> <span class="mi">70</span> <span class="o">+</span> <span class="n">os</span><span class="o">.</span><span class="n">linesep</span><span class="p">)</span>
<span class="c1">#                vequals = &quot;{}={}&quot;.format(vstr, vfmt.format(v))</span>
                <span class="n">vequals</span> <span class="o">=</span> <span class="s2">&quot;alpha=</span><span class="si">{}</span><span class="s2">, t_len=</span><span class="si">{}</span><span class="s2">, k_ratio=</span><span class="si">{}</span><span class="s2">, beta=</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">alpha</span><span class="p">,</span> <span class="n">t_length</span><span class="p">,</span> <span class="n">k_ratio</span><span class="p">,</span> <span class="n">beta</span><span class="p">)</span>
                <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">vequals</span> <span class="o">+</span> <span class="n">os</span><span class="o">.</span><span class="n">linesep</span><span class="p">);</span> <span class="nb">print</span><span class="p">(</span><span class="n">vequals</span><span class="p">)</span>


                <span class="n">v_crit</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="o">/</span><span class="n">pdict</span><span class="p">[</span><span class="s2">&quot;rho&quot;</span><span class="p">]</span><span class="o">/</span><span class="n">pdict</span><span class="p">[</span><span class="s2">&quot;A&quot;</span><span class="p">]</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">pdict</span><span class="p">[</span><span class="s2">&quot;k1&quot;</span><span class="p">]</span><span class="o">*</span><span class="n">pdict</span><span class="p">[</span><span class="s2">&quot;E&quot;</span><span class="p">]</span><span class="o">*</span><span class="n">pdict</span><span class="p">[</span><span class="s2">&quot;I&quot;</span><span class="p">]))</span>
                <span class="n">v_raw</span> <span class="o">=</span> <span class="n">v_crit</span><span class="o">*</span><span class="n">alpha</span>

                <span class="n">c_crit</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">4</span><span class="o">*</span><span class="n">pdict</span><span class="p">[</span><span class="s2">&quot;rho&quot;</span><span class="p">]</span><span class="o">*</span><span class="n">pdict</span><span class="p">[</span><span class="s2">&quot;A&quot;</span><span class="p">]</span><span class="o">*</span><span class="n">pdict</span><span class="p">[</span><span class="s2">&quot;k1&quot;</span><span class="p">])</span>
                <span class="n">c_raw</span> <span class="o">=</span> <span class="n">c_crit</span><span class="o">*</span><span class="n">beta</span>

                <span class="n">tmax</span> <span class="o">=</span> <span class="n">pdict</span><span class="p">[</span><span class="s2">&quot;L&quot;</span><span class="p">]</span> <span class="o">/</span> <span class="n">v_raw</span>

                <span class="c1">#pdict[&quot;mubar&quot;] = PolyLine([0,0.1,0.9,1],[1/beta,1,1,1/beta])</span>
                <span class="c1">#pdict[&quot;mubar&quot;] = PolyLine([0,0.1,0.1,0.9,0.9,1],[1/beta,1/beta,1,1,1/beta,1/beta])</span>
                <span class="n">tran_start</span> <span class="o">=</span> <span class="mf">0.3</span>
                <span class="n">pdict</span><span class="p">[</span><span class="s2">&quot;mu&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">c_raw</span>
                <span class="n">pdict</span><span class="p">[</span><span class="s2">&quot;tvals&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">tmax</span><span class="o">*</span><span class="p">(</span><span class="n">tran_start</span><span class="o">-</span><span class="mf">0.1</span><span class="p">),</span><span class="n">tmax</span><span class="o">*</span><span class="p">(</span><span class="n">tran_start</span><span class="o">+</span><span class="n">t_length</span><span class="o">/</span><span class="n">pdict</span><span class="p">[</span><span class="s2">&quot;L&quot;</span><span class="p">]</span><span class="o">+</span><span class="mf">0.1</span><span class="p">),</span><span class="mi">200</span><span class="p">)</span>
                <span class="n">pdict</span><span class="p">[</span><span class="s2">&quot;xvals_norm&quot;</span><span class="p">]</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">tran_start</span><span class="o">-</span><span class="mf">0.1</span><span class="p">,</span><span class="n">tran_start</span><span class="o">+</span><span class="n">t_length</span><span class="o">/</span><span class="n">pdict</span><span class="p">[</span><span class="s2">&quot;L&quot;</span><span class="p">]</span><span class="o">+</span><span class="mf">0.1</span><span class="p">,</span><span class="mi">300</span><span class="p">)</span>
                <span class="n">pdict</span><span class="p">[</span><span class="s2">&quot;moving_loads_v_norm&quot;</span><span class="p">]</span><span class="o">=</span><span class="p">[</span><span class="n">v_raw</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">pdict</span><span class="p">[</span><span class="s2">&quot;rho&quot;</span><span class="p">]</span><span class="o">/</span><span class="n">pdict</span><span class="p">[</span><span class="s2">&quot;E&quot;</span><span class="p">])]</span>
                <span class="n">pdict</span><span class="p">[</span><span class="s2">&quot;file_stem&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;DAF_alp</span><span class="si">{:5.3f}</span><span class="s2">_bet</span><span class="si">{:5.3f}</span><span class="s2">_tlen</span><span class="si">{:5.3f}</span><span class="s2">_krat</span><span class="si">{:5.3f}</span><span class="s2">_n</span><span class="si">{:d}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">alpha</span><span class="p">,</span><span class="n">beta</span><span class="p">,</span><span class="n">t_length</span><span class="p">,</span><span class="n">k_ratio</span><span class="p">,</span><span class="n">nterms</span><span class="p">)</span>
                <span class="n">pdict</span><span class="p">[</span><span class="s2">&quot;k1bar&quot;</span><span class="p">]</span><span class="o">=</span><span class="n">PolyLine</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="n">tran_start</span><span class="p">,</span> <span class="n">tran_start</span><span class="o">+</span><span class="n">t_length</span><span class="o">/</span><span class="n">pdict</span><span class="p">[</span><span class="s2">&quot;L&quot;</span><span class="p">],</span><span class="mi">1</span><span class="p">],[</span><span class="mf">1.0</span><span class="p">,</span><span class="mf">1.0</span><span class="p">,</span><span class="n">k_ratio</span><span class="p">,</span><span class="n">k_ratio</span><span class="p">])</span>
                <span class="n">pdict</span><span class="p">[</span><span class="s2">&quot;k1bar&quot;</span><span class="p">]</span><span class="o">=</span><span class="n">PolyLine</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="n">tran_start</span><span class="p">,</span> <span class="n">tran_start</span><span class="o">+</span><span class="n">t_length</span><span class="o">/</span><span class="n">pdict</span><span class="p">[</span><span class="s2">&quot;L&quot;</span><span class="p">],</span><span class="mi">1</span><span class="p">],[</span><span class="n">k_ratio</span><span class="p">,</span><span class="n">k_ratio</span><span class="p">,</span><span class="mf">1.0</span><span class="p">,</span><span class="mf">1.0</span><span class="p">])</span>

                <span class="n">xstart</span> <span class="o">=</span> <span class="mf">0.0</span> <span class="c1">#start position on beam</span>
                <span class="n">xend</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="c1">#end position on beam</span>
                <span class="n">pdict</span><span class="p">[</span><span class="s2">&quot;tvals&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">tmax</span><span class="o">*</span><span class="p">(</span><span class="n">xend</span><span class="o">-</span><span class="n">xstart</span><span class="p">),</span> <span class="mi">200</span><span class="p">)</span>
                <span class="n">pdict</span><span class="p">[</span><span class="s2">&quot;moving_loads_x0_norm&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">xstart</span><span class="p">]</span>
                <span class="n">pdict</span><span class="p">[</span><span class="s2">&quot;moving_loads_L_norm&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">xend</span> <span class="o">-</span> <span class="n">xstart</span><span class="p">]</span>
                <span class="n">pdict</span><span class="p">[</span><span class="s2">&quot;xvals_norm&quot;</span><span class="p">]</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">xstart</span><span class="p">,</span><span class="n">xend</span><span class="p">,</span><span class="mi">200</span><span class="p">)</span>

                <span class="n">pdict</span><span class="p">[</span><span class="s2">&quot;tvals&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">tmax</span><span class="o">*</span><span class="mf">0.25</span><span class="p">,</span> <span class="n">tmax</span><span class="o">*</span><span class="mf">0.8</span><span class="p">,</span> <span class="mi">300</span><span class="p">)</span>
                <span class="n">pdict</span><span class="p">[</span><span class="s2">&quot;xvals_norm&quot;</span><span class="p">]</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.25</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">,</span> <span class="mi">300</span><span class="p">)</span>

                <span class="n">a</span> <span class="o">=</span> <span class="n">SpecBeam</span><span class="p">(</span><span class="o">**</span><span class="n">pdict</span><span class="p">)</span>
                <span class="n">a</span><span class="o">.</span><span class="n">runme</span><span class="p">()</span>
                <span class="n">a</span><span class="o">.</span><span class="n">saveme</span><span class="p">()</span>

                <span class="n">w_now</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">defl</span><span class="p">)</span>

                <span class="n">defl_max_envelope</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">defl</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
                <span class="n">defl_min_envelope</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">defl</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
                <span class="n">line</span><span class="p">,</span><span class="o">=</span><span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">pdict</span><span class="p">[</span><span class="s2">&quot;xvals_norm&quot;</span><span class="p">],</span><span class="n">defl_max_envelope</span><span class="p">,</span>
                         <span class="n">label</span><span class="o">=</span><span class="s2">&quot;$</span><span class="se">\\</span><span class="s2">alpha=</span><span class="si">{}</span><span class="s2">,\ tlen=</span><span class="si">{}</span><span class="s2">$&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">alpha</span><span class="p">,</span><span class="n">t_length</span><span class="p">))</span>
                <span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">pdict</span><span class="p">[</span><span class="s2">&quot;xvals_norm&quot;</span><span class="p">],</span><span class="n">defl_min_envelope</span><span class="p">,</span>
                         <span class="n">color</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">get_color</span><span class="p">(),</span>
                         <span class="p">)</span>
                <span class="k">if</span> <span class="n">j</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span>
                    <span class="n">w_0</span> <span class="o">=</span> <span class="n">w_now</span>

                <span class="n">DAF</span> <span class="o">=</span> <span class="n">w_now</span> <span class="o">/</span> <span class="n">w_0</span>

                <span class="n">z</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">DAF</span>



                <span class="n">end_time1</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
                <span class="n">elapsed_time</span> <span class="o">=</span> <span class="p">(</span><span class="n">end_time1</span> <span class="o">-</span> <span class="n">start_time1</span><span class="p">);</span> <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Run time=</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">timedelta</span><span class="p">(</span><span class="n">seconds</span><span class="o">=</span><span class="n">elapsed_time</span><span class="p">))))</span>

                <span class="k">if</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">i</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span><span class="c1">#i==0:#i==len(t_lengths)-1: #i is t_length counter,j is alpha counter</span>
                    <span class="n">a</span><span class="o">.</span><span class="n">animateme</span><span class="p">()</span>
<span class="c1">#                    print(&quot;******************&quot;,t_length,alpha, DAF)</span>
<span class="c1">#                    print(repr(z))</span>
        <span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="n">alpha</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">alphas</span><span class="p">[</span><span class="mi">1</span><span class="p">:]):</span>
            <span class="n">x</span> <span class="o">=</span> <span class="n">t_lengths</span>
            <span class="n">y</span> <span class="o">=</span> <span class="n">z</span><span class="p">[</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">,:]</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span>
                    <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span>
                    <span class="n">label</span><span class="o">=</span><span class="s2">&quot;$</span><span class="si">{}</span><span class="s2">$&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">alpha</span><span class="p">))</span>

        <span class="c1">#contourv = np.linspace(.1,10,10)</span>
<span class="c1">#        CS = ax.contour(alphas, t_lengths, z )</span>
 <span class="c1">#       ax.clabel(CS,inline=1,fontsize=8,fmt=&#39;%.1f&#39;)</span>





        <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;$</span><span class="se">\\</span><span class="s2">beta=</span><span class="si">{}</span><span class="s2">,kratio=</span><span class="si">{}</span><span class="s2">$&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">beta</span><span class="p">,</span> <span class="n">k_ratio</span><span class="p">))</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">25</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">12</span><span class="p">)</span>
        <span class="c1">#ax.xaxis.label.set_fontsize(30)</span>
        <span class="c1">#ax.yaxis.label.set_fontsize(30)</span>
        <span class="c1">#ax.set_ylabel(&quot;$\\frac{u_\\mathrm{a,max}}{u_\\mathrm{p,max}}$&quot;)</span>
<span class="c1">#        ax.set_ylabel(&quot;$u_\\mathrm{a,max}/u_\\mathrm{p,max}$&quot;)</span>
<span class="c1">#        ax.set_xlabel(&quot;$n_a=r_e/r_w$&quot;)</span>
    <span class="c1">#    ax.set_xscale(&quot;log&quot;)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Transition length (m)&quot;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;DAF&quot;</span><span class="p">)</span>

<span class="c1">#        ax.set_xlim(3.5, 4.5)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
        <span class="n">leg</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s2">&quot;$</span><span class="se">\\</span><span class="s2">alpha$&quot;</span><span class="p">,</span>
                        <span class="n">loc</span><span class="o">=</span><span class="s2">&quot;upper right&quot;</span><span class="p">,</span>
<span class="c1">#                        ncol=2,</span>
                        <span class="n">labelspacing</span><span class="o">=.</span><span class="mi">2</span><span class="p">,</span>
                        <span class="n">handlelength</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
                        <span class="n">fontsize</span><span class="o">=</span><span class="mi">8</span>
                        <span class="p">)</span>
        <span class="n">leg</span><span class="o">.</span><span class="n">draggable</span><span class="p">()</span>

        <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">labelpad</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">labelpad</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="n">fig</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">top</span><span class="o">=</span><span class="mf">0.95</span><span class="p">,</span> <span class="n">bottom</span><span class="o">=</span><span class="mf">0.13</span><span class="p">,</span> <span class="n">left</span><span class="o">=</span><span class="mf">0.14</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="mf">0.95</span><span class="p">)</span>




        <span class="n">end_time0</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
        <span class="n">elapsed_time</span> <span class="o">=</span> <span class="p">(</span><span class="n">end_time0</span> <span class="o">-</span> <span class="n">start_time0</span><span class="p">);</span> <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Total run time=</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">timedelta</span><span class="p">(</span><span class="n">seconds</span><span class="o">=</span><span class="n">elapsed_time</span><span class="p">))))</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;Total run time=</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">timedelta</span><span class="p">(</span><span class="n">seconds</span><span class="o">=</span><span class="n">elapsed_time</span><span class="p">)))</span> <span class="o">+</span> <span class="n">os</span><span class="o">.</span><span class="n">linesep</span><span class="p">)</span>
<span class="c1">#        a.animateme()</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">saveas</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">save_figure</span><span class="p">(</span><span class="n">fig</span><span class="o">=</span><span class="n">fig</span><span class="p">,</span> <span class="n">fname</span><span class="o">=</span><span class="n">saveas</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span></div>

<div class="viewcode-block" id="FIGURE_DAFwrtinf_transition_length"><a class="viewcode-back" href="../../../api/geotecha.beam_on_foundation.specbeam.html#geotecha.beam_on_foundation.specbeam.FIGURE_DAFwrtinf_transition_length">[docs]</a><span class="k">def</span> <span class="nf">FIGURE_DAFwrtinf_transition_length</span><span class="p">(</span><span class="n">saveas</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">k_ratio</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span><span class="n">beta</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span><span class="n">nterms</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span><span class="n">force_calc</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Dynamic amplification factor with rest to length of transition&quot;&quot;&quot;</span>

    <span class="c1">####</span>

    <span class="n">start_time0</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
    <span class="n">ftime</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">fromtimestamp</span><span class="p">(</span><span class="n">start_time0</span><span class="p">)</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s1">&#39;%Y-%m-</span><span class="si">%d</span><span class="s1"> %H%M%S&#39;</span><span class="p">)</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">ftime</span> <span class="o">+</span> <span class="s2">&quot;.txt&quot;</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">ftime</span> <span class="o">+</span> <span class="n">os</span><span class="o">.</span><span class="n">linesep</span><span class="p">)</span>

        <span class="n">matplotlib</span><span class="o">.</span><span class="n">rcParams</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s1">&#39;font.size&#39;</span><span class="p">:</span> <span class="mi">11</span><span class="p">})</span>
        <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mf">3.54</span><span class="p">,</span><span class="mf">3.54</span><span class="p">))</span>
        <span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="s2">&quot;111&quot;</span><span class="p">)</span>

        <span class="n">fig2</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mf">3.54</span><span class="p">,</span><span class="mf">3.54</span><span class="p">))</span>
        <span class="n">ax2</span> <span class="o">=</span> <span class="n">fig2</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="s2">&quot;111&quot;</span><span class="p">)</span>

        <span class="n">fig3</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mf">3.54</span><span class="p">,</span><span class="mf">3.54</span><span class="p">))</span>
        <span class="n">ax3</span> <span class="o">=</span> <span class="n">fig3</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="s2">&quot;111&quot;</span><span class="p">)</span>

        <span class="n">alphas</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.0001</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">,</span> <span class="mf">1.3</span><span class="p">]</span>
        <span class="n">t_lengths</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">25</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">6</span><span class="p">)</span>
        <span class="c1">#betas = [0, 0.05, 0.1, 0.3, 1.1, 2.0]</span>


        <span class="n">pdict</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">(</span>
                    <span class="n">E</span> <span class="o">=</span> <span class="mf">6.998</span><span class="o">*</span><span class="mf">1e9</span><span class="p">,</span> <span class="c1">#Pa</span>
                    <span class="n">rho</span> <span class="o">=</span> <span class="mi">2373</span><span class="p">,</span> <span class="c1">#kg/m3</span>
                    <span class="n">L</span> <span class="o">=</span> <span class="mi">200</span><span class="p">,</span><span class="c1">#160, #m</span>
                    <span class="n">A</span> <span class="o">=</span> <span class="mf">0.3</span><span class="o">*</span><span class="mf">0.1</span><span class="p">,</span> <span class="c1"># m^2</span>
                    <span class="n">I</span> <span class="o">=</span> <span class="mf">0.00022477900799999998</span><span class="p">,</span>
                    <span class="n">k1</span> <span class="o">=</span> <span class="mf">800002.6125</span><span class="p">,</span>

<span class="c1">#                    kf=5.41e-4,</span>
                    <span class="c1">#Fz_norm=1.013e-4,</span>
<span class="c1">#                    mu_norm=39.263/4/2/1000,</span>
<span class="c1">#                    mubar=PolyLine([0,0.05,0.05,.95,.95,1],[1,1,1,1,1,1]),</span>
<span class="c1">#                    k1_norm=97.552,</span>
    <span class="c1">#                k1bar=PolyLine([0,0.2,0.3,1],[1.0,1,0.1,0.1]),</span>
<span class="c1">#                    k1bar=PolyLine([0,0.2,0.2,1],[1.0,1,1,1]),</span>

    <span class="c1">#                k3_norm=2.497e6,</span>
                    <span class="n">nterms</span><span class="o">=</span><span class="n">nterms</span><span class="p">,</span>
                    <span class="n">BC</span><span class="o">=</span><span class="s2">&quot;SS&quot;</span><span class="p">,</span>
<span class="c1">#                    nquad=20,</span>
                    <span class="n">moving_loads_x_norm</span><span class="o">=</span><span class="p">[[</span><span class="mi">0</span><span class="p">]],</span>
                    <span class="n">moving_loads_Fz_norm</span><span class="o">=</span><span class="p">[[</span><span class="mf">1.013e-4</span><span class="p">]],</span>
<span class="c1">#                    moving_loads_v_norm=[v,],#[0.01165,],</span>
<span class="c1">#                    tvals=t,</span>
                    <span class="c1">#xvals_norm=np.linspace(0.15,0.85,100)</span>
                    <span class="n">use_analytical</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                    <span class="n">implementation</span><span class="o">=</span><span class="s2">&quot;fortran&quot;</span><span class="p">,</span>
                    <span class="n">force_calc</span><span class="o">=</span><span class="n">force_calc</span><span class="p">,</span>
                    <span class="p">)</span>


        <span class="n">zmax</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">alphas</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">t_lengths</span><span class="p">)),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
        <span class="n">zmin</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">alphas</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">t_lengths</span><span class="p">)),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>




        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">t_length</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">t_lengths</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="n">alpha</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">alphas</span><span class="p">):</span>

                <span class="n">start_time1</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>

                <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;*&quot;</span> <span class="o">*</span> <span class="mi">70</span> <span class="o">+</span> <span class="n">os</span><span class="o">.</span><span class="n">linesep</span><span class="p">)</span>
<span class="c1">#                vequals = &quot;{}={}&quot;.format(vstr, vfmt.format(v))</span>
                <span class="n">vequals</span> <span class="o">=</span> <span class="s2">&quot;alpha=</span><span class="si">{}</span><span class="s2">, t_len=</span><span class="si">{}</span><span class="s2">, k_ratio=</span><span class="si">{}</span><span class="s2">, beta=</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">alpha</span><span class="p">,</span> <span class="n">t_length</span><span class="p">,</span> <span class="n">k_ratio</span><span class="p">,</span> <span class="n">beta</span><span class="p">)</span>
                <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">vequals</span> <span class="o">+</span> <span class="n">os</span><span class="o">.</span><span class="n">linesep</span><span class="p">);</span> <span class="nb">print</span><span class="p">(</span><span class="n">vequals</span><span class="p">)</span>


                <span class="n">v_crit</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="o">/</span><span class="n">pdict</span><span class="p">[</span><span class="s2">&quot;rho&quot;</span><span class="p">]</span><span class="o">/</span><span class="n">pdict</span><span class="p">[</span><span class="s2">&quot;A&quot;</span><span class="p">]</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">pdict</span><span class="p">[</span><span class="s2">&quot;k1&quot;</span><span class="p">]</span><span class="o">*</span><span class="n">pdict</span><span class="p">[</span><span class="s2">&quot;E&quot;</span><span class="p">]</span><span class="o">*</span><span class="n">pdict</span><span class="p">[</span><span class="s2">&quot;I&quot;</span><span class="p">]))</span>
                <span class="n">v_raw</span> <span class="o">=</span> <span class="n">v_crit</span><span class="o">*</span><span class="n">alpha</span>

                <span class="n">c_crit</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">4</span><span class="o">*</span><span class="n">pdict</span><span class="p">[</span><span class="s2">&quot;rho&quot;</span><span class="p">]</span><span class="o">*</span><span class="n">pdict</span><span class="p">[</span><span class="s2">&quot;A&quot;</span><span class="p">]</span><span class="o">*</span><span class="n">pdict</span><span class="p">[</span><span class="s2">&quot;k1&quot;</span><span class="p">])</span>
                <span class="n">c_raw</span> <span class="o">=</span> <span class="n">c_crit</span><span class="o">*</span><span class="n">beta</span>

                <span class="n">tmax</span> <span class="o">=</span> <span class="n">pdict</span><span class="p">[</span><span class="s2">&quot;L&quot;</span><span class="p">]</span> <span class="o">/</span> <span class="n">v_raw</span>

                <span class="c1">#pdict[&quot;mubar&quot;] = PolyLine([0,0.1,0.9,1],[1/beta,1,1,1/beta])</span>
                <span class="c1">#pdict[&quot;mubar&quot;] = PolyLine([0,0.1,0.1,0.9,0.9,1],[1/beta,1/beta,1,1,1/beta,1/beta])</span>
                <span class="n">tran_start</span> <span class="o">=</span> <span class="mf">0.3</span>
                <span class="n">pdict</span><span class="p">[</span><span class="s2">&quot;mu&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">c_raw</span>
                <span class="n">pdict</span><span class="p">[</span><span class="s2">&quot;tvals&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">tmax</span><span class="o">*</span><span class="p">(</span><span class="n">tran_start</span><span class="o">-</span><span class="mf">0.1</span><span class="p">),</span><span class="n">tmax</span><span class="o">*</span><span class="p">(</span><span class="n">tran_start</span><span class="o">+</span><span class="n">t_length</span><span class="o">/</span><span class="n">pdict</span><span class="p">[</span><span class="s2">&quot;L&quot;</span><span class="p">]</span><span class="o">+</span><span class="mf">0.1</span><span class="p">),</span><span class="mi">200</span><span class="p">)</span>
                <span class="n">pdict</span><span class="p">[</span><span class="s2">&quot;xvals_norm&quot;</span><span class="p">]</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">tran_start</span><span class="o">-</span><span class="mf">0.1</span><span class="p">,</span><span class="n">tran_start</span><span class="o">+</span><span class="n">t_length</span><span class="o">/</span><span class="n">pdict</span><span class="p">[</span><span class="s2">&quot;L&quot;</span><span class="p">]</span><span class="o">+</span><span class="mf">0.1</span><span class="p">,</span><span class="mi">300</span><span class="p">)</span>
                <span class="n">pdict</span><span class="p">[</span><span class="s2">&quot;moving_loads_v_norm&quot;</span><span class="p">]</span><span class="o">=</span><span class="p">[</span><span class="n">v_raw</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">pdict</span><span class="p">[</span><span class="s2">&quot;rho&quot;</span><span class="p">]</span><span class="o">/</span><span class="n">pdict</span><span class="p">[</span><span class="s2">&quot;E&quot;</span><span class="p">])]</span>
                <span class="n">pdict</span><span class="p">[</span><span class="s2">&quot;file_stem&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;DAF_alp</span><span class="si">{:5.3f}</span><span class="s2">_bet</span><span class="si">{:5.3f}</span><span class="s2">_tlen</span><span class="si">{:5.3f}</span><span class="s2">_krat</span><span class="si">{:5.3f}</span><span class="s2">_n</span><span class="si">{:d}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">alpha</span><span class="p">,</span><span class="n">beta</span><span class="p">,</span><span class="n">t_length</span><span class="p">,</span><span class="n">k_ratio</span><span class="p">,</span><span class="n">nterms</span><span class="p">)</span>
                <span class="n">pdict</span><span class="p">[</span><span class="s2">&quot;k1bar&quot;</span><span class="p">]</span><span class="o">=</span><span class="n">PolyLine</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="n">tran_start</span><span class="p">,</span> <span class="n">tran_start</span><span class="o">+</span><span class="n">t_length</span><span class="o">/</span><span class="n">pdict</span><span class="p">[</span><span class="s2">&quot;L&quot;</span><span class="p">],</span><span class="mi">1</span><span class="p">],[</span><span class="mf">1.0</span><span class="p">,</span><span class="mf">1.0</span><span class="p">,</span><span class="n">k_ratio</span><span class="p">,</span><span class="n">k_ratio</span><span class="p">])</span> <span class="c1">#soft to stiff</span>
                <span class="n">pdict</span><span class="p">[</span><span class="s2">&quot;k1bar&quot;</span><span class="p">]</span><span class="o">=</span><span class="n">PolyLine</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="n">tran_start</span><span class="p">,</span> <span class="n">tran_start</span><span class="o">+</span><span class="n">t_length</span><span class="o">/</span><span class="n">pdict</span><span class="p">[</span><span class="s2">&quot;L&quot;</span><span class="p">],</span><span class="mi">1</span><span class="p">],[</span><span class="n">k_ratio</span><span class="p">,</span><span class="n">k_ratio</span><span class="p">,</span><span class="mf">1.0</span><span class="p">,</span><span class="mf">1.0</span><span class="p">])</span> <span class="c1">#stiff to soft</span>

                <span class="n">xstart</span> <span class="o">=</span> <span class="mf">0.0</span> <span class="c1">#start position on beam</span>
                <span class="n">xend</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="c1">#end position on beam</span>
                <span class="n">pdict</span><span class="p">[</span><span class="s2">&quot;tvals&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">tmax</span><span class="o">*</span><span class="p">(</span><span class="n">xend</span><span class="o">-</span><span class="n">xstart</span><span class="p">),</span> <span class="mi">200</span><span class="p">)</span>
                <span class="n">pdict</span><span class="p">[</span><span class="s2">&quot;moving_loads_x0_norm&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">xstart</span><span class="p">]</span>
                <span class="n">pdict</span><span class="p">[</span><span class="s2">&quot;moving_loads_L_norm&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">xend</span> <span class="o">-</span> <span class="n">xstart</span><span class="p">]</span>
                <span class="n">pdict</span><span class="p">[</span><span class="s2">&quot;xvals_norm&quot;</span><span class="p">]</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">xstart</span><span class="p">,</span><span class="n">xend</span><span class="p">,</span><span class="mi">200</span><span class="p">)</span>

                <span class="n">pdict</span><span class="p">[</span><span class="s2">&quot;tvals&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">tmax</span><span class="o">*</span><span class="mf">0.25</span><span class="p">,</span> <span class="n">tmax</span><span class="o">*</span><span class="mf">0.8</span><span class="p">,</span> <span class="mi">300</span><span class="p">)</span>
                <span class="n">pdict</span><span class="p">[</span><span class="s2">&quot;xvals_norm&quot;</span><span class="p">]</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.25</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">,</span> <span class="mi">300</span><span class="p">)</span>

                <span class="n">a</span> <span class="o">=</span> <span class="n">SpecBeam</span><span class="p">(</span><span class="o">**</span><span class="n">pdict</span><span class="p">)</span>
                <span class="n">a</span><span class="o">.</span><span class="n">runme</span><span class="p">()</span>
                <span class="n">a</span><span class="o">.</span><span class="n">saveme</span><span class="p">()</span>

                <span class="n">w_now_max</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">defl</span><span class="p">)</span>
                <span class="n">w_now_min</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">defl</span><span class="p">)</span>

                <span class="n">defl_max_envelope</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">defl</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
                <span class="n">defl_min_envelope</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">defl</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
                <span class="n">line</span><span class="p">,</span><span class="o">=</span><span class="n">ax3</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">pdict</span><span class="p">[</span><span class="s2">&quot;xvals_norm&quot;</span><span class="p">],</span><span class="n">defl_max_envelope</span><span class="p">,</span>
                         <span class="n">label</span><span class="o">=</span><span class="s2">&quot;$</span><span class="se">\\</span><span class="s2">alpha=</span><span class="si">{}</span><span class="s2">,\ tlen=</span><span class="si">{}</span><span class="s2">$&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">alpha</span><span class="p">,</span><span class="n">t_length</span><span class="p">))</span>
                <span class="n">ax3</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">pdict</span><span class="p">[</span><span class="s2">&quot;xvals_norm&quot;</span><span class="p">],</span><span class="n">defl_min_envelope</span><span class="p">,</span>
                         <span class="n">color</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">get_color</span><span class="p">(),</span>
                         <span class="p">)</span>
<span class="c1">#                if i==0:</span>
<span class="c1">#                    w_0 = w_now_max</span>
<span class="c1">#</span>
<span class="c1">#                DAF = w_now / w_0</span>

                <span class="n">zmax</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">w_now_max</span>
                <span class="n">zmin</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">w_now_min</span>



                <span class="n">end_time1</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
                <span class="n">elapsed_time</span> <span class="o">=</span> <span class="p">(</span><span class="n">end_time1</span> <span class="o">-</span> <span class="n">start_time1</span><span class="p">);</span> <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Run time=</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">timedelta</span><span class="p">(</span><span class="n">seconds</span><span class="o">=</span><span class="n">elapsed_time</span><span class="p">))))</span>

                <span class="k">if</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">i</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span><span class="c1">#i==0:#i==len(t_lengths)-1: #i is t_length counter,j is alpha counter</span>
                    <span class="n">a</span><span class="o">.</span><span class="n">animateme</span><span class="p">()</span>
<span class="c1">#                    print(&quot;******************&quot;,t_length,alpha, DAF)</span>
<span class="c1">#                    print(repr(z))</span>
        <span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="n">alpha</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">alphas</span><span class="p">):</span>
            <span class="n">x</span> <span class="o">=</span> <span class="n">t_lengths</span>
            <span class="n">y</span> <span class="o">=</span> <span class="n">zmax</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="p">:]</span> <span class="o">/</span> <span class="n">zmax</span><span class="p">[</span><span class="n">j</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span>
                    <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span>
                    <span class="n">label</span><span class="o">=</span><span class="s2">&quot;$</span><span class="si">{}</span><span class="s2">$&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">alpha</span><span class="p">))</span>
            <span class="n">y</span> <span class="o">=</span> <span class="n">zmin</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="p">:]</span> <span class="o">/</span> <span class="n">zmin</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
            <span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span>
                    <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;s&#39;</span><span class="p">,</span>
                    <span class="n">label</span><span class="o">=</span><span class="s2">&quot;$</span><span class="si">{}</span><span class="s2">$&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">alpha</span><span class="p">))</span>
        <span class="c1">#contourv = np.linspace(.1,10,10)</span>
<span class="c1">#        CS = ax.contour(alphas, t_lengths, z )</span>
 <span class="c1">#       ax.clabel(CS,inline=1,fontsize=8,fmt=&#39;%.1f&#39;)</span>

        <span class="n">adjust</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">top</span><span class="o">=</span><span class="mf">0.9</span><span class="p">,</span> <span class="n">bottom</span><span class="o">=</span><span class="mf">0.13</span><span class="p">,</span> <span class="n">left</span><span class="o">=</span><span class="mf">0.19</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="mf">0.95</span><span class="p">)</span>
        <span class="c1">###################</span>
        <span class="n">ax2</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;$</span><span class="se">\\</span><span class="s2">beta=</span><span class="si">{}</span><span class="s2">,k_1/k_2=</span><span class="si">{}</span><span class="s2">$&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">beta</span><span class="p">,</span> <span class="n">k_ratio</span><span class="p">))</span>
        <span class="n">ax2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Transition length (m)&quot;</span><span class="p">)</span>
        <span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;DAFup w.r.t. infinite&quot;</span><span class="p">)</span>
        <span class="n">ax2</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
        <span class="n">leg</span> <span class="o">=</span> <span class="n">ax2</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s2">&quot;$</span><span class="se">\\</span><span class="s2">alpha$&quot;</span><span class="p">,</span>
                        <span class="n">loc</span><span class="o">=</span><span class="s2">&quot;upper right&quot;</span><span class="p">,</span>
<span class="c1">#                        ncol=2,</span>
                        <span class="n">labelspacing</span><span class="o">=.</span><span class="mi">2</span><span class="p">,</span>
                        <span class="n">handlelength</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
                        <span class="n">fontsize</span><span class="o">=</span><span class="mi">8</span>
                        <span class="p">)</span>
        <span class="n">leg</span><span class="o">.</span><span class="n">draggable</span><span class="p">()</span>
        <span class="n">ax2</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">labelpad</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
        <span class="n">ax2</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">labelpad</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">fig2</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="o">**</span><span class="n">adjust</span><span class="p">)</span>
        <span class="c1">####################</span>

        <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;$</span><span class="se">\\</span><span class="s2">beta=</span><span class="si">{}</span><span class="s2">,kratio=</span><span class="si">{}</span><span class="s2">$&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">beta</span><span class="p">,</span> <span class="n">k_ratio</span><span class="p">))</span>
<span class="c1">#        ax.set_xlim(0,25)</span>
<span class="c1">#        ax.set_ylim(0,12)</span>
        <span class="c1">#ax.xaxis.label.set_fontsize(30)</span>
        <span class="c1">#ax.yaxis.label.set_fontsize(30)</span>
        <span class="c1">#ax.set_ylabel(&quot;$\\frac{u_\\mathrm{a,max}}{u_\\mathrm{p,max}}$&quot;)</span>
<span class="c1">#        ax.set_ylabel(&quot;$u_\\mathrm{a,max}/u_\\mathrm{p,max}$&quot;)</span>
<span class="c1">#        ax.set_xlabel(&quot;$n_a=r_e/r_w$&quot;)</span>
    <span class="c1">#    ax.set_xscale(&quot;log&quot;)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Transition length (m)&quot;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;DAF w.r.t. infinite&quot;</span><span class="p">)</span>

<span class="c1">#        ax.set_xlim(3.5, 4.5)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
        <span class="n">leg</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s2">&quot;$</span><span class="se">\\</span><span class="s2">alpha$&quot;</span><span class="p">,</span>
                        <span class="n">loc</span><span class="o">=</span><span class="s2">&quot;upper right&quot;</span><span class="p">,</span>
<span class="c1">#                        ncol=2,</span>
                        <span class="n">labelspacing</span><span class="o">=.</span><span class="mi">2</span><span class="p">,</span>
                        <span class="n">handlelength</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
                        <span class="n">fontsize</span><span class="o">=</span><span class="mi">8</span>
                        <span class="p">)</span>
        <span class="n">leg</span><span class="o">.</span><span class="n">draggable</span><span class="p">()</span>

        <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">labelpad</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">labelpad</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="n">fig</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="o">**</span><span class="n">adjust</span><span class="p">)</span>




        <span class="n">end_time0</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
        <span class="n">elapsed_time</span> <span class="o">=</span> <span class="p">(</span><span class="n">end_time0</span> <span class="o">-</span> <span class="n">start_time0</span><span class="p">);</span> <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Total run time=</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">timedelta</span><span class="p">(</span><span class="n">seconds</span><span class="o">=</span><span class="n">elapsed_time</span><span class="p">))))</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;Total run time=</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">timedelta</span><span class="p">(</span><span class="n">seconds</span><span class="o">=</span><span class="n">elapsed_time</span><span class="p">)))</span> <span class="o">+</span> <span class="n">os</span><span class="o">.</span><span class="n">linesep</span><span class="p">)</span>
<span class="c1">#        a.animateme()</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">saveas</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">save_figure</span><span class="p">(</span><span class="n">fig</span><span class="o">=</span><span class="n">fig</span><span class="p">,</span> <span class="n">fname</span><span class="o">=</span><span class="n">saveas</span><span class="p">)</span>
        <span class="n">save_figure</span><span class="p">(</span><span class="n">fig</span><span class="o">=</span><span class="n">fig2</span><span class="p">,</span> <span class="n">fname</span><span class="o">=</span><span class="n">saveas</span> <span class="o">+</span> <span class="s2">&quot;_up&quot;</span><span class="p">)</span>

<span class="c1">#    plt.show()</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">clf</span><span class="p">()</span>
    <span class="n">fig2</span><span class="o">.</span><span class="n">clf</span><span class="p">()</span></div>

<div class="viewcode-block" id="FIGURE_DAFwrtinf_transition_lengthrev"><a class="viewcode-back" href="../../../api/geotecha.beam_on_foundation.specbeam.html#geotecha.beam_on_foundation.specbeam.FIGURE_DAFwrtinf_transition_lengthrev">[docs]</a><span class="k">def</span> <span class="nf">FIGURE_DAFwrtinf_transition_lengthrev</span><span class="p">(</span><span class="n">saveas</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">k_ratio</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span><span class="n">beta</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span><span class="n">nterms</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span><span class="n">force_calc</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Dynamic amplification factor with rest to length of transition&quot;&quot;&quot;</span>


    <span class="n">start_time0</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
    <span class="n">ftime</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">fromtimestamp</span><span class="p">(</span><span class="n">start_time0</span><span class="p">)</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s1">&#39;%Y-%m-</span><span class="si">%d</span><span class="s1"> %H%M%S&#39;</span><span class="p">)</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">ftime</span> <span class="o">+</span> <span class="s2">&quot;.txt&quot;</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">ftime</span> <span class="o">+</span> <span class="n">os</span><span class="o">.</span><span class="n">linesep</span><span class="p">)</span>

        <span class="n">matplotlib</span><span class="o">.</span><span class="n">rcParams</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s1">&#39;font.size&#39;</span><span class="p">:</span> <span class="mi">11</span><span class="p">})</span>
        <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mf">3.54</span><span class="p">,</span><span class="mf">3.54</span><span class="p">))</span>
        <span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="s2">&quot;111&quot;</span><span class="p">)</span>

        <span class="n">fig2</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mf">3.54</span><span class="p">,</span><span class="mf">3.54</span><span class="p">))</span>
        <span class="n">ax2</span> <span class="o">=</span> <span class="n">fig2</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="s2">&quot;111&quot;</span><span class="p">)</span>

        <span class="n">fig3</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mf">3.54</span><span class="p">,</span><span class="mf">3.54</span><span class="p">))</span>
        <span class="n">ax3</span> <span class="o">=</span> <span class="n">fig3</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="s2">&quot;111&quot;</span><span class="p">)</span>

        <span class="n">alphas</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.0001</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">,</span> <span class="mf">1.3</span><span class="p">]</span>
        <span class="n">t_lengths</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">25</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">6</span><span class="p">)</span>
        <span class="c1">#betas = [0, 0.05, 0.1, 0.3, 1.1, 2.0]</span>


        <span class="n">pdict</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">(</span>
                    <span class="n">E</span> <span class="o">=</span> <span class="mf">6.998</span><span class="o">*</span><span class="mf">1e9</span><span class="p">,</span> <span class="c1">#Pa</span>
                    <span class="n">rho</span> <span class="o">=</span> <span class="mi">2373</span><span class="p">,</span> <span class="c1">#kg/m3</span>
                    <span class="n">L</span> <span class="o">=</span> <span class="mi">200</span><span class="p">,</span><span class="c1">#160, #m</span>
                    <span class="n">A</span> <span class="o">=</span> <span class="mf">0.3</span><span class="o">*</span><span class="mf">0.1</span><span class="p">,</span> <span class="c1"># m^2</span>
                    <span class="n">I</span> <span class="o">=</span> <span class="mf">0.00022477900799999998</span><span class="p">,</span>
                    <span class="n">k1</span> <span class="o">=</span> <span class="mf">800002.6125</span><span class="p">,</span>

<span class="c1">#                    kf=5.41e-4,</span>
                    <span class="c1">#Fz_norm=1.013e-4,</span>
<span class="c1">#                    mu_norm=39.263/4/2/1000,</span>
<span class="c1">#                    mubar=PolyLine([0,0.05,0.05,.95,.95,1],[1,1,1,1,1,1]),</span>
<span class="c1">#                    k1_norm=97.552,</span>
    <span class="c1">#                k1bar=PolyLine([0,0.2,0.3,1],[1.0,1,0.1,0.1]),</span>
<span class="c1">#                    k1bar=PolyLine([0,0.2,0.2,1],[1.0,1,1,1]),</span>

    <span class="c1">#                k3_norm=2.497e6,</span>
                    <span class="n">nterms</span><span class="o">=</span><span class="n">nterms</span><span class="p">,</span>
                    <span class="n">BC</span><span class="o">=</span><span class="s2">&quot;SS&quot;</span><span class="p">,</span>
<span class="c1">#                    nquad=20,</span>
                    <span class="n">moving_loads_x_norm</span><span class="o">=</span><span class="p">[[</span><span class="mi">0</span><span class="p">]],</span>
                    <span class="n">moving_loads_Fz_norm</span><span class="o">=</span><span class="p">[[</span><span class="mf">1.013e-4</span><span class="p">]],</span>
<span class="c1">#                    moving_loads_v_norm=[v,],#[0.01165,],</span>
<span class="c1">#                    tvals=t,</span>
                    <span class="c1">#xvals_norm=np.linspace(0.15,0.85,100)</span>
                    <span class="n">use_analytical</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                    <span class="n">implementation</span><span class="o">=</span><span class="s2">&quot;fortran&quot;</span><span class="p">,</span>
                    <span class="n">force_calc</span><span class="o">=</span><span class="n">force_calc</span><span class="p">,</span>
                    <span class="p">)</span>


        <span class="n">zmax</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">alphas</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">t_lengths</span><span class="p">)),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
        <span class="n">zmin</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">alphas</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">t_lengths</span><span class="p">)),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>




        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">t_length</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">t_lengths</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="n">alpha</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">alphas</span><span class="p">):</span>

                <span class="n">start_time1</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>

                <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;*&quot;</span> <span class="o">*</span> <span class="mi">70</span> <span class="o">+</span> <span class="n">os</span><span class="o">.</span><span class="n">linesep</span><span class="p">)</span>
<span class="c1">#                vequals = &quot;{}={}&quot;.format(vstr, vfmt.format(v))</span>
                <span class="n">vequals</span> <span class="o">=</span> <span class="s2">&quot;alpha=</span><span class="si">{}</span><span class="s2">, t_len=</span><span class="si">{}</span><span class="s2">, k_ratio=</span><span class="si">{}</span><span class="s2">, beta=</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">alpha</span><span class="p">,</span> <span class="n">t_length</span><span class="p">,</span> <span class="n">k_ratio</span><span class="p">,</span> <span class="n">beta</span><span class="p">)</span>
                <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">vequals</span> <span class="o">+</span> <span class="n">os</span><span class="o">.</span><span class="n">linesep</span><span class="p">);</span> <span class="nb">print</span><span class="p">(</span><span class="n">vequals</span><span class="p">)</span>


                <span class="n">v_crit</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="o">/</span><span class="n">pdict</span><span class="p">[</span><span class="s2">&quot;rho&quot;</span><span class="p">]</span><span class="o">/</span><span class="n">pdict</span><span class="p">[</span><span class="s2">&quot;A&quot;</span><span class="p">]</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">pdict</span><span class="p">[</span><span class="s2">&quot;k1&quot;</span><span class="p">]</span><span class="o">*</span><span class="n">pdict</span><span class="p">[</span><span class="s2">&quot;E&quot;</span><span class="p">]</span><span class="o">*</span><span class="n">pdict</span><span class="p">[</span><span class="s2">&quot;I&quot;</span><span class="p">]))</span>
                <span class="n">v_raw</span> <span class="o">=</span> <span class="n">v_crit</span><span class="o">*</span><span class="n">alpha</span>

                <span class="n">c_crit</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">4</span><span class="o">*</span><span class="n">pdict</span><span class="p">[</span><span class="s2">&quot;rho&quot;</span><span class="p">]</span><span class="o">*</span><span class="n">pdict</span><span class="p">[</span><span class="s2">&quot;A&quot;</span><span class="p">]</span><span class="o">*</span><span class="n">pdict</span><span class="p">[</span><span class="s2">&quot;k1&quot;</span><span class="p">])</span>
                <span class="n">c_raw</span> <span class="o">=</span> <span class="n">c_crit</span><span class="o">*</span><span class="n">beta</span>

                <span class="n">tmax</span> <span class="o">=</span> <span class="n">pdict</span><span class="p">[</span><span class="s2">&quot;L&quot;</span><span class="p">]</span> <span class="o">/</span> <span class="n">v_raw</span>

                <span class="c1">#pdict[&quot;mubar&quot;] = PolyLine([0,0.1,0.9,1],[1/beta,1,1,1/beta])</span>
                <span class="c1">#pdict[&quot;mubar&quot;] = PolyLine([0,0.1,0.1,0.9,0.9,1],[1/beta,1/beta,1,1,1/beta,1/beta])</span>
                <span class="n">tran_start</span> <span class="o">=</span> <span class="mf">0.6</span>
                <span class="n">pdict</span><span class="p">[</span><span class="s2">&quot;mu&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">c_raw</span>
                <span class="n">pdict</span><span class="p">[</span><span class="s2">&quot;tvals&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">tmax</span><span class="o">*</span><span class="p">(</span><span class="n">tran_start</span><span class="o">-</span><span class="mf">0.1</span><span class="p">),</span><span class="n">tmax</span><span class="o">*</span><span class="p">(</span><span class="n">tran_start</span><span class="o">+</span><span class="n">t_length</span><span class="o">/</span><span class="n">pdict</span><span class="p">[</span><span class="s2">&quot;L&quot;</span><span class="p">]</span><span class="o">+</span><span class="mf">0.1</span><span class="p">),</span><span class="mi">200</span><span class="p">)</span>
                <span class="n">pdict</span><span class="p">[</span><span class="s2">&quot;xvals_norm&quot;</span><span class="p">]</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">tran_start</span><span class="o">-</span><span class="mf">0.1</span><span class="p">,</span><span class="n">tran_start</span><span class="o">+</span><span class="n">t_length</span><span class="o">/</span><span class="n">pdict</span><span class="p">[</span><span class="s2">&quot;L&quot;</span><span class="p">]</span><span class="o">+</span><span class="mf">0.1</span><span class="p">,</span><span class="mi">300</span><span class="p">)</span>
                <span class="n">pdict</span><span class="p">[</span><span class="s2">&quot;moving_loads_v_norm&quot;</span><span class="p">]</span><span class="o">=</span><span class="p">[</span><span class="n">v_raw</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">pdict</span><span class="p">[</span><span class="s2">&quot;rho&quot;</span><span class="p">]</span><span class="o">/</span><span class="n">pdict</span><span class="p">[</span><span class="s2">&quot;E&quot;</span><span class="p">])]</span>
                <span class="n">pdict</span><span class="p">[</span><span class="s2">&quot;file_stem&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;revDAF_alp</span><span class="si">{:5.3f}</span><span class="s2">_bet</span><span class="si">{:5.3f}</span><span class="s2">_tlen</span><span class="si">{:5.3f}</span><span class="s2">_krat</span><span class="si">{:5.3f}</span><span class="s2">_n</span><span class="si">{:d}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">alpha</span><span class="p">,</span><span class="n">beta</span><span class="p">,</span><span class="n">t_length</span><span class="p">,</span><span class="n">k_ratio</span><span class="p">,</span><span class="n">nterms</span><span class="p">)</span>
                <span class="n">pdict</span><span class="p">[</span><span class="s2">&quot;k1bar&quot;</span><span class="p">]</span><span class="o">=</span><span class="n">PolyLine</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="n">tran_start</span><span class="p">,</span> <span class="n">tran_start</span><span class="o">+</span><span class="n">t_length</span><span class="o">/</span><span class="n">pdict</span><span class="p">[</span><span class="s2">&quot;L&quot;</span><span class="p">],</span><span class="mi">1</span><span class="p">],[</span><span class="mf">1.0</span><span class="p">,</span><span class="mf">1.0</span><span class="p">,</span><span class="n">k_ratio</span><span class="p">,</span><span class="n">k_ratio</span><span class="p">])</span> <span class="c1">#soft to stiff</span>
<span class="c1">#                pdict[&quot;k1bar&quot;]=PolyLine([0, tran_start, tran_start+t_length/pdict[&quot;L&quot;],1],[k_ratio,k_ratio,1.0,1.0])#stiff to soft</span>

                <span class="n">xstart</span> <span class="o">=</span> <span class="mf">0.0</span> <span class="c1">#start position on beam</span>
                <span class="n">xend</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="c1">#end position on beam</span>
                <span class="n">pdict</span><span class="p">[</span><span class="s2">&quot;tvals&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">tmax</span><span class="o">*</span><span class="p">(</span><span class="n">xend</span><span class="o">-</span><span class="n">xstart</span><span class="p">),</span> <span class="mi">200</span><span class="p">)</span>
                <span class="n">pdict</span><span class="p">[</span><span class="s2">&quot;moving_loads_x0_norm&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">xstart</span><span class="p">]</span>
                <span class="n">pdict</span><span class="p">[</span><span class="s2">&quot;moving_loads_L_norm&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">xend</span> <span class="o">-</span> <span class="n">xstart</span><span class="p">]</span>
                <span class="n">pdict</span><span class="p">[</span><span class="s2">&quot;xvals_norm&quot;</span><span class="p">]</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">xstart</span><span class="p">,</span><span class="n">xend</span><span class="p">,</span><span class="mi">200</span><span class="p">)</span>

                <span class="n">pdict</span><span class="p">[</span><span class="s2">&quot;tvals&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">tmax</span><span class="o">*</span><span class="mf">0.25</span><span class="p">,</span> <span class="n">tmax</span><span class="o">*</span><span class="mf">0.8</span><span class="p">,</span> <span class="mi">300</span><span class="p">)</span>
                <span class="n">pdict</span><span class="p">[</span><span class="s2">&quot;xvals_norm&quot;</span><span class="p">]</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.25</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">,</span> <span class="mi">300</span><span class="p">)</span>

                <span class="n">a</span> <span class="o">=</span> <span class="n">SpecBeam</span><span class="p">(</span><span class="o">**</span><span class="n">pdict</span><span class="p">)</span>
                <span class="n">a</span><span class="o">.</span><span class="n">runme</span><span class="p">()</span>
                <span class="n">a</span><span class="o">.</span><span class="n">saveme</span><span class="p">()</span>

                <span class="n">w_now_max</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">defl</span><span class="p">)</span>
                <span class="n">w_now_min</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">defl</span><span class="p">)</span>

                <span class="n">defl_max_envelope</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">defl</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
                <span class="n">defl_min_envelope</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">defl</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
                <span class="n">line</span><span class="p">,</span><span class="o">=</span><span class="n">ax3</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">pdict</span><span class="p">[</span><span class="s2">&quot;xvals_norm&quot;</span><span class="p">],</span><span class="n">defl_max_envelope</span><span class="p">,</span>
                         <span class="n">label</span><span class="o">=</span><span class="s2">&quot;$</span><span class="se">\\</span><span class="s2">alpha=</span><span class="si">{}</span><span class="s2">,\ tlen=</span><span class="si">{}</span><span class="s2">$&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">alpha</span><span class="p">,</span><span class="n">t_length</span><span class="p">))</span>
                <span class="n">ax3</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">pdict</span><span class="p">[</span><span class="s2">&quot;xvals_norm&quot;</span><span class="p">],</span><span class="n">defl_min_envelope</span><span class="p">,</span>
                         <span class="n">color</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">get_color</span><span class="p">(),</span>
                         <span class="p">)</span>
<span class="c1">#                if i==0:</span>
<span class="c1">#                    w_0 = w_now_max</span>
<span class="c1">#</span>
<span class="c1">#                DAF = w_now / w_0</span>

                <span class="n">zmax</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">w_now_max</span>
                <span class="n">zmin</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">w_now_min</span>



                <span class="n">end_time1</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
                <span class="n">elapsed_time</span> <span class="o">=</span> <span class="p">(</span><span class="n">end_time1</span> <span class="o">-</span> <span class="n">start_time1</span><span class="p">);</span> <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Run time=</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">timedelta</span><span class="p">(</span><span class="n">seconds</span><span class="o">=</span><span class="n">elapsed_time</span><span class="p">))))</span>

                <span class="k">if</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">i</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span><span class="c1">#i==0:#i==len(t_lengths)-1: #i is t_length counter,j is alpha counter</span>
                    <span class="n">a</span><span class="o">.</span><span class="n">animateme</span><span class="p">()</span>
<span class="c1">#                    print(&quot;******************&quot;,t_length,alpha, DAF)</span>
<span class="c1">#                    print(repr(z))</span>
        <span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="n">alpha</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">alphas</span><span class="p">):</span>
            <span class="n">x</span> <span class="o">=</span> <span class="n">t_lengths</span>
            <span class="n">y</span> <span class="o">=</span> <span class="n">zmax</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="p">:]</span> <span class="o">/</span> <span class="n">zmax</span><span class="p">[</span><span class="n">j</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span>
                    <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span>
                    <span class="n">label</span><span class="o">=</span><span class="s2">&quot;$</span><span class="si">{}</span><span class="s2">$&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">alpha</span><span class="p">))</span>
            <span class="n">y</span> <span class="o">=</span> <span class="n">zmin</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="p">:]</span> <span class="o">/</span> <span class="n">zmin</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
            <span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span>
                    <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;s&#39;</span><span class="p">,</span>
                    <span class="n">label</span><span class="o">=</span><span class="s2">&quot;$</span><span class="si">{}</span><span class="s2">$&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">alpha</span><span class="p">))</span>
        <span class="c1">#contourv = np.linspace(.1,10,10)</span>
<span class="c1">#        CS = ax.contour(alphas, t_lengths, z )</span>
 <span class="c1">#       ax.clabel(CS,inline=1,fontsize=8,fmt=&#39;%.1f&#39;)</span>

        <span class="n">adjust</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">top</span><span class="o">=</span><span class="mf">0.9</span><span class="p">,</span> <span class="n">bottom</span><span class="o">=</span><span class="mf">0.13</span><span class="p">,</span> <span class="n">left</span><span class="o">=</span><span class="mf">0.19</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="mf">0.95</span><span class="p">)</span>
        <span class="c1">###################</span>
        <span class="n">ax2</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;$</span><span class="se">\\</span><span class="s2">beta=</span><span class="si">{}</span><span class="s2">,k_1/k_2=</span><span class="si">{}</span><span class="s2">$&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">beta</span><span class="p">,</span> <span class="n">k_ratio</span><span class="p">))</span>
        <span class="n">ax2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Transition length (m)&quot;</span><span class="p">)</span>
        <span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;DAFup w.r.t. infinite&quot;</span><span class="p">)</span>
        <span class="n">ax2</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
        <span class="n">leg</span> <span class="o">=</span> <span class="n">ax2</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s2">&quot;$</span><span class="se">\\</span><span class="s2">alpha$&quot;</span><span class="p">,</span>
                        <span class="n">loc</span><span class="o">=</span><span class="s2">&quot;upper right&quot;</span><span class="p">,</span>
<span class="c1">#                        ncol=2,</span>
                        <span class="n">labelspacing</span><span class="o">=.</span><span class="mi">2</span><span class="p">,</span>
                        <span class="n">handlelength</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
                        <span class="n">fontsize</span><span class="o">=</span><span class="mi">8</span>
                        <span class="p">)</span>
        <span class="n">leg</span><span class="o">.</span><span class="n">draggable</span><span class="p">()</span>
        <span class="n">ax2</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">labelpad</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
        <span class="n">ax2</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">labelpad</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">fig2</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="o">**</span><span class="n">adjust</span><span class="p">)</span>
        <span class="c1">####################</span>

        <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;$</span><span class="se">\\</span><span class="s2">beta=</span><span class="si">{}</span><span class="s2">,kratio=</span><span class="si">{}</span><span class="s2">$&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">beta</span><span class="p">,</span> <span class="n">k_ratio</span><span class="p">))</span>
<span class="c1">#        ax.set_xlim(0,25)</span>
<span class="c1">#        ax.set_ylim(0,12)</span>
        <span class="c1">#ax.xaxis.label.set_fontsize(30)</span>
        <span class="c1">#ax.yaxis.label.set_fontsize(30)</span>
        <span class="c1">#ax.set_ylabel(&quot;$\\frac{u_\\mathrm{a,max}}{u_\\mathrm{p,max}}$&quot;)</span>
<span class="c1">#        ax.set_ylabel(&quot;$u_\\mathrm{a,max}/u_\\mathrm{p,max}$&quot;)</span>
<span class="c1">#        ax.set_xlabel(&quot;$n_a=r_e/r_w$&quot;)</span>
    <span class="c1">#    ax.set_xscale(&quot;log&quot;)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Transition length (m)&quot;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;DAF w.r.t. infinite&quot;</span><span class="p">)</span>

<span class="c1">#        ax.set_xlim(3.5, 4.5)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
        <span class="n">leg</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s2">&quot;$</span><span class="se">\\</span><span class="s2">alpha$&quot;</span><span class="p">,</span>
                        <span class="n">loc</span><span class="o">=</span><span class="s2">&quot;upper right&quot;</span><span class="p">,</span>
<span class="c1">#                        ncol=2,</span>
                        <span class="n">labelspacing</span><span class="o">=.</span><span class="mi">2</span><span class="p">,</span>
                        <span class="n">handlelength</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
                        <span class="n">fontsize</span><span class="o">=</span><span class="mi">8</span>
                        <span class="p">)</span>
        <span class="n">leg</span><span class="o">.</span><span class="n">draggable</span><span class="p">()</span>

        <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">labelpad</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">labelpad</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="n">fig</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="o">**</span><span class="n">adjust</span><span class="p">)</span>




        <span class="n">end_time0</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
        <span class="n">elapsed_time</span> <span class="o">=</span> <span class="p">(</span><span class="n">end_time0</span> <span class="o">-</span> <span class="n">start_time0</span><span class="p">);</span> <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Total run time=</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">timedelta</span><span class="p">(</span><span class="n">seconds</span><span class="o">=</span><span class="n">elapsed_time</span><span class="p">))))</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;Total run time=</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">timedelta</span><span class="p">(</span><span class="n">seconds</span><span class="o">=</span><span class="n">elapsed_time</span><span class="p">)))</span> <span class="o">+</span> <span class="n">os</span><span class="o">.</span><span class="n">linesep</span><span class="p">)</span>
<span class="c1">#        a.animateme()</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">saveas</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">save_figure</span><span class="p">(</span><span class="n">fig</span><span class="o">=</span><span class="n">fig</span><span class="p">,</span> <span class="n">fname</span><span class="o">=</span><span class="n">saveas</span><span class="p">)</span>
        <span class="n">save_figure</span><span class="p">(</span><span class="n">fig</span><span class="o">=</span><span class="n">fig2</span><span class="p">,</span> <span class="n">fname</span><span class="o">=</span><span class="n">saveas</span> <span class="o">+</span> <span class="s2">&quot;_up&quot;</span><span class="p">)</span>

<span class="c1">#    plt.show()</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">clf</span><span class="p">()</span>
    <span class="n">fig2</span><span class="o">.</span><span class="n">clf</span><span class="p">()</span></div>

<div class="viewcode-block" id="FIGURE_DAFwrtinf_transition_length_betaconst"><a class="viewcode-back" href="../../../api/geotecha.beam_on_foundation.specbeam.html#geotecha.beam_on_foundation.specbeam.FIGURE_DAFwrtinf_transition_length_betaconst">[docs]</a><span class="k">def</span> <span class="nf">FIGURE_DAFwrtinf_transition_length_betaconst</span><span class="p">(</span><span class="n">saveas</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">k_ratio</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span><span class="n">beta</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span><span class="n">nterms</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span><span class="n">force_calc</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Dynamic amplification factor with rest to length of transition with</span>
<span class="sd">    beta term constant&quot;&quot;&quot;</span>

    <span class="c1">####</span>

    <span class="n">start_time0</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
    <span class="n">ftime</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">fromtimestamp</span><span class="p">(</span><span class="n">start_time0</span><span class="p">)</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s1">&#39;%Y-%m-</span><span class="si">%d</span><span class="s1"> %H%M%S&#39;</span><span class="p">)</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">ftime</span> <span class="o">+</span> <span class="s2">&quot;.txt&quot;</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">ftime</span> <span class="o">+</span> <span class="n">os</span><span class="o">.</span><span class="n">linesep</span><span class="p">)</span>

        <span class="n">matplotlib</span><span class="o">.</span><span class="n">rcParams</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s1">&#39;font.size&#39;</span><span class="p">:</span> <span class="mi">11</span><span class="p">})</span>
        <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mf">3.54</span><span class="p">,</span><span class="mf">3.54</span><span class="p">))</span>
        <span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="s2">&quot;111&quot;</span><span class="p">)</span>

        <span class="n">fig2</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mf">3.54</span><span class="p">,</span><span class="mf">3.54</span><span class="p">))</span>
        <span class="n">ax2</span> <span class="o">=</span> <span class="n">fig2</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="s2">&quot;111&quot;</span><span class="p">)</span>

        <span class="n">fig3</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mf">3.54</span><span class="p">,</span><span class="mf">3.54</span><span class="p">))</span>
        <span class="n">ax3</span> <span class="o">=</span> <span class="n">fig3</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="s2">&quot;111&quot;</span><span class="p">)</span>

        <span class="n">alphas</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.0001</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">,</span> <span class="mf">1.3</span><span class="p">]</span>
        <span class="n">t_lengths</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">25</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">6</span><span class="p">)</span>
        <span class="c1">#betas = [0, 0.05, 0.1, 0.3, 1.1, 2.0]</span>


        <span class="n">pdict</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">(</span>
                    <span class="n">E</span> <span class="o">=</span> <span class="mf">6.998</span><span class="o">*</span><span class="mf">1e9</span><span class="p">,</span> <span class="c1">#Pa</span>
                    <span class="n">rho</span> <span class="o">=</span> <span class="mi">2373</span><span class="p">,</span> <span class="c1">#kg/m3</span>
                    <span class="n">L</span> <span class="o">=</span> <span class="mi">200</span><span class="p">,</span><span class="c1">#160, #m</span>
                    <span class="n">A</span> <span class="o">=</span> <span class="mf">0.3</span><span class="o">*</span><span class="mf">0.1</span><span class="p">,</span> <span class="c1"># m^2</span>
                    <span class="n">I</span> <span class="o">=</span> <span class="mf">0.00022477900799999998</span><span class="p">,</span>
                    <span class="n">k1</span> <span class="o">=</span> <span class="mf">800002.6125</span><span class="p">,</span>

<span class="c1">#                    kf=5.41e-4,</span>
                    <span class="c1">#Fz_norm=1.013e-4,</span>
<span class="c1">#                    mu_norm=39.263/4/2/1000,</span>
<span class="c1">#                    mubar=PolyLine([0,0.05,0.05,.95,.95,1],[1,1,1,1,1,1]),</span>
<span class="c1">#                    k1_norm=97.552,</span>
    <span class="c1">#                k1bar=PolyLine([0,0.2,0.3,1],[1.0,1,0.1,0.1]),</span>
<span class="c1">#                    k1bar=PolyLine([0,0.2,0.2,1],[1.0,1,1,1]),</span>

    <span class="c1">#                k3_norm=2.497e6,</span>
                    <span class="n">nterms</span><span class="o">=</span><span class="n">nterms</span><span class="p">,</span>
                    <span class="n">BC</span><span class="o">=</span><span class="s2">&quot;SS&quot;</span><span class="p">,</span>
<span class="c1">#                    nquad=20,</span>
                    <span class="n">moving_loads_x_norm</span><span class="o">=</span><span class="p">[[</span><span class="mi">0</span><span class="p">]],</span>
                    <span class="n">moving_loads_Fz_norm</span><span class="o">=</span><span class="p">[[</span><span class="mf">1.013e-4</span><span class="p">]],</span>
<span class="c1">#                    moving_loads_v_norm=[v,],#[0.01165,],</span>
<span class="c1">#                    tvals=t,</span>
                    <span class="c1">#xvals_norm=np.linspace(0.15,0.85,100)</span>
                    <span class="n">use_analytical</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                    <span class="n">implementation</span><span class="o">=</span><span class="s2">&quot;fortran&quot;</span><span class="p">,</span>
                    <span class="n">force_calc</span><span class="o">=</span><span class="n">force_calc</span><span class="p">,</span>
                    <span class="p">)</span>


        <span class="n">zmax</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">alphas</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">t_lengths</span><span class="p">)),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
        <span class="n">zmin</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">alphas</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">t_lengths</span><span class="p">)),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>




        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">t_length</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">t_lengths</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="n">alpha</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">alphas</span><span class="p">):</span>

                <span class="n">start_time1</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>

                <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;*&quot;</span> <span class="o">*</span> <span class="mi">70</span> <span class="o">+</span> <span class="n">os</span><span class="o">.</span><span class="n">linesep</span><span class="p">)</span>
<span class="c1">#                vequals = &quot;{}={}&quot;.format(vstr, vfmt.format(v))</span>
                <span class="n">vequals</span> <span class="o">=</span> <span class="s2">&quot;alpha=</span><span class="si">{}</span><span class="s2">, t_len=</span><span class="si">{}</span><span class="s2">, k_ratio=</span><span class="si">{}</span><span class="s2">, beta=</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">alpha</span><span class="p">,</span> <span class="n">t_length</span><span class="p">,</span> <span class="n">k_ratio</span><span class="p">,</span> <span class="n">beta</span><span class="p">)</span>
                <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">vequals</span> <span class="o">+</span> <span class="n">os</span><span class="o">.</span><span class="n">linesep</span><span class="p">);</span> <span class="nb">print</span><span class="p">(</span><span class="n">vequals</span><span class="p">)</span>


                <span class="n">v_crit</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="o">/</span><span class="n">pdict</span><span class="p">[</span><span class="s2">&quot;rho&quot;</span><span class="p">]</span><span class="o">/</span><span class="n">pdict</span><span class="p">[</span><span class="s2">&quot;A&quot;</span><span class="p">]</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">pdict</span><span class="p">[</span><span class="s2">&quot;k1&quot;</span><span class="p">]</span><span class="o">*</span><span class="n">pdict</span><span class="p">[</span><span class="s2">&quot;E&quot;</span><span class="p">]</span><span class="o">*</span><span class="n">pdict</span><span class="p">[</span><span class="s2">&quot;I&quot;</span><span class="p">]))</span>
                <span class="n">v_raw</span> <span class="o">=</span> <span class="n">v_crit</span><span class="o">*</span><span class="n">alpha</span>

                <span class="n">c_crit</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">4</span><span class="o">*</span><span class="n">pdict</span><span class="p">[</span><span class="s2">&quot;rho&quot;</span><span class="p">]</span><span class="o">*</span><span class="n">pdict</span><span class="p">[</span><span class="s2">&quot;A&quot;</span><span class="p">]</span><span class="o">*</span><span class="n">pdict</span><span class="p">[</span><span class="s2">&quot;k1&quot;</span><span class="p">])</span>
                <span class="n">c_raw</span> <span class="o">=</span> <span class="n">c_crit</span><span class="o">*</span><span class="n">beta</span>

                <span class="n">tmax</span> <span class="o">=</span> <span class="n">pdict</span><span class="p">[</span><span class="s2">&quot;L&quot;</span><span class="p">]</span> <span class="o">/</span> <span class="n">v_raw</span>

                <span class="c1">#pdict[&quot;mubar&quot;] = PolyLine([0,0.1,0.9,1],[1/beta,1,1,1/beta])</span>
                <span class="c1">#pdict[&quot;mubar&quot;] = PolyLine([0,0.1,0.1,0.9,0.9,1],[1/beta,1/beta,1,1,1/beta,1/beta])</span>
                <span class="n">tran_start</span> <span class="o">=</span> <span class="mf">0.3</span>
                <span class="n">pdict</span><span class="p">[</span><span class="s2">&quot;mu&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">c_raw</span>
                <span class="n">pdict</span><span class="p">[</span><span class="s2">&quot;tvals&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">tmax</span><span class="o">*</span><span class="p">(</span><span class="n">tran_start</span><span class="o">-</span><span class="mf">0.1</span><span class="p">),</span><span class="n">tmax</span><span class="o">*</span><span class="p">(</span><span class="n">tran_start</span><span class="o">+</span><span class="n">t_length</span><span class="o">/</span><span class="n">pdict</span><span class="p">[</span><span class="s2">&quot;L&quot;</span><span class="p">]</span><span class="o">+</span><span class="mf">0.1</span><span class="p">),</span><span class="mi">200</span><span class="p">)</span>
                <span class="n">pdict</span><span class="p">[</span><span class="s2">&quot;xvals_norm&quot;</span><span class="p">]</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">tran_start</span><span class="o">-</span><span class="mf">0.1</span><span class="p">,</span><span class="n">tran_start</span><span class="o">+</span><span class="n">t_length</span><span class="o">/</span><span class="n">pdict</span><span class="p">[</span><span class="s2">&quot;L&quot;</span><span class="p">]</span><span class="o">+</span><span class="mf">0.1</span><span class="p">,</span><span class="mi">300</span><span class="p">)</span>
                <span class="n">pdict</span><span class="p">[</span><span class="s2">&quot;moving_loads_v_norm&quot;</span><span class="p">]</span><span class="o">=</span><span class="p">[</span><span class="n">v_raw</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">pdict</span><span class="p">[</span><span class="s2">&quot;rho&quot;</span><span class="p">]</span><span class="o">/</span><span class="n">pdict</span><span class="p">[</span><span class="s2">&quot;E&quot;</span><span class="p">])]</span>
                <span class="n">pdict</span><span class="p">[</span><span class="s2">&quot;file_stem&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;betaconst_DAF_alp</span><span class="si">{:5.3f}</span><span class="s2">_bet</span><span class="si">{:5.3f}</span><span class="s2">_tlen</span><span class="si">{:5.3f}</span><span class="s2">_krat</span><span class="si">{:5.3f}</span><span class="s2">_n</span><span class="si">{:d}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">alpha</span><span class="p">,</span><span class="n">beta</span><span class="p">,</span><span class="n">t_length</span><span class="p">,</span><span class="n">k_ratio</span><span class="p">,</span><span class="n">nterms</span><span class="p">)</span>
                <span class="n">pdict</span><span class="p">[</span><span class="s2">&quot;k1bar&quot;</span><span class="p">]</span><span class="o">=</span><span class="n">PolyLine</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="n">tran_start</span><span class="p">,</span> <span class="n">tran_start</span><span class="o">+</span><span class="n">t_length</span><span class="o">/</span><span class="n">pdict</span><span class="p">[</span><span class="s2">&quot;L&quot;</span><span class="p">],</span><span class="mi">1</span><span class="p">],[</span><span class="mf">1.0</span><span class="p">,</span><span class="mf">1.0</span><span class="p">,</span><span class="n">k_ratio</span><span class="p">,</span><span class="n">k_ratio</span><span class="p">])</span> <span class="c1">#soft to stiff</span>
                <span class="n">pdict</span><span class="p">[</span><span class="s2">&quot;k1bar&quot;</span><span class="p">]</span><span class="o">=</span><span class="n">PolyLine</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="n">tran_start</span><span class="p">,</span> <span class="n">tran_start</span><span class="o">+</span><span class="n">t_length</span><span class="o">/</span><span class="n">pdict</span><span class="p">[</span><span class="s2">&quot;L&quot;</span><span class="p">],</span><span class="mi">1</span><span class="p">],[</span><span class="n">k_ratio</span><span class="p">,</span> <span class="n">k_ratio</span><span class="p">,</span><span class="mf">1.0</span><span class="p">,</span><span class="mf">1.0</span><span class="p">])</span> <span class="c1">#stiff to soft</span>


                <span class="k">if</span> <span class="n">t_length</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span>
                    <span class="n">mubar_x</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                    <span class="n">mubar_mag</span><span class="o">=</span><span class="p">[</span><span class="n">k_ratio</span><span class="p">]</span>
                    <span class="k">for</span> <span class="n">xx</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">tran_start</span><span class="p">,</span> <span class="n">tran_start</span><span class="o">+</span><span class="n">t_length</span><span class="o">/</span><span class="n">pdict</span><span class="p">[</span><span class="s2">&quot;L&quot;</span><span class="p">],</span> <span class="mi">6</span><span class="p">):</span>
                        <span class="n">mubar_x</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">xx</span><span class="p">)</span>

                        <span class="n">know</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">k_ratio</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">k_ratio</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">xx</span><span class="o">-</span><span class="n">tran_start</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">t_length</span><span class="o">/</span><span class="n">pdict</span><span class="p">[</span><span class="s2">&quot;L&quot;</span><span class="p">]))</span> <span class="c1">#stiff to soft</span>
                        <span class="n">mubar_mag</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">know</span><span class="p">)</span>
                    <span class="n">mubar_x</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mf">1.0</span><span class="p">)</span>
                    <span class="n">mubar_mag</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mf">1.0</span><span class="p">)</span>
                    <span class="n">pdict</span><span class="p">[</span><span class="s2">&quot;mubar&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">PolyLine</span><span class="p">(</span><span class="n">mubar_x</span><span class="p">,</span> <span class="n">mubar_mag</span><span class="p">)</span>
                    <span class="k">for</span> <span class="n">xx</span><span class="p">,</span> <span class="n">mag</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">mubar_x</span><span class="p">,</span> <span class="n">mubar_mag</span><span class="p">):</span>
                        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{:8.3g}</span><span class="s2">, </span><span class="si">{:8.3g}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">xx</span><span class="p">,</span> <span class="n">mag</span><span class="p">))</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">pdict</span><span class="p">[</span><span class="s2">&quot;mubar&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">PolyLine</span><span class="p">([</span><span class="mi">0</span><span class="p">],[</span><span class="mi">1</span><span class="p">],[</span><span class="mi">1</span><span class="p">],[</span><span class="mi">1</span><span class="p">])</span>

                <span class="n">xstart</span> <span class="o">=</span> <span class="mf">0.0</span> <span class="c1">#start position on beam</span>
                <span class="n">xend</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="c1">#end position on beam</span>
                <span class="n">pdict</span><span class="p">[</span><span class="s2">&quot;tvals&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">tmax</span><span class="o">*</span><span class="p">(</span><span class="n">xend</span><span class="o">-</span><span class="n">xstart</span><span class="p">),</span> <span class="mi">200</span><span class="p">)</span>
                <span class="n">pdict</span><span class="p">[</span><span class="s2">&quot;moving_loads_x0_norm&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">xstart</span><span class="p">]</span>
                <span class="n">pdict</span><span class="p">[</span><span class="s2">&quot;moving_loads_L_norm&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">xend</span> <span class="o">-</span> <span class="n">xstart</span><span class="p">]</span>
                <span class="n">pdict</span><span class="p">[</span><span class="s2">&quot;xvals_norm&quot;</span><span class="p">]</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">xstart</span><span class="p">,</span><span class="n">xend</span><span class="p">,</span><span class="mi">200</span><span class="p">)</span>

                <span class="n">pdict</span><span class="p">[</span><span class="s2">&quot;tvals&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">tmax</span><span class="o">*</span><span class="mf">0.25</span><span class="p">,</span> <span class="n">tmax</span><span class="o">*</span><span class="mf">0.8</span><span class="p">,</span> <span class="mi">300</span><span class="p">)</span>
                <span class="n">pdict</span><span class="p">[</span><span class="s2">&quot;xvals_norm&quot;</span><span class="p">]</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.25</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">,</span> <span class="mi">300</span><span class="p">)</span>

                <span class="n">a</span> <span class="o">=</span> <span class="n">SpecBeam</span><span class="p">(</span><span class="o">**</span><span class="n">pdict</span><span class="p">)</span>
                <span class="n">a</span><span class="o">.</span><span class="n">runme</span><span class="p">()</span>
                <span class="n">a</span><span class="o">.</span><span class="n">saveme</span><span class="p">()</span>

                <span class="n">w_now_max</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">defl</span><span class="p">)</span>
                <span class="n">w_now_min</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">defl</span><span class="p">)</span>

                <span class="n">defl_max_envelope</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">defl</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
                <span class="n">defl_min_envelope</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">defl</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
                <span class="n">line</span><span class="p">,</span><span class="o">=</span><span class="n">ax3</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">pdict</span><span class="p">[</span><span class="s2">&quot;xvals_norm&quot;</span><span class="p">],</span><span class="n">defl_max_envelope</span><span class="p">,</span>
                         <span class="n">label</span><span class="o">=</span><span class="s2">&quot;$</span><span class="se">\\</span><span class="s2">alpha=</span><span class="si">{}</span><span class="s2">,\ tlen=</span><span class="si">{}</span><span class="s2">$&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">alpha</span><span class="p">,</span><span class="n">t_length</span><span class="p">))</span>
                <span class="n">ax3</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">pdict</span><span class="p">[</span><span class="s2">&quot;xvals_norm&quot;</span><span class="p">],</span><span class="n">defl_min_envelope</span><span class="p">,</span>
                         <span class="n">color</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">get_color</span><span class="p">(),</span>
                         <span class="p">)</span>
<span class="c1">#                if i==0:</span>
<span class="c1">#                    w_0 = w_now_max</span>
<span class="c1">#</span>
<span class="c1">#                DAF = w_now / w_0</span>

                <span class="n">zmax</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">w_now_max</span>
                <span class="n">zmin</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">w_now_min</span>



                <span class="n">end_time1</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
                <span class="n">elapsed_time</span> <span class="o">=</span> <span class="p">(</span><span class="n">end_time1</span> <span class="o">-</span> <span class="n">start_time1</span><span class="p">);</span> <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Run time=</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">timedelta</span><span class="p">(</span><span class="n">seconds</span><span class="o">=</span><span class="n">elapsed_time</span><span class="p">))))</span>

                <span class="k">if</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">i</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span><span class="c1">#i==0:#i==len(t_lengths)-1: #i is t_length counter,j is alpha counter</span>
                    <span class="n">a</span><span class="o">.</span><span class="n">animateme</span><span class="p">()</span>
<span class="c1">#                    print(&quot;******************&quot;,t_length,alpha, DAF)</span>
<span class="c1">#                    print(repr(z))</span>
        <span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="n">alpha</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">alphas</span><span class="p">):</span>
            <span class="n">x</span> <span class="o">=</span> <span class="n">t_lengths</span>
            <span class="n">y</span> <span class="o">=</span> <span class="n">zmax</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="p">:]</span> <span class="o">/</span> <span class="n">zmax</span><span class="p">[</span><span class="n">j</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span>
                    <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span>
                    <span class="n">label</span><span class="o">=</span><span class="s2">&quot;$</span><span class="si">{}</span><span class="s2">$&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">alpha</span><span class="p">))</span>
            <span class="n">y</span> <span class="o">=</span> <span class="n">zmin</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="p">:]</span> <span class="o">/</span> <span class="n">zmin</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
            <span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span>
                    <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;s&#39;</span><span class="p">,</span>
                    <span class="n">label</span><span class="o">=</span><span class="s2">&quot;$</span><span class="si">{}</span><span class="s2">$&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">alpha</span><span class="p">))</span>
        <span class="c1">#contourv = np.linspace(.1,10,10)</span>
<span class="c1">#        CS = ax.contour(alphas, t_lengths, z )</span>
 <span class="c1">#       ax.clabel(CS,inline=1,fontsize=8,fmt=&#39;%.1f&#39;)</span>

        <span class="n">adjust</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">top</span><span class="o">=</span><span class="mf">0.9</span><span class="p">,</span> <span class="n">bottom</span><span class="o">=</span><span class="mf">0.13</span><span class="p">,</span> <span class="n">left</span><span class="o">=</span><span class="mf">0.19</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="mf">0.95</span><span class="p">)</span>
        <span class="c1">###################</span>
        <span class="n">ax2</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;$</span><span class="se">\\</span><span class="s2">beta=</span><span class="si">{}</span><span class="s2">,k_1/k_2=</span><span class="si">{}</span><span class="s2">$&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">beta</span><span class="p">,</span> <span class="n">k_ratio</span><span class="p">))</span>
        <span class="n">ax2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Transition length (m)&quot;</span><span class="p">)</span>
        <span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;DAFup w.r.t. infinite&quot;</span><span class="p">)</span>
        <span class="n">ax2</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
        <span class="n">leg</span> <span class="o">=</span> <span class="n">ax2</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s2">&quot;$</span><span class="se">\\</span><span class="s2">alpha$&quot;</span><span class="p">,</span>
                        <span class="n">loc</span><span class="o">=</span><span class="s2">&quot;upper right&quot;</span><span class="p">,</span>
<span class="c1">#                        ncol=2,</span>
                        <span class="n">labelspacing</span><span class="o">=.</span><span class="mi">2</span><span class="p">,</span>
                        <span class="n">handlelength</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
                        <span class="n">fontsize</span><span class="o">=</span><span class="mi">8</span>
                        <span class="p">)</span>
        <span class="n">leg</span><span class="o">.</span><span class="n">draggable</span><span class="p">()</span>
        <span class="n">ax2</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">labelpad</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
        <span class="n">ax2</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">labelpad</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">fig2</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="o">**</span><span class="n">adjust</span><span class="p">)</span>
        <span class="c1">####################</span>

        <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;$</span><span class="se">\\</span><span class="s2">beta=</span><span class="si">{}</span><span class="s2">,kratio=</span><span class="si">{}</span><span class="s2">$&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">beta</span><span class="p">,</span> <span class="n">k_ratio</span><span class="p">))</span>
<span class="c1">#        ax.set_xlim(0,25)</span>
<span class="c1">#        ax.set_ylim(0,12)</span>
        <span class="c1">#ax.xaxis.label.set_fontsize(30)</span>
        <span class="c1">#ax.yaxis.label.set_fontsize(30)</span>
        <span class="c1">#ax.set_ylabel(&quot;$\\frac{u_\\mathrm{a,max}}{u_\\mathrm{p,max}}$&quot;)</span>
<span class="c1">#        ax.set_ylabel(&quot;$u_\\mathrm{a,max}/u_\\mathrm{p,max}$&quot;)</span>
<span class="c1">#        ax.set_xlabel(&quot;$n_a=r_e/r_w$&quot;)</span>
    <span class="c1">#    ax.set_xscale(&quot;log&quot;)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Transition length (m)&quot;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;DAF w.r.t. infinite&quot;</span><span class="p">)</span>

<span class="c1">#        ax.set_xlim(3.5, 4.5)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
        <span class="n">leg</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s2">&quot;$</span><span class="se">\\</span><span class="s2">alpha$&quot;</span><span class="p">,</span>
                        <span class="n">loc</span><span class="o">=</span><span class="s2">&quot;upper right&quot;</span><span class="p">,</span>
<span class="c1">#                        ncol=2,</span>
                        <span class="n">labelspacing</span><span class="o">=.</span><span class="mi">2</span><span class="p">,</span>
                        <span class="n">handlelength</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
                        <span class="n">fontsize</span><span class="o">=</span><span class="mi">8</span>
                        <span class="p">)</span>
        <span class="n">leg</span><span class="o">.</span><span class="n">draggable</span><span class="p">()</span>

        <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">labelpad</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">labelpad</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="n">fig</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="o">**</span><span class="n">adjust</span><span class="p">)</span>




        <span class="n">end_time0</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
        <span class="n">elapsed_time</span> <span class="o">=</span> <span class="p">(</span><span class="n">end_time0</span> <span class="o">-</span> <span class="n">start_time0</span><span class="p">);</span> <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Total run time=</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">timedelta</span><span class="p">(</span><span class="n">seconds</span><span class="o">=</span><span class="n">elapsed_time</span><span class="p">))))</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;Total run time=</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">timedelta</span><span class="p">(</span><span class="n">seconds</span><span class="o">=</span><span class="n">elapsed_time</span><span class="p">)))</span> <span class="o">+</span> <span class="n">os</span><span class="o">.</span><span class="n">linesep</span><span class="p">)</span>
<span class="c1">#        a.animateme()</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">saveas</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">save_figure</span><span class="p">(</span><span class="n">fig</span><span class="o">=</span><span class="n">fig</span><span class="p">,</span> <span class="n">fname</span><span class="o">=</span><span class="n">saveas</span><span class="p">)</span>
        <span class="n">save_figure</span><span class="p">(</span><span class="n">fig</span><span class="o">=</span><span class="n">fig2</span><span class="p">,</span> <span class="n">fname</span><span class="o">=</span><span class="n">saveas</span> <span class="o">+</span> <span class="s2">&quot;_up&quot;</span><span class="p">)</span>

<span class="c1">#    plt.show()</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">clf</span><span class="p">()</span>
    <span class="n">fig2</span><span class="o">.</span><span class="n">clf</span><span class="p">()</span></div>



<div class="viewcode-block" id="moving_load_on_beam_on_elastic_foundation"><a class="viewcode-back" href="../../../api/geotecha.beam_on_foundation.specbeam.html#geotecha.beam_on_foundation.specbeam.moving_load_on_beam_on_elastic_foundation">[docs]</a><span class="k">def</span> <span class="nf">moving_load_on_beam_on_elastic_foundation</span><span class="p">(</span><span class="n">alp</span><span class="p">,</span> <span class="n">bet</span><span class="p">,</span><span class="n">slim</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">6</span><span class="p">,</span><span class="mi">6</span><span class="p">),</span><span class="n">npts</span><span class="o">=</span><span class="mi">1001</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Displacement vs distance from moving point load on infinite beam on</span>
<span class="sd">    elastic foundation.</span>

<span class="sd">    This is to generate data for a a single subplot of  esveld Figure 6.17</span>

<span class="sd">    Esveld, C. (2001). Modern railway track. MRT-productions Zaltbommel, The Netherlands, Netherlands.0</span>

<span class="sd">    s is in multiples of lambda.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    alp : float</span>
<span class="sd">        velocity ratio.</span>
<span class="sd">    bet : float</span>
<span class="sd">        damping ratio</span>
<span class="sd">    slim : two element tuple of float, optional</span>
<span class="sd">        Distance, in multiples of characteristic length,  on either side</span>
<span class="sd">        of moving load to assess deflection at Default slim = (-6,6).</span>
<span class="sd">    npts : int, optional</span>
<span class="sd">        number of points witin slim to evaluate deflection.  Use an odd</span>
<span class="sd">        value to capture the mid point directly under the mmoving load.</span>
<span class="sd">        Default npts=1001.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    s : 1D numpy array of float</span>
<span class="sd">        Distances, in multiples of characteristic length,</span>
<span class="sd">        from moving point load.</span>
<span class="sd">        w.r.t. normalised by characteristic lengths</span>
<span class="sd">    disp : 1D numpy array of float</span>
<span class="sd">        Displacements at s.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">gam</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">roots</span><span class="p">([</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">4.0</span><span class="o">*</span><span class="n">alp</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">8</span><span class="o">*</span><span class="n">alp</span><span class="o">*</span><span class="n">bet</span><span class="p">,</span><span class="mi">4</span><span class="p">])</span>
    <span class="c1">#print(gam)</span>

    <span class="n">cmat</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">complex</span><span class="p">)</span>
    <span class="n">cmat</span><span class="p">[</span><span class="mi">0</span><span class="p">,:]</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">cmat</span><span class="p">[</span><span class="mi">1</span><span class="p">,:]</span><span class="o">=</span><span class="p">[</span><span class="n">gam</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">gam</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="o">-</span><span class="n">gam</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="o">-</span><span class="n">gam</span><span class="p">[</span><span class="mi">3</span><span class="p">]]</span>
    <span class="n">cmat</span><span class="p">[</span><span class="mi">2</span><span class="p">,:]</span><span class="o">=</span><span class="p">[</span><span class="n">gam</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span> <span class="n">gam</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="n">gam</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="n">gam</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="p">]</span>
    <span class="n">cmat</span><span class="p">[</span><span class="mi">3</span><span class="p">,:]</span><span class="o">=</span><span class="p">[</span><span class="n">gam</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">**</span><span class="mi">3</span><span class="p">,</span> <span class="n">gam</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">**</span><span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="n">gam</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">**</span><span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="n">gam</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">**</span><span class="mi">3</span><span class="p">]</span>

    <span class="n">rhs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">8.0</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">complex</span><span class="p">)</span>

    <span class="n">A</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">cmat</span><span class="p">,</span> <span class="n">rhs</span><span class="p">)</span>
    <span class="c1">#print(A)</span>

    <span class="n">smin</span><span class="p">,</span><span class="n">smax</span><span class="o">=</span><span class="n">slim</span>
    <span class="n">s</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">smin</span><span class="p">,</span><span class="n">smax</span><span class="p">,</span><span class="n">npts</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">complex</span><span class="p">)</span>

    <span class="n">disp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">s</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">complex</span><span class="p">)</span>

    <span class="n">s_neg</span> <span class="o">=</span> <span class="n">s</span><span class="p">[</span><span class="n">s</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">s_pos</span> <span class="o">=</span> <span class="n">s</span><span class="p">[</span><span class="n">s</span><span class="o">&gt;=</span><span class="mi">0</span><span class="p">]</span>



    <span class="c1">#assume that gam0 and gam1 are have negative real components</span>
    <span class="n">disp</span><span class="p">[</span><span class="n">s</span><span class="o">&gt;=</span><span class="mi">0</span><span class="p">]</span><span class="o">=</span><span class="n">A</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">s_pos</span><span class="o">*</span><span class="n">gam</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">+</span><span class="n">A</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">s_pos</span><span class="o">*</span><span class="n">gam</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">disp</span><span class="p">[</span><span class="n">s</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">]</span><span class="o">=</span><span class="n">A</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">s_neg</span><span class="o">*</span><span class="n">gam</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span><span class="o">+</span><span class="n">A</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">s_neg</span><span class="o">*</span><span class="n">gam</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>

    <span class="k">return</span>  <span class="n">s</span><span class="p">,</span> <span class="n">disp</span></div>

<div class="viewcode-block" id="esveld_fig6p17"><a class="viewcode-back" href="../../../api/geotecha.beam_on_foundation.specbeam.html#geotecha.beam_on_foundation.specbeam.esveld_fig6p17">[docs]</a><span class="k">def</span> <span class="nf">esveld_fig6p17</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;Displacement shapes before and after a moving</span>
<span class="sd">    point load on infinite beam on elastic foundation for</span>
<span class="sd">    a sub crtical , critical, super critcal velocity ratio (alpha) and</span>
<span class="sd">    damping ratios (beta) , Esveld Figure 6p17.</span>


<span class="sd">    Esveld, C. (2001). Modern railway track. MRT-productions Zaltbommel, The Netherlands, Netherlands.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    fig : matplotlib figure</span>
<span class="sd">        the deflection shape plot.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">sharex</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">sharey</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">11</span><span class="p">))</span>

    <span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">alp</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="o">.</span><span class="mi">5</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">]):</span>
        <span class="k">for</span> <span class="n">j</span><span class="p">,</span><span class="n">bet</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="o">.</span><span class="mi">1</span><span class="p">,</span><span class="mf">1.1</span><span class="p">]):</span>


            <span class="n">s</span><span class="p">,</span> <span class="n">disp</span> <span class="o">=</span><span class="n">moving_load_on_beam_on_elastic_foundation</span><span class="p">(</span><span class="n">alp</span><span class="o">=</span><span class="n">alp</span><span class="p">,</span> <span class="n">bet</span><span class="o">=</span><span class="n">bet</span><span class="p">)</span>
            <span class="n">axs</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">s</span><span class="p">,</span><span class="n">disp</span><span class="p">)</span>
            <span class="n">axs</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
            <span class="n">axs</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">invert_yaxis</span><span class="p">()</span>
            <span class="n">axs</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;rel vert displ&quot;</span><span class="p">)</span>
            <span class="n">axs</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Rel dist, s $</span><span class="se">\\</span><span class="s2">alpha=&quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">alp</span><span class="p">)</span><span class="o">+</span><span class="s2">&quot;,</span><span class="se">\\</span><span class="s2">beta=&quot;</span> <span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">bet</span><span class="p">)</span> <span class="o">+</span><span class="s2">&quot;$&quot;</span><span class="p">)</span>
            <span class="n">axs</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>

    <span class="k">return</span> <span class="n">fig</span></div>


<div class="viewcode-block" id="esveld_fig6p18"><a class="viewcode-back" href="../../../api/geotecha.beam_on_foundation.specbeam.html#geotecha.beam_on_foundation.specbeam.esveld_fig6p18">[docs]</a><span class="k">def</span> <span class="nf">esveld_fig6p18</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;Dynamic Amplification Factor vs</span>
<span class="sd">    velocity ratio (alpha) for variuos damping ratios (beta) for moving</span>
<span class="sd">    point load on infinite beam on elastic foundation, Esveld Figure 6p18.</span>


<span class="sd">    Esveld, C. (2001). Modern railway track. MRT-productions Zaltbommel, The Netherlands, Netherlands.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    fig : matplotlib figure</span>
<span class="sd">        the Dynamic amplification plotplot of</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>

    <span class="n">alpha</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">100</span><span class="p">)</span>
    <span class="c1">#DAF = np.empty_like(alp)</span>
    <span class="k">for</span> <span class="n">j</span><span class="p">,</span><span class="n">bet</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mf">0.05</span><span class="p">,</span><span class="mf">0.1</span><span class="p">,</span><span class="mf">0.3</span><span class="p">,</span><span class="mf">1.1</span><span class="p">,</span><span class="mf">2.0</span><span class="p">]):</span>
        <span class="n">DAF</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty_like</span><span class="p">(</span><span class="n">alpha</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">alp</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">alpha</span><span class="p">):</span>



            <span class="n">s</span><span class="p">,</span> <span class="n">disp</span><span class="o">=</span><span class="n">moving_load_on_beam_on_elastic_foundation</span><span class="p">(</span><span class="n">alp</span><span class="o">=</span><span class="n">alp</span><span class="p">,</span> <span class="n">bet</span><span class="o">=</span><span class="n">bet</span><span class="p">)</span>

            <span class="n">mx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">disp</span><span class="p">)</span>
            <span class="n">DAF</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">mx</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">alpha</span><span class="p">,</span> <span class="n">DAF</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;$</span><span class="se">\\</span><span class="s2">beta=&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">bet</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;$&quot;</span><span class="p">)</span>
    <span class="n">leg</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    <span class="n">leg</span><span class="o">.</span><span class="n">draggable</span><span class="p">()</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">4</span><span class="p">])</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>


    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Deflection amplification factor&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Rel dist, s $</span><span class="se">\\</span><span class="s2">alpha=&quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">alp</span><span class="p">)</span><span class="o">+</span><span class="s2">&quot;,</span><span class="se">\\</span><span class="s2">beta=&quot;</span> <span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">bet</span><span class="p">)</span> <span class="o">+</span><span class="s2">&quot;$&quot;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">fig</span></div>




<div class="viewcode-block" id="case_study_PaixaoEtAl2014"><a class="viewcode-back" href="../../../api/geotecha.beam_on_foundation.specbeam.html#geotecha.beam_on_foundation.specbeam.case_study_PaixaoEtAl2014">[docs]</a><span class="k">def</span> <span class="nf">case_study_PaixaoEtAl2014</span><span class="p">(</span>
       <span class="n">saveas</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
       <span class="n">nterms</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span>
       <span class="n">force_calc</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
       <span class="n">nx</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">nt</span><span class="o">=</span><span class="mi">100</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Try and replicate Paixao et al 2014 for 6 rail cars going over</span>
<span class="sd">    transition using specbeam.</span>

<span class="sd">    Some eplots will be produced.</span>

<span class="sd">    You&#39;ll have to read the source code for this one.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    saveas : string, optional</span>
<span class="sd">        Filename stem (not including extension) to save figure to.</span>
<span class="sd">        Default saveas=None, i.e. figure won&#39;t be saved to disk.</span>
<span class="sd">    nx : int, optional</span>
<span class="sd">        Number of points between `xlim[0]` and `xlim[1]` at which to</span>
<span class="sd">        calculate deflection.  Default nx = 100.</span>
<span class="sd">    nt : int, optional</span>
<span class="sd">        Number of evaluation times from when load enters `xlim[0]` and</span>
<span class="sd">        leaves `xlim[1]`.  Default nt=100</span>
<span class="sd">    nterms : int, optional</span>
<span class="sd">        Number of series terms in approximation.  More terms  leads to higher</span>
<span class="sd">        accuracy but also longer computation times.  Start of with a</span>
<span class="sd">        small enough value to observe behaviour and then increase</span>
<span class="sd">        to confirm. Default nterms=100 .</span>
<span class="sd">    force_calc : [True, False], optional</span>
<span class="sd">        When True all calcuations will be done from scratch. When False</span>
<span class="sd">        Current working directory will be searched for a results file</span>
<span class="sd">        named according to &quot;saveas&quot; and</span>
<span class="sd">        if found it will be loaded.  Be careful as name of results file may</span>
<span class="sd">        not be unique to your analysis parameters.  Safest to use</span>
<span class="sd">        force_calc = True, but if you are simply regenerating graphs then</span>
<span class="sd">        consider force_calc=False.  Default force_calc=True.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1">####</span>

    <span class="n">start_time0</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
    <span class="n">ftime</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">fromtimestamp</span><span class="p">(</span><span class="n">start_time0</span><span class="p">)</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s1">&#39;%Y-%m-</span><span class="si">%d</span><span class="s1"> %H%M%S&#39;</span><span class="p">)</span>


    <span class="c1">#raw digitized data,</span>
    <span class="c1">#time in seconds but not sure what time zero represents, probably just</span>
    <span class="c1"># offset the specbeam data to line up with the peaks, which is what</span>
    <span class="c1"># paxior seems to do</span>
    <span class="c1">#Displacemtn in mm positive up</span>

    <span class="n">fig12top_t_raw</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
      <span class="p">[</span> <span class="mf">0.12883271</span><span class="p">,</span>  <span class="mf">0.13973975</span><span class="p">,</span>  <span class="mf">0.1478486</span> <span class="p">,</span>  <span class="mf">0.15608597</span><span class="p">,</span>  <span class="mf">0.17517319</span><span class="p">,</span>
        <span class="mf">0.18598029</span><span class="p">,</span>  <span class="mf">0.19146229</span><span class="p">,</span>  <span class="mf">0.20236935</span><span class="p">,</span>  <span class="mf">0.21608873</span><span class="p">,</span>  <span class="mf">0.22693857</span><span class="p">,</span>
        <span class="mf">0.22956522</span><span class="p">,</span>  <span class="mf">0.24040088</span><span class="p">,</span>  <span class="mf">0.24591183</span><span class="p">,</span>  <span class="mf">0.25674748</span><span class="p">,</span>  <span class="mf">0.26498448</span><span class="p">,</span>
        <span class="mf">0.27853267</span><span class="p">,</span>  <span class="mf">0.28120274</span><span class="p">,</span>  <span class="mf">0.29483585</span><span class="p">,</span>  <span class="mf">0.30842746</span><span class="p">,</span>  <span class="mf">0.31379463</span><span class="p">,</span>
        <span class="mf">0.3274287</span> <span class="p">,</span>  <span class="mf">0.34114769</span><span class="p">,</span>  <span class="mf">0.35198335</span><span class="p">,</span>  <span class="mf">0.35465343</span><span class="p">,</span>  <span class="mf">0.35733701</span><span class="p">,</span>
        <span class="mf">0.37639615</span><span class="p">,</span>  <span class="mf">0.39545432</span><span class="p">,</span>  <span class="mf">0.4090884</span> <span class="p">,</span>  <span class="mf">0.43087358</span><span class="p">,</span>  <span class="mf">0.45003211</span><span class="p">,</span>
        <span class="mf">0.46359477</span><span class="p">,</span>  <span class="mf">0.48263944</span><span class="p">,</span>  <span class="mf">0.49891464</span><span class="p">,</span>  <span class="mf">0.51260468</span><span class="p">,</span>  <span class="mf">0.5317497</span> <span class="p">,</span>
        <span class="mf">0.5398294</span> <span class="p">,</span>  <span class="mf">0.55340654</span><span class="p">,</span>  <span class="mf">0.56148624</span><span class="p">,</span>  <span class="mf">0.5697242</span> <span class="p">,</span>  <span class="mf">0.5860129</span> <span class="p">,</span>
        <span class="mf">0.59135209</span><span class="p">,</span>  <span class="mf">0.59961803</span><span class="p">,</span>  <span class="mf">0.60769869</span><span class="p">,</span>  <span class="mf">0.61592217</span><span class="p">,</span>  <span class="mf">0.62133277</span><span class="p">,</span>
        <span class="mf">0.62955528</span><span class="p">,</span>  <span class="mf">0.63769288</span><span class="p">,</span>  <span class="mf">0.64029155</span><span class="p">,</span>  <span class="mf">0.64558731</span><span class="p">,</span>  <span class="mf">0.64814352</span><span class="p">,</span>
        <span class="mf">0.65066981</span><span class="p">,</span>  <span class="mf">0.65316812</span><span class="p">,</span>  <span class="mf">0.65569538</span><span class="p">,</span>  <span class="mf">0.65826509</span><span class="p">,</span>  <span class="mf">0.66657349</span><span class="p">,</span>
        <span class="mf">0.67219831</span><span class="p">,</span>  <span class="mf">0.67506813</span><span class="p">,</span>  <span class="mf">0.67793795</span><span class="p">,</span>  <span class="mf">0.68077883</span><span class="p">,</span>  <span class="mf">0.6836197</span> <span class="p">,</span>
        <span class="mf">0.68901582</span><span class="p">,</span>  <span class="mf">0.69165694</span><span class="p">,</span>  <span class="mf">0.6942836</span> <span class="p">,</span>  <span class="mf">0.69688226</span><span class="p">,</span>  <span class="mf">0.69922328</span><span class="p">,</span>
        <span class="mf">0.69942303</span><span class="p">,</span>  <span class="mf">0.70452001</span><span class="p">,</span>  <span class="mf">0.71281393</span><span class="p">,</span>  <span class="mf">0.71319992</span><span class="p">,</span>  <span class="mf">0.71572621</span><span class="p">,</span>
        <span class="mf">0.71609773</span><span class="p">,</span>  <span class="mf">0.71899553</span><span class="p">,</span>  <span class="mf">0.73024516</span><span class="p">,</span>  <span class="mf">0.73308604</span><span class="p">,</span>  <span class="mf">0.73861146</span><span class="p">,</span>
        <span class="mf">0.74690539</span><span class="p">,</span>  <span class="mf">0.75243081</span><span class="p">,</span>  <span class="mf">0.75796974</span><span class="p">,</span>  <span class="mf">0.76623568</span><span class="p">,</span>  <span class="mf">0.77981282</span><span class="p">,</span>
        <span class="mf">0.785152</span>  <span class="p">,</span>  <span class="mf">0.79336005</span><span class="p">,</span>  <span class="mf">0.80695166</span><span class="p">,</span>  <span class="mf">0.81506031</span><span class="p">,</span>  <span class="mf">0.81775837</span><span class="p">,</span>
        <span class="mf">0.82867991</span><span class="p">,</span>  <span class="mf">0.83953004</span><span class="p">,</span>  <span class="mf">0.85042263</span><span class="p">,</span>  <span class="mf">0.85580427</span><span class="p">,</span>  <span class="mf">0.86131522</span><span class="p">,</span>
        <span class="mf">0.86952423</span><span class="p">,</span>  <span class="mf">0.87773227</span><span class="p">,</span>  <span class="mf">0.88585539</span><span class="p">,</span>  <span class="mf">0.89944701</span><span class="p">,</span>  <span class="mf">0.90757013</span><span class="p">,</span>
        <span class="mf">0.91572124</span><span class="p">,</span>  <span class="mf">0.91839132</span><span class="p">,</span>  <span class="mf">0.93740703</span><span class="p">,</span>  <span class="mf">0.94564499</span><span class="p">,</span>  <span class="mf">0.9509697</span> <span class="p">,</span>
        <span class="mf">0.95630888</span><span class="p">,</span>  <span class="mf">0.95873578</span><span class="p">,</span>  <span class="mf">0.95890755</span><span class="p">,</span>  <span class="mf">0.96363204</span><span class="p">,</span>  <span class="mf">0.96388969</span><span class="p">,</span>
        <span class="mf">0.96605991</span><span class="p">,</span>  <span class="mf">0.96614483</span><span class="p">,</span>  <span class="mf">0.9715699</span> <span class="p">,</span>  <span class="mf">0.97710883</span><span class="p">,</span>  <span class="mf">0.97999313</span><span class="p">,</span>
        <span class="mf">0.98287646</span><span class="p">,</span>  <span class="mf">0.98563241</span><span class="p">,</span>  <span class="mf">0.98576076</span><span class="p">,</span>  <span class="mf">0.99131416</span><span class="p">,</span>  <span class="mf">0.99141355</span><span class="p">,</span>
        <span class="mf">0.99695345</span><span class="p">,</span>  <span class="mf">1.00222123</span><span class="p">,</span>  <span class="mf">1.0050621</span> <span class="p">,</span>  <span class="mf">1.00738865</span><span class="p">,</span>  <span class="mf">1.00756041</span><span class="p">,</span>
        <span class="mf">1.00991591</span><span class="p">,</span>  <span class="mf">1.01001626</span><span class="p">,</span>  <span class="mf">1.0181529</span> <span class="p">,</span>  <span class="mf">1.02092236</span><span class="p">,</span>  <span class="mf">1.02377771</span><span class="p">,</span>
        <span class="mf">1.02656165</span><span class="p">,</span>  <span class="mf">1.02944595</span><span class="p">,</span>  <span class="mf">1.02955982</span><span class="p">,</span>  <span class="mf">1.03237271</span><span class="p">,</span>  <span class="mf">1.03525604</span><span class="p">,</span>
        <span class="mf">1.03809691</span><span class="p">,</span>  <span class="mf">1.03819727</span><span class="p">,</span>  <span class="mf">1.04367927</span><span class="p">,</span>  <span class="mf">1.0437362</span> <span class="p">,</span>  <span class="mf">1.04923268</span><span class="p">,</span>
        <span class="mf">1.05201662</span><span class="p">,</span>  <span class="mf">1.05755555</span><span class="p">,</span>  <span class="mf">1.06298062</span><span class="p">,</span>  <span class="mf">1.06562174</span><span class="p">,</span>  <span class="mf">1.06823392</span><span class="p">,</span>
        <span class="mf">1.07081811</span><span class="p">,</span>  <span class="mf">1.07335888</span><span class="p">,</span>  <span class="mf">1.07588614</span><span class="p">,</span>  <span class="mf">1.0783555</span> <span class="p">,</span>  <span class="mf">1.08092521</span><span class="p">,</span>
        <span class="mf">1.08352388</span><span class="p">,</span>  <span class="mf">1.09192202</span><span class="p">,</span>  <span class="mf">1.09198957</span><span class="p">,</span>  <span class="mf">1.09481693</span><span class="p">,</span>  <span class="mf">1.09765395</span><span class="p">,</span>
        <span class="mf">1.10324113</span><span class="p">,</span>  <span class="mf">1.10332798</span><span class="p">,</span>  <span class="mf">1.10622289</span><span class="p">,</span>  <span class="mf">1.11435759</span><span class="p">,</span>  <span class="mf">1.11699196</span><span class="p">,</span>
        <span class="mf">1.11945264</span><span class="p">,</span>  <span class="mf">1.11961669</span><span class="p">,</span>  <span class="mf">1.12198086</span><span class="p">,</span>  <span class="mf">1.12455734</span><span class="p">,</span>  <span class="mf">1.12716276</span><span class="p">,</span>
        <span class="mf">1.13274994</span><span class="p">,</span>  <span class="mf">1.13314558</span><span class="p">,</span>  <span class="mf">1.1356159</span> <span class="p">,</span>  <span class="mf">1.135751</span>  <span class="p">,</span>  <span class="mf">1.13599224</span><span class="p">,</span>
        <span class="mf">1.1388582</span> <span class="p">,</span>  <span class="mf">1.14713765</span><span class="p">,</span>  <span class="mf">1.15000362</span><span class="p">,</span>  <span class="mf">1.15285993</span><span class="p">,</span>  <span class="mf">1.15573554</span><span class="p">,</span>
        <span class="mf">1.16401499</span><span class="p">,</span>  <span class="mf">1.17223654</span><span class="p">,</span>  <span class="mf">1.17773688</span><span class="p">,</span>  <span class="mf">1.18053529</span><span class="p">,</span>  <span class="mf">1.18878579</span><span class="p">,</span>
        <span class="mf">1.19957417</span><span class="p">,</span>  <span class="mf">1.19964172</span><span class="p">,</span>  <span class="mf">1.20222784</span><span class="p">,</span>  <span class="mf">1.21588217</span><span class="p">,</span>  <span class="mf">1.23223843</span><span class="p">,</span>
        <span class="mf">1.24307505</span><span class="p">,</span>  <span class="mf">1.25395028</span><span class="p">,</span>  <span class="mf">1.25933481</span><span class="p">,</span>  <span class="mf">1.2648062</span> <span class="p">,</span>  <span class="mf">1.27838334</span><span class="p">,</span>
        <span class="mf">1.28658559</span><span class="p">,</span>  <span class="mf">1.29747046</span><span class="p">,</span>  <span class="mf">1.30295149</span><span class="p">,</span>  <span class="mf">1.31105725</span><span class="p">,</span>  <span class="mf">1.32193247</span><span class="p">,</span>
        <span class="mf">1.33287524</span><span class="p">,</span>  <span class="mf">1.33550961</span><span class="p">,</span>  <span class="mf">1.35997162</span><span class="p">,</span>  <span class="mf">1.37088544</span><span class="p">,</span>  <span class="mf">1.37355841</span><span class="p">,</span>
        <span class="mf">1.37621208</span><span class="p">,</span>  <span class="mf">1.37865346</span><span class="p">,</span>  <span class="mf">1.37880785</span><span class="p">,</span>  <span class="mf">1.3839222</span> <span class="p">,</span>  <span class="mf">1.38636357</span><span class="p">,</span>
        <span class="mf">1.38651797</span><span class="p">,</span>  <span class="mf">1.39147792</span><span class="p">,</span>  <span class="mf">1.39164196</span><span class="p">,</span>  <span class="mf">1.39413159</span><span class="p">,</span>  <span class="mf">1.39693</span>   <span class="p">,</span>
        <span class="mf">1.39988281</span><span class="p">,</span>  <span class="mf">1.40250753</span><span class="p">,</span>  <span class="mf">1.4053928</span> <span class="p">,</span>  <span class="mf">1.40826841</span><span class="p">,</span>  <span class="mf">1.40836491</span><span class="p">,</span>
        <span class="mf">1.41119227</span><span class="p">,</span>  <span class="mf">1.41950067</span><span class="p">,</span>  <span class="mf">1.42218329</span><span class="p">,</span>  <span class="mf">1.42756783</span><span class="p">,</span>  <span class="mf">1.4302022</span> <span class="p">,</span>
        <span class="mf">1.43263392</span><span class="p">,</span>  <span class="mf">1.43280762</span><span class="p">,</span>  <span class="mf">1.43530689</span><span class="p">,</span>  <span class="mf">1.44065283</span><span class="p">,</span>  <span class="mf">1.4434802</span> <span class="p">,</span>
        <span class="mf">1.44635581</span><span class="p">,</span>  <span class="mf">1.44915422</span><span class="p">,</span>  <span class="mf">1.45475106</span><span class="p">,</span>  <span class="mf">1.4548765</span> <span class="p">,</span>  <span class="mf">1.45767492</span><span class="p">,</span>
        <span class="mf">1.45781966</span><span class="p">,</span>  <span class="mf">1.46336825</span><span class="p">,</span>  <span class="mf">1.46351299</span><span class="p">,</span>  <span class="mf">1.46639825</span><span class="p">,</span>  <span class="mf">1.47737962</span><span class="p">,</span>
        <span class="mf">1.48291855</span><span class="p">,</span>  <span class="mf">1.48825484</span><span class="p">,</span>  <span class="mf">1.48834169</span><span class="p">,</span>  <span class="mf">1.49352358</span><span class="p">,</span>  <span class="mf">1.49608076</span><span class="p">,</span>
        <span class="mf">1.49862828</span><span class="p">,</span>  <span class="mf">1.50096351</span><span class="p">,</span>  <span class="mf">1.5011758</span> <span class="p">,</span>  <span class="mf">1.50361718</span><span class="p">,</span>  <span class="mf">1.506184</span>  <span class="p">,</span>
        <span class="mf">1.51171328</span><span class="p">,</span>  <span class="mf">1.51190628</span><span class="p">,</span>  <span class="mf">1.51747416</span><span class="p">,</span>  <span class="mf">1.52304204</span><span class="p">,</span>  <span class="mf">1.52586941</span><span class="p">,</span>
        <span class="mf">1.52874502</span><span class="p">,</span>  <span class="mf">1.53422605</span><span class="p">,</span>  <span class="mf">1.53962024</span><span class="p">,</span>  <span class="mf">1.54212916</span><span class="p">,</span>  <span class="mf">1.54224496</span><span class="p">,</span>
        <span class="mf">1.54717596</span><span class="p">,</span>  <span class="mf">1.5473979</span> <span class="p">,</span>  <span class="mf">1.552464</span>  <span class="p">,</span>  <span class="mf">1.55556156</span><span class="p">,</span>  <span class="mf">1.56085925</span><span class="p">,</span>
        <span class="mf">1.56121629</span><span class="p">,</span>  <span class="mf">1.56417875</span><span class="p">,</span>  <span class="mf">1.56708331</span><span class="p">,</span>  <span class="mf">1.56711226</span><span class="p">,</span>  <span class="mf">1.57543996</span><span class="p">,</span>
        <span class="mf">1.57555575</span><span class="p">,</span>  <span class="mf">1.58654677</span><span class="p">,</span>  <span class="mf">1.58937414</span><span class="p">,</span>  <span class="mf">1.59763429</span><span class="p">,</span>  <span class="mf">1.60313462</span><span class="p">,</span>
        <span class="mf">1.60323112</span><span class="p">,</span>  <span class="mf">1.6087604</span> <span class="p">,</span>  <span class="mf">1.61959702</span><span class="p">,</span>  <span class="mf">1.62764488</span><span class="p">,</span>  <span class="mf">1.62772208</span><span class="p">,</span>
        <span class="mf">1.64390464</span><span class="p">,</span>  <span class="mf">1.65211654</span><span class="p">,</span>  <span class="mf">1.65759757</span><span class="p">,</span>  <span class="mf">1.66575158</span><span class="p">,</span>  <span class="mf">1.68204993</span><span class="p">,</span>
        <span class="mf">1.69026184</span><span class="p">,</span>  <span class="mf">1.69568497</span><span class="p">,</span>  <span class="mf">1.70390652</span><span class="p">,</span>  <span class="mf">1.70666634</span><span class="p">,</span>  <span class="mf">1.71480104</span><span class="p">,</span>
        <span class="mf">1.72028208</span><span class="p">,</span>  <span class="mf">1.73385922</span><span class="p">,</span>  <span class="mf">1.74471514</span><span class="p">,</span>  <span class="mf">1.75010933</span><span class="p">,</span>  <span class="mf">1.75823438</span><span class="p">,</span>
        <span class="mf">1.76086875</span><span class="p">,</span>  <span class="mf">1.77181152</span><span class="p">,</span>  <span class="mf">1.77727326</span><span class="p">,</span>  <span class="mf">1.78542726</span><span class="p">,</span>  <span class="mf">1.79084075</span><span class="p">,</span>
        <span class="mf">1.7989465</span> <span class="p">,</span>  <span class="mf">1.80154227</span><span class="p">,</span>  <span class="mf">1.80411875</span><span class="p">,</span>  <span class="mf">1.80644432</span><span class="p">,</span>  <span class="mf">1.80668557</span><span class="p">,</span>
        <span class="mf">1.80895325</span><span class="p">,</span>  <span class="mf">1.81151042</span><span class="p">,</span>  <span class="mf">1.81681776</span><span class="p">,</span>  <span class="mf">1.82501036</span><span class="p">,</span>  <span class="mf">1.82515511</span><span class="p">,</span>
        <span class="mf">1.83075194</span><span class="p">,</span>  <span class="mf">1.8336372</span> <span class="p">,</span>  <span class="mf">1.83659001</span><span class="p">,</span>  <span class="mf">1.8421579</span> <span class="p">,</span>  <span class="mf">1.85278222</span><span class="p">,</span>
        <span class="mf">1.85296557</span><span class="p">,</span>  <span class="mf">1.85806062</span><span class="p">,</span>  <span class="mf">1.86060814</span><span class="p">,</span>  <span class="mf">1.86316531</span><span class="p">,</span>  <span class="mf">1.86878144</span><span class="p">,</span>
        <span class="mf">1.87171495</span><span class="p">,</span>  <span class="mf">1.8719369</span> <span class="p">,</span>  <span class="mf">1.88026459</span><span class="p">,</span>  <span class="mf">1.88313056</span><span class="p">,</span>  <span class="mf">1.88330425</span><span class="p">,</span>
        <span class="mf">1.88616057</span><span class="p">,</span>  <span class="mf">1.88904583</span><span class="p">,</span>  <span class="mf">1.89452686</span><span class="p">,</span>  <span class="mf">1.90278701</span><span class="p">,</span>  <span class="mf">1.90284491</span><span class="p">,</span>
        <span class="mf">1.9082584</span> <span class="p">,</span>  <span class="mf">1.91638345</span><span class="p">,</span>  <span class="mf">1.91896957</span><span class="p">,</span>  <span class="mf">1.9215943</span> <span class="p">,</span>  <span class="mf">1.92398742</span><span class="p">,</span>
        <span class="mf">1.92420937</span><span class="p">,</span>  <span class="mf">1.9264867</span> <span class="p">,</span>  <span class="mf">1.92903422</span><span class="p">,</span>  <span class="mf">1.93440911</span><span class="p">,</span>  <span class="mf">1.94273681</span><span class="p">,</span>
        <span class="mf">1.9428526</span> <span class="p">,</span>  <span class="mf">1.94854593</span><span class="p">,</span>  <span class="mf">1.94861348</span><span class="p">,</span>  <span class="mf">1.95417171</span><span class="p">,</span>  <span class="mf">1.95972029</span><span class="p">,</span>
        <span class="mf">1.9677199</span> <span class="p">,</span>  <span class="mf">1.97011303</span><span class="p">,</span>  <span class="mf">1.97024812</span><span class="p">,</span>  <span class="mf">1.97540107</span><span class="p">,</span>  <span class="mf">1.97798719</span><span class="p">,</span>
        <span class="mf">1.9810365</span> <span class="p">,</span>  <span class="mf">1.98362262</span><span class="p">,</span>  <span class="mf">1.98389281</span><span class="p">,</span>  <span class="mf">1.98681667</span><span class="p">,</span>  <span class="mf">1.98961509</span><span class="p">,</span>
        <span class="mf">1.99518297</span><span class="p">,</span>  <span class="mf">2.0007798</span> <span class="p">,</span>  <span class="mf">2.00094385</span><span class="p">,</span>  <span class="mf">2.00651173</span><span class="p">,</span>  <span class="mf">2.01473328</span><span class="p">,</span>
        <span class="mf">2.01480083</span><span class="p">,</span>  <span class="mf">2.02035906</span><span class="p">,</span>  <span class="mf">2.03406164</span><span class="p">,</span>  <span class="mf">2.04493687</span><span class="p">,</span>  <span class="mf">2.0504179</span> <span class="p">,</span>
        <span class="mf">2.05577349</span><span class="p">,</span>  <span class="mf">2.07209115</span><span class="p">,</span>  <span class="mf">2.09383194</span><span class="p">,</span>  <span class="mf">2.09923577</span><span class="p">,</span>  <span class="mf">2.11281292</span><span class="p">,</span>
        <span class="mf">2.12378463</span><span class="p">,</span>  <span class="mf">2.13738107</span><span class="p">,</span>  <span class="mf">2.14829489</span><span class="p">,</span>  <span class="mf">2.16183343</span><span class="p">,</span>  <span class="mf">2.17272795</span><span class="p">,</span>
        <span class="mf">2.17809319</span><span class="p">,</span>  <span class="mf">2.18892981</span><span class="p">,</span>  <span class="mf">2.2025745</span> <span class="p">,</span>  <span class="mf">2.20807484</span><span class="p">,</span>  <span class="mf">2.22157478</span><span class="p">,</span>
        <span class="mf">2.22669877</span><span class="p">,</span>  <span class="mf">2.22684352</span><span class="p">,</span>  <span class="mf">2.23196751</span><span class="p">,</span>  <span class="mf">2.23433169</span><span class="p">,</span>  <span class="mf">2.23449574</span><span class="p">,</span>
        <span class="mf">2.23961973</span><span class="p">,</span>  <span class="mf">2.24493672</span><span class="p">,</span>  <span class="mf">2.25042741</span><span class="p">,</span>  <span class="mf">2.25327407</span><span class="p">,</span>  <span class="mf">2.25338987</span><span class="p">,</span>
        <span class="mf">2.25626548</span><span class="p">,</span>  <span class="mf">2.26182371</span><span class="p">,</span>  <span class="mf">2.26193951</span><span class="p">,</span>  <span class="mf">2.26751704</span><span class="p">,</span>  <span class="mf">2.27278578</span><span class="p">,</span>
        <span class="mf">2.27287263</span><span class="p">,</span>  <span class="mf">2.27808347</span><span class="p">,</span>  <span class="mf">2.28065029</span><span class="p">,</span>  <span class="mf">2.28319781</span><span class="p">,</span>  <span class="mf">2.2885148</span> <span class="p">,</span>
        <span class="mf">2.29419848</span><span class="p">,</span>  <span class="mf">2.29714164</span><span class="p">,</span>  <span class="mf">2.30002691</span><span class="p">,</span>  <span class="mf">2.30292182</span><span class="p">,</span>  <span class="mf">2.3085669</span> <span class="p">,</span>
        <span class="mf">2.31140391</span><span class="p">,</span>  <span class="mf">2.31431812</span><span class="p">,</span>  <span class="mf">2.31449182</span><span class="p">,</span>  <span class="mf">2.32820406</span><span class="p">,</span>  <span class="mf">2.33360789</span><span class="p">,</span>
        <span class="mf">2.33894418</span><span class="p">,</span>  <span class="mf">2.3415303</span> <span class="p">,</span>  <span class="mf">2.34682799</span><span class="p">,</span>  <span class="mf">2.34943341</span><span class="p">,</span>  <span class="mf">2.35177829</span><span class="p">,</span>
        <span class="mf">2.35196164</span><span class="p">,</span>  <span class="mf">2.35710493</span><span class="p">,</span>  <span class="mf">2.36538438</span><span class="p">,</span>  <span class="mf">2.36822139</span><span class="p">,</span>  <span class="mf">2.36837579</span><span class="p">,</span>
        <span class="mf">2.37394367</span><span class="p">,</span>  <span class="mf">2.37407877</span><span class="p">,</span>  <span class="mf">2.38239682</span><span class="p">,</span>  <span class="mf">2.39029028</span><span class="p">,</span>  <span class="mf">2.39045432</span><span class="p">,</span>
        <span class="mf">2.3928957</span> <span class="p">,</span>  <span class="mf">2.39531778</span><span class="p">,</span>  <span class="mf">2.39546252</span><span class="p">,</span>  <span class="mf">2.40054792</span><span class="p">,</span>  <span class="mf">2.40895281</span><span class="p">,</span>
        <span class="mf">2.40904931</span><span class="p">,</span>  <span class="mf">2.41211792</span><span class="p">,</span>  <span class="mf">2.41771475</span><span class="p">,</span>  <span class="mf">2.42050352</span><span class="p">,</span>  <span class="mf">2.42056141</span><span class="p">,</span>
        <span class="mf">2.42070616</span><span class="p">,</span>  <span class="mf">2.42633194</span><span class="p">,</span>  <span class="mf">2.43185157</span><span class="p">,</span>  <span class="mf">2.44012137</span><span class="p">,</span>  <span class="mf">2.44292944</span><span class="p">,</span>
        <span class="mf">2.45385291</span><span class="p">,</span>  <span class="mf">2.45665132</span><span class="p">,</span>  <span class="mf">2.47026706</span><span class="p">,</span>  <span class="mf">2.47836317</span><span class="p">,</span>  <span class="mf">2.49467117</span><span class="p">,</span>
        <span class="mf">2.51105638</span><span class="p">,</span>  <span class="mf">2.51909458</span><span class="p">,</span>  <span class="mf">2.53537364</span><span class="p">,</span>  <span class="mf">2.5435759</span> <span class="p">,</span>  <span class="mf">2.54636466</span><span class="p">,</span>
        <span class="mf">2.55726883</span><span class="p">,</span>  <span class="mf">2.56274022</span><span class="p">,</span>  <span class="mf">2.57635595</span><span class="p">,</span>  <span class="mf">2.58449066</span><span class="p">,</span>  <span class="mf">2.59809675</span><span class="p">,</span>
        <span class="mf">2.60619285</span><span class="p">,</span>  <span class="mf">2.61155809</span><span class="p">,</span>  <span class="mf">2.62244296</span><span class="p">,</span>  <span class="mf">2.62796259</span><span class="p">,</span>  <span class="mf">2.63335678</span><span class="p">,</span>
        <span class="mf">2.6441934</span> <span class="p">,</span>  <span class="mf">2.64952004</span><span class="p">,</span>  <span class="mf">2.65208686</span><span class="p">,</span>  <span class="mf">2.65717226</span><span class="p">,</span>  <span class="mf">2.65738456</span><span class="p">,</span>
        <span class="mf">2.6623831</span> <span class="p">,</span>  <span class="mf">2.66488238</span><span class="p">,</span>  <span class="mf">2.66747815</span><span class="p">,</span>  <span class="mf">2.67304603</span><span class="p">,</span>  <span class="mf">2.6758734</span> <span class="p">,</span>
        <span class="mf">2.67602779</span><span class="p">,</span>  <span class="mf">2.68161497</span><span class="p">,</span>  <span class="mf">2.68444234</span><span class="p">,</span>  <span class="mf">2.68729865</span><span class="p">,</span>  <span class="mf">2.69284723</span><span class="p">,</span>
        <span class="mf">2.69293408</span><span class="p">,</span>  <span class="mf">2.69831862</span><span class="p">,</span>  <span class="mf">2.70093369</span><span class="p">,</span>  <span class="mf">2.70350051</span><span class="p">,</span>  <span class="mf">2.70581644</span><span class="p">,</span>
        <span class="mf">2.70600943</span><span class="p">,</span>  <span class="mf">2.7138643</span> <span class="p">,</span>  <span class="mf">2.71949008</span><span class="p">,</span>  <span class="mf">2.72247184</span><span class="p">,</span>  <span class="mf">2.72264553</span><span class="p">,</span>
        <span class="mf">2.72830991</span><span class="p">,</span>  <span class="mf">2.73125307</span><span class="p">,</span>  <span class="mf">2.73417693</span><span class="p">,</span>  <span class="mf">2.7370622</span> <span class="p">,</span>  <span class="mf">2.73983166</span><span class="p">,</span>
        <span class="mf">2.75361145</span><span class="p">,</span>  <span class="mf">2.75900563</span><span class="p">,</span>  <span class="mf">2.76430332</span><span class="p">,</span>  <span class="mf">2.76687015</span><span class="p">,</span>  <span class="mf">2.76928257</span><span class="p">,</span>
        <span class="mf">2.76938872</span><span class="p">,</span>  <span class="mf">2.77458026</span><span class="p">,</span>  <span class="mf">2.779849</span>  <span class="p">,</span>  <span class="mf">2.78241583</span><span class="p">,</span>  <span class="mf">2.78542654</span><span class="p">,</span>
        <span class="mf">2.78803196</span><span class="p">,</span>  <span class="mf">2.79375423</span><span class="p">,</span>  <span class="mf">2.79664915</span><span class="p">,</span>  <span class="mf">2.80223633</span><span class="p">,</span>  <span class="mf">2.80769806</span><span class="p">,</span>
        <span class="mf">2.81575557</span><span class="p">,</span>  <span class="mf">2.81835134</span><span class="p">,</span>  <span class="mf">2.82073482</span><span class="p">,</span>  <span class="mf">2.82086026</span><span class="p">,</span>  <span class="mf">2.82099536</span><span class="p">,</span>
        <span class="mf">2.82335954</span><span class="p">,</span>  <span class="mf">2.82884057</span><span class="p">,</span>  <span class="mf">2.83448565</span><span class="p">,</span>  <span class="mf">2.83740951</span><span class="p">,</span>  <span class="mf">2.84023688</span><span class="p">,</span>
        <span class="mf">2.84035268</span><span class="p">,</span>  <span class="mf">2.84318969</span><span class="p">,</span>  <span class="mf">2.8460653</span> <span class="p">,</span>  <span class="mf">2.84896021</span><span class="p">,</span>  <span class="mf">2.85185513</span><span class="p">,</span>
        <span class="mf">2.85742301</span><span class="p">,</span>  <span class="mf">2.86298124</span><span class="p">,</span>  <span class="mf">2.87659698</span><span class="p">,</span>  <span class="mf">2.87941469</span><span class="p">,</span>  <span class="mf">2.89031886</span><span class="p">,</span>
        <span class="mf">2.89854042</span><span class="p">,</span>  <span class="mf">2.90934809</span><span class="p">,</span>  <span class="mf">2.92025226</span><span class="p">,</span>  <span class="mf">2.9339452</span> <span class="p">,</span>  <span class="mf">2.94472392</span><span class="p">,</span>
        <span class="mf">2.96654191</span><span class="p">,</span>  <span class="mf">2.98289817</span><span class="p">,</span>  <span class="mf">2.99927372</span><span class="p">,</span>  <span class="mf">3.01290876</span><span class="p">,</span>  <span class="mf">3.03735147</span><span class="p">,</span>
        <span class="mf">3.04829424</span><span class="p">,</span>  <span class="mf">3.06466014</span><span class="p">,</span>  <span class="mf">3.0726501</span> <span class="p">,</span>  <span class="mf">3.07786095</span><span class="p">,</span>  <span class="mf">3.08304284</span><span class="p">,</span>
        <span class="mf">3.08557106</span><span class="p">,</span>  <span class="mf">3.08813789</span><span class="p">,</span>  <span class="mf">3.09345487</span><span class="p">,</span>  <span class="mf">3.09911925</span><span class="p">,</span>  <span class="mf">3.10474503</span><span class="p">,</span>
        <span class="mf">3.10487048</span><span class="p">,</span>  <span class="mf">3.10781364</span><span class="p">,</span>  <span class="mf">3.11340082</span><span class="p">,</span>  <span class="mf">3.11348767</span><span class="p">,</span>  <span class="mf">3.12694901</span><span class="p">,</span>
        <span class="mf">3.12704551</span><span class="p">,</span>  <span class="mf">3.12952548</span><span class="p">,</span>  <span class="mf">3.13210196</span><span class="p">,</span>  <span class="mf">3.13473633</span><span class="p">,</span>  <span class="mf">3.1373707</span> <span class="p">,</span>
        <span class="mf">3.13749614</span><span class="p">,</span>  <span class="mf">3.14315087</span><span class="p">,</span>  <span class="mf">3.14607473</span><span class="p">,</span>  <span class="mf">3.14621948</span><span class="p">,</span>  <span class="mf">3.14908544</span><span class="p">,</span>
        <span class="mf">3.14914334</span><span class="p">,</span>  <span class="mf">3.15474017</span><span class="p">,</span>  <span class="mf">3.15765438</span><span class="p">,</span>  <span class="mf">3.16053965</span><span class="p">,</span>  <span class="mf">3.16337666</span><span class="p">,</span>
        <span class="mf">3.17162716</span><span class="p">,</span>  <span class="mf">3.17998381</span><span class="p">,</span>  <span class="mf">3.19369604</span><span class="p">,</span>  <span class="mf">3.20467741</span><span class="p">,</span>  <span class="mf">3.21547544</span><span class="p">,</span>
        <span class="mf">3.23462046</span><span class="p">,</span>  <span class="mf">3.24272621</span><span class="p">,</span>  <span class="mf">3.26179404</span><span class="p">,</span>  <span class="mf">3.27815994</span><span class="p">,</span>  <span class="mf">3.28909306</span><span class="p">,</span>
        <span class="mf">3.29174673</span><span class="p">,</span>  <span class="mf">3.30531422</span><span class="p">,</span>  <span class="mf">3.30805474</span><span class="p">,</span>  <span class="mf">3.32164153</span><span class="p">,</span>  <span class="mf">3.33527657</span><span class="p">,</span>
        <span class="mf">3.35438299</span><span class="p">,</span>  <span class="mf">3.36251769</span><span class="p">,</span>  <span class="mf">3.37613343</span><span class="p">,</span>  <span class="mf">3.38425849</span><span class="p">,</span>  <span class="mf">3.3952688</span> <span class="p">,</span>
        <span class="mf">3.40890384</span><span class="p">,</span>  <span class="mf">3.42254853</span><span class="p">,</span>  <span class="mf">3.43348165</span><span class="p">,</span>  <span class="mf">3.44437617</span><span class="p">,</span>  <span class="mf">3.45804015</span><span class="p">,</span>
        <span class="mf">3.47168484</span><span class="p">,</span>  <span class="mf">3.48261796</span><span class="p">,</span>  <span class="mf">3.49624335</span><span class="p">,</span>  <span class="mf">3.50985909</span><span class="p">,</span>  <span class="mf">3.51528222</span><span class="p">,</span>
        <span class="mf">3.52077291</span><span class="p">,</span>  <span class="mf">3.53442725</span><span class="p">,</span>  <span class="mf">3.5425716</span> <span class="p">,</span>  <span class="mf">3.55618734</span><span class="p">,</span>  <span class="mf">3.56709151</span><span class="p">,</span>
        <span class="mf">3.57801498</span><span class="p">,</span>  <span class="mf">3.58348636</span><span class="p">,</span>  <span class="mf">3.59440018</span><span class="p">])</span>

    <span class="n">fig12top_w_raw</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
      <span class="p">[</span>  <span class="mf">4.18764000e-02</span><span class="p">,</span>   <span class="mf">4.18600000e-02</span><span class="p">,</span>   <span class="mf">1.56698000e-02</span><span class="p">,</span>
         <span class="mf">3.65997000e-02</span><span class="p">,</span>   <span class="mf">3.65710000e-02</span><span class="p">,</span>  <span class="o">-</span><span class="mf">9.45000000e-05</span><span class="p">,</span>
         <span class="mf">1.03684000e-02</span><span class="p">,</span>   <span class="mf">1.03520000e-02</span><span class="p">,</span>   <span class="mf">4.17449000e-02</span><span class="p">,</span>
         <span class="mf">2.07862000e-02</span><span class="p">,</span>  <span class="o">-</span><span class="mf">1.58670000e-02</span><span class="p">,</span>  <span class="o">-</span><span class="mf">4.20614000e-02</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">2.11273000e-02</span><span class="p">,</span>  <span class="o">-</span><span class="mf">4.73216000e-02</span><span class="p">,</span>  <span class="o">-</span><span class="mf">2.63916000e-02</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">5.78256000e-02</span><span class="p">,</span>  <span class="o">-</span><span class="mf">7.87721000e-02</span><span class="p">,</span>  <span class="o">-</span><span class="mf">7.87926000e-02</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">9.45199000e-02</span><span class="p">,</span>  <span class="o">-</span><span class="mf">1.25942000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">1.25962000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">9.45692000e-02</span><span class="p">,</span>  <span class="o">-</span><span class="mf">1.20764000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">1.41710000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.57421000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">1.67921000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">1.78421000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.78441000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">1.88945000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">1.62796000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.88995000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">2.04730000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">2.36168000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">2.15246000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">1.94333000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">2.30994000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">2.51957000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">2.88619000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">2.67689000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">2.93891000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">3.35784000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">3.04383000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">3.41044000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">3.25350000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">3.41065000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">3.25370000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">3.41089000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">3.88214000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">4.45813000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">5.08644000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">5.81947000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">6.65720000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">7.39022000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">7.96618000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">7.49510000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">6.86691000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">6.34339000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">5.81988000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">5.40107000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">4.98227000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">5.19177000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">5.50595000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">5.87248000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">6.34372000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">7.75737000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">7.02439000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">8.33337000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">7.91464000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">6.50104000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">7.23406000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">5.87281000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">5.24458000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">3.98821000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">3.56940000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">3.30770000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">2.88898000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">2.62728000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">2.31323000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.99922000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">2.20885000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">2.62778000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">2.52319000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">2.68046000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">2.94236000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">3.04712000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">2.99492000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">3.20451000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">3.25703000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">3.51889000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">3.30955000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">3.20496000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">3.10038000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">3.30992000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">3.46720000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">3.67674000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">3.78158000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">3.99104000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">4.25311000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">4.04381000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">4.51509000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">4.93402000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">6.03353000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">5.40526000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">8.07549000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">7.13309000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">9.17501000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">8.86087000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">8.96566000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">8.65161000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">8.07574000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">7.49987000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">7.39520000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">6.92399000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">6.55759000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">6.19109000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">5.87704000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">6.55775000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">6.13894000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">7.60495000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">6.97668000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">8.33797000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">7.97148000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">8.12867000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">7.97164000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">7.50048000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">7.29110000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">6.71523000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">6.29638000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">5.98229000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">5.40642000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">4.98761000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">4.62112000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">4.51649000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">4.30707000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">4.15008000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">3.94070000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">3.62665000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">3.73144000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">4.04562000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">4.46450000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">4.98810000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">5.66877000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">6.40179000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">7.34424000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">7.92019000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">8.39144000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">7.60622000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">7.34444000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">6.97799000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">6.55919000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">6.08807000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">5.77393000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">5.14570000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">5.30290000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">5.66943000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">6.61187000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">6.03596000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">7.34489000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">7.92085000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">8.33974000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">7.86862000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">6.40265000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">7.34510000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">6.87390000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">5.98385000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">5.46033000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">5.09397000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">4.57045000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">4.09929000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">3.57577000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">3.20940000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">3.05246000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">2.89547000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">2.63374000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">2.37208000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">2.79109000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">2.52931000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">3.05291000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">3.00076000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">3.00101000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">3.26295000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">3.36783000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">3.62969000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">3.57741000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">3.78704000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">3.68245000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">3.78733000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">3.68270000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">3.94460000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">4.04948000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">3.94493000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">4.25911000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">4.57361000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">4.52142000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">4.73089000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">4.99271000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">6.03986000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">5.46395000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">6.72057000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">7.76773000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">7.19181000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">9.02435000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">8.39608000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">9.28617000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">9.02443000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">8.18678000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">8.55331000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">7.97744000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">7.45392000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">7.08743000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">6.72098000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">6.24990000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">6.40701000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">6.66887000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">6.98305000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">8.08256000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">7.45429000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">8.29203000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">8.65860000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">8.29215000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">7.76863000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">7.50689000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">6.98342000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">6.51222000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">6.25048000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">5.72692000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">5.36051000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">4.83695000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">4.26108000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">3.99947000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">3.68541000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">4.10434000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">3.79021000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">4.78505000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">5.41336000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">6.04167000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">7.50767000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">6.72234000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">7.76949000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">8.34545000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">8.08375000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">7.35077000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">6.93201000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">6.51324000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">6.14679000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">5.62328000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">5.51865000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">5.72815000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">6.51353000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">6.09468000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">8.03193000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">7.19424000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">8.60793000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">7.24672000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">7.82271000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">6.51382000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">5.67617000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">4.99558000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">4.89087000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">4.36744000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">3.94859000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">3.63462000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">3.26817000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">2.95416000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">2.79717000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">2.43068000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">2.16899000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">2.43093000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">2.90225000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">2.64048000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">3.26899000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">3.16440000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">3.05977000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">3.16461000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">3.37428000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">3.26969000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">3.37448000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">3.21754000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">3.11287000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">3.27006000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">3.16543000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">3.37506000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">3.58465000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">3.79415000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">4.00370000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">4.31787000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">4.21333000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">4.16105000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">4.26589000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">4.42304000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">4.68494000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">5.15618000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">5.73214000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">7.19814000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">6.30809000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">7.98352000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">8.61183000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">9.13547000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">9.08324000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">8.55968000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">8.03621000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">7.46033000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">6.62268000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">6.20392000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">7.25120000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">6.57057000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">7.87955000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">8.56022000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">9.18853000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">8.56034000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">7.82740000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">6.98971000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">6.46627000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">5.94275000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">5.31448000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">4.84332000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">4.26745000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">4.16282000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">3.84881000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">3.63939000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">3.79654000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">4.00608000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">4.52968000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">4.89621000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">6.10044000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">5.31510000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">6.93817000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">7.61884000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">7.88070000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">7.35726000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">6.93842000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">6.04845000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">5.78667000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">5.42026000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">5.05386000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">5.73460000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">6.93883000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">6.46763000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">7.56718000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">8.09078000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">6.88664000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">7.41024000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">6.41548000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">5.68254000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">5.42080000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">5.00203000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">4.47856000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">3.90264000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">3.48388000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">3.32694000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">3.06516000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">2.69875000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">2.43718000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">2.54205000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">2.43742000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">2.80399000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">2.96131000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">3.22342000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">3.43292000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">3.64255000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">3.38094000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">3.53821000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">3.48602000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">3.85271000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">3.90523000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">4.21945000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">4.48139000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">4.42924000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">4.27226000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">4.74367000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">5.94793000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">5.42437000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">6.62864000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">7.98993000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">7.36166000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">8.56593000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">9.08957000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">8.93258000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">8.51378000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">8.09493000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">7.51906000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">7.15265000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">6.73380000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">6.26268000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">6.94339000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">6.62926000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">7.51939000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">8.09534000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">8.77601000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">9.24729000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">8.40968000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">7.62439000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">7.04851000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">6.42028000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">5.73974000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">5.32094000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">4.64035000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">4.01208000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">3.69815000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">3.90766000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">4.32659000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">4.85019000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">5.42618000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">5.84507000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">7.25872000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">6.57809000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">7.73000000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">7.36363000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">6.94483000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">6.36892000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">5.95015000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">5.47895000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">4.95551000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">6.00275000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">5.42684000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">6.47400000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">7.57351000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">7.04995000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">8.41128000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">7.57372000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">7.20722000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">5.95073000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">5.42725000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">5.21787000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">5.00845000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">4.48489000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">3.85670000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">3.59500000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">3.28099000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">2.96690000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">2.91471000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">2.65297000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">2.70553000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">3.01979000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">3.22946000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">3.12499000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">3.64867000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">3.96306000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">3.85847000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">3.64908000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">3.64925000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">3.59698000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">3.64954000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">3.80673000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">3.91164000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">4.22590000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">4.54012000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">4.64500000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">4.38330000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">4.59280000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">4.85475000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">5.32603000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">5.90199000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">7.26332000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">6.47798000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">8.15345000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">8.99118000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">9.46243000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">9.04366000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">8.67721000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">8.10130000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">7.63018000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">7.26373000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">6.79257000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">6.42616000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">6.11203000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">6.37389000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">6.79278000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">7.36873000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">8.88709000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">8.15411000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">9.35842000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">8.73023000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">7.78786000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">7.15959000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">6.37434000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">5.58904000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">4.85610000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">4.28023000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">4.12320000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">3.59985000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">3.80936000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">4.38535000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">4.96131000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">6.11318000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">5.74669000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">6.68917000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">7.36988000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">7.94584000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">6.89876000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">7.37000000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">6.37533000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">5.74710000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">5.27598000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">5.22370000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">5.69503000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">6.16627000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">7.42285000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">6.95165000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">6.48045000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">7.78939000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">7.68476000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">7.00421000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">6.27127000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">5.90482000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">5.48598000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">5.06717000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">4.54365000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">3.91543000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">3.28720000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">2.86843000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">2.50202000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">2.55459000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">2.24049000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">2.24066000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">2.08371000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">2.45037000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">2.45053000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">2.24131000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">2.71268000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">2.71301000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">2.71326000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">2.66115000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">2.66135000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">3.02821000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">2.87131000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">2.87156000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">3.55230000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">4.44244000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">5.43728000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">6.17030000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">6.74626000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">7.26990000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">6.48464000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">5.85645000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">5.38525000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">4.59995000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">4.12883000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">3.81470000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">4.44318000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">4.07668000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">4.96677000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">5.54273000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">5.85691000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">6.22344000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">5.75223000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">5.01934000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">4.28640000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">3.76284000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">3.23932000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">3.02990000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">2.50642000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.82584000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">1.24996000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">8.31159000e-02</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">5.69503000e-02</span><span class="p">,</span>   <span class="mf">5.86434000e-03</span><span class="p">,</span>   <span class="mf">3.72573000e-02</span><span class="p">,</span>
         <span class="mf">6.34187000e-02</span><span class="p">,</span>   <span class="mf">2.15177000e-02</span><span class="p">,</span>   <span class="mf">4.24312000e-02</span><span class="p">,</span>
         <span class="mf">1.62410000e-02</span><span class="p">,</span>   <span class="mf">1.09766000e-02</span><span class="p">,</span>   <span class="mf">1.09520000e-02</span><span class="p">,</span>
         <span class="mf">2.14067000e-02</span><span class="p">,</span>  <span class="o">-</span><span class="mf">4.77531000e-03</span><span class="p">,</span>  <span class="o">-</span><span class="mf">3.09738000e-02</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">2.57423000e-02</span><span class="p">,</span>  <span class="o">-</span><span class="mf">4.14696000e-02</span><span class="p">,</span>  <span class="o">-</span><span class="mf">4.14901000e-02</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">3.62833000e-02</span><span class="p">,</span>  <span class="o">-</span><span class="mf">5.20024000e-02</span><span class="p">,</span>  <span class="o">-</span><span class="mf">5.72585000e-02</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">7.82132000e-02</span><span class="p">,</span>  <span class="o">-</span><span class="mf">4.15805000e-02</span><span class="p">,</span>  <span class="o">-</span><span class="mf">4.16011000e-02</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">3.63861000e-02</span><span class="p">,</span>  <span class="o">-</span><span class="mf">2.59313000e-02</span><span class="p">,</span>  <span class="o">-</span><span class="mf">3.11833000e-02</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">2.07327000e-02</span><span class="p">,</span>  <span class="o">-</span><span class="mf">1.55177000e-02</span><span class="p">,</span>  <span class="o">-</span><span class="mf">5.06298000e-03</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.03191000e-02</span><span class="p">,</span>  <span class="o">-</span><span class="mf">1.55752000e-02</span><span class="p">,</span>  <span class="o">-</span><span class="mf">2.60546000e-02</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.55917000e-02</span><span class="p">,</span>  <span class="o">-</span><span class="mf">5.14106000e-03</span><span class="p">,</span>  <span class="o">-</span><span class="mf">2.08601000e-02</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">2.61163000e-02</span><span class="p">,</span>  <span class="o">-</span><span class="mf">2.61327000e-02</span><span class="p">,</span>  <span class="o">-</span><span class="mf">2.09136000e-02</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.56862000e-02</span><span class="p">,</span>  <span class="o">-</span><span class="mf">1.04671000e-02</span><span class="p">])</span>



    <span class="n">fig13top_t_raw</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
      <span class="p">[</span> <span class="mf">0.179243</span><span class="p">,</span>  <span class="mf">0.183404</span><span class="p">,</span>  <span class="mf">0.195889</span><span class="p">,</span>  <span class="mf">0.208374</span><span class="p">,</span>  <span class="mf">0.214617</span><span class="p">,</span>  <span class="mf">0.22294</span> <span class="p">,</span>
        <span class="mf">0.229183</span><span class="p">,</span>  <span class="mf">0.239587</span><span class="p">,</span>  <span class="mf">0.24791</span> <span class="p">,</span>  <span class="mf">0.258314</span><span class="p">,</span>  <span class="mf">0.264557</span><span class="p">,</span>  <span class="mf">0.27288</span> <span class="p">,</span>
        <span class="mf">0.279123</span><span class="p">,</span>  <span class="mf">0.289527</span><span class="p">,</span>  <span class="mf">0.29785</span> <span class="p">,</span>  <span class="mf">0.306174</span><span class="p">,</span>  <span class="mf">0.312416</span><span class="p">,</span>  <span class="mf">0.316578</span><span class="p">,</span>
        <span class="mf">0.333225</span><span class="p">,</span>  <span class="mf">0.335305</span><span class="p">,</span>  <span class="mf">0.351952</span><span class="p">,</span>  <span class="mf">0.37068</span> <span class="p">,</span>  <span class="mf">0.374841</span><span class="p">,</span>  <span class="mf">0.376922</span><span class="p">,</span>
        <span class="mf">0.385246</span><span class="p">,</span>  <span class="mf">0.387326</span><span class="p">,</span>  <span class="mf">0.393569</span><span class="p">,</span>  <span class="mf">0.399811</span><span class="p">,</span>  <span class="mf">0.399811</span><span class="p">,</span>  <span class="mf">0.403973</span><span class="p">,</span>
        <span class="mf">0.408135</span><span class="p">,</span>  <span class="mf">0.416458</span><span class="p">,</span>  <span class="mf">0.418539</span><span class="p">,</span>  <span class="mf">0.422701</span><span class="p">,</span>  <span class="mf">0.426862</span><span class="p">,</span>  <span class="mf">0.433105</span><span class="p">,</span>
        <span class="mf">0.439347</span><span class="p">,</span>  <span class="mf">0.443509</span><span class="p">,</span>  <span class="mf">0.443509</span><span class="p">,</span>  <span class="mf">0.451832</span><span class="p">,</span>  <span class="mf">0.453913</span><span class="p">,</span>  <span class="mf">0.455994</span><span class="p">,</span>
        <span class="mf">0.462237</span><span class="p">,</span>  <span class="mf">0.464317</span><span class="p">,</span>  <span class="mf">0.466398</span><span class="p">,</span>  <span class="mf">0.468479</span><span class="p">,</span>  <span class="mf">0.474722</span><span class="p">,</span>  <span class="mf">0.476802</span><span class="p">,</span>
        <span class="mf">0.478883</span><span class="p">,</span>  <span class="mf">0.483045</span><span class="p">,</span>  <span class="mf">0.487207</span><span class="p">,</span>  <span class="mf">0.491368</span><span class="p">,</span>  <span class="mf">0.493449</span><span class="p">,</span>  <span class="mf">0.49553</span> <span class="p">,</span>
        <span class="mf">0.505934</span><span class="p">,</span>  <span class="mf">0.510096</span><span class="p">,</span>  <span class="mf">0.514257</span><span class="p">,</span>  <span class="mf">0.5205</span>  <span class="p">,</span>  <span class="mf">0.522581</span><span class="p">,</span>  <span class="mf">0.526743</span><span class="p">,</span>
        <span class="mf">0.532985</span><span class="p">,</span>  <span class="mf">0.541308</span><span class="p">,</span>  <span class="mf">0.549632</span><span class="p">,</span>  <span class="mf">0.557955</span><span class="p">,</span>  <span class="mf">0.57044</span> <span class="p">,</span>  <span class="mf">0.574602</span><span class="p">,</span>
        <span class="mf">0.587087</span><span class="p">,</span>  <span class="mf">0.591249</span><span class="p">,</span>  <span class="mf">0.593329</span><span class="p">,</span>  <span class="mf">0.603734</span><span class="p">,</span>  <span class="mf">0.612057</span><span class="p">,</span>  <span class="mf">0.614138</span><span class="p">,</span>
        <span class="mf">0.62038</span> <span class="p">,</span>  <span class="mf">0.628704</span><span class="p">,</span>  <span class="mf">0.637027</span><span class="p">,</span>  <span class="mf">0.64535</span> <span class="p">,</span>  <span class="mf">0.647431</span><span class="p">,</span>  <span class="mf">0.653674</span><span class="p">,</span>
        <span class="mf">0.659916</span><span class="p">,</span>  <span class="mf">0.664078</span><span class="p">,</span>  <span class="mf">0.674482</span><span class="p">,</span>  <span class="mf">0.678644</span><span class="p">,</span>  <span class="mf">0.686967</span><span class="p">,</span>  <span class="mf">0.689048</span><span class="p">,</span>
        <span class="mf">0.69321</span> <span class="p">,</span>  <span class="mf">0.697371</span><span class="p">,</span>  <span class="mf">0.699452</span><span class="p">,</span>  <span class="mf">0.701533</span><span class="p">,</span>  <span class="mf">0.705695</span><span class="p">,</span>  <span class="mf">0.709856</span><span class="p">,</span>
        <span class="mf">0.711937</span><span class="p">,</span>  <span class="mf">0.716099</span><span class="p">,</span>  <span class="mf">0.71818</span> <span class="p">,</span>  <span class="mf">0.726503</span><span class="p">,</span>  <span class="mf">0.732746</span><span class="p">,</span>  <span class="mf">0.734826</span><span class="p">,</span>
        <span class="mf">0.738988</span><span class="p">,</span>  <span class="mf">0.74315</span> <span class="p">,</span>  <span class="mf">0.749392</span><span class="p">,</span>  <span class="mf">0.751473</span><span class="p">,</span>  <span class="mf">0.753554</span><span class="p">,</span>  <span class="mf">0.755635</span><span class="p">,</span>
        <span class="mf">0.759796</span><span class="p">,</span>  <span class="mf">0.761877</span><span class="p">,</span>  <span class="mf">0.766039</span><span class="p">,</span>  <span class="mf">0.770201</span><span class="p">,</span>  <span class="mf">0.772281</span><span class="p">,</span>  <span class="mf">0.774362</span><span class="p">,</span>
        <span class="mf">0.776443</span><span class="p">,</span>  <span class="mf">0.780605</span><span class="p">,</span>  <span class="mf">0.784766</span><span class="p">,</span>  <span class="mf">0.786847</span><span class="p">,</span>  <span class="mf">0.791009</span><span class="p">,</span>  <span class="mf">0.795171</span><span class="p">,</span>
        <span class="mf">0.801413</span><span class="p">,</span>  <span class="mf">0.809737</span><span class="p">,</span>  <span class="mf">0.813898</span><span class="p">,</span>  <span class="mf">0.815979</span><span class="p">,</span>  <span class="mf">0.820141</span><span class="p">,</span>  <span class="mf">0.822222</span><span class="p">,</span>
        <span class="mf">0.826383</span><span class="p">,</span>  <span class="mf">0.828464</span><span class="p">,</span>  <span class="mf">0.830545</span><span class="p">,</span>  <span class="mf">0.834707</span><span class="p">,</span>  <span class="mf">0.840949</span><span class="p">,</span>  <span class="mf">0.84303</span> <span class="p">,</span>
        <span class="mf">0.84303</span> <span class="p">,</span>  <span class="mf">0.845111</span><span class="p">,</span>  <span class="mf">0.859677</span><span class="p">,</span>  <span class="mf">0.863838</span><span class="p">,</span>  <span class="mf">0.865919</span><span class="p">,</span>  <span class="mf">0.870081</span><span class="p">,</span>
        <span class="mf">0.872162</span><span class="p">,</span>  <span class="mf">0.878404</span><span class="p">,</span>  <span class="mf">0.884647</span><span class="p">,</span>  <span class="mf">0.886728</span><span class="p">,</span>  <span class="mf">0.888808</span><span class="p">,</span>  <span class="mf">0.890889</span><span class="p">,</span>
        <span class="mf">0.895051</span><span class="p">,</span>  <span class="mf">0.897132</span><span class="p">,</span>  <span class="mf">0.901293</span><span class="p">,</span>  <span class="mf">0.903374</span><span class="p">,</span>  <span class="mf">0.905455</span><span class="p">,</span>  <span class="mf">0.91794</span> <span class="p">,</span>
        <span class="mf">0.920021</span><span class="p">,</span>  <span class="mf">0.928344</span><span class="p">,</span>  <span class="mf">0.94291</span> <span class="p">,</span>  <span class="mf">0.947072</span><span class="p">,</span>  <span class="mf">0.955395</span><span class="p">,</span>  <span class="mf">0.957476</span><span class="p">,</span>
        <span class="mf">0.963719</span><span class="p">,</span>  <span class="mf">0.965799</span><span class="p">,</span>  <span class="mf">0.974123</span><span class="p">,</span>  <span class="mf">0.980365</span><span class="p">,</span>  <span class="mf">0.984527</span><span class="p">,</span>  <span class="mf">0.990769</span><span class="p">,</span>
        <span class="mf">0.994931</span><span class="p">,</span>  <span class="mf">0.997012</span><span class="p">,</span>  <span class="mf">1.00534</span> <span class="p">,</span>  <span class="mf">1.0095</span>  <span class="p">,</span>  <span class="mf">1.02198</span> <span class="p">,</span>  <span class="mf">1.02614</span> <span class="p">,</span>
        <span class="mf">1.03447</span> <span class="p">,</span>  <span class="mf">1.04071</span> <span class="p">,</span>  <span class="mf">1.04695</span> <span class="p">,</span>  <span class="mf">1.04903</span> <span class="p">,</span>  <span class="mf">1.05528</span> <span class="p">,</span>  <span class="mf">1.0636</span>  <span class="p">,</span>
        <span class="mf">1.06776</span> <span class="p">,</span>  <span class="mf">1.07192</span> <span class="p">,</span>  <span class="mf">1.07816</span> <span class="p">,</span>  <span class="mf">1.08441</span> <span class="p">,</span>  <span class="mf">1.09065</span> <span class="p">,</span>  <span class="mf">1.09897</span> <span class="p">,</span>
        <span class="mf">1.11146</span> <span class="p">,</span>  <span class="mf">1.11354</span> <span class="p">,</span>  <span class="mf">1.11562</span> <span class="p">,</span>  <span class="mf">1.11978</span> <span class="p">,</span>  <span class="mf">1.12394</span> <span class="p">,</span>  <span class="mf">1.12602</span> <span class="p">,</span>
        <span class="mf">1.1281</span>  <span class="p">,</span>  <span class="mf">1.13019</span> <span class="p">,</span>  <span class="mf">1.13227</span> <span class="p">,</span>  <span class="mf">1.13851</span> <span class="p">,</span>  <span class="mf">1.14059</span> <span class="p">,</span>  <span class="mf">1.14475</span> <span class="p">,</span>
        <span class="mf">1.15099</span> <span class="p">,</span>  <span class="mf">1.15307</span> <span class="p">,</span>  <span class="mf">1.15724</span> <span class="p">,</span>  <span class="mf">1.15724</span> <span class="p">,</span>  <span class="mf">1.16764</span> <span class="p">,</span>  <span class="mf">1.17388</span> <span class="p">,</span>
        <span class="mf">1.17596</span> <span class="p">,</span>  <span class="mf">1.18013</span> <span class="p">,</span>  <span class="mf">1.18221</span> <span class="p">,</span>  <span class="mf">1.18637</span> <span class="p">,</span>  <span class="mf">1.18845</span> <span class="p">,</span>  <span class="mf">1.19469</span> <span class="p">,</span>
        <span class="mf">1.19677</span> <span class="p">,</span>  <span class="mf">1.19677</span> <span class="p">,</span>  <span class="mf">1.20093</span> <span class="p">,</span>  <span class="mf">1.20301</span> <span class="p">,</span>  <span class="mf">1.21134</span> <span class="p">,</span>  <span class="mf">1.21342</span> <span class="p">,</span>
        <span class="mf">1.21966</span> <span class="p">,</span>  <span class="mf">1.2259</span>  <span class="p">,</span>  <span class="mf">1.23215</span> <span class="p">,</span>  <span class="mf">1.23423</span> <span class="p">,</span>  <span class="mf">1.23631</span> <span class="p">,</span>  <span class="mf">1.23839</span> <span class="p">,</span>
        <span class="mf">1.24255</span> <span class="p">,</span>  <span class="mf">1.24463</span> <span class="p">,</span>  <span class="mf">1.24671</span> <span class="p">,</span>  <span class="mf">1.24879</span> <span class="p">,</span>  <span class="mf">1.25296</span> <span class="p">,</span>  <span class="mf">1.2592</span>  <span class="p">,</span>
        <span class="mf">1.26336</span> <span class="p">,</span>  <span class="mf">1.26544</span> <span class="p">,</span>  <span class="mf">1.26752</span> <span class="p">,</span>  <span class="mf">1.2696</span>  <span class="p">,</span>  <span class="mf">1.27376</span> <span class="p">,</span>  <span class="mf">1.27793</span> <span class="p">,</span>
        <span class="mf">1.28209</span> <span class="p">,</span>  <span class="mf">1.28625</span> <span class="p">,</span>  <span class="mf">1.28833</span> <span class="p">,</span>  <span class="mf">1.29041</span> <span class="p">,</span>  <span class="mf">1.29249</span> <span class="p">,</span>  <span class="mf">1.29665</span> <span class="p">,</span>
        <span class="mf">1.29873</span> <span class="p">,</span>  <span class="mf">1.30081</span> <span class="p">,</span>  <span class="mf">1.30914</span> <span class="p">,</span>  <span class="mf">1.31122</span> <span class="p">,</span>  <span class="mf">1.31122</span> <span class="p">,</span>  <span class="mf">1.3133</span>  <span class="p">,</span>
        <span class="mf">1.31746</span> <span class="p">,</span>  <span class="mf">1.32162</span> <span class="p">,</span>  <span class="mf">1.3237</span>  <span class="p">,</span>  <span class="mf">1.32787</span> <span class="p">,</span>  <span class="mf">1.34035</span> <span class="p">,</span>  <span class="mf">1.34243</span> <span class="p">,</span>
        <span class="mf">1.34867</span> <span class="p">,</span>  <span class="mf">1.35284</span> <span class="p">,</span>  <span class="mf">1.357</span>   <span class="p">,</span>  <span class="mf">1.3674</span>  <span class="p">,</span>  <span class="mf">1.37781</span> <span class="p">,</span>  <span class="mf">1.39237</span> <span class="p">,</span>
        <span class="mf">1.40278</span> <span class="p">,</span>  <span class="mf">1.4111</span>  <span class="p">,</span>  <span class="mf">1.4215</span>  <span class="p">,</span>  <span class="mf">1.42358</span> <span class="p">,</span>  <span class="mf">1.43399</span> <span class="p">,</span>  <span class="mf">1.44439</span> <span class="p">,</span>
        <span class="mf">1.4548</span>  <span class="p">,</span>  <span class="mf">1.46104</span> <span class="p">,</span>  <span class="mf">1.47144</span> <span class="p">,</span>  <span class="mf">1.47352</span> <span class="p">,</span>  <span class="mf">1.48393</span> <span class="p">,</span>  <span class="mf">1.49225</span> <span class="p">,</span>
        <span class="mf">1.50057</span> <span class="p">,</span>  <span class="mf">1.50474</span> <span class="p">,</span>  <span class="mf">1.50682</span> <span class="p">,</span>  <span class="mf">1.51722</span> <span class="p">,</span>  <span class="mf">1.52554</span> <span class="p">,</span>  <span class="mf">1.53595</span> <span class="p">,</span>
        <span class="mf">1.54011</span> <span class="p">,</span>  <span class="mf">1.54219</span> <span class="p">,</span>  <span class="mf">1.54635</span> <span class="p">,</span>  <span class="mf">1.54843</span> <span class="p">,</span>  <span class="mf">1.5526</span>  <span class="p">,</span>  <span class="mf">1.55676</span> <span class="p">,</span>
        <span class="mf">1.563</span>   <span class="p">,</span>  <span class="mf">1.56716</span> <span class="p">,</span>  <span class="mf">1.5734</span>  <span class="p">,</span>  <span class="mf">1.57549</span> <span class="p">,</span>  <span class="mf">1.57549</span> <span class="p">,</span>  <span class="mf">1.57965</span> <span class="p">,</span>
        <span class="mf">1.58173</span> <span class="p">,</span>  <span class="mf">1.58589</span> <span class="p">,</span>  <span class="mf">1.59005</span> <span class="p">,</span>  <span class="mf">1.59629</span> <span class="p">,</span>  <span class="mf">1.59837</span> <span class="p">,</span>  <span class="mf">1.60046</span> <span class="p">,</span>
        <span class="mf">1.60462</span> <span class="p">,</span>  <span class="mf">1.6067</span>  <span class="p">,</span>  <span class="mf">1.61294</span> <span class="p">,</span>  <span class="mf">1.61918</span> <span class="p">,</span>  <span class="mf">1.62126</span> <span class="p">,</span>  <span class="mf">1.62334</span> <span class="p">,</span>
        <span class="mf">1.62959</span> <span class="p">,</span>  <span class="mf">1.63167</span> <span class="p">,</span>  <span class="mf">1.63375</span> <span class="p">,</span>  <span class="mf">1.63791</span> <span class="p">,</span>  <span class="mf">1.63999</span> <span class="p">,</span>  <span class="mf">1.65248</span> <span class="p">,</span>
        <span class="mf">1.65456</span> <span class="p">,</span>  <span class="mf">1.65664</span> <span class="p">,</span>  <span class="mf">1.6608</span>  <span class="p">,</span>  <span class="mf">1.66288</span> <span class="p">,</span>  <span class="mf">1.66496</span> <span class="p">,</span>  <span class="mf">1.66912</span> <span class="p">,</span>
        <span class="mf">1.6712</span>  <span class="p">,</span>  <span class="mf">1.67328</span> <span class="p">,</span>  <span class="mf">1.67537</span> <span class="p">,</span>  <span class="mf">1.67953</span> <span class="p">,</span>  <span class="mf">1.68577</span> <span class="p">,</span>  <span class="mf">1.68785</span> <span class="p">,</span>
        <span class="mf">1.69201</span> <span class="p">,</span>  <span class="mf">1.69409</span> <span class="p">,</span>  <span class="mf">1.69617</span> <span class="p">,</span>  <span class="mf">1.70034</span> <span class="p">,</span>  <span class="mf">1.7045</span>  <span class="p">,</span>  <span class="mf">1.70866</span> <span class="p">,</span>
        <span class="mf">1.71282</span> <span class="p">,</span>  <span class="mf">1.7149</span>  <span class="p">,</span>  <span class="mf">1.71698</span> <span class="p">,</span>  <span class="mf">1.71906</span> <span class="p">,</span>  <span class="mf">1.72322</span> <span class="p">,</span>  <span class="mf">1.73363</span> <span class="p">,</span>
        <span class="mf">1.73363</span> <span class="p">,</span>  <span class="mf">1.73987</span> <span class="p">,</span>  <span class="mf">1.74195</span> <span class="p">,</span>  <span class="mf">1.74403</span> <span class="p">,</span>  <span class="mf">1.74611</span> <span class="p">,</span>  <span class="mf">1.75236</span> <span class="p">,</span>
        <span class="mf">1.75444</span> <span class="p">,</span>  <span class="mf">1.76068</span> <span class="p">,</span>  <span class="mf">1.76692</span> <span class="p">,</span>  <span class="mf">1.77316</span> <span class="p">,</span>  <span class="mf">1.78565</span> <span class="p">,</span>  <span class="mf">1.79397</span> <span class="p">,</span>
        <span class="mf">1.80022</span> <span class="p">,</span>  <span class="mf">1.80854</span> <span class="p">,</span>  <span class="mf">1.81686</span> <span class="p">,</span>  <span class="mf">1.82727</span> <span class="p">,</span>  <span class="mf">1.83767</span> <span class="p">,</span>  <span class="mf">1.84183</span> <span class="p">,</span>
        <span class="mf">1.84599</span> <span class="p">,</span>  <span class="mf">1.85848</span> <span class="p">,</span>  <span class="mf">1.86472</span> <span class="p">,</span>  <span class="mf">1.87721</span> <span class="p">,</span>  <span class="mf">1.88137</span> <span class="p">,</span>  <span class="mf">1.88761</span> <span class="p">,</span>
        <span class="mf">1.89801</span> <span class="p">,</span>  <span class="mf">1.90634</span> <span class="p">,</span>  <span class="mf">1.91674</span> <span class="p">,</span>  <span class="mf">1.92299</span> <span class="p">,</span>  <span class="mf">1.92923</span> <span class="p">,</span>  <span class="mf">1.93755</span> <span class="p">,</span>
        <span class="mf">1.94796</span> <span class="p">,</span>  <span class="mf">1.96044</span> <span class="p">,</span>  <span class="mf">1.96252</span> <span class="p">,</span>  <span class="mf">1.9646</span>  <span class="p">,</span>  <span class="mf">1.96876</span> <span class="p">,</span>  <span class="mf">1.97084</span> <span class="p">,</span>
        <span class="mf">1.97501</span> <span class="p">,</span>  <span class="mf">1.97917</span> <span class="p">,</span>  <span class="mf">1.98125</span> <span class="p">,</span>  <span class="mf">1.98541</span> <span class="p">,</span>  <span class="mf">1.98749</span> <span class="p">,</span>  <span class="mf">1.99165</span> <span class="p">,</span>
        <span class="mf">1.9979</span>  <span class="p">,</span>  <span class="mf">1.99998</span> <span class="p">,</span>  <span class="mf">2.00206</span> <span class="p">,</span>  <span class="mf">2.00622</span> <span class="p">,</span>  <span class="mf">2.01454</span> <span class="p">,</span>  <span class="mf">2.01662</span> <span class="p">,</span>
        <span class="mf">2.0187</span>  <span class="p">,</span>  <span class="mf">2.02078</span> <span class="p">,</span>  <span class="mf">2.02495</span> <span class="p">,</span>  <span class="mf">2.02703</span> <span class="p">,</span>  <span class="mf">2.02911</span> <span class="p">,</span>  <span class="mf">2.03535</span> <span class="p">,</span>
        <span class="mf">2.03743</span> <span class="p">,</span>  <span class="mf">2.04159</span> <span class="p">,</span>  <span class="mf">2.04367</span> <span class="p">,</span>  <span class="mf">2.04575</span> <span class="p">,</span>  <span class="mf">2.04784</span> <span class="p">,</span>  <span class="mf">2.05408</span> <span class="p">,</span>
        <span class="mf">2.05824</span> <span class="p">,</span>  <span class="mf">2.06032</span> <span class="p">,</span>  <span class="mf">2.0624</span>  <span class="p">,</span>  <span class="mf">2.06656</span> <span class="p">,</span>  <span class="mf">2.07697</span> <span class="p">,</span>  <span class="mf">2.07905</span> <span class="p">,</span>
        <span class="mf">2.08321</span> <span class="p">,</span>  <span class="mf">2.08529</span> <span class="p">,</span>  <span class="mf">2.08737</span> <span class="p">,</span>  <span class="mf">2.09153</span> <span class="p">,</span>  <span class="mf">2.09361</span> <span class="p">,</span>  <span class="mf">2.09569</span> <span class="p">,</span>
        <span class="mf">2.09778</span> <span class="p">,</span>  <span class="mf">2.10194</span> <span class="p">,</span>  <span class="mf">2.1061</span>  <span class="p">,</span>  <span class="mf">2.11026</span> <span class="p">,</span>  <span class="mf">2.11026</span> <span class="p">,</span>  <span class="mf">2.11234</span> <span class="p">,</span>
        <span class="mf">2.11442</span> <span class="p">,</span>  <span class="mf">2.12066</span> <span class="p">,</span>  <span class="mf">2.12483</span> <span class="p">,</span>  <span class="mf">2.12899</span> <span class="p">,</span>  <span class="mf">2.13315</span> <span class="p">,</span>  <span class="mf">2.13939</span> <span class="p">,</span>
        <span class="mf">2.14147</span> <span class="p">,</span>  <span class="mf">2.14355</span> <span class="p">,</span>  <span class="mf">2.1498</span>  <span class="p">,</span>  <span class="mf">2.15604</span> <span class="p">,</span>  <span class="mf">2.15812</span> <span class="p">,</span>  <span class="mf">2.16436</span> <span class="p">,</span>
        <span class="mf">2.16852</span> <span class="p">,</span>  <span class="mf">2.17269</span> <span class="p">,</span>  <span class="mf">2.17477</span> <span class="p">,</span>  <span class="mf">2.17685</span> <span class="p">,</span>  <span class="mf">2.18517</span> <span class="p">,</span>  <span class="mf">2.19141</span> <span class="p">,</span>
        <span class="mf">2.19557</span> <span class="p">,</span>  <span class="mf">2.20182</span> <span class="p">,</span>  <span class="mf">2.2039</span>  <span class="p">,</span>  <span class="mf">2.21014</span> <span class="p">,</span>  <span class="mf">2.2143</span>  <span class="p">,</span>  <span class="mf">2.21846</span> <span class="p">,</span>
        <span class="mf">2.22263</span> <span class="p">,</span>  <span class="mf">2.22679</span> <span class="p">,</span>  <span class="mf">2.23511</span> <span class="p">,</span>  <span class="mf">2.23719</span> <span class="p">,</span>  <span class="mf">2.24343</span> <span class="p">,</span>  <span class="mf">2.25384</span> <span class="p">,</span>
        <span class="mf">2.26008</span> <span class="p">,</span>  <span class="mf">2.26632</span> <span class="p">,</span>  <span class="mf">2.27673</span> <span class="p">,</span>  <span class="mf">2.28713</span> <span class="p">,</span>  <span class="mf">2.29337</span> <span class="p">,</span>  <span class="mf">2.3017</span>  <span class="p">,</span>
        <span class="mf">2.3121</span>  <span class="p">,</span>  <span class="mf">2.32251</span> <span class="p">,</span>  <span class="mf">2.33083</span> <span class="p">,</span>  <span class="mf">2.33915</span> <span class="p">,</span>  <span class="mf">2.36204</span> <span class="p">,</span>  <span class="mf">2.3662</span>  <span class="p">,</span>
        <span class="mf">2.37661</span> <span class="p">,</span>  <span class="mf">2.38493</span> <span class="p">,</span>  <span class="mf">2.39117</span> <span class="p">,</span>  <span class="mf">2.39534</span> <span class="p">,</span>  <span class="mf">2.39742</span> <span class="p">,</span>  <span class="mf">2.3995</span>  <span class="p">,</span>
        <span class="mf">2.40574</span> <span class="p">,</span>  <span class="mf">2.40782</span> <span class="p">,</span>  <span class="mf">2.4099</span>  <span class="p">,</span>  <span class="mf">2.41198</span> <span class="p">,</span>  <span class="mf">2.41614</span> <span class="p">,</span>  <span class="mf">2.42239</span> <span class="p">,</span>
        <span class="mf">2.42447</span> <span class="p">,</span>  <span class="mf">2.42863</span> <span class="p">,</span>  <span class="mf">2.43071</span> <span class="p">,</span>  <span class="mf">2.43903</span> <span class="p">,</span>  <span class="mf">2.44319</span> <span class="p">,</span>  <span class="mf">2.44528</span> <span class="p">,</span>
        <span class="mf">2.44944</span> <span class="p">,</span>  <span class="mf">2.4536</span>  <span class="p">,</span>  <span class="mf">2.45568</span> <span class="p">,</span>  <span class="mf">2.45984</span> <span class="p">,</span>  <span class="mf">2.464</span>   <span class="p">,</span>  <span class="mf">2.46608</span> <span class="p">,</span>
        <span class="mf">2.46816</span> <span class="p">,</span>  <span class="mf">2.47233</span> <span class="p">,</span>  <span class="mf">2.47649</span> <span class="p">,</span>  <span class="mf">2.47857</span> <span class="p">,</span>  <span class="mf">2.48273</span> <span class="p">,</span>  <span class="mf">2.48481</span> <span class="p">,</span>
        <span class="mf">2.48897</span> <span class="p">,</span>  <span class="mf">2.50562</span> <span class="p">,</span>  <span class="mf">2.50978</span> <span class="p">,</span>  <span class="mf">2.51394</span> <span class="p">,</span>  <span class="mf">2.5181</span>  <span class="p">,</span>  <span class="mf">2.52019</span> <span class="p">,</span>
        <span class="mf">2.52227</span> <span class="p">,</span>  <span class="mf">2.52435</span> <span class="p">,</span>  <span class="mf">2.52851</span> <span class="p">,</span>  <span class="mf">2.53267</span> <span class="p">,</span>  <span class="mf">2.53683</span> <span class="p">,</span>  <span class="mf">2.53891</span> <span class="p">,</span>
        <span class="mf">2.54099</span> <span class="p">,</span>  <span class="mf">2.54516</span> <span class="p">,</span>  <span class="mf">2.54932</span> <span class="p">,</span>  <span class="mf">2.55556</span> <span class="p">,</span>  <span class="mf">2.55764</span> <span class="p">,</span>  <span class="mf">2.55972</span> <span class="p">,</span>
        <span class="mf">2.56388</span> <span class="p">,</span>  <span class="mf">2.56804</span> <span class="p">,</span>  <span class="mf">2.57013</span> <span class="p">,</span>  <span class="mf">2.57429</span> <span class="p">,</span>  <span class="mf">2.57637</span> <span class="p">,</span>  <span class="mf">2.58053</span> <span class="p">,</span>
        <span class="mf">2.58261</span> <span class="p">,</span>  <span class="mf">2.58677</span> <span class="p">,</span>  <span class="mf">2.59093</span> <span class="p">,</span>  <span class="mf">2.5951</span>  <span class="p">,</span>  <span class="mf">2.59718</span> <span class="p">,</span>  <span class="mf">2.59926</span> <span class="p">,</span>
        <span class="mf">2.60134</span> <span class="p">,</span>  <span class="mf">2.60342</span> <span class="p">,</span>  <span class="mf">2.61382</span> <span class="p">,</span>  <span class="mf">2.6159</span>  <span class="p">,</span>  <span class="mf">2.62007</span> <span class="p">,</span>  <span class="mf">2.63671</span> <span class="p">,</span>
        <span class="mf">2.64712</span> <span class="p">,</span>  <span class="mf">2.65752</span> <span class="p">,</span>  <span class="mf">2.66584</span> <span class="p">,</span>  <span class="mf">2.67209</span> <span class="p">,</span>  <span class="mf">2.68249</span> <span class="p">,</span>  <span class="mf">2.68873</span> <span class="p">,</span>
        <span class="mf">2.69706</span> <span class="p">,</span>  <span class="mf">2.71578</span> <span class="p">,</span>  <span class="mf">2.72619</span> <span class="p">,</span>  <span class="mf">2.73243</span> <span class="p">,</span>  <span class="mf">2.73867</span> <span class="p">,</span>  <span class="mf">2.75532</span> <span class="p">,</span>
        <span class="mf">2.76781</span> <span class="p">,</span>  <span class="mf">2.77197</span> <span class="p">,</span>  <span class="mf">2.78237</span> <span class="p">,</span>  <span class="mf">2.79069</span> <span class="p">,</span>  <span class="mf">2.79902</span> <span class="p">,</span>  <span class="mf">2.80526</span> <span class="p">,</span>
        <span class="mf">2.80942</span> <span class="p">,</span>  <span class="mf">2.81566</span> <span class="p">,</span>  <span class="mf">2.81775</span> <span class="p">,</span>  <span class="mf">2.81983</span> <span class="p">,</span>  <span class="mf">2.82399</span> <span class="p">,</span>  <span class="mf">2.82607</span> <span class="p">,</span>
        <span class="mf">2.82815</span> <span class="p">,</span>  <span class="mf">2.83023</span> <span class="p">,</span>  <span class="mf">2.83439</span> <span class="p">,</span>  <span class="mf">2.83647</span> <span class="p">,</span>  <span class="mf">2.83855</span> <span class="p">,</span>  <span class="mf">2.8448</span>  <span class="p">,</span>
        <span class="mf">2.84688</span> <span class="p">,</span>  <span class="mf">2.85104</span> <span class="p">,</span>  <span class="mf">2.8552</span>  <span class="p">,</span>  <span class="mf">2.86144</span> <span class="p">,</span>  <span class="mf">2.86769</span> <span class="p">,</span>  <span class="mf">2.86977</span> <span class="p">,</span>
        <span class="mf">2.87393</span> <span class="p">,</span>  <span class="mf">2.87601</span> <span class="p">,</span>  <span class="mf">2.87809</span> <span class="p">,</span>  <span class="mf">2.88225</span> <span class="p">,</span>  <span class="mf">2.88849</span> <span class="p">,</span>  <span class="mf">2.89266</span> <span class="p">,</span>
        <span class="mf">2.89474</span> <span class="p">,</span>  <span class="mf">2.90098</span> <span class="p">,</span>  <span class="mf">2.90306</span> <span class="p">,</span>  <span class="mf">2.90514</span> <span class="p">,</span>  <span class="mf">2.90722</span> <span class="p">,</span>  <span class="mf">2.91138</span> <span class="p">,</span>
        <span class="mf">2.91346</span> <span class="p">,</span>  <span class="mf">2.92387</span> <span class="p">,</span>  <span class="mf">2.93219</span> <span class="p">,</span>  <span class="mf">2.93843</span> <span class="p">,</span>  <span class="mf">2.95092</span> <span class="p">,</span>  <span class="mf">2.95716</span> <span class="p">,</span>
        <span class="mf">2.97173</span> <span class="p">,</span>  <span class="mf">2.98005</span> <span class="p">,</span>  <span class="mf">2.98837</span> <span class="p">,</span>  <span class="mf">2.99254</span> <span class="p">,</span>  <span class="mf">2.99878</span> <span class="p">,</span>  <span class="mf">3.00086</span> <span class="p">,</span>
        <span class="mf">3.00294</span> <span class="p">,</span>  <span class="mf">3.0071</span>  <span class="p">,</span>  <span class="mf">3.01126</span> <span class="p">,</span>  <span class="mf">3.01334</span> <span class="p">,</span>  <span class="mf">3.01751</span> <span class="p">,</span>  <span class="mf">3.02791</span> <span class="p">,</span>
        <span class="mf">3.03623</span> <span class="p">,</span>  <span class="mf">3.04456</span> <span class="p">,</span>  <span class="mf">3.05288</span> <span class="p">,</span>  <span class="mf">3.06953</span> <span class="p">,</span>  <span class="mf">3.07161</span> <span class="p">,</span>  <span class="mf">3.08825</span> <span class="p">,</span>
        <span class="mf">3.10074</span> <span class="p">,</span>  <span class="mf">3.10282</span> <span class="p">,</span>  <span class="mf">3.11947</span> <span class="p">,</span>  <span class="mf">3.12987</span> <span class="p">,</span>  <span class="mf">3.14236</span> <span class="p">,</span>  <span class="mf">3.15484</span> <span class="p">,</span>
        <span class="mf">3.159</span>   <span class="p">,</span>  <span class="mf">3.16941</span> <span class="p">,</span>  <span class="mf">3.17981</span> <span class="p">,</span>  <span class="mf">3.19022</span> <span class="p">,</span>  <span class="mf">3.19646</span> <span class="p">,</span>  <span class="mf">3.20686</span> <span class="p">,</span>
        <span class="mf">3.22143</span> <span class="p">,</span>  <span class="mf">3.23391</span> <span class="p">,</span>  <span class="mf">3.24432</span> <span class="p">,</span>  <span class="mf">3.25888</span> <span class="p">,</span>  <span class="mf">3.26513</span> <span class="p">,</span>  <span class="mf">3.27553</span> <span class="p">,</span>
        <span class="mf">3.28177</span> <span class="p">,</span>  <span class="mf">3.29634</span> <span class="p">,</span>  <span class="mf">3.30674</span> <span class="p">,</span>  <span class="mf">3.31715</span> <span class="p">,</span>  <span class="mf">3.32547</span> <span class="p">,</span>  <span class="mf">3.33171</span> <span class="p">,</span>
        <span class="mf">3.3442</span>  <span class="p">,</span>  <span class="mf">3.3546</span>  <span class="p">,</span>  <span class="mf">3.36293</span> <span class="p">,</span>  <span class="mf">3.36917</span> <span class="p">,</span>  <span class="mf">3.37749</span> <span class="p">,</span>  <span class="mf">3.38581</span> <span class="p">,</span>
        <span class="mf">3.38998</span> <span class="p">,</span>  <span class="mf">3.3983</span>  <span class="p">,</span>  <span class="mf">3.40662</span> <span class="p">,</span>  <span class="mf">3.41703</span> <span class="p">,</span>  <span class="mf">3.42327</span> <span class="p">,</span>  <span class="mf">3.43784</span> <span class="p">,</span>
        <span class="mf">3.44408</span> <span class="p">,</span>  <span class="mf">3.45448</span> <span class="p">,</span>  <span class="mf">3.46489</span> <span class="p">,</span>  <span class="mf">3.47737</span> <span class="p">,</span>  <span class="mf">3.48569</span> <span class="p">,</span>  <span class="mf">3.49194</span> <span class="p">,</span>
        <span class="mf">3.51066</span> <span class="p">,</span>  <span class="mf">3.52107</span> <span class="p">,</span>  <span class="mf">3.52731</span> <span class="p">,</span>  <span class="mf">3.54396</span> <span class="p">,</span>  <span class="mf">3.54604</span> <span class="p">,</span>  <span class="mf">3.55436</span> <span class="p">,</span>
        <span class="mf">3.56477</span> <span class="p">,</span>  <span class="mf">3.57309</span> <span class="p">,</span>  <span class="mf">3.58141</span> <span class="p">,</span>  <span class="mf">3.58557</span> <span class="p">,</span>  <span class="mf">3.59598</span> <span class="p">,</span>  <span class="mf">3.6043</span>  <span class="p">,</span>
        <span class="mf">3.61263</span> <span class="p">,</span>  <span class="mf">3.62095</span> <span class="p">,</span>  <span class="mf">3.63343</span> <span class="p">,</span>  <span class="mf">3.64176</span> <span class="p">])</span>
    <span class="n">fig13top_w_raw</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
      <span class="p">[</span> <span class="mf">0.</span>        <span class="p">,</span> <span class="o">-</span><span class="mf">0.0198413</span> <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span> <span class="o">-</span><span class="mf">0.015873</span>  <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>
       <span class="o">-</span><span class="mf">0.015873</span>  <span class="p">,</span>  <span class="mf">0.015873</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.0198413</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.00396825</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0198413</span> <span class="p">,</span>
        <span class="mf">0.015873</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.0238095</span> <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span> <span class="o">-</span><span class="mf">0.0277778</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.00396825</span><span class="p">,</span>
       <span class="o">-</span><span class="mf">0.031746</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.0119048</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.031746</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.0277778</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.00793651</span><span class="p">,</span>
       <span class="o">-</span><span class="mf">0.00793651</span><span class="p">,</span>  <span class="mf">0.0277778</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.0119048</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.0634921</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.0992063</span> <span class="p">,</span>
       <span class="o">-</span><span class="mf">0.138889</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.230159</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.484127</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.484127</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.603175</span>  <span class="p">,</span>
       <span class="o">-</span><span class="mf">0.702381</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.531746</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.611111</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.488095</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.452381</span>  <span class="p">,</span>
       <span class="o">-</span><span class="mf">0.361111</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.404762</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.599206</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.599206</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.714286</span>  <span class="p">,</span>
       <span class="o">-</span><span class="mf">0.753968</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.789683</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.72619</span>   <span class="p">,</span> <span class="o">-</span><span class="mf">0.603175</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.539683</span>  <span class="p">,</span>
       <span class="o">-</span><span class="mf">0.47619</span>   <span class="p">,</span> <span class="o">-</span><span class="mf">0.365079</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.31746</span>   <span class="p">,</span> <span class="o">-</span><span class="mf">0.234127</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.18254</span>   <span class="p">,</span>
       <span class="o">-</span><span class="mf">0.150794</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.115079</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.0793651</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.047619</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.0753968</span> <span class="p">,</span>
       <span class="o">-</span><span class="mf">0.00396825</span><span class="p">,</span>  <span class="mf">0.015873</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.015873</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.0674603</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.015873</span>  <span class="p">,</span>
        <span class="mf">0.0198413</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.0714286</span> <span class="p">,</span>  <span class="mf">0.0119048</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.0436508</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.0595238</span> <span class="p">,</span>
        <span class="mf">0.</span>        <span class="p">,</span> <span class="o">-</span><span class="mf">0.0396825</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.031746</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.00793651</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0119048</span> <span class="p">,</span>
       <span class="o">-</span><span class="mf">0.0357143</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.015873</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.0436508</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.015873</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.0396825</span> <span class="p">,</span>
       <span class="o">-</span><span class="mf">0.0277778</span> <span class="p">,</span>  <span class="mf">0.00396825</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0277778</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.0119048</span> <span class="p">,</span>  <span class="mf">0.00396825</span><span class="p">,</span>
        <span class="mf">0.0238095</span> <span class="p">,</span>  <span class="mf">0.0119048</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.0119048</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.0357143</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.0793651</span> <span class="p">,</span>
       <span class="o">-</span><span class="mf">0.138889</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.214286</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.281746</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.357143</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.440476</span>  <span class="p">,</span>
       <span class="o">-</span><span class="mf">0.535714</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.722222</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.809524</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.710317</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.543651</span>  <span class="p">,</span>
       <span class="o">-</span><span class="mf">0.496032</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.460317</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.416667</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.464286</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.527778</span>  <span class="p">,</span>
       <span class="o">-</span><span class="mf">0.571429</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.619048</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.690476</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.777778</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.837302</span>  <span class="p">,</span>
       <span class="o">-</span><span class="mf">0.765873</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.714286</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.555556</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.412698</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.349206</span>  <span class="p">,</span>
       <span class="o">-</span><span class="mf">0.337302</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.269841</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.150794</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.0634921</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.123016</span>  <span class="p">,</span>
       <span class="o">-</span><span class="mf">0.138889</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.257937</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.345238</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.420635</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.484127</span>  <span class="p">,</span>
       <span class="o">-</span><span class="mf">0.619048</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.694444</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.77381</span>   <span class="p">,</span> <span class="o">-</span><span class="mf">0.869048</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.634921</span>  <span class="p">,</span>
       <span class="o">-</span><span class="mf">0.730159</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.730159</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.496032</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.384921</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.5</span>       <span class="p">,</span>
       <span class="o">-</span><span class="mf">0.603175</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.706349</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.765873</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.84127</span>   <span class="p">,</span> <span class="o">-</span><span class="mf">0.785714</span>  <span class="p">,</span>
       <span class="o">-</span><span class="mf">0.710317</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.615079</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.452381</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.420635</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.357143</span>  <span class="p">,</span>
       <span class="o">-</span><span class="mf">0.22619</span>   <span class="p">,</span> <span class="o">-</span><span class="mf">0.142857</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.0873016</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.126984</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.0396825</span> <span class="p">,</span>
       <span class="o">-</span><span class="mf">0.0238095</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.0515873</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.00396825</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0238095</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.0515873</span> <span class="p">,</span>
       <span class="o">-</span><span class="mf">0.0357143</span> <span class="p">,</span>  <span class="mf">0.00396825</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0357143</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.0436508</span> <span class="p">,</span>  <span class="mf">0.00396825</span><span class="p">,</span>
       <span class="o">-</span><span class="mf">0.00793651</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0396825</span> <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span> <span class="o">-</span><span class="mf">0.0119048</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.0357143</span> <span class="p">,</span>
       <span class="o">-</span><span class="mf">0.031746</span>  <span class="p">,</span>  <span class="mf">0.00396825</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0357143</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.00793651</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0119048</span> <span class="p">,</span>
       <span class="o">-</span><span class="mf">0.0357143</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.0357143</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.0396825</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.0277778</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.00793651</span><span class="p">,</span>
       <span class="o">-</span><span class="mf">0.031746</span>  <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">0.0198413</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.00396825</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.015873</span>  <span class="p">,</span>
       <span class="o">-</span><span class="mf">0.0714286</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.119048</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.15873</span>   <span class="p">,</span> <span class="o">-</span><span class="mf">0.190476</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.285714</span>  <span class="p">,</span>
       <span class="o">-</span><span class="mf">0.404762</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.519841</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.587302</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.638889</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.686508</span>  <span class="p">,</span>
       <span class="o">-</span><span class="mf">0.785714</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.638889</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.714286</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.448413</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.448413</span>  <span class="p">,</span>
       <span class="o">-</span><span class="mf">0.412698</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.496032</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.563492</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.626984</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.722222</span>  <span class="p">,</span>
       <span class="o">-</span><span class="mf">0.805556</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.888889</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.84127</span>   <span class="p">,</span> <span class="o">-</span><span class="mf">0.5</span>       <span class="p">,</span> <span class="o">-</span><span class="mf">0.5</span>       <span class="p">,</span>
       <span class="o">-</span><span class="mf">0.404762</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.373016</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.253968</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.138889</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.0952381</span> <span class="p">,</span>
       <span class="o">-</span><span class="mf">0.123016</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.150794</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.257937</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.202381</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.285714</span>  <span class="p">,</span>
       <span class="o">-</span><span class="mf">0.337302</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.448413</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.539683</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.599206</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.742063</span>  <span class="p">,</span>
       <span class="o">-</span><span class="mf">0.865079</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.75</span>      <span class="p">,</span> <span class="o">-</span><span class="mf">0.68254</span>   <span class="p">,</span> <span class="o">-</span><span class="mf">0.603175</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.571429</span>  <span class="p">,</span>
       <span class="o">-</span><span class="mf">0.555556</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.436508</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.400794</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.464286</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.539683</span>  <span class="p">,</span>
       <span class="o">-</span><span class="mf">0.619048</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.686508</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.765873</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.825397</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.876984</span>  <span class="p">,</span>
       <span class="o">-</span><span class="mf">0.718254</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.571429</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.571429</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.492063</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.444444</span>  <span class="p">,</span>
       <span class="o">-</span><span class="mf">0.392857</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.309524</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.162698</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.142857</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.047619</span>  <span class="p">,</span>
       <span class="o">-</span><span class="mf">0.0277778</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.0634921</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.031746</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.0515873</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.00396825</span><span class="p">,</span>
       <span class="o">-</span><span class="mf">0.0357143</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.0119048</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.0396825</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.00793651</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0277778</span> <span class="p">,</span>
       <span class="o">-</span><span class="mf">0.0515873</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.015873</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.0436508</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.015873</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.0238095</span> <span class="p">,</span>
        <span class="mf">0.00793651</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.031746</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.015873</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.0396825</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.015873</span>  <span class="p">,</span>
        <span class="mf">0.00396825</span><span class="p">,</span>  <span class="mf">0.015873</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.00793651</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.015873</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.0753968</span> <span class="p">,</span>
       <span class="o">-</span><span class="mf">0.115079</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.222222</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.301587</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.416667</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.507937</span>  <span class="p">,</span>
       <span class="o">-</span><span class="mf">0.694444</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.849206</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.75</span>      <span class="p">,</span> <span class="o">-</span><span class="mf">0.599206</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.599206</span>  <span class="p">,</span>
       <span class="o">-</span><span class="mf">0.52381</span>   <span class="p">,</span> <span class="o">-</span><span class="mf">0.5</span>       <span class="p">,</span> <span class="o">-</span><span class="mf">0.464286</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.424603</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.464286</span>  <span class="p">,</span>
       <span class="o">-</span><span class="mf">0.511905</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.646825</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.72619</span>   <span class="p">,</span> <span class="o">-</span><span class="mf">0.81746</span>   <span class="p">,</span> <span class="o">-</span><span class="mf">0.912698</span>  <span class="p">,</span>
       <span class="o">-</span><span class="mf">0.718254</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.583333</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.642857</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.444444</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.376984</span>  <span class="p">,</span>
       <span class="o">-</span><span class="mf">0.293651</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.257937</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.162698</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.138889</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.166667</span>  <span class="p">,</span>
       <span class="o">-</span><span class="mf">0.202381</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.257937</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.309524</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.369048</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.464286</span>  <span class="p">,</span>
       <span class="o">-</span><span class="mf">0.559524</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.674603</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.75</span>      <span class="p">,</span> <span class="o">-</span><span class="mf">0.813492</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.75</span>      <span class="p">,</span>
       <span class="o">-</span><span class="mf">0.698413</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.575397</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.535714</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.492063</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.448413</span>  <span class="p">,</span>
       <span class="o">-</span><span class="mf">0.396825</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.452381</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.503968</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.587302</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.65873</span>   <span class="p">,</span>
       <span class="o">-</span><span class="mf">0.746032</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.833333</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.547619</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.547619</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.468254</span>  <span class="p">,</span>
       <span class="o">-</span><span class="mf">0.404762</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.361111</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.305556</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.202381</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.146825</span>  <span class="p">,</span>
       <span class="o">-</span><span class="mf">0.115079</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.0833333</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.047619</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.0396825</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.047619</span>  <span class="p">,</span>
       <span class="o">-</span><span class="mf">0.0198413</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.0396825</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.015873</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.0515873</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.0277778</span> <span class="p">,</span>
       <span class="o">-</span><span class="mf">0.0396825</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.0238095</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.0436508</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.0198413</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.0595238</span> <span class="p">,</span>
       <span class="o">-</span><span class="mf">0.015873</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.0396825</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.00396825</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.047619</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.0238095</span> <span class="p">,</span>
       <span class="o">-</span><span class="mf">0.0436508</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.015873</span>  <span class="p">,</span>  <span class="mf">0.0119048</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.00793651</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.015873</span>  <span class="p">,</span>
       <span class="o">-</span><span class="mf">0.0555556</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.103175</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.142857</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.242063</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.392857</span>  <span class="p">,</span>
       <span class="o">-</span><span class="mf">0.496032</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.623016</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.710317</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.809524</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.865079</span>  <span class="p">,</span>
       <span class="o">-</span><span class="mf">0.813492</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.690476</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.599206</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.484127</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.464286</span>  <span class="p">,</span>
       <span class="o">-</span><span class="mf">0.444444</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.492063</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.539683</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.626984</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.714286</span>  <span class="p">,</span>
       <span class="o">-</span><span class="mf">0.797619</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.865079</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.896825</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.809524</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.714286</span>  <span class="p">,</span>
       <span class="o">-</span><span class="mf">0.626984</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.543651</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.380952</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.297619</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.222222</span>  <span class="p">,</span>
       <span class="o">-</span><span class="mf">0.142857</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.0952381</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.142857</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.170635</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.202381</span>  <span class="p">,</span>
       <span class="o">-</span><span class="mf">0.289683</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.345238</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.412698</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.496032</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.563492</span>  <span class="p">,</span>
       <span class="o">-</span><span class="mf">0.650794</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.702381</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.813492</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.753968</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.753968</span>  <span class="p">,</span>
       <span class="o">-</span><span class="mf">0.555556</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.535714</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.488095</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.392857</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.424603</span>  <span class="p">,</span>
       <span class="o">-</span><span class="mf">0.543651</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.626984</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.698413</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.769841</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.829365</span>  <span class="p">,</span>
       <span class="o">-</span><span class="mf">0.77381</span>   <span class="p">,</span> <span class="o">-</span><span class="mf">0.56746</span>   <span class="p">,</span> <span class="o">-</span><span class="mf">0.456349</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.31746</span>   <span class="p">,</span> <span class="o">-</span><span class="mf">0.25</span>      <span class="p">,</span>
       <span class="o">-</span><span class="mf">0.186508</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.103175</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.138889</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.0357143</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.0119048</span> <span class="p">,</span>
       <span class="o">-</span><span class="mf">0.0714286</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.015873</span>  <span class="p">,</span>  <span class="mf">0.0198413</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.0238095</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.0674603</span> <span class="p">,</span>
       <span class="o">-</span><span class="mf">0.031746</span>  <span class="p">,</span>  <span class="mf">0.00396825</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.031746</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.0674603</span> <span class="p">,</span>  <span class="mf">0.0238095</span> <span class="p">,</span>
       <span class="o">-</span><span class="mf">0.0634921</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.00793651</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0634921</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.00793651</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0753968</span> <span class="p">,</span>
       <span class="o">-</span><span class="mf">0.00793651</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0555556</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.00793651</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0555556</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.0277778</span> <span class="p">,</span>
       <span class="o">-</span><span class="mf">0.0396825</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.00793651</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0238095</span> <span class="p">,</span>  <span class="mf">0.015873</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.0436508</span> <span class="p">,</span>
       <span class="o">-</span><span class="mf">0.150794</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.31746</span>   <span class="p">,</span> <span class="o">-</span><span class="mf">0.238095</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.400794</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.527778</span>  <span class="p">,</span>
       <span class="o">-</span><span class="mf">0.670635</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.72619</span>   <span class="p">,</span> <span class="o">-</span><span class="mf">0.801587</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.84127</span>   <span class="p">,</span> <span class="o">-</span><span class="mf">0.730159</span>  <span class="p">,</span>
       <span class="o">-</span><span class="mf">0.59127</span>   <span class="p">,</span> <span class="o">-</span><span class="mf">0.543651</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.480159</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.420635</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.484127</span>  <span class="p">,</span>
       <span class="o">-</span><span class="mf">0.543651</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.611111</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.678571</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.765873</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.849206</span>  <span class="p">,</span>
       <span class="o">-</span><span class="mf">0.714286</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.785714</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.587302</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.484127</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.40873</span>   <span class="p">,</span>
       <span class="o">-</span><span class="mf">0.34127</span>   <span class="p">,</span> <span class="o">-</span><span class="mf">0.281746</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.218254</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.111111</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.198413</span>  <span class="p">,</span>
       <span class="o">-</span><span class="mf">0.289683</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.376984</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.452381</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.543651</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.642857</span>  <span class="p">,</span>
       <span class="o">-</span><span class="mf">0.718254</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.793651</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.587302</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.68254</span>   <span class="p">,</span> <span class="o">-</span><span class="mf">0.531746</span>  <span class="p">,</span>
       <span class="o">-</span><span class="mf">0.484127</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.448413</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.40873</span>   <span class="p">,</span> <span class="o">-</span><span class="mf">0.436508</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.519841</span>  <span class="p">,</span>
       <span class="o">-</span><span class="mf">0.563492</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.65873</span>   <span class="p">,</span> <span class="o">-</span><span class="mf">0.722222</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.781746</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.853175</span>  <span class="p">,</span>
       <span class="o">-</span><span class="mf">0.65873</span>   <span class="p">,</span> <span class="o">-</span><span class="mf">0.615079</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.507937</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.43254</span>   <span class="p">,</span> <span class="o">-</span><span class="mf">0.388889</span>  <span class="p">,</span>
       <span class="o">-</span><span class="mf">0.325397</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.253968</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.198413</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.150794</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.0833333</span> <span class="p">,</span>
       <span class="o">-</span><span class="mf">0.126984</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.0634921</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.0198413</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.0396825</span> <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>
       <span class="o">-</span><span class="mf">0.0357143</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.0119048</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.0357143</span> <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span> <span class="o">-</span><span class="mf">0.047619</span>  <span class="p">,</span>
       <span class="o">-</span><span class="mf">0.0119048</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.0436508</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.0198413</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.0515873</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.00396825</span><span class="p">,</span>
       <span class="o">-</span><span class="mf">0.0357143</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.0198413</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.0357143</span> <span class="p">,</span>  <span class="mf">0.0198413</span> <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>
        <span class="mf">0.00396825</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.015873</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.0634921</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.146825</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.210317</span>  <span class="p">,</span>
       <span class="o">-</span><span class="mf">0.27381</span>   <span class="p">,</span> <span class="o">-</span><span class="mf">0.464286</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.34127</span>   <span class="p">,</span> <span class="o">-</span><span class="mf">0.551587</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.646825</span>  <span class="p">,</span>
       <span class="o">-</span><span class="mf">0.72619</span>   <span class="p">,</span> <span class="o">-</span><span class="mf">0.781746</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.825397</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.718254</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.626984</span>  <span class="p">,</span>
       <span class="o">-</span><span class="mf">0.535714</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.480159</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.444444</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.488095</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.559524</span>  <span class="p">,</span>
       <span class="o">-</span><span class="mf">0.623016</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.710317</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.793651</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.845238</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.793651</span>  <span class="p">,</span>
       <span class="o">-</span><span class="mf">0.611111</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.702381</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.436508</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.376984</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.313492</span>  <span class="p">,</span>
       <span class="o">-</span><span class="mf">0.246032</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.166667</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.0873016</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.103175</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.047619</span>  <span class="p">,</span>
        <span class="mf">0.</span>        <span class="p">,</span> <span class="o">-</span><span class="mf">0.0674603</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.00793651</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.047619</span>  <span class="p">,</span>  <span class="mf">0.015873</span>  <span class="p">,</span>
       <span class="o">-</span><span class="mf">0.103175</span>  <span class="p">,</span>  <span class="mf">0.0396825</span> <span class="p">,</span>  <span class="mf">0.186508</span>  <span class="p">,</span>  <span class="mf">0.0833333</span> <span class="p">,</span>  <span class="mf">0.031746</span>  <span class="p">,</span>
       <span class="o">-</span><span class="mf">0.142857</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.0277778</span> <span class="p">,</span>  <span class="mf">0.0198413</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.0357143</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.0634921</span> <span class="p">,</span>
       <span class="o">-</span><span class="mf">0.0436508</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.0238095</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.00396825</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0238095</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.00396825</span><span class="p">,</span>
       <span class="o">-</span><span class="mf">0.0198413</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.00793651</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0277778</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.0238095</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.031746</span>  <span class="p">,</span>
        <span class="mf">0.00396825</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0198413</span> <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span> <span class="o">-</span><span class="mf">0.0198413</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.0119048</span> <span class="p">,</span>
       <span class="o">-</span><span class="mf">0.00396825</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0238095</span> <span class="p">,</span>  <span class="mf">0.00396825</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.00396825</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0277778</span> <span class="p">,</span>
       <span class="o">-</span><span class="mf">0.0119048</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.0277778</span> <span class="p">,</span>  <span class="mf">0.00396825</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0277778</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.015873</span>  <span class="p">,</span>
       <span class="o">-</span><span class="mf">0.0357143</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.0198413</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.00793651</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0277778</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.00396825</span><span class="p">,</span>
       <span class="o">-</span><span class="mf">0.0277778</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.00396825</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.015873</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.00396825</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0119048</span> <span class="p">,</span>
       <span class="o">-</span><span class="mf">0.00396825</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0277778</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.00793651</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0238095</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.00396825</span><span class="p">,</span>
       <span class="o">-</span><span class="mf">0.031746</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.0238095</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.031746</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.0198413</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.0277778</span> <span class="p">,</span>
       <span class="o">-</span><span class="mf">0.0198413</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.0277778</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.015873</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.00396825</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0238095</span> <span class="p">,</span>
       <span class="o">-</span><span class="mf">0.015873</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.015873</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.00793651</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.015873</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.015873</span>  <span class="p">,</span>
       <span class="o">-</span><span class="mf">0.0119048</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.0198413</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.0119048</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.015873</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.0119048</span> <span class="p">,</span>
       <span class="o">-</span><span class="mf">0.0277778</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.0198413</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.0238095</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.0277778</span> <span class="p">])</span>

    <span class="n">fig13bot_t_raw</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
      <span class="p">[</span> <span class="mf">0.14382</span> <span class="p">,</span>  <span class="mf">0.14955</span> <span class="p">,</span>  <span class="mf">0.15719</span> <span class="p">,</span>  <span class="mf">0.16674</span> <span class="p">,</span>  <span class="mf">0.17247</span> <span class="p">,</span>  <span class="mf">0.1973</span>  <span class="p">,</span>
        <span class="mf">0.21067</span> <span class="p">,</span>  <span class="mf">0.22022</span> <span class="p">,</span>  <span class="mf">0.229769</span><span class="p">,</span>  <span class="mf">0.241229</span><span class="p">,</span>  <span class="mf">0.254599</span><span class="p">,</span>  <span class="mf">0.266059</span><span class="p">,</span>
        <span class="mf">0.273699</span><span class="p">,</span>  <span class="mf">0.283249</span><span class="p">,</span>  <span class="mf">0.290889</span><span class="p">,</span>  <span class="mf">0.298529</span><span class="p">,</span>  <span class="mf">0.306169</span><span class="p">,</span>  <span class="mf">0.315719</span><span class="p">,</span>
        <span class="mf">0.321449</span><span class="p">,</span>  <span class="mf">0.336729</span><span class="p">,</span>  <span class="mf">0.348189</span><span class="p">,</span>  <span class="mf">0.355829</span><span class="p">,</span>  <span class="mf">0.357739</span><span class="p">,</span>  <span class="mf">0.359649</span><span class="p">,</span>
        <span class="mf">0.363469</span><span class="p">,</span>  <span class="mf">0.365379</span><span class="p">,</span>  <span class="mf">0.367289</span><span class="p">,</span>  <span class="mf">0.371109</span><span class="p">,</span>  <span class="mf">0.378749</span><span class="p">,</span>  <span class="mf">0.384479</span><span class="p">,</span>
        <span class="mf">0.388299</span><span class="p">,</span>  <span class="mf">0.390209</span><span class="p">,</span>  <span class="mf">0.394029</span><span class="p">,</span>  <span class="mf">0.399759</span><span class="p">,</span>  <span class="mf">0.407398</span><span class="p">,</span>  <span class="mf">0.411218</span><span class="p">,</span>
        <span class="mf">0.416948</span><span class="p">,</span>  <span class="mf">0.424588</span><span class="p">,</span>  <span class="mf">0.426498</span><span class="p">,</span>  <span class="mf">0.428408</span><span class="p">,</span>  <span class="mf">0.434138</span><span class="p">,</span>  <span class="mf">0.436048</span><span class="p">,</span>
        <span class="mf">0.439868</span><span class="p">,</span>  <span class="mf">0.443688</span><span class="p">,</span>  <span class="mf">0.445598</span><span class="p">,</span>  <span class="mf">0.449418</span><span class="p">,</span>  <span class="mf">0.455148</span><span class="p">,</span>  <span class="mf">0.457058</span><span class="p">,</span>
        <span class="mf">0.460878</span><span class="p">,</span>  <span class="mf">0.462788</span><span class="p">,</span>  <span class="mf">0.472338</span><span class="p">,</span>  <span class="mf">0.479978</span><span class="p">,</span>  <span class="mf">0.487618</span><span class="p">,</span>  <span class="mf">0.497168</span><span class="p">,</span>
        <span class="mf">0.504808</span><span class="p">,</span>  <span class="mf">0.514358</span><span class="p">,</span>  <span class="mf">0.521998</span><span class="p">,</span>  <span class="mf">0.533458</span><span class="p">,</span>  <span class="mf">0.539188</span><span class="p">,</span>  <span class="mf">0.556378</span><span class="p">,</span>
        <span class="mf">0.564018</span><span class="p">,</span>  <span class="mf">0.571658</span><span class="p">,</span>  <span class="mf">0.579297</span><span class="p">,</span>  <span class="mf">0.590757</span><span class="p">,</span>  <span class="mf">0.598397</span><span class="p">,</span>  <span class="mf">0.606037</span><span class="p">,</span>
        <span class="mf">0.617497</span><span class="p">,</span>  <span class="mf">0.619407</span><span class="p">,</span>  <span class="mf">0.634687</span><span class="p">,</span>  <span class="mf">0.644237</span><span class="p">,</span>  <span class="mf">0.649967</span><span class="p">,</span>  <span class="mf">0.657607</span><span class="p">,</span>
        <span class="mf">0.667157</span><span class="p">,</span>  <span class="mf">0.669067</span><span class="p">,</span>  <span class="mf">0.674797</span><span class="p">,</span>  <span class="mf">0.676707</span><span class="p">,</span>  <span class="mf">0.680527</span><span class="p">,</span>  <span class="mf">0.682437</span><span class="p">,</span>
        <span class="mf">0.688167</span><span class="p">,</span>  <span class="mf">0.697717</span><span class="p">,</span>  <span class="mf">0.703447</span><span class="p">,</span>  <span class="mf">0.705357</span><span class="p">,</span>  <span class="mf">0.711087</span><span class="p">,</span>  <span class="mf">0.716817</span><span class="p">,</span>
        <span class="mf">0.718727</span><span class="p">,</span>  <span class="mf">0.720637</span><span class="p">,</span>  <span class="mf">0.724457</span><span class="p">,</span>  <span class="mf">0.728277</span><span class="p">,</span>  <span class="mf">0.737827</span><span class="p">,</span>  <span class="mf">0.741647</span><span class="p">,</span>
        <span class="mf">0.745467</span><span class="p">,</span>  <span class="mf">0.747377</span><span class="p">,</span>  <span class="mf">0.749286</span><span class="p">,</span>  <span class="mf">0.756926</span><span class="p">,</span>  <span class="mf">0.760746</span><span class="p">,</span>  <span class="mf">0.762656</span><span class="p">,</span>
        <span class="mf">0.768386</span><span class="p">,</span>  <span class="mf">0.772206</span><span class="p">,</span>  <span class="mf">0.776026</span><span class="p">,</span>  <span class="mf">0.779846</span><span class="p">,</span>  <span class="mf">0.783666</span><span class="p">,</span>  <span class="mf">0.789396</span><span class="p">,</span>
        <span class="mf">0.793216</span><span class="p">,</span>  <span class="mf">0.795126</span><span class="p">,</span>  <span class="mf">0.798946</span><span class="p">,</span>  <span class="mf">0.802766</span><span class="p">,</span>  <span class="mf">0.808496</span><span class="p">,</span>  <span class="mf">0.812316</span><span class="p">,</span>
        <span class="mf">0.816136</span><span class="p">,</span>  <span class="mf">0.821866</span><span class="p">,</span>  <span class="mf">0.829506</span><span class="p">,</span>  <span class="mf">0.833326</span><span class="p">,</span>  <span class="mf">0.837146</span><span class="p">,</span>  <span class="mf">0.840966</span><span class="p">,</span>
        <span class="mf">0.844786</span><span class="p">,</span>  <span class="mf">0.850516</span><span class="p">,</span>  <span class="mf">0.858156</span><span class="p">,</span>  <span class="mf">0.861976</span><span class="p">,</span>  <span class="mf">0.861976</span><span class="p">,</span>  <span class="mf">0.863886</span><span class="p">,</span>
        <span class="mf">0.867706</span><span class="p">,</span>  <span class="mf">0.875346</span><span class="p">,</span>  <span class="mf">0.879166</span><span class="p">,</span>  <span class="mf">0.882986</span><span class="p">,</span>  <span class="mf">0.886806</span><span class="p">,</span>  <span class="mf">0.894446</span><span class="p">,</span>
        <span class="mf">0.903996</span><span class="p">,</span>  <span class="mf">0.911636</span><span class="p">,</span>  <span class="mf">0.921186</span><span class="p">,</span>  <span class="mf">0.928825</span><span class="p">,</span>  <span class="mf">0.938375</span><span class="p">,</span>  <span class="mf">0.946015</span><span class="p">,</span>
        <span class="mf">0.961295</span><span class="p">,</span>  <span class="mf">0.976575</span><span class="p">,</span>  <span class="mf">0.980395</span><span class="p">,</span>  <span class="mf">0.989945</span><span class="p">,</span>  <span class="mf">0.999495</span><span class="p">,</span>  <span class="mf">1.0205</span>  <span class="p">,</span>
        <span class="mf">1.03196</span> <span class="p">,</span>  <span class="mf">1.03578</span> <span class="p">,</span>  <span class="mf">1.04342</span> <span class="p">,</span>  <span class="mf">1.04915</span> <span class="p">,</span>  <span class="mf">1.06061</span> <span class="p">,</span>  <span class="mf">1.06825</span> <span class="p">,</span>
        <span class="mf">1.07971</span> <span class="p">,</span>  <span class="mf">1.08353</span> <span class="p">,</span>  <span class="mf">1.08926</span> <span class="p">,</span>  <span class="mf">1.09499</span> <span class="p">,</span>  <span class="mf">1.0969</span>  <span class="p">,</span>  <span class="mf">1.10072</span> <span class="p">,</span>
        <span class="mf">1.10263</span> <span class="p">,</span>  <span class="mf">1.10645</span> <span class="p">,</span>  <span class="mf">1.11409</span> <span class="p">,</span>  <span class="mf">1.11982</span> <span class="p">,</span>  <span class="mf">1.12173</span> <span class="p">,</span>  <span class="mf">1.12364</span> <span class="p">,</span>
        <span class="mf">1.12746</span> <span class="p">,</span>  <span class="mf">1.12937</span> <span class="p">,</span>  <span class="mf">1.13701</span> <span class="p">,</span>  <span class="mf">1.14274</span> <span class="p">,</span>  <span class="mf">1.14656</span> <span class="p">,</span>  <span class="mf">1.15038</span> <span class="p">,</span>
        <span class="mf">1.15229</span> <span class="p">,</span>  <span class="mf">1.1542</span>  <span class="p">,</span>  <span class="mf">1.15993</span> <span class="p">,</span>  <span class="mf">1.16375</span> <span class="p">,</span>  <span class="mf">1.16757</span> <span class="p">,</span>  <span class="mf">1.17139</span> <span class="p">,</span>
        <span class="mf">1.17521</span> <span class="p">,</span>  <span class="mf">1.18094</span> <span class="p">,</span>  <span class="mf">1.18285</span> <span class="p">,</span>  <span class="mf">1.18667</span> <span class="p">,</span>  <span class="mf">1.18858</span> <span class="p">,</span>  <span class="mf">1.19049</span> <span class="p">,</span>
        <span class="mf">1.20386</span> <span class="p">,</span>  <span class="mf">1.20768</span> <span class="p">,</span>  <span class="mf">1.20959</span> <span class="p">,</span>  <span class="mf">1.21341</span> <span class="p">,</span>  <span class="mf">1.21723</span> <span class="p">,</span>  <span class="mf">1.21914</span> <span class="p">,</span>
        <span class="mf">1.21914</span> <span class="p">,</span>  <span class="mf">1.22678</span> <span class="p">,</span>  <span class="mf">1.2306</span>  <span class="p">,</span>  <span class="mf">1.23251</span> <span class="p">,</span>  <span class="mf">1.23442</span> <span class="p">,</span>  <span class="mf">1.23824</span> <span class="p">,</span>
        <span class="mf">1.24015</span> <span class="p">,</span>  <span class="mf">1.24397</span> <span class="p">,</span>  <span class="mf">1.24779</span> <span class="p">,</span>  <span class="mf">1.25543</span> <span class="p">,</span>  <span class="mf">1.25734</span> <span class="p">,</span>  <span class="mf">1.26116</span> <span class="p">,</span>
        <span class="mf">1.26307</span> <span class="p">,</span>  <span class="mf">1.2688</span>  <span class="p">,</span>  <span class="mf">1.27262</span> <span class="p">,</span>  <span class="mf">1.27453</span> <span class="p">,</span>  <span class="mf">1.28026</span> <span class="p">,</span>  <span class="mf">1.28217</span> <span class="p">,</span>
        <span class="mf">1.28599</span> <span class="p">,</span>  <span class="mf">1.28981</span> <span class="p">,</span>  <span class="mf">1.29554</span> <span class="p">,</span>  <span class="mf">1.29745</span> <span class="p">,</span>  <span class="mf">1.30509</span> <span class="p">,</span>  <span class="mf">1.31082</span> <span class="p">,</span>
        <span class="mf">1.31655</span> <span class="p">,</span>  <span class="mf">1.32419</span> <span class="p">,</span>  <span class="mf">1.32992</span> <span class="p">,</span>  <span class="mf">1.33947</span> <span class="p">,</span>  <span class="mf">1.34902</span> <span class="p">,</span>  <span class="mf">1.35475</span> <span class="p">,</span>
        <span class="mf">1.36048</span> <span class="p">,</span>  <span class="mf">1.37194</span> <span class="p">,</span>  <span class="mf">1.37767</span> <span class="p">,</span>  <span class="mf">1.38149</span> <span class="p">,</span>  <span class="mf">1.38722</span> <span class="p">,</span>  <span class="mf">1.39868</span> <span class="p">,</span>
        <span class="mf">1.40632</span> <span class="p">,</span>  <span class="mf">1.41396</span> <span class="p">,</span>  <span class="mf">1.41969</span> <span class="p">,</span>  <span class="mf">1.42924</span> <span class="p">,</span>  <span class="mf">1.44261</span> <span class="p">,</span>  <span class="mf">1.45216</span> <span class="p">,</span>
        <span class="mf">1.46171</span> <span class="p">,</span>  <span class="mf">1.46935</span> <span class="p">,</span>  <span class="mf">1.47699</span> <span class="p">,</span>  <span class="mf">1.48463</span> <span class="p">,</span>  <span class="mf">1.49991</span> <span class="p">,</span>  <span class="mf">1.50373</span> <span class="p">,</span>
        <span class="mf">1.50946</span> <span class="p">,</span>  <span class="mf">1.51519</span> <span class="p">,</span>  <span class="mf">1.5171</span>  <span class="p">,</span>  <span class="mf">1.52092</span> <span class="p">,</span>  <span class="mf">1.52474</span> <span class="p">,</span>  <span class="mf">1.52856</span> <span class="p">,</span>
        <span class="mf">1.53047</span> <span class="p">,</span>  <span class="mf">1.53238</span> <span class="p">,</span>  <span class="mf">1.53429</span> <span class="p">,</span>  <span class="mf">1.54002</span> <span class="p">,</span>  <span class="mf">1.54575</span> <span class="p">,</span>  <span class="mf">1.54766</span> <span class="p">,</span>
        <span class="mf">1.55148</span> <span class="p">,</span>  <span class="mf">1.56103</span> <span class="p">,</span>  <span class="mf">1.56103</span> <span class="p">,</span>  <span class="mf">1.56867</span> <span class="p">,</span>  <span class="mf">1.57058</span> <span class="p">,</span>  <span class="mf">1.57631</span> <span class="p">,</span>
        <span class="mf">1.58204</span> <span class="p">,</span>  <span class="mf">1.58586</span> <span class="p">,</span>  <span class="mf">1.59159</span> <span class="p">,</span>  <span class="mf">1.59541</span> <span class="p">,</span>  <span class="mf">1.59732</span> <span class="p">,</span>  <span class="mf">1.59923</span> <span class="p">,</span>
        <span class="mf">1.60878</span> <span class="p">,</span>  <span class="mf">1.61069</span> <span class="p">,</span>  <span class="mf">1.61451</span> <span class="p">,</span>  <span class="mf">1.62024</span> <span class="p">,</span>  <span class="mf">1.62215</span> <span class="p">,</span>  <span class="mf">1.62597</span> <span class="p">,</span>
        <span class="mf">1.6317</span>  <span class="p">,</span>  <span class="mf">1.63361</span> <span class="p">,</span>  <span class="mf">1.63743</span> <span class="p">,</span>  <span class="mf">1.64316</span> <span class="p">,</span>  <span class="mf">1.64507</span> <span class="p">,</span>  <span class="mf">1.64889</span> <span class="p">,</span>
        <span class="mf">1.65462</span> <span class="p">,</span>  <span class="mf">1.66035</span> <span class="p">,</span>  <span class="mf">1.66417</span> <span class="p">,</span>  <span class="mf">1.66608</span> <span class="p">,</span>  <span class="mf">1.6699</span>  <span class="p">,</span>  <span class="mf">1.67563</span> <span class="p">,</span>
        <span class="mf">1.67754</span> <span class="p">,</span>  <span class="mf">1.68327</span> <span class="p">,</span>  <span class="mf">1.689</span>   <span class="p">,</span>  <span class="mf">1.69091</span> <span class="p">,</span>  <span class="mf">1.69282</span> <span class="p">,</span>  <span class="mf">1.69855</span> <span class="p">,</span>
        <span class="mf">1.70237</span> <span class="p">,</span>  <span class="mf">1.70428</span> <span class="p">,</span>  <span class="mf">1.70619</span> <span class="p">,</span>  <span class="mf">1.71574</span> <span class="p">,</span>  <span class="mf">1.71956</span> <span class="p">,</span>  <span class="mf">1.71956</span> <span class="p">,</span>
        <span class="mf">1.72147</span> <span class="p">,</span>  <span class="mf">1.73102</span> <span class="p">,</span>  <span class="mf">1.73484</span> <span class="p">,</span>  <span class="mf">1.74057</span> <span class="p">,</span>  <span class="mf">1.75012</span> <span class="p">,</span>  <span class="mf">1.75203</span> <span class="p">,</span>
        <span class="mf">1.75394</span> <span class="p">,</span>  <span class="mf">1.75776</span> <span class="p">,</span>  <span class="mf">1.76158</span> <span class="p">,</span>  <span class="mf">1.7654</span>  <span class="p">,</span>  <span class="mf">1.76922</span> <span class="p">,</span>  <span class="mf">1.77113</span> <span class="p">,</span>
        <span class="mf">1.77304</span> <span class="p">,</span>  <span class="mf">1.77877</span> <span class="p">,</span>  <span class="mf">1.7845</span>  <span class="p">,</span>  <span class="mf">1.78641</span> <span class="p">,</span>  <span class="mf">1.79023</span> <span class="p">,</span>  <span class="mf">1.79787</span> <span class="p">,</span>
        <span class="mf">1.8036</span>  <span class="p">,</span>  <span class="mf">1.80742</span> <span class="p">,</span>  <span class="mf">1.81124</span> <span class="p">,</span>  <span class="mf">1.81697</span> <span class="p">,</span>  <span class="mf">1.82461</span> <span class="p">,</span>  <span class="mf">1.83607</span> <span class="p">,</span>
        <span class="mf">1.84371</span> <span class="p">,</span>  <span class="mf">1.85708</span> <span class="p">,</span>  <span class="mf">1.87618</span> <span class="p">,</span>  <span class="mf">1.88191</span> <span class="p">,</span>  <span class="mf">1.89528</span> <span class="p">,</span>  <span class="mf">1.90292</span> <span class="p">,</span>
        <span class="mf">1.9182</span>  <span class="p">,</span>  <span class="mf">1.92393</span> <span class="p">,</span>  <span class="mf">1.93157</span> <span class="p">,</span>  <span class="mf">1.9373</span>  <span class="p">,</span>  <span class="mf">1.93921</span> <span class="p">,</span>  <span class="mf">1.94112</span> <span class="p">,</span>
        <span class="mf">1.94303</span> <span class="p">,</span>  <span class="mf">1.94876</span> <span class="p">,</span>  <span class="mf">1.95067</span> <span class="p">,</span>  <span class="mf">1.95258</span> <span class="p">,</span>  <span class="mf">1.9564</span>  <span class="p">,</span>  <span class="mf">1.96022</span> <span class="p">,</span>
        <span class="mf">1.96595</span> <span class="p">,</span>  <span class="mf">1.96977</span> <span class="p">,</span>  <span class="mf">1.97168</span> <span class="p">,</span>  <span class="mf">1.97359</span> <span class="p">,</span>  <span class="mf">1.98887</span> <span class="p">,</span>  <span class="mf">1.99269</span> <span class="p">,</span>
        <span class="mf">1.9946</span>  <span class="p">,</span>  <span class="mf">1.99651</span> <span class="p">,</span>  <span class="mf">2.00224</span> <span class="p">,</span>  <span class="mf">2.00606</span> <span class="p">,</span>  <span class="mf">2.00988</span> <span class="p">,</span>  <span class="mf">2.01561</span> <span class="p">,</span>
        <span class="mf">2.01752</span> <span class="p">,</span>  <span class="mf">2.02134</span> <span class="p">,</span>  <span class="mf">2.02516</span> <span class="p">,</span>  <span class="mf">2.03089</span> <span class="p">,</span>  <span class="mf">2.0328</span>  <span class="p">,</span>  <span class="mf">2.03662</span> <span class="p">,</span>
        <span class="mf">2.04426</span> <span class="p">,</span>  <span class="mf">2.04999</span> <span class="p">,</span>  <span class="mf">2.05572</span> <span class="p">,</span>  <span class="mf">2.05763</span> <span class="p">,</span>  <span class="mf">2.05954</span> <span class="p">,</span>  <span class="mf">2.06527</span> <span class="p">,</span>
        <span class="mf">2.071</span>   <span class="p">,</span>  <span class="mf">2.07673</span> <span class="p">,</span>  <span class="mf">2.08246</span> <span class="p">,</span>  <span class="mf">2.08437</span> <span class="p">,</span>  <span class="mf">2.08437</span> <span class="p">,</span>  <span class="mf">2.09201</span> <span class="p">,</span>
        <span class="mf">2.09583</span> <span class="p">,</span>  <span class="mf">2.09774</span> <span class="p">,</span>  <span class="mf">2.10538</span> <span class="p">,</span>  <span class="mf">2.1092</span>  <span class="p">,</span>  <span class="mf">2.11111</span> <span class="p">,</span>  <span class="mf">2.11684</span> <span class="p">,</span>
        <span class="mf">2.12257</span> <span class="p">,</span>  <span class="mf">2.12639</span> <span class="p">,</span>  <span class="mf">2.13021</span> <span class="p">,</span>  <span class="mf">2.13212</span> <span class="p">,</span>  <span class="mf">2.13594</span> <span class="p">,</span>  <span class="mf">2.13785</span> <span class="p">,</span>
        <span class="mf">2.14167</span> <span class="p">,</span>  <span class="mf">2.14358</span> <span class="p">,</span>  <span class="mf">2.1474</span>  <span class="p">,</span>  <span class="mf">2.15122</span> <span class="p">,</span>  <span class="mf">2.15504</span> <span class="p">,</span>  <span class="mf">2.16077</span> <span class="p">,</span>
        <span class="mf">2.16841</span> <span class="p">,</span>  <span class="mf">2.17414</span> <span class="p">,</span>  <span class="mf">2.17605</span> <span class="p">,</span>  <span class="mf">2.17987</span> <span class="p">,</span>  <span class="mf">2.18942</span> <span class="p">,</span>  <span class="mf">2.19324</span> <span class="p">,</span>
        <span class="mf">2.20279</span> <span class="p">,</span>  <span class="mf">2.20852</span> <span class="p">,</span>  <span class="mf">2.21807</span> <span class="p">,</span>  <span class="mf">2.2238</span>  <span class="p">,</span>  <span class="mf">2.22571</span> <span class="p">,</span>  <span class="mf">2.22953</span> <span class="p">,</span>
        <span class="mf">2.23526</span> <span class="p">,</span>  <span class="mf">2.24099</span> <span class="p">,</span>  <span class="mf">2.24481</span> <span class="p">,</span>  <span class="mf">2.24863</span> <span class="p">,</span>  <span class="mf">2.25436</span> <span class="p">,</span>  <span class="mf">2.26009</span> <span class="p">,</span>
        <span class="mf">2.26391</span> <span class="p">,</span>  <span class="mf">2.27346</span> <span class="p">,</span>  <span class="mf">2.28301</span> <span class="p">,</span>  <span class="mf">2.29447</span> <span class="p">,</span>  <span class="mf">2.29829</span> <span class="p">,</span>  <span class="mf">2.30402</span> <span class="p">,</span>
        <span class="mf">2.30784</span> <span class="p">,</span>  <span class="mf">2.31357</span> <span class="p">,</span>  <span class="mf">2.3193</span>  <span class="p">,</span>  <span class="mf">2.32503</span> <span class="p">,</span>  <span class="mf">2.33267</span> <span class="p">,</span>  <span class="mf">2.34031</span> <span class="p">,</span>
        <span class="mf">2.35177</span> <span class="p">,</span>  <span class="mf">2.3575</span>  <span class="p">,</span>  <span class="mf">2.36132</span> <span class="p">,</span>  <span class="mf">2.36705</span> <span class="p">,</span>  <span class="mf">2.37087</span> <span class="p">,</span>  <span class="mf">2.37469</span> <span class="p">,</span>
        <span class="mf">2.37851</span> <span class="p">,</span>  <span class="mf">2.38042</span> <span class="p">,</span>  <span class="mf">2.38233</span> <span class="p">,</span>  <span class="mf">2.38997</span> <span class="p">,</span>  <span class="mf">2.39379</span> <span class="p">,</span>  <span class="mf">2.39952</span> <span class="p">,</span>
        <span class="mf">2.40143</span> <span class="p">,</span>  <span class="mf">2.40716</span> <span class="p">,</span>  <span class="mf">2.4148</span>  <span class="p">,</span>  <span class="mf">2.41671</span> <span class="p">,</span>  <span class="mf">2.42244</span> <span class="p">,</span>  <span class="mf">2.42626</span> <span class="p">,</span>
        <span class="mf">2.43199</span> <span class="p">,</span>  <span class="mf">2.43581</span> <span class="p">,</span>  <span class="mf">2.43772</span> <span class="p">,</span>  <span class="mf">2.43963</span> <span class="p">,</span>  <span class="mf">2.44345</span> <span class="p">,</span>  <span class="mf">2.44727</span> <span class="p">,</span>
        <span class="mf">2.45109</span> <span class="p">,</span>  <span class="mf">2.453</span>   <span class="p">,</span>  <span class="mf">2.45491</span> <span class="p">,</span>  <span class="mf">2.45873</span> <span class="p">,</span>  <span class="mf">2.46637</span> <span class="p">,</span>  <span class="mf">2.46828</span> <span class="p">,</span>
        <span class="mf">2.47592</span> <span class="p">,</span>  <span class="mf">2.47974</span> <span class="p">,</span>  <span class="mf">2.48547</span> <span class="p">,</span>  <span class="mf">2.4912</span>  <span class="p">,</span>  <span class="mf">2.49884</span> <span class="p">,</span>  <span class="mf">2.50266</span> <span class="p">,</span>
        <span class="mf">2.50457</span> <span class="p">,</span>  <span class="mf">2.50839</span> <span class="p">,</span>  <span class="mf">2.51603</span> <span class="p">,</span>  <span class="mf">2.52367</span> <span class="p">,</span>  <span class="mf">2.52749</span> <span class="p">,</span>  <span class="mf">2.53131</span> <span class="p">,</span>
        <span class="mf">2.53322</span> <span class="p">,</span>  <span class="mf">2.53704</span> <span class="p">,</span>  <span class="mf">2.53895</span> <span class="p">,</span>  <span class="mf">2.54659</span> <span class="p">,</span>  <span class="mf">2.55232</span> <span class="p">,</span>  <span class="mf">2.55614</span> <span class="p">,</span>
        <span class="mf">2.55996</span> <span class="p">,</span>  <span class="mf">2.5676</span>  <span class="p">,</span>  <span class="mf">2.56951</span> <span class="p">,</span>  <span class="mf">2.57333</span> <span class="p">,</span>  <span class="mf">2.58288</span> <span class="p">,</span>  <span class="mf">2.58479</span> <span class="p">,</span>
        <span class="mf">2.59816</span> <span class="p">,</span>  <span class="mf">2.60007</span> <span class="p">,</span>  <span class="mf">2.60389</span> <span class="p">,</span>  <span class="mf">2.60962</span> <span class="p">,</span>  <span class="mf">2.61344</span> <span class="p">,</span>  <span class="mf">2.61726</span> <span class="p">,</span>
        <span class="mf">2.62108</span> <span class="p">,</span>  <span class="mf">2.63063</span> <span class="p">,</span>  <span class="mf">2.63636</span> <span class="p">,</span>  <span class="mf">2.644</span>   <span class="p">,</span>  <span class="mf">2.64973</span> <span class="p">,</span>  <span class="mf">2.65164</span> <span class="p">,</span>
        <span class="mf">2.65928</span> <span class="p">,</span>  <span class="mf">2.66501</span> <span class="p">,</span>  <span class="mf">2.67265</span> <span class="p">,</span>  <span class="mf">2.68029</span> <span class="p">,</span>  <span class="mf">2.68602</span> <span class="p">,</span>  <span class="mf">2.68984</span> <span class="p">,</span>
        <span class="mf">2.69748</span> <span class="p">,</span>  <span class="mf">2.7013</span>  <span class="p">,</span>  <span class="mf">2.71085</span> <span class="p">,</span>  <span class="mf">2.7204</span>  <span class="p">,</span>  <span class="mf">2.73377</span> <span class="p">,</span>  <span class="mf">2.73759</span> <span class="p">,</span>
        <span class="mf">2.74714</span> <span class="p">,</span>  <span class="mf">2.75286</span> <span class="p">,</span>  <span class="mf">2.75668</span> <span class="p">,</span>  <span class="mf">2.76814</span> <span class="p">,</span>  <span class="mf">2.77196</span> <span class="p">,</span>  <span class="mf">2.77578</span> <span class="p">,</span>
        <span class="mf">2.78151</span> <span class="p">,</span>  <span class="mf">2.78533</span> <span class="p">,</span>  <span class="mf">2.78724</span> <span class="p">,</span>  <span class="mf">2.79106</span> <span class="p">,</span>  <span class="mf">2.79297</span> <span class="p">,</span>  <span class="mf">2.79488</span> <span class="p">,</span>
        <span class="mf">2.80061</span> <span class="p">,</span>  <span class="mf">2.80252</span> <span class="p">,</span>  <span class="mf">2.80634</span> <span class="p">,</span>  <span class="mf">2.81016</span> <span class="p">,</span>  <span class="mf">2.81398</span> <span class="p">,</span>  <span class="mf">2.81589</span> <span class="p">,</span>
        <span class="mf">2.81971</span> <span class="p">,</span>  <span class="mf">2.82162</span> <span class="p">,</span>  <span class="mf">2.82926</span> <span class="p">,</span>  <span class="mf">2.83499</span> <span class="p">,</span>  <span class="mf">2.8369</span>  <span class="p">,</span>  <span class="mf">2.84072</span> <span class="p">,</span>
        <span class="mf">2.84263</span> <span class="p">,</span>  <span class="mf">2.84263</span> <span class="p">,</span>  <span class="mf">2.84645</span> <span class="p">,</span>  <span class="mf">2.84836</span> <span class="p">,</span>  <span class="mf">2.85218</span> <span class="p">,</span>  <span class="mf">2.85409</span> <span class="p">,</span>
        <span class="mf">2.856</span>   <span class="p">,</span>  <span class="mf">2.85791</span> <span class="p">,</span>  <span class="mf">2.86173</span> <span class="p">,</span>  <span class="mf">2.86555</span> <span class="p">,</span>  <span class="mf">2.86746</span> <span class="p">,</span>  <span class="mf">2.87319</span> <span class="p">,</span>
        <span class="mf">2.88083</span> <span class="p">,</span>  <span class="mf">2.88274</span> <span class="p">,</span>  <span class="mf">2.88656</span> <span class="p">,</span>  <span class="mf">2.88847</span> <span class="p">,</span>  <span class="mf">2.89611</span> <span class="p">,</span>  <span class="mf">2.89993</span> <span class="p">,</span>
        <span class="mf">2.90375</span> <span class="p">,</span>  <span class="mf">2.91139</span> <span class="p">,</span>  <span class="mf">2.91903</span> <span class="p">,</span>  <span class="mf">2.92667</span> <span class="p">,</span>  <span class="mf">2.93431</span> <span class="p">,</span>  <span class="mf">2.94004</span> <span class="p">,</span>
        <span class="mf">2.94386</span> <span class="p">,</span>  <span class="mf">2.94959</span> <span class="p">,</span>  <span class="mf">2.95341</span> <span class="p">,</span>  <span class="mf">2.96296</span> <span class="p">,</span>  <span class="mf">2.96678</span> <span class="p">,</span>  <span class="mf">2.96869</span> <span class="p">,</span>
        <span class="mf">2.97633</span> <span class="p">,</span>  <span class="mf">2.98206</span> <span class="p">,</span>  <span class="mf">2.98397</span> <span class="p">,</span>  <span class="mf">2.99161</span> <span class="p">,</span>  <span class="mf">3.00116</span> <span class="p">,</span>  <span class="mf">3.00307</span> <span class="p">,</span>
        <span class="mf">3.01453</span> <span class="p">,</span>  <span class="mf">3.01835</span> <span class="p">,</span>  <span class="mf">3.02599</span> <span class="p">,</span>  <span class="mf">3.03554</span> <span class="p">,</span>  <span class="mf">3.05082</span> <span class="p">,</span>  <span class="mf">3.0661</span>  <span class="p">,</span>
        <span class="mf">3.07183</span> <span class="p">,</span>  <span class="mf">3.07756</span> <span class="p">,</span>  <span class="mf">3.0852</span>  <span class="p">,</span>  <span class="mf">3.09857</span> <span class="p">,</span>  <span class="mf">3.11003</span> <span class="p">,</span>  <span class="mf">3.11958</span> <span class="p">,</span>
        <span class="mf">3.1234</span>  <span class="p">,</span>  <span class="mf">3.13677</span> <span class="p">,</span>  <span class="mf">3.15014</span> <span class="p">,</span>  <span class="mf">3.15778</span> <span class="p">,</span>  <span class="mf">3.16924</span> <span class="p">,</span>  <span class="mf">3.17306</span> <span class="p">,</span>
        <span class="mf">3.18261</span> <span class="p">,</span>  <span class="mf">3.19025</span> <span class="p">,</span>  <span class="mf">3.20935</span> <span class="p">,</span>  <span class="mf">3.23036</span> <span class="p">,</span>  <span class="mf">3.24182</span> <span class="p">,</span>  <span class="mf">3.24373</span> <span class="p">,</span>
        <span class="mf">3.25901</span> <span class="p">,</span>  <span class="mf">3.27047</span> <span class="p">,</span>  <span class="mf">3.28002</span> <span class="p">,</span>  <span class="mf">3.28766</span> <span class="p">,</span>  <span class="mf">3.29912</span> <span class="p">,</span>  <span class="mf">3.31058</span> <span class="p">,</span>
        <span class="mf">3.32013</span> <span class="p">,</span>  <span class="mf">3.32777</span> <span class="p">,</span>  <span class="mf">3.33732</span> <span class="p">,</span>  <span class="mf">3.34687</span> <span class="p">,</span>  <span class="mf">3.35833</span> <span class="p">,</span>  <span class="mf">3.37552</span> <span class="p">,</span>
        <span class="mf">3.38507</span> <span class="p">,</span>  <span class="mf">3.39462</span> <span class="p">,</span>  <span class="mf">3.40608</span> <span class="p">,</span>  <span class="mf">3.41372</span> <span class="p">,</span>  <span class="mf">3.41945</span> <span class="p">,</span>  <span class="mf">3.429</span>   <span class="p">,</span>
        <span class="mf">3.43855</span> <span class="p">,</span>  <span class="mf">3.4481</span>  <span class="p">,</span>  <span class="mf">3.46529</span> <span class="p">,</span>  <span class="mf">3.46911</span> <span class="p">,</span>  <span class="mf">3.47866</span> <span class="p">,</span>  <span class="mf">3.49012</span> <span class="p">,</span>
        <span class="mf">3.49967</span> <span class="p">,</span>  <span class="mf">3.50922</span> <span class="p">,</span>  <span class="mf">3.5245</span>  <span class="p">,</span>  <span class="mf">3.53405</span> <span class="p">,</span>  <span class="mf">3.53596</span> <span class="p">,</span>  <span class="mf">3.54169</span> <span class="p">,</span>
        <span class="mf">3.54742</span> <span class="p">,</span>  <span class="mf">3.54933</span> <span class="p">,</span>  <span class="mf">3.55506</span> <span class="p">,</span>  <span class="mf">3.56461</span> <span class="p">,</span>  <span class="mf">3.57225</span> <span class="p">,</span>  <span class="mf">3.58562</span> <span class="p">,</span>
        <span class="mf">3.59135</span> <span class="p">,</span>  <span class="mf">3.60663</span> <span class="p">])</span>
    <span class="n">fig13bot_w_raw</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
      <span class="p">[</span>  <span class="mf">3.77358000e-03</span><span class="p">,</span>  <span class="o">-</span><span class="mf">1.13208000e-02</span><span class="p">,</span>   <span class="mf">7.54717000e-03</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.13208000e-02</span><span class="p">,</span>   <span class="mf">1.50943000e-02</span><span class="p">,</span>  <span class="o">-</span><span class="mf">3.77358000e-02</span><span class="p">,</span>
         <span class="mf">2.22045000e-16</span><span class="p">,</span>  <span class="o">-</span><span class="mf">2.64151000e-02</span><span class="p">,</span>   <span class="mf">7.54717000e-03</span><span class="p">,</span>
         <span class="mf">3.77358000e-03</span><span class="p">,</span>   <span class="mf">1.50943000e-02</span><span class="p">,</span>  <span class="o">-</span><span class="mf">1.13208000e-02</span><span class="p">,</span>
         <span class="mf">7.54717000e-03</span><span class="p">,</span>  <span class="o">-</span><span class="mf">1.50943000e-02</span><span class="p">,</span>   <span class="mf">3.77358000e-03</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.13208000e-02</span><span class="p">,</span>   <span class="mf">3.77358000e-03</span><span class="p">,</span>  <span class="o">-</span><span class="mf">1.50943000e-02</span><span class="p">,</span>
         <span class="mf">1.13208000e-02</span><span class="p">,</span>   <span class="mf">1.50943000e-02</span><span class="p">,</span>  <span class="o">-</span><span class="mf">1.50943000e-02</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">9.81132000e-02</span><span class="p">,</span>  <span class="o">-</span><span class="mf">5.28302000e-02</span><span class="p">,</span>  <span class="o">-</span><span class="mf">1.47170000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">2.79245000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">3.47170000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">4.07547000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">4.86792000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">6.22642000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">5.66038000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">5.24528000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">4.26415000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">3.47170000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">3.01887000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">4.07547000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">3.81132000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">5.13208000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">6.94340000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">5.43396000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">6.30189000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">4.83019000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">4.52830000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">3.66038000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">2.75472000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">1.84906000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.62264000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">1.35849000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">5.66038000e-02</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.09434000e-01</span><span class="p">,</span>   <span class="mf">3.01887000e-02</span><span class="p">,</span>  <span class="o">-</span><span class="mf">6.03774000e-02</span><span class="p">,</span>
         <span class="mf">4.15094000e-02</span><span class="p">,</span>  <span class="o">-</span><span class="mf">4.90566000e-02</span><span class="p">,</span>   <span class="mf">6.03774000e-02</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">3.77358000e-02</span><span class="p">,</span>   <span class="mf">3.39623000e-02</span><span class="p">,</span>  <span class="o">-</span><span class="mf">4.15094000e-02</span><span class="p">,</span>
         <span class="mf">4.15094000e-02</span><span class="p">,</span>   <span class="mf">2.22045000e-16</span><span class="p">,</span>   <span class="mf">3.01887000e-02</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">3.01887000e-02</span><span class="p">,</span>   <span class="mf">4.52830000e-02</span><span class="p">,</span>  <span class="o">-</span><span class="mf">7.54717000e-03</span><span class="p">,</span>
         <span class="mf">3.39623000e-02</span><span class="p">,</span>  <span class="o">-</span><span class="mf">7.54717000e-03</span><span class="p">,</span>   <span class="mf">3.77358000e-02</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">2.64151000e-02</span><span class="p">,</span>   <span class="mf">3.77358000e-02</span><span class="p">,</span>  <span class="o">-</span><span class="mf">3.39623000e-02</span><span class="p">,</span>
         <span class="mf">4.90566000e-02</span><span class="p">,</span>  <span class="o">-</span><span class="mf">1.13208000e-02</span><span class="p">,</span>   <span class="mf">1.50943000e-02</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">5.66038000e-02</span><span class="p">,</span>  <span class="o">-</span><span class="mf">2.07547000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">2.79245000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">3.50943000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">4.45283000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">5.32075000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">5.77358000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">5.09434000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">4.67925000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">3.81132000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">3.05660000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">3.35849000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">3.84906000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">4.26415000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">4.67925000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">5.77358000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">6.60377000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">6.11321000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">4.03774000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">3.24528000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">2.86792000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">2.64151000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">6.79245000e-02</span><span class="p">,</span>  <span class="o">-</span><span class="mf">1.62264000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">3.77358000e-03</span><span class="p">,</span>  <span class="o">-</span><span class="mf">6.03774000e-02</span><span class="p">,</span>  <span class="o">-</span><span class="mf">1.05660000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.50943000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">2.18868000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">3.05660000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">4.03774000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">4.86792000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">5.50943000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">6.22642000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">5.66038000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">5.24528000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">4.07547000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">3.28302000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">3.66038000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">4.11321000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">4.79245000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">5.39623000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">6.52830000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">6.26415000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">5.66038000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">4.71698000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">4.71698000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">2.37736000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.69811000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">1.24528000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">7.92453000e-02</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">3.01887000e-02</span><span class="p">,</span>   <span class="mf">3.77358000e-03</span><span class="p">,</span>   <span class="mf">3.39623000e-02</span><span class="p">,</span>
         <span class="mf">3.77358000e-03</span><span class="p">,</span>   <span class="mf">5.28302000e-02</span><span class="p">,</span>  <span class="o">-</span><span class="mf">1.13208000e-02</span><span class="p">,</span>
         <span class="mf">5.66038000e-02</span><span class="p">,</span>   <span class="mf">2.22045000e-16</span><span class="p">,</span>   <span class="mf">2.26415000e-02</span><span class="p">,</span>
         <span class="mf">3.77358000e-02</span><span class="p">,</span>   <span class="mf">3.01887000e-02</span><span class="p">,</span>   <span class="mf">1.13208000e-02</span><span class="p">,</span>
         <span class="mf">3.39623000e-02</span><span class="p">,</span>   <span class="mf">1.88679000e-02</span><span class="p">,</span>   <span class="mf">3.77358000e-02</span><span class="p">,</span>
         <span class="mf">1.88679000e-02</span><span class="p">,</span>   <span class="mf">3.39623000e-02</span><span class="p">,</span>   <span class="mf">2.26415000e-02</span><span class="p">,</span>
         <span class="mf">5.28302000e-02</span><span class="p">,</span>   <span class="mf">1.13208000e-02</span><span class="p">,</span>   <span class="mf">3.01887000e-02</span><span class="p">,</span>
         <span class="mf">3.01887000e-02</span><span class="p">,</span>   <span class="mf">7.54717000e-03</span><span class="p">,</span>  <span class="o">-</span><span class="mf">3.77358000e-02</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.24528000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">1.96226000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">2.79245000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">3.66038000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">4.90566000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">6.11321000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">5.58491000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">5.01887000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">4.56604000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">4.03774000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">3.54717000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">3.24528000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">3.58491000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">4.15094000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">4.90566000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">5.58491000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">6.26415000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">6.41509000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">6.03774000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">5.09434000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">3.05660000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">2.67925000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">2.07547000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">2.52830000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.24528000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">4.90566000e-02</span><span class="p">,</span>  <span class="o">-</span><span class="mf">1.88679000e-02</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">3.01887000e-02</span><span class="p">,</span>  <span class="o">-</span><span class="mf">1.43396000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">2.15094000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">2.64151000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">4.00000000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">5.77358000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">5.77358000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">6.37736000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">5.84906000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">5.20755000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">4.60377000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">4.26415000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">3.96226000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">3.62264000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">3.20755000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">4.37736000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">4.90566000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">5.20755000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">5.73585000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">6.03774000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">6.33962000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">6.75472000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">6.37736000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">4.18868000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">3.20755000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">2.67925000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">2.41509000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.09434000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">7.54717000e-02</span><span class="p">,</span>   <span class="mf">1.50943000e-02</span><span class="p">,</span>
         <span class="mf">7.92453000e-02</span><span class="p">,</span>  <span class="o">-</span><span class="mf">1.50943000e-02</span><span class="p">,</span>   <span class="mf">5.66038000e-02</span><span class="p">,</span>
         <span class="mf">1.13208000e-02</span><span class="p">,</span>   <span class="mf">1.13208000e-02</span><span class="p">,</span>  <span class="o">-</span><span class="mf">1.13208000e-02</span><span class="p">,</span>
         <span class="mf">6.03774000e-02</span><span class="p">,</span>  <span class="o">-</span><span class="mf">5.66038000e-02</span><span class="p">,</span>   <span class="mf">4.90566000e-02</span><span class="p">,</span>
         <span class="mf">7.54717000e-02</span><span class="p">,</span>   <span class="mf">1.13208000e-02</span><span class="p">,</span>   <span class="mf">2.26415000e-02</span><span class="p">,</span>
         <span class="mf">5.66038000e-02</span><span class="p">,</span>   <span class="mf">7.54717000e-03</span><span class="p">,</span>   <span class="mf">4.52830000e-02</span><span class="p">,</span>
         <span class="mf">2.64151000e-02</span><span class="p">,</span>   <span class="mf">3.39623000e-02</span><span class="p">,</span>   <span class="mf">3.77358000e-03</span><span class="p">,</span>
         <span class="mf">2.26415000e-02</span><span class="p">,</span>   <span class="mf">1.88679000e-02</span><span class="p">,</span>   <span class="mf">3.77358000e-03</span><span class="p">,</span>
         <span class="mf">4.15094000e-02</span><span class="p">,</span>   <span class="mf">2.64151000e-02</span><span class="p">,</span>  <span class="o">-</span><span class="mf">3.77358000e-03</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">3.77358000e-02</span><span class="p">,</span>  <span class="o">-</span><span class="mf">7.92453000e-02</span><span class="p">,</span>  <span class="o">-</span><span class="mf">1.47170000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">2.11321000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">2.94340000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">4.11321000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">5.01887000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">5.69811000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">5.96226000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">5.73585000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">4.79245000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">5.35849000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">4.07547000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">3.01887000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">3.01887000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">3.50943000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">4.37736000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">5.35849000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">5.58491000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">6.07547000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">4.98113000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">3.47170000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">2.37736000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">2.11321000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.39623000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">2.15094000e-01</span><span class="p">,</span>   <span class="mf">3.01887000e-02</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.50943000e-02</span><span class="p">,</span>  <span class="o">-</span><span class="mf">5.66038000e-02</span><span class="p">,</span>  <span class="o">-</span><span class="mf">1.09434000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.39623000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">2.15094000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">3.62264000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">4.30189000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">4.75472000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">5.50943000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">6.07547000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">5.50943000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">4.33962000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">3.77358000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">2.98113000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">3.47170000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">4.18868000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">4.60377000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">4.79245000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">5.09434000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">5.84906000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">6.52830000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">5.58491000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">4.22642000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">3.43396000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">2.67925000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">1.28302000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">1.28302000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">3.77358000e-02</span><span class="p">,</span>  <span class="o">-</span><span class="mf">6.79245000e-02</span><span class="p">,</span>  <span class="o">-</span><span class="mf">1.50943000e-02</span><span class="p">,</span>
         <span class="mf">9.81132000e-02</span><span class="p">,</span>  <span class="o">-</span><span class="mf">5.66038000e-02</span><span class="p">,</span>   <span class="mf">1.50943000e-02</span><span class="p">,</span>
         <span class="mf">4.90566000e-02</span><span class="p">,</span>   <span class="mf">9.43396000e-02</span><span class="p">,</span>  <span class="o">-</span><span class="mf">1.13208000e-02</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">6.79245000e-02</span><span class="p">,</span>  <span class="o">-</span><span class="mf">1.88679000e-02</span><span class="p">,</span>   <span class="mf">3.77358000e-02</span><span class="p">,</span>
         <span class="mf">8.30189000e-02</span><span class="p">,</span>   <span class="mf">4.15094000e-02</span><span class="p">,</span>  <span class="o">-</span><span class="mf">3.77358000e-02</span><span class="p">,</span>
         <span class="mf">2.22045000e-16</span><span class="p">,</span>   <span class="mf">5.66038000e-02</span><span class="p">,</span>  <span class="o">-</span><span class="mf">4.90566000e-02</span><span class="p">,</span>
         <span class="mf">1.13208000e-02</span><span class="p">,</span>   <span class="mf">6.79245000e-02</span><span class="p">,</span>   <span class="mf">1.50943000e-02</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">4.15094000e-02</span><span class="p">,</span>   <span class="mf">5.28302000e-02</span><span class="p">,</span>  <span class="o">-</span><span class="mf">2.64151000e-02</span><span class="p">,</span>
         <span class="mf">3.77358000e-02</span><span class="p">,</span>  <span class="o">-</span><span class="mf">7.54717000e-03</span><span class="p">,</span>   <span class="mf">7.54717000e-03</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.13208000e-02</span><span class="p">,</span>   <span class="mf">4.15094000e-02</span><span class="p">,</span>   <span class="mf">1.50943000e-02</span><span class="p">,</span>
         <span class="mf">4.52830000e-02</span><span class="p">,</span>   <span class="mf">1.13208000e-02</span><span class="p">,</span>  <span class="o">-</span><span class="mf">2.64151000e-02</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">5.66038000e-02</span><span class="p">,</span>  <span class="o">-</span><span class="mf">1.05660000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">1.54717000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">2.15094000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">3.32075000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">4.07547000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">5.01887000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">5.84906000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">6.37736000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">5.92453000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">5.28302000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">4.56604000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">3.69811000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">3.28302000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">3.69811000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">4.86792000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">6.37736000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">6.94340000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">6.41509000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">5.69811000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">5.01887000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">3.84906000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">2.90566000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">2.26415000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.47170000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">6.03774000e-02</span><span class="p">,</span>   <span class="mf">2.22045000e-16</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">6.03774000e-02</span><span class="p">,</span>  <span class="o">-</span><span class="mf">2.64151000e-02</span><span class="p">,</span>  <span class="o">-</span><span class="mf">5.66038000e-02</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.35849000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">2.64151000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">4.30189000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">5.50943000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">6.41509000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">5.66038000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">3.39623000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">3.39623000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">3.73585000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">3.47170000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">3.01887000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">4.33962000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">5.09434000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">5.81132000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">6.18868000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">6.52830000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">5.58491000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">4.67925000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">4.22642000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">2.71698000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">2.30189000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">2.11321000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">1.69811000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">1.09434000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">6.03774000e-02</span><span class="p">,</span>  <span class="o">-</span><span class="mf">3.77358000e-03</span><span class="p">,</span>   <span class="mf">2.64151000e-02</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">3.77358000e-03</span><span class="p">,</span>   <span class="mf">3.77358000e-02</span><span class="p">,</span>   <span class="mf">2.22045000e-16</span><span class="p">,</span>
         <span class="mf">5.66038000e-02</span><span class="p">,</span>   <span class="mf">2.22045000e-16</span><span class="p">,</span>   <span class="mf">3.01887000e-02</span><span class="p">,</span>
         <span class="mf">3.77358000e-03</span><span class="p">,</span>   <span class="mf">5.66038000e-02</span><span class="p">,</span>   <span class="mf">7.54717000e-03</span><span class="p">,</span>
         <span class="mf">3.77358000e-02</span><span class="p">,</span>   <span class="mf">7.54717000e-03</span><span class="p">,</span>   <span class="mf">6.79245000e-02</span><span class="p">,</span>
         <span class="mf">7.54717000e-03</span><span class="p">,</span>  <span class="o">-</span><span class="mf">2.64151000e-02</span><span class="p">,</span>   <span class="mf">2.26415000e-02</span><span class="p">,</span>
         <span class="mf">5.28302000e-02</span><span class="p">,</span>  <span class="o">-</span><span class="mf">1.13208000e-02</span><span class="p">,</span>  <span class="o">-</span><span class="mf">1.50943000e-02</span><span class="p">,</span>
         <span class="mf">1.88679000e-02</span><span class="p">,</span>  <span class="o">-</span><span class="mf">1.88679000e-02</span><span class="p">,</span>   <span class="mf">7.54717000e-03</span><span class="p">,</span>
         <span class="mf">2.64151000e-02</span><span class="p">,</span>   <span class="mf">3.77358000e-02</span><span class="p">,</span>   <span class="mf">2.64151000e-02</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">7.54717000e-03</span><span class="p">,</span>   <span class="mf">2.26415000e-02</span><span class="p">,</span>   <span class="mf">1.50943000e-02</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.13208000e-02</span><span class="p">,</span>   <span class="mf">3.77358000e-02</span><span class="p">,</span>   <span class="mf">3.77358000e-03</span><span class="p">,</span>
         <span class="mf">3.77358000e-03</span><span class="p">,</span>  <span class="o">-</span><span class="mf">5.28302000e-02</span><span class="p">,</span>  <span class="o">-</span><span class="mf">1.28302000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">2.07547000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">2.94340000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">4.26415000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">4.98113000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">5.39623000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">5.84906000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">5.69811000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">5.35849000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">4.15094000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">3.81132000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">3.47170000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">3.73585000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">4.11321000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">5.24528000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">5.66038000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">6.11321000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">5.77358000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">5.13208000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">4.33962000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">3.47170000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">2.83019000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">2.41509000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">1.84906000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">1.09434000e-01</span><span class="p">,</span>
         <span class="mf">1.50943000e-02</span><span class="p">,</span>  <span class="o">-</span><span class="mf">7.92453000e-02</span><span class="p">,</span>  <span class="o">-</span><span class="mf">1.01887000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">7.92453000e-02</span><span class="p">,</span>  <span class="o">-</span><span class="mf">1.54717000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">3.77358000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">4.64151000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">5.84906000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">5.43396000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">4.41509000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">3.96226000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">3.62264000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">2.98113000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">3.62264000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">4.37736000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">5.09434000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">5.50943000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">5.96226000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">6.30189000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">3.92453000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">2.60377000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">2.33962000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">1.35849000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">6.03774000e-02</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.88679000e-02</span><span class="p">,</span>   <span class="mf">2.22045000e-16</span><span class="p">,</span>   <span class="mf">4.52830000e-02</span><span class="p">,</span>
         <span class="mf">2.22045000e-16</span><span class="p">,</span>   <span class="mf">2.64151000e-02</span><span class="p">,</span>   <span class="mf">5.28302000e-02</span><span class="p">,</span>
         <span class="mf">1.50943000e-02</span><span class="p">,</span>  <span class="o">-</span><span class="mf">7.54717000e-03</span><span class="p">,</span>   <span class="mf">7.54717000e-03</span><span class="p">,</span>
         <span class="mf">3.39623000e-02</span><span class="p">,</span>   <span class="mf">7.54717000e-03</span><span class="p">,</span>   <span class="mf">3.39623000e-02</span><span class="p">,</span>
         <span class="mf">3.77358000e-03</span><span class="p">,</span>   <span class="mf">1.50943000e-02</span><span class="p">,</span>   <span class="mf">4.52830000e-02</span><span class="p">,</span>
         <span class="mf">1.88679000e-02</span><span class="p">,</span>   <span class="mf">2.64151000e-02</span><span class="p">,</span>   <span class="mf">1.50943000e-02</span><span class="p">,</span>
         <span class="mf">7.54717000e-03</span><span class="p">,</span>  <span class="o">-</span><span class="mf">1.50943000e-02</span><span class="p">,</span>   <span class="mf">2.26415000e-02</span><span class="p">,</span>
         <span class="mf">4.15094000e-02</span><span class="p">,</span>   <span class="mf">1.50943000e-02</span><span class="p">,</span>   <span class="mf">3.01887000e-02</span><span class="p">,</span>
         <span class="mf">7.54717000e-03</span><span class="p">,</span>   <span class="mf">1.88679000e-02</span><span class="p">,</span>   <span class="mf">3.01887000e-02</span><span class="p">,</span>
         <span class="mf">7.54717000e-03</span><span class="p">,</span>   <span class="mf">2.26415000e-02</span><span class="p">,</span>   <span class="mf">7.54717000e-03</span><span class="p">,</span>
         <span class="mf">1.88679000e-02</span><span class="p">,</span>   <span class="mf">2.22045000e-16</span><span class="p">,</span>  <span class="o">-</span><span class="mf">1.88679000e-02</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">4.52830000e-02</span><span class="p">,</span>  <span class="o">-</span><span class="mf">7.54717000e-02</span><span class="p">,</span>  <span class="o">-</span><span class="mf">1.58491000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">2.33962000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">3.66038000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">4.11321000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">4.71698000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">5.96226000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">6.41509000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">6.41509000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">5.32075000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">6.07547000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">5.13208000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">3.96226000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">4.15094000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">3.81132000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">3.28302000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">3.69811000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">3.96226000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">3.96226000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">5.50943000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">6.33962000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">6.60377000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">6.22642000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">5.73585000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">5.47170000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">5.01887000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">4.18868000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">3.20755000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">2.18868000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.73585000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">7.92453000e-02</span><span class="p">,</span>   <span class="mf">1.50943000e-02</span><span class="p">,</span>
         <span class="mf">6.79245000e-02</span><span class="p">,</span>   <span class="mf">2.22045000e-16</span><span class="p">,</span>   <span class="mf">3.01887000e-02</span><span class="p">,</span>
         <span class="mf">9.05660000e-02</span><span class="p">,</span>  <span class="o">-</span><span class="mf">2.26415000e-02</span><span class="p">,</span>   <span class="mf">5.28302000e-02</span><span class="p">,</span>
         <span class="mf">3.77358000e-02</span><span class="p">,</span>  <span class="o">-</span><span class="mf">4.90566000e-02</span><span class="p">,</span>   <span class="mf">1.88679000e-02</span><span class="p">,</span>
         <span class="mf">9.81132000e-02</span><span class="p">,</span>  <span class="o">-</span><span class="mf">1.16981000e-01</span><span class="p">,</span>   <span class="mf">3.09434000e-01</span><span class="p">,</span>
         <span class="mf">2.98113000e-01</span><span class="p">,</span>   <span class="mf">6.03774000e-02</span><span class="p">,</span>  <span class="o">-</span><span class="mf">1.43396000e-01</span><span class="p">,</span>
         <span class="mf">8.67925000e-02</span><span class="p">,</span>   <span class="mf">2.22045000e-16</span><span class="p">,</span>   <span class="mf">3.01887000e-02</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">5.66038000e-02</span><span class="p">,</span>   <span class="mf">5.28302000e-02</span><span class="p">,</span>  <span class="o">-</span><span class="mf">1.13208000e-02</span><span class="p">,</span>
         <span class="mf">4.52830000e-02</span><span class="p">,</span>  <span class="o">-</span><span class="mf">1.50943000e-02</span><span class="p">,</span>   <span class="mf">3.77358000e-02</span><span class="p">,</span>
         <span class="mf">3.77358000e-03</span><span class="p">,</span>   <span class="mf">1.50943000e-02</span><span class="p">,</span>   <span class="mf">3.77358000e-02</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">3.39623000e-02</span><span class="p">,</span>   <span class="mf">1.13208000e-02</span><span class="p">,</span>   <span class="mf">2.64151000e-02</span><span class="p">,</span>
         <span class="mf">2.26415000e-02</span><span class="p">,</span>  <span class="o">-</span><span class="mf">7.54717000e-03</span><span class="p">,</span>   <span class="mf">2.26415000e-02</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.13208000e-02</span><span class="p">,</span>   <span class="mf">2.64151000e-02</span><span class="p">,</span>   <span class="mf">4.15094000e-02</span><span class="p">,</span>
         <span class="mf">1.88679000e-02</span><span class="p">,</span>   <span class="mf">3.77358000e-03</span><span class="p">,</span>  <span class="o">-</span><span class="mf">1.88679000e-02</span><span class="p">,</span>
         <span class="mf">2.26415000e-02</span><span class="p">,</span>   <span class="mf">2.22045000e-16</span><span class="p">,</span>   <span class="mf">1.88679000e-02</span><span class="p">,</span>
         <span class="mf">1.13208000e-02</span><span class="p">,</span>   <span class="mf">4.15094000e-02</span><span class="p">,</span>  <span class="o">-</span><span class="mf">3.77358000e-03</span><span class="p">,</span>
         <span class="mf">2.26415000e-02</span><span class="p">,</span>   <span class="mf">3.01887000e-02</span><span class="p">,</span>   <span class="mf">1.13208000e-02</span><span class="p">,</span>
         <span class="mf">2.64151000e-02</span><span class="p">,</span>   <span class="mf">1.50943000e-02</span><span class="p">,</span>  <span class="o">-</span><span class="mf">7.54717000e-03</span><span class="p">,</span>
         <span class="mf">2.26415000e-02</span><span class="p">,</span>  <span class="o">-</span><span class="mf">3.77358000e-03</span><span class="p">,</span>   <span class="mf">1.13208000e-02</span><span class="p">,</span>
         <span class="mf">1.13208000e-02</span><span class="p">,</span>   <span class="mf">1.50943000e-02</span><span class="p">,</span>  <span class="o">-</span><span class="mf">1.13208000e-02</span><span class="p">,</span>
         <span class="mf">1.50943000e-02</span><span class="p">,</span>   <span class="mf">7.54717000e-03</span><span class="p">,</span>   <span class="mf">1.88679000e-02</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">3.77358000e-03</span><span class="p">,</span>   <span class="mf">7.54717000e-03</span><span class="p">,</span>  <span class="o">-</span><span class="mf">3.77358000e-03</span><span class="p">,</span>
         <span class="mf">1.88679000e-02</span><span class="p">,</span>   <span class="mf">3.77358000e-03</span><span class="p">,</span>   <span class="mf">7.54717000e-03</span><span class="p">,</span>
         <span class="mf">1.88679000e-02</span><span class="p">,</span>  <span class="o">-</span><span class="mf">3.77358000e-03</span><span class="p">,</span>   <span class="mf">7.54717000e-03</span><span class="p">,</span>
         <span class="mf">2.26415000e-02</span><span class="p">,</span>   <span class="mf">3.77358000e-03</span><span class="p">,</span>   <span class="mf">3.77358000e-03</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">3.77358000e-03</span><span class="p">,</span>   <span class="mf">1.88679000e-02</span><span class="p">,</span>   <span class="mf">3.01887000e-02</span><span class="p">,</span>
         <span class="mf">1.13208000e-02</span><span class="p">,</span>  <span class="o">-</span><span class="mf">1.13208000e-02</span><span class="p">,</span>   <span class="mf">2.22045000e-16</span><span class="p">,</span>
         <span class="mf">7.54717000e-03</span><span class="p">,</span>   <span class="mf">7.54717000e-03</span><span class="p">,</span>   <span class="mf">7.54717000e-03</span><span class="p">,</span>
         <span class="mf">1.50943000e-02</span><span class="p">,</span>   <span class="mf">7.54717000e-03</span><span class="p">])</span>

    <span class="n">fig14top_t_raw</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
      <span class="p">[</span> <span class="mf">0.747111</span><span class="p">,</span>  <span class="mf">0.75739</span> <span class="p">,</span>  <span class="mf">0.761501</span><span class="p">,</span>  <span class="mf">0.769724</span><span class="p">,</span>  <span class="mf">0.777947</span><span class="p">,</span>  <span class="mf">0.78617</span> <span class="p">,</span>
        <span class="mf">0.794393</span><span class="p">,</span>  <span class="mf">0.804672</span><span class="p">,</span>  <span class="mf">0.808783</span><span class="p">,</span>  <span class="mf">0.817006</span><span class="p">,</span>  <span class="mf">0.825229</span><span class="p">,</span>  <span class="mf">0.82934</span> <span class="p">,</span>
        <span class="mf">0.837563</span><span class="p">,</span>  <span class="mf">0.84373</span> <span class="p">,</span>  <span class="mf">0.851953</span><span class="p">,</span>  <span class="mf">0.856065</span><span class="p">,</span>  <span class="mf">0.862232</span><span class="p">,</span>  <span class="mf">0.870455</span><span class="p">,</span>
        <span class="mf">0.893068</span><span class="p">,</span>  <span class="mf">0.903346</span><span class="p">,</span>  <span class="mf">0.911569</span><span class="p">,</span>  <span class="mf">0.917736</span><span class="p">,</span>  <span class="mf">0.921848</span><span class="p">,</span>  <span class="mf">0.938293</span><span class="p">,</span>
        <span class="mf">0.942405</span><span class="p">,</span>  <span class="mf">0.944461</span><span class="p">,</span>  <span class="mf">0.946516</span><span class="p">,</span>  <span class="mf">0.950628</span><span class="p">,</span>  <span class="mf">0.952683</span><span class="p">,</span>  <span class="mf">0.956795</span><span class="p">,</span>
        <span class="mf">0.960906</span><span class="p">,</span>  <span class="mf">0.962962</span><span class="p">,</span>  <span class="mf">0.965018</span><span class="p">,</span>  <span class="mf">0.969129</span><span class="p">,</span>  <span class="mf">0.973241</span><span class="p">,</span>  <span class="mf">0.975296</span><span class="p">,</span>
        <span class="mf">0.977352</span><span class="p">,</span>  <span class="mf">0.983519</span><span class="p">,</span>  <span class="mf">0.985575</span><span class="p">,</span>  <span class="mf">0.987631</span><span class="p">,</span>  <span class="mf">0.991742</span><span class="p">,</span>  <span class="mf">0.993798</span><span class="p">,</span>
        <span class="mf">1.00202</span> <span class="p">,</span>  <span class="mf">1.00819</span> <span class="p">,</span>  <span class="mf">1.0123</span>  <span class="p">,</span>  <span class="mf">1.01641</span> <span class="p">,</span>  <span class="mf">1.02052</span> <span class="p">,</span>  <span class="mf">1.02258</span> <span class="p">,</span>
        <span class="mf">1.02875</span> <span class="p">,</span>  <span class="mf">1.0308</span>  <span class="p">,</span>  <span class="mf">1.03491</span> <span class="p">,</span>  <span class="mf">1.03697</span> <span class="p">,</span>  <span class="mf">1.04108</span> <span class="p">,</span>  <span class="mf">1.04519</span> <span class="p">,</span>
        <span class="mf">1.04725</span> <span class="p">,</span>  <span class="mf">1.0493</span>  <span class="p">,</span>  <span class="mf">1.05136</span> <span class="p">,</span>  <span class="mf">1.05547</span> <span class="p">,</span>  <span class="mf">1.06164</span> <span class="p">,</span>  <span class="mf">1.08014</span> <span class="p">,</span>
        <span class="mf">1.09042</span> <span class="p">,</span>  <span class="mf">1.10275</span> <span class="p">,</span>  <span class="mf">1.10892</span> <span class="p">,</span>  <span class="mf">1.11509</span> <span class="p">,</span>  <span class="mf">1.12742</span> <span class="p">,</span>  <span class="mf">1.13564</span> <span class="p">,</span>
        <span class="mf">1.14592</span> <span class="p">,</span>  <span class="mf">1.1562</span>  <span class="p">,</span>  <span class="mf">1.16237</span> <span class="p">,</span>  <span class="mf">1.17059</span> <span class="p">,</span>  <span class="mf">1.17676</span> <span class="p">,</span>  <span class="mf">1.18498</span> <span class="p">,</span>
        <span class="mf">1.1932</span>  <span class="p">,</span>  <span class="mf">1.20348</span> <span class="p">,</span>  <span class="mf">1.20759</span> <span class="p">,</span>  <span class="mf">1.21376</span> <span class="p">,</span>  <span class="mf">1.22198</span> <span class="p">,</span>  <span class="mf">1.24665</span> <span class="p">,</span>
        <span class="mf">1.25899</span> <span class="p">,</span>  <span class="mf">1.26104</span> <span class="p">,</span>  <span class="mf">1.26515</span> <span class="p">,</span>  <span class="mf">1.26721</span> <span class="p">,</span>  <span class="mf">1.26926</span> <span class="p">,</span>  <span class="mf">1.27132</span> <span class="p">,</span>
        <span class="mf">1.27749</span> <span class="p">,</span>  <span class="mf">1.27954</span> <span class="p">,</span>  <span class="mf">1.2816</span>  <span class="p">,</span>  <span class="mf">1.28365</span> <span class="p">,</span>  <span class="mf">1.28777</span> <span class="p">,</span>  <span class="mf">1.29393</span> <span class="p">,</span>
        <span class="mf">1.29599</span> <span class="p">,</span>  <span class="mf">1.29804</span> <span class="p">,</span>  <span class="mf">1.3001</span>  <span class="p">,</span>  <span class="mf">1.30216</span> <span class="p">,</span>  <span class="mf">1.30421</span> <span class="p">,</span>  <span class="mf">1.30627</span> <span class="p">,</span>
        <span class="mf">1.31243</span> <span class="p">,</span>  <span class="mf">1.32066</span> <span class="p">,</span>  <span class="mf">1.32271</span> <span class="p">,</span>  <span class="mf">1.32477</span> <span class="p">,</span>  <span class="mf">1.33094</span> <span class="p">,</span>  <span class="mf">1.3371</span>  <span class="p">,</span>
        <span class="mf">1.34121</span> <span class="p">,</span>  <span class="mf">1.34327</span> <span class="p">,</span>  <span class="mf">1.34533</span> <span class="p">,</span>  <span class="mf">1.34944</span> <span class="p">,</span>  <span class="mf">1.35149</span> <span class="p">,</span>  <span class="mf">1.35355</span> <span class="p">,</span>
        <span class="mf">1.35972</span> <span class="p">,</span>  <span class="mf">1.36383</span> <span class="p">,</span>  <span class="mf">1.37616</span> <span class="p">,</span>  <span class="mf">1.38027</span> <span class="p">,</span>  <span class="mf">1.38233</span> <span class="p">,</span>  <span class="mf">1.38438</span> <span class="p">,</span>
        <span class="mf">1.38644</span> <span class="p">,</span>  <span class="mf">1.3885</span>  <span class="p">,</span>  <span class="mf">1.39261</span> <span class="p">,</span>  <span class="mf">1.39466</span> <span class="p">,</span>  <span class="mf">1.40083</span> <span class="p">,</span>  <span class="mf">1.407</span>   <span class="p">,</span>
        <span class="mf">1.41316</span> <span class="p">,</span>  <span class="mf">1.41522</span> <span class="p">,</span>  <span class="mf">1.41728</span> <span class="p">,</span>  <span class="mf">1.41933</span> <span class="p">,</span>  <span class="mf">1.42755</span> <span class="p">,</span>  <span class="mf">1.43167</span> <span class="p">,</span>
        <span class="mf">1.43372</span> <span class="p">,</span>  <span class="mf">1.43578</span> <span class="p">,</span>  <span class="mf">1.44194</span> <span class="p">,</span>  <span class="mf">1.44606</span> <span class="p">,</span>  <span class="mf">1.45222</span> <span class="p">,</span>  <span class="mf">1.45633</span> <span class="p">,</span>
        <span class="mf">1.45839</span> <span class="p">,</span>  <span class="mf">1.46045</span> <span class="p">,</span>  <span class="mf">1.4625</span>  <span class="p">,</span>  <span class="mf">1.46456</span> <span class="p">,</span>  <span class="mf">1.46867</span> <span class="p">,</span>  <span class="mf">1.47278</span> <span class="p">,</span>
        <span class="mf">1.47484</span> <span class="p">,</span>  <span class="mf">1.47689</span> <span class="p">,</span>  <span class="mf">1.48511</span> <span class="p">,</span>  <span class="mf">1.49128</span> <span class="p">,</span>  <span class="mf">1.49334</span> <span class="p">,</span>  <span class="mf">1.49951</span> <span class="p">,</span>
        <span class="mf">1.50156</span> <span class="p">,</span>  <span class="mf">1.50978</span> <span class="p">,</span>  <span class="mf">1.52006</span> <span class="p">,</span>  <span class="mf">1.52829</span> <span class="p">,</span>  <span class="mf">1.5324</span>  <span class="p">,</span>  <span class="mf">1.53856</span> <span class="p">,</span>
        <span class="mf">1.54062</span> <span class="p">,</span>  <span class="mf">1.5509</span>  <span class="p">,</span>  <span class="mf">1.55501</span> <span class="p">,</span>  <span class="mf">1.56529</span> <span class="p">,</span>  <span class="mf">1.57351</span> <span class="p">,</span>  <span class="mf">1.57968</span> <span class="p">,</span>
        <span class="mf">1.58173</span> <span class="p">,</span>  <span class="mf">1.58996</span> <span class="p">,</span>  <span class="mf">1.59407</span> <span class="p">,</span>  <span class="mf">1.60435</span> <span class="p">,</span>  <span class="mf">1.60846</span> <span class="p">,</span>  <span class="mf">1.61463</span> <span class="p">,</span>
        <span class="mf">1.62079</span> <span class="p">,</span>  <span class="mf">1.62696</span> <span class="p">,</span>  <span class="mf">1.63107</span> <span class="p">,</span>  <span class="mf">1.63724</span> <span class="p">,</span>  <span class="mf">1.64135</span> <span class="p">,</span>  <span class="mf">1.64752</span> <span class="p">,</span>
        <span class="mf">1.65368</span> <span class="p">,</span>  <span class="mf">1.66191</span> <span class="p">,</span>  <span class="mf">1.67219</span> <span class="p">,</span>  <span class="mf">1.67835</span> <span class="p">,</span>  <span class="mf">1.68246</span> <span class="p">,</span>  <span class="mf">1.68863</span> <span class="p">,</span>
        <span class="mf">1.69069</span> <span class="p">,</span>  <span class="mf">1.69274</span> <span class="p">,</span>  <span class="mf">1.69685</span> <span class="p">,</span>  <span class="mf">1.70097</span> <span class="p">,</span>  <span class="mf">1.70508</span> <span class="p">,</span>  <span class="mf">1.70713</span> <span class="p">,</span>
        <span class="mf">1.71124</span> <span class="p">,</span>  <span class="mf">1.71741</span> <span class="p">,</span>  <span class="mf">1.71947</span> <span class="p">,</span>  <span class="mf">1.72358</span> <span class="p">,</span>  <span class="mf">1.72769</span> <span class="p">,</span>  <span class="mf">1.73386</span> <span class="p">,</span>
        <span class="mf">1.74002</span> <span class="p">,</span>  <span class="mf">1.74208</span> <span class="p">,</span>  <span class="mf">1.74414</span> <span class="p">,</span>  <span class="mf">1.74825</span> <span class="p">,</span>  <span class="mf">1.7503</span>  <span class="p">,</span>  <span class="mf">1.75441</span> <span class="p">,</span>
        <span class="mf">1.76058</span> <span class="p">,</span>  <span class="mf">1.76264</span> <span class="p">,</span>  <span class="mf">1.76469</span> <span class="p">,</span>  <span class="mf">1.76675</span> <span class="p">,</span>  <span class="mf">1.77086</span> <span class="p">,</span>  <span class="mf">1.77292</span> <span class="p">,</span>
        <span class="mf">1.77497</span> <span class="p">,</span>  <span class="mf">1.77703</span> <span class="p">,</span>  <span class="mf">1.78114</span> <span class="p">,</span>  <span class="mf">1.78525</span> <span class="p">,</span>  <span class="mf">1.78936</span> <span class="p">,</span>  <span class="mf">1.79142</span> <span class="p">,</span>
        <span class="mf">1.79758</span> <span class="p">,</span>  <span class="mf">1.8017</span>  <span class="p">,</span>  <span class="mf">1.80581</span> <span class="p">,</span>  <span class="mf">1.80786</span> <span class="p">,</span>  <span class="mf">1.80992</span> <span class="p">,</span>  <span class="mf">1.81403</span> <span class="p">,</span>
        <span class="mf">1.81609</span> <span class="p">,</span>  <span class="mf">1.81814</span> <span class="p">,</span>  <span class="mf">1.82431</span> <span class="p">,</span>  <span class="mf">1.82842</span> <span class="p">,</span>  <span class="mf">1.83048</span> <span class="p">,</span>  <span class="mf">1.83459</span> <span class="p">,</span>
        <span class="mf">1.84075</span> <span class="p">,</span>  <span class="mf">1.84898</span> <span class="p">,</span>  <span class="mf">1.8572</span>  <span class="p">,</span>  <span class="mf">1.85926</span> <span class="p">,</span>  <span class="mf">1.86337</span> <span class="p">,</span>  <span class="mf">1.86748</span> <span class="p">,</span>
        <span class="mf">1.87159</span> <span class="p">,</span>  <span class="mf">1.8757</span>  <span class="p">,</span>  <span class="mf">1.87776</span> <span class="p">,</span>  <span class="mf">1.87981</span> <span class="p">,</span>  <span class="mf">1.88187</span> <span class="p">,</span>  <span class="mf">1.88392</span> <span class="p">,</span>
        <span class="mf">1.88804</span> <span class="p">,</span>  <span class="mf">1.89009</span> <span class="p">,</span>  <span class="mf">1.8942</span>  <span class="p">,</span>  <span class="mf">1.89626</span> <span class="p">,</span>  <span class="mf">1.90243</span> <span class="p">,</span>  <span class="mf">1.90859</span> <span class="p">,</span>
        <span class="mf">1.91065</span> <span class="p">,</span>  <span class="mf">1.91476</span> <span class="p">,</span>  <span class="mf">1.92709</span> <span class="p">,</span>  <span class="mf">1.93532</span> <span class="p">,</span>  <span class="mf">1.94148</span> <span class="p">,</span>  <span class="mf">1.94765</span> <span class="p">,</span>
        <span class="mf">1.95587</span> <span class="p">,</span>  <span class="mf">1.96204</span> <span class="p">,</span>  <span class="mf">1.9641</span>  <span class="p">,</span>  <span class="mf">1.97026</span> <span class="p">,</span>  <span class="mf">1.97643</span> <span class="p">,</span>  <span class="mf">1.98054</span> <span class="p">,</span>
        <span class="mf">1.99699</span> <span class="p">,</span>  <span class="mf">2.00316</span> <span class="p">,</span>  <span class="mf">2.00521</span> <span class="p">,</span>  <span class="mf">2.01549</span> <span class="p">,</span>  <span class="mf">2.02988</span> <span class="p">,</span>  <span class="mf">2.04016</span> <span class="p">,</span>
        <span class="mf">2.05044</span> <span class="p">,</span>  <span class="mf">2.07305</span> <span class="p">,</span>  <span class="mf">2.07922</span> <span class="p">,</span>  <span class="mf">2.08744</span> <span class="p">,</span>  <span class="mf">2.09566</span> <span class="p">,</span>  <span class="mf">2.10183</span> <span class="p">,</span>
        <span class="mf">2.10594</span> <span class="p">,</span>  <span class="mf">2.108</span>   <span class="p">,</span>  <span class="mf">2.11211</span> <span class="p">,</span>  <span class="mf">2.11622</span> <span class="p">,</span>  <span class="mf">2.11828</span> <span class="p">,</span>  <span class="mf">2.12444</span> <span class="p">,</span>
        <span class="mf">2.1265</span>  <span class="p">,</span>  <span class="mf">2.12856</span> <span class="p">,</span>  <span class="mf">2.13472</span> <span class="p">,</span>  <span class="mf">2.14089</span> <span class="p">,</span>  <span class="mf">2.14295</span> <span class="p">,</span>  <span class="mf">2.145</span>   <span class="p">,</span>
        <span class="mf">2.14911</span> <span class="p">,</span>  <span class="mf">2.15117</span> <span class="p">,</span>  <span class="mf">2.15734</span> <span class="p">,</span>  <span class="mf">2.16145</span> <span class="p">,</span>  <span class="mf">2.16556</span> <span class="p">,</span>  <span class="mf">2.16761</span> <span class="p">,</span>
        <span class="mf">2.17173</span> <span class="p">,</span>  <span class="mf">2.17378</span> <span class="p">,</span>  <span class="mf">2.17789</span> <span class="p">,</span>  <span class="mf">2.182</span>   <span class="p">,</span>  <span class="mf">2.18406</span> <span class="p">,</span>  <span class="mf">2.18817</span> <span class="p">,</span>
        <span class="mf">2.19023</span> <span class="p">,</span>  <span class="mf">2.19434</span> <span class="p">,</span>  <span class="mf">2.19639</span> <span class="p">,</span>  <span class="mf">2.20051</span> <span class="p">,</span>  <span class="mf">2.20462</span> <span class="p">,</span>  <span class="mf">2.20667</span> <span class="p">,</span>
        <span class="mf">2.21284</span> <span class="p">,</span>  <span class="mf">2.2149</span>  <span class="p">,</span>  <span class="mf">2.22106</span> <span class="p">,</span>  <span class="mf">2.22723</span> <span class="p">,</span>  <span class="mf">2.22929</span> <span class="p">,</span>  <span class="mf">2.23134</span> <span class="p">,</span>
        <span class="mf">2.23545</span> <span class="p">,</span>  <span class="mf">2.23751</span> <span class="p">,</span>  <span class="mf">2.23956</span> <span class="p">,</span>  <span class="mf">2.24368</span> <span class="p">,</span>  <span class="mf">2.24573</span> <span class="p">,</span>  <span class="mf">2.2519</span>  <span class="p">,</span>
        <span class="mf">2.25601</span> <span class="p">,</span>  <span class="mf">2.25601</span> <span class="p">,</span>  <span class="mf">2.26012</span> <span class="p">,</span>  <span class="mf">2.26218</span> <span class="p">,</span>  <span class="mf">2.26629</span> <span class="p">,</span>  <span class="mf">2.27246</span> <span class="p">,</span>
        <span class="mf">2.27657</span> <span class="p">,</span>  <span class="mf">2.28068</span> <span class="p">,</span>  <span class="mf">2.28273</span> <span class="p">,</span>  <span class="mf">2.28479</span> <span class="p">,</span>  <span class="mf">2.29096</span> <span class="p">,</span>  <span class="mf">2.29918</span> <span class="p">,</span>
        <span class="mf">2.30124</span> <span class="p">,</span>  <span class="mf">2.30535</span> <span class="p">,</span>  <span class="mf">2.30946</span> <span class="p">,</span>  <span class="mf">2.31151</span> <span class="p">,</span>  <span class="mf">2.31563</span> <span class="p">,</span>  <span class="mf">2.31974</span> <span class="p">,</span>
        <span class="mf">2.32179</span> <span class="p">,</span>  <span class="mf">2.32385</span> <span class="p">,</span>  <span class="mf">2.33413</span> <span class="p">,</span>  <span class="mf">2.33618</span> <span class="p">,</span>  <span class="mf">2.34235</span> <span class="p">,</span>  <span class="mf">2.35057</span> <span class="p">,</span>
        <span class="mf">2.35263</span> <span class="p">,</span>  <span class="mf">2.3588</span>  <span class="p">,</span>  <span class="mf">2.36291</span> <span class="p">,</span>  <span class="mf">2.37524</span> <span class="p">,</span>  <span class="mf">2.3773</span>  <span class="p">,</span>  <span class="mf">2.38346</span> <span class="p">,</span>
        <span class="mf">2.38758</span> <span class="p">,</span>  <span class="mf">2.39785</span> <span class="p">,</span>  <span class="mf">2.40402</span> <span class="p">,</span>  <span class="mf">2.4143</span>  <span class="p">,</span>  <span class="mf">2.42047</span> <span class="p">,</span>  <span class="mf">2.42869</span> <span class="p">,</span>
        <span class="mf">2.43486</span> <span class="p">,</span>  <span class="mf">2.44514</span> <span class="p">,</span>  <span class="mf">2.45336</span> <span class="p">,</span>  <span class="mf">2.46158</span> <span class="p">,</span>  <span class="mf">2.48008</span> <span class="p">,</span>  <span class="mf">2.49036</span> <span class="p">,</span>
        <span class="mf">2.49859</span> <span class="p">,</span>  <span class="mf">2.50681</span> <span class="p">,</span>  <span class="mf">2.51298</span> <span class="p">,</span>  <span class="mf">2.52531</span> <span class="p">,</span>  <span class="mf">2.52942</span> <span class="p">,</span>  <span class="mf">2.53148</span> <span class="p">,</span>
        <span class="mf">2.53559</span> <span class="p">,</span>  <span class="mf">2.53764</span> <span class="p">,</span>  <span class="mf">2.54176</span> <span class="p">,</span>  <span class="mf">2.54792</span> <span class="p">,</span>  <span class="mf">2.54998</span> <span class="p">,</span>  <span class="mf">2.55203</span> <span class="p">,</span>
        <span class="mf">2.55409</span> <span class="p">,</span>  <span class="mf">2.56231</span> <span class="p">,</span>  <span class="mf">2.56642</span> <span class="p">,</span>  <span class="mf">2.56848</span> <span class="p">,</span>  <span class="mf">2.57259</span> <span class="p">,</span>  <span class="mf">2.5767</span>  <span class="p">,</span>
        <span class="mf">2.58287</span> <span class="p">,</span>  <span class="mf">2.58904</span> <span class="p">,</span>  <span class="mf">2.59109</span> <span class="p">,</span>  <span class="mf">2.5952</span>  <span class="p">,</span>  <span class="mf">2.59726</span> <span class="p">,</span>  <span class="mf">2.60137</span> <span class="p">,</span>
        <span class="mf">2.60548</span> <span class="p">,</span>  <span class="mf">2.60959</span> <span class="p">,</span>  <span class="mf">2.61165</span> <span class="p">,</span>  <span class="mf">2.61371</span> <span class="p">,</span>  <span class="mf">2.61782</span> <span class="p">,</span>  <span class="mf">2.61987</span> <span class="p">,</span>
        <span class="mf">2.62193</span> <span class="p">,</span>  <span class="mf">2.62398</span> <span class="p">,</span>  <span class="mf">2.62604</span> <span class="p">,</span>  <span class="mf">2.6281</span>  <span class="p">,</span>  <span class="mf">2.63221</span> <span class="p">,</span>  <span class="mf">2.64043</span> <span class="p">,</span>
        <span class="mf">2.64865</span> <span class="p">,</span>  <span class="mf">2.65276</span> <span class="p">,</span>  <span class="mf">2.65482</span> <span class="p">,</span>  <span class="mf">2.65893</span> <span class="p">,</span>  <span class="mf">2.66304</span> <span class="p">,</span>  <span class="mf">2.6651</span>  <span class="p">,</span>
        <span class="mf">2.66921</span> <span class="p">,</span>  <span class="mf">2.67743</span> <span class="p">,</span>  <span class="mf">2.67949</span> <span class="p">,</span>  <span class="mf">2.68154</span> <span class="p">,</span>  <span class="mf">2.68771</span> <span class="p">,</span>  <span class="mf">2.69182</span> <span class="p">,</span>
        <span class="mf">2.69593</span> <span class="p">,</span>  <span class="mf">2.70005</span> <span class="p">,</span>  <span class="mf">2.7021</span>  <span class="p">,</span>  <span class="mf">2.70621</span> <span class="p">,</span>  <span class="mf">2.71032</span> <span class="p">,</span>  <span class="mf">2.71444</span> <span class="p">,</span>
        <span class="mf">2.71855</span> <span class="p">,</span>  <span class="mf">2.7206</span>  <span class="p">,</span>  <span class="mf">2.72471</span> <span class="p">,</span>  <span class="mf">2.72883</span> <span class="p">,</span>  <span class="mf">2.73088</span> <span class="p">,</span>  <span class="mf">2.73499</span> <span class="p">,</span>
        <span class="mf">2.73705</span> <span class="p">,</span>  <span class="mf">2.7391</span>  <span class="p">,</span>  <span class="mf">2.74322</span> <span class="p">,</span>  <span class="mf">2.74733</span> <span class="p">,</span>  <span class="mf">2.75761</span> <span class="p">,</span>  <span class="mf">2.75966</span> <span class="p">,</span>
        <span class="mf">2.76583</span> <span class="p">,</span>  <span class="mf">2.77816</span> <span class="p">,</span>  <span class="mf">2.78227</span> <span class="p">,</span>  <span class="mf">2.79255</span> <span class="p">,</span>  <span class="mf">2.80078</span> <span class="p">,</span>  <span class="mf">2.809</span>   <span class="p">,</span>
        <span class="mf">2.81928</span> <span class="p">,</span>  <span class="mf">2.82956</span> <span class="p">,</span>  <span class="mf">2.84806</span> <span class="p">,</span>  <span class="mf">2.85422</span> <span class="p">,</span>  <span class="mf">2.86656</span> <span class="p">,</span>  <span class="mf">2.87889</span> <span class="p">,</span>
        <span class="mf">2.88917</span> <span class="p">,</span>  <span class="mf">2.89945</span> <span class="p">,</span>  <span class="mf">2.92617</span> <span class="p">,</span>  <span class="mf">2.94056</span> <span class="p">,</span>  <span class="mf">2.9529</span>  <span class="p">,</span>  <span class="mf">2.95495</span> <span class="p">,</span>
        <span class="mf">2.95907</span> <span class="p">,</span>  <span class="mf">2.96112</span> <span class="p">,</span>  <span class="mf">2.96523</span> <span class="p">,</span>  <span class="mf">2.96729</span> <span class="p">,</span>  <span class="mf">2.97346</span> <span class="p">,</span>  <span class="mf">2.97551</span> <span class="p">,</span>
        <span class="mf">2.97962</span> <span class="p">,</span>  <span class="mf">2.98785</span> <span class="p">,</span>  <span class="mf">2.99196</span> <span class="p">,</span>  <span class="mf">2.99401</span> <span class="p">,</span>  <span class="mf">2.99607</span> <span class="p">,</span>  <span class="mf">3.00018</span> <span class="p">,</span>
        <span class="mf">3.01252</span> <span class="p">,</span>  <span class="mf">3.01663</span> <span class="p">,</span>  <span class="mf">3.01868</span> <span class="p">,</span>  <span class="mf">3.02279</span> <span class="p">,</span>  <span class="mf">3.03307</span> <span class="p">,</span>  <span class="mf">3.03718</span> <span class="p">,</span>
        <span class="mf">3.03924</span> <span class="p">,</span>  <span class="mf">3.04952</span> <span class="p">,</span>  <span class="mf">3.05157</span> <span class="p">,</span>  <span class="mf">3.05363</span> <span class="p">,</span>  <span class="mf">3.0598</span>  <span class="p">,</span>  <span class="mf">3.06391</span> <span class="p">,</span>
        <span class="mf">3.07008</span> <span class="p">,</span>  <span class="mf">3.07213</span> <span class="p">,</span>  <span class="mf">3.07624</span> <span class="p">,</span>  <span class="mf">3.08035</span> <span class="p">,</span>  <span class="mf">3.08241</span> <span class="p">,</span>  <span class="mf">3.08652</span> <span class="p">,</span>
        <span class="mf">3.08858</span> <span class="p">,</span>  <span class="mf">3.09269</span> <span class="p">,</span>  <span class="mf">3.10091</span> <span class="p">,</span>  <span class="mf">3.10297</span> <span class="p">,</span>  <span class="mf">3.10502</span> <span class="p">,</span>  <span class="mf">3.10913</span> <span class="p">,</span>
        <span class="mf">3.11325</span> <span class="p">,</span>  <span class="mf">3.11941</span> <span class="p">,</span>  <span class="mf">3.12558</span> <span class="p">,</span>  <span class="mf">3.12558</span> <span class="p">,</span>  <span class="mf">3.12969</span> <span class="p">,</span>  <span class="mf">3.1338</span>  <span class="p">,</span>
        <span class="mf">3.13791</span> <span class="p">,</span>  <span class="mf">3.14614</span> <span class="p">,</span>  <span class="mf">3.14819</span> <span class="p">,</span>  <span class="mf">3.15025</span> <span class="p">,</span>  <span class="mf">3.15436</span> <span class="p">,</span>  <span class="mf">3.15847</span> <span class="p">,</span>
        <span class="mf">3.16053</span> <span class="p">,</span>  <span class="mf">3.16669</span> <span class="p">,</span>  <span class="mf">3.16875</span> <span class="p">,</span>  <span class="mf">3.17081</span> <span class="p">,</span>  <span class="mf">3.17492</span> <span class="p">,</span>  <span class="mf">3.17697</span> <span class="p">,</span>
        <span class="mf">3.18931</span> <span class="p">,</span>  <span class="mf">3.19547</span> <span class="p">,</span>  <span class="mf">3.2037</span>  <span class="p">,</span>  <span class="mf">3.21192</span> <span class="p">,</span>  <span class="mf">3.2222</span>  <span class="p">,</span>  <span class="mf">3.22631</span> <span class="p">,</span>
        <span class="mf">3.23042</span> <span class="p">,</span>  <span class="mf">3.23453</span> <span class="p">,</span>  <span class="mf">3.24276</span> <span class="p">,</span>  <span class="mf">3.25098</span> <span class="p">,</span>  <span class="mf">3.25509</span> <span class="p">,</span>  <span class="mf">3.26126</span> <span class="p">,</span>
        <span class="mf">3.26948</span> <span class="p">,</span>  <span class="mf">3.2777</span>  <span class="p">,</span>  <span class="mf">3.28593</span> <span class="p">,</span>  <span class="mf">3.29209</span> <span class="p">,</span>  <span class="mf">3.30237</span> <span class="p">,</span>  <span class="mf">3.30854</span> <span class="p">,</span>
        <span class="mf">3.33321</span> <span class="p">,</span>  <span class="mf">3.34554</span> <span class="p">,</span>  <span class="mf">3.35582</span> <span class="p">,</span>  <span class="mf">3.36404</span> <span class="p">,</span>  <span class="mf">3.37432</span> <span class="p">,</span>  <span class="mf">3.37843</span> <span class="p">,</span>
        <span class="mf">3.37843</span> <span class="p">,</span>  <span class="mf">3.38254</span> <span class="p">,</span>  <span class="mf">3.38666</span> <span class="p">,</span>  <span class="mf">3.38871</span> <span class="p">,</span>  <span class="mf">3.39077</span> <span class="p">,</span>  <span class="mf">3.39488</span> <span class="p">,</span>
        <span class="mf">3.39899</span> <span class="p">,</span>  <span class="mf">3.40105</span> <span class="p">,</span>  <span class="mf">3.40516</span> <span class="p">,</span>  <span class="mf">3.40927</span> <span class="p">,</span>  <span class="mf">3.41132</span> <span class="p">,</span>  <span class="mf">3.41544</span> <span class="p">,</span>
        <span class="mf">3.41749</span> <span class="p">,</span>  <span class="mf">3.4216</span>  <span class="p">,</span>  <span class="mf">3.42366</span> <span class="p">,</span>  <span class="mf">3.43188</span> <span class="p">,</span>  <span class="mf">3.43394</span> <span class="p">,</span>  <span class="mf">3.43599</span> <span class="p">,</span>
        <span class="mf">3.4401</span>  <span class="p">,</span>  <span class="mf">3.44216</span> <span class="p">,</span>  <span class="mf">3.44422</span> <span class="p">,</span>  <span class="mf">3.44833</span> <span class="p">,</span>  <span class="mf">3.45449</span> <span class="p">,</span>  <span class="mf">3.46066</span> <span class="p">,</span>
        <span class="mf">3.46477</span> <span class="p">,</span>  <span class="mf">3.46683</span> <span class="p">,</span>  <span class="mf">3.46889</span> <span class="p">,</span>  <span class="mf">3.473</span>   <span class="p">,</span>  <span class="mf">3.47505</span> <span class="p">,</span>  <span class="mf">3.47916</span> <span class="p">,</span>
        <span class="mf">3.48533</span> <span class="p">,</span>  <span class="mf">3.48944</span> <span class="p">,</span>  <span class="mf">3.49767</span> <span class="p">,</span>  <span class="mf">3.50383</span> <span class="p">,</span>  <span class="mf">3.51206</span> <span class="p">,</span>  <span class="mf">3.51617</span> <span class="p">,</span>
        <span class="mf">3.52233</span> <span class="p">,</span>  <span class="mf">3.5285</span>  <span class="p">,</span>  <span class="mf">3.53467</span> <span class="p">,</span>  <span class="mf">3.54289</span> <span class="p">,</span>  <span class="mf">3.547</span>   <span class="p">,</span>  <span class="mf">3.55111</span> <span class="p">,</span>
        <span class="mf">3.55728</span> <span class="p">,</span>  <span class="mf">3.55934</span> <span class="p">,</span>  <span class="mf">3.56345</span> <span class="p">,</span>  <span class="mf">3.58401</span> <span class="p">,</span>  <span class="mf">3.58606</span> <span class="p">,</span>  <span class="mf">3.58812</span> <span class="p">,</span>
        <span class="mf">3.59223</span> <span class="p">,</span>  <span class="mf">3.5984</span>  <span class="p">,</span>  <span class="mf">3.60456</span> <span class="p">,</span>  <span class="mf">3.61073</span> <span class="p">,</span>  <span class="mf">3.61895</span> <span class="p">,</span>  <span class="mf">3.62512</span> <span class="p">,</span>
        <span class="mf">3.63129</span> <span class="p">,</span>  <span class="mf">3.6354</span>  <span class="p">,</span>  <span class="mf">3.64362</span> <span class="p">,</span>  <span class="mf">3.6539</span>  <span class="p">,</span>  <span class="mf">3.66418</span> <span class="p">,</span>  <span class="mf">3.66829</span> <span class="p">,</span>
        <span class="mf">3.67446</span> <span class="p">,</span>  <span class="mf">3.6909</span>  <span class="p">,</span>  <span class="mf">3.69501</span> <span class="p">,</span>  <span class="mf">3.70324</span> <span class="p">,</span>  <span class="mf">3.70735</span> <span class="p">,</span>  <span class="mf">3.71968</span> <span class="p">,</span>
        <span class="mf">3.72379</span> <span class="p">,</span>  <span class="mf">3.73202</span> <span class="p">,</span>  <span class="mf">3.74435</span> <span class="p">,</span>  <span class="mf">3.75257</span> <span class="p">,</span>  <span class="mf">3.76285</span> <span class="p">,</span>  <span class="mf">3.77108</span> <span class="p">,</span>
        <span class="mf">3.78135</span> <span class="p">,</span>  <span class="mf">3.80191</span> <span class="p">,</span>  <span class="mf">3.8163</span>  <span class="p">,</span>  <span class="mf">3.82452</span> <span class="p">,</span>  <span class="mf">3.83891</span> <span class="p">,</span>  <span class="mf">3.85125</span> <span class="p">,</span>
        <span class="mf">3.86153</span> <span class="p">,</span>  <span class="mf">3.88003</span> <span class="p">,</span>  <span class="mf">3.88414</span> <span class="p">,</span>  <span class="mf">3.89647</span> <span class="p">,</span>  <span class="mf">3.91498</span> <span class="p">,</span>  <span class="mf">3.9232</span>  <span class="p">,</span>
        <span class="mf">3.93553</span> <span class="p">,</span>  <span class="mf">3.94787</span> <span class="p">,</span>  <span class="mf">3.95609</span> <span class="p">,</span>  <span class="mf">3.97254</span> <span class="p">,</span>  <span class="mf">3.98282</span> <span class="p">,</span>  <span class="mf">3.98898</span> <span class="p">,</span>
        <span class="mf">3.99721</span> <span class="p">,</span>  <span class="mf">4.00132</span> <span class="p">,</span>  <span class="mf">4.01571</span> <span class="p">,</span>  <span class="mf">4.02599</span> <span class="p">,</span>  <span class="mf">4.03832</span> <span class="p">,</span>  <span class="mf">4.05065</span> <span class="p">,</span>
        <span class="mf">4.06093</span> <span class="p">,</span>  <span class="mf">4.06916</span> <span class="p">,</span>  <span class="mf">4.0856</span>  <span class="p">,</span>  <span class="mf">4.09588</span> <span class="p">,</span>  <span class="mf">4.1041</span>  <span class="p">,</span>  <span class="mf">4.11438</span> <span class="p">,</span>
        <span class="mf">4.13083</span> <span class="p">,</span>  <span class="mf">4.13699</span> <span class="p">,</span>  <span class="mf">4.14522</span> <span class="p">,</span>  <span class="mf">4.1555</span>  <span class="p">,</span>  <span class="mf">4.16372</span> <span class="p">,</span>  <span class="mf">4.18016</span> <span class="p">,</span>
        <span class="mf">4.20278</span> <span class="p">])</span>
    <span class="n">fig14top_w_raw</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
      <span class="p">[</span>  <span class="mf">2.22045000e-16</span><span class="p">,</span>   <span class="mf">2.22045000e-16</span><span class="p">,</span>  <span class="o">-</span><span class="mf">1.18110000e-02</span><span class="p">,</span>
         <span class="mf">2.22045000e-16</span><span class="p">,</span>   <span class="mf">2.22045000e-16</span><span class="p">,</span>  <span class="o">-</span><span class="mf">2.36220000e-02</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">3.93701000e-03</span><span class="p">,</span>  <span class="o">-</span><span class="mf">3.93701000e-03</span><span class="p">,</span>  <span class="o">-</span><span class="mf">1.57480000e-02</span><span class="p">,</span>
         <span class="mf">2.22045000e-16</span><span class="p">,</span>  <span class="o">-</span><span class="mf">1.18110000e-02</span><span class="p">,</span>   <span class="mf">2.22045000e-16</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">3.93701000e-03</span><span class="p">,</span>   <span class="mf">7.87402000e-03</span><span class="p">,</span>  <span class="o">-</span><span class="mf">1.18110000e-02</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.57480000e-02</span><span class="p">,</span>   <span class="mf">2.22045000e-16</span><span class="p">,</span>  <span class="o">-</span><span class="mf">7.87402000e-03</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">7.87402000e-03</span><span class="p">,</span>  <span class="o">-</span><span class="mf">1.18110000e-02</span><span class="p">,</span>   <span class="mf">2.22045000e-16</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">7.87402000e-03</span><span class="p">,</span>  <span class="o">-</span><span class="mf">3.93701000e-03</span><span class="p">,</span>   <span class="mf">3.54331000e-02</span><span class="p">,</span>
         <span class="mf">3.93701000e-03</span><span class="p">,</span>  <span class="o">-</span><span class="mf">5.90551000e-02</span><span class="p">,</span>  <span class="o">-</span><span class="mf">1.25984000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.92913000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">2.32283000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">2.71654000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">3.34646000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">4.25197000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">5.15748000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">5.94488000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">6.61417000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">7.28346000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">7.67717000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">7.40157000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">6.85039000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">5.31496000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">4.72441000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">4.21260000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">3.54331000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">4.21260000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">4.72441000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">5.31496000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">7.40157000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">7.91339000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">7.51969000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">6.53543000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">5.74803000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">6.22047000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">5.03937000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">3.93701000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">2.87402000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">1.96850000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">1.10236000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">6.29921000e-02</span><span class="p">,</span>   <span class="mf">2.22045000e-16</span><span class="p">,</span>   <span class="mf">3.54331000e-02</span><span class="p">,</span>
         <span class="mf">2.36220000e-02</span><span class="p">,</span>   <span class="mf">2.75591000e-02</span><span class="p">,</span>   <span class="mf">3.54331000e-02</span><span class="p">,</span>
         <span class="mf">1.96850000e-02</span><span class="p">,</span>   <span class="mf">2.36220000e-02</span><span class="p">,</span>   <span class="mf">3.54331000e-02</span><span class="p">,</span>
         <span class="mf">2.36220000e-02</span><span class="p">,</span>   <span class="mf">3.93701000e-02</span><span class="p">,</span>   <span class="mf">3.14961000e-02</span><span class="p">,</span>
         <span class="mf">3.14961000e-02</span><span class="p">,</span>   <span class="mf">1.57480000e-02</span><span class="p">,</span>   <span class="mf">3.14961000e-02</span><span class="p">,</span>
         <span class="mf">1.57480000e-02</span><span class="p">,</span>   <span class="mf">2.36220000e-02</span><span class="p">,</span>   <span class="mf">7.87402000e-03</span><span class="p">,</span>
         <span class="mf">3.54331000e-02</span><span class="p">,</span>   <span class="mf">1.96850000e-02</span><span class="p">,</span>   <span class="mf">5.90551000e-02</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">3.93701000e-03</span><span class="p">,</span>   <span class="mf">3.54331000e-02</span><span class="p">,</span>  <span class="o">-</span><span class="mf">7.08661000e-02</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.53543000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">2.28346000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">3.07087000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">4.05512000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">4.80315000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">5.27559000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">7.32283000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">7.63780000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">7.32283000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">6.73228000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">5.98425000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">5.27559000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">4.52756000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">3.97638000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">3.70079000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">3.50394000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">4.44882000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">3.66142000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">6.33858000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">6.81102000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">6.57480000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">6.02362000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">5.19685000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">3.74016000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">2.99213000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">2.32283000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">1.65354000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">7.48031000e-02</span><span class="p">,</span>  <span class="o">-</span><span class="mf">1.18110000e-02</span><span class="p">,</span>  <span class="o">-</span><span class="mf">5.90551000e-02</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">9.05512000e-02</span><span class="p">,</span>  <span class="o">-</span><span class="mf">1.29921000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">2.00787000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">2.59843000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">3.22835000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">5.78740000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">6.92913000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">7.75591000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">7.12598000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">5.55118000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">4.88189000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">4.44882000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">4.09449000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">3.74016000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">4.01575000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">4.52756000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">5.31496000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">7.20472000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">8.14961000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">7.59843000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">5.70866000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">4.76378000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">4.09449000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">3.42520000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">2.71654000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">2.00787000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">1.45669000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.02362000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">4.72441000e-02</span><span class="p">,</span>   <span class="mf">1.18110000e-02</span><span class="p">,</span>
         <span class="mf">1.18110000e-02</span><span class="p">,</span>   <span class="mf">3.93701000e-03</span><span class="p">,</span>   <span class="mf">1.18110000e-02</span><span class="p">,</span>
         <span class="mf">3.54331000e-02</span><span class="p">,</span>   <span class="mf">2.75591000e-02</span><span class="p">,</span>   <span class="mf">2.75591000e-02</span><span class="p">,</span>
         <span class="mf">1.57480000e-02</span><span class="p">,</span>   <span class="mf">2.22045000e-16</span><span class="p">,</span>   <span class="mf">1.18110000e-02</span><span class="p">,</span>
         <span class="mf">3.54331000e-02</span><span class="p">,</span>   <span class="mf">1.96850000e-02</span><span class="p">,</span>   <span class="mf">1.96850000e-02</span><span class="p">,</span>
         <span class="mf">3.93701000e-02</span><span class="p">,</span>   <span class="mf">1.57480000e-02</span><span class="p">,</span>   <span class="mf">2.75591000e-02</span><span class="p">,</span>
         <span class="mf">4.72441000e-02</span><span class="p">,</span>   <span class="mf">3.54331000e-02</span><span class="p">,</span>   <span class="mf">1.57480000e-02</span><span class="p">,</span>
         <span class="mf">3.54331000e-02</span><span class="p">,</span>   <span class="mf">3.14961000e-02</span><span class="p">,</span>   <span class="mf">1.96850000e-02</span><span class="p">,</span>
         <span class="mf">3.14961000e-02</span><span class="p">,</span>   <span class="mf">3.93701000e-02</span><span class="p">,</span>   <span class="mf">2.75591000e-02</span><span class="p">,</span>
         <span class="mf">2.75591000e-02</span><span class="p">,</span>   <span class="mf">3.93701000e-02</span><span class="p">,</span>   <span class="mf">2.36220000e-02</span><span class="p">,</span>
         <span class="mf">3.54331000e-02</span><span class="p">,</span>   <span class="mf">5.51181000e-02</span><span class="p">,</span>   <span class="mf">4.33071000e-02</span><span class="p">,</span>
         <span class="mf">5.51181000e-02</span><span class="p">,</span>   <span class="mf">3.54331000e-02</span><span class="p">,</span>  <span class="o">-</span><span class="mf">9.05512000e-02</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.65354000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">2.28346000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">2.99213000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">4.01575000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">6.57480000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">6.88976000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">7.40157000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">6.85039000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">5.43307000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">4.84252000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">4.37008000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">3.54331000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">3.81890000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">4.33071000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">5.00000000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">5.98425000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">6.85039000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">7.44094000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">6.81102000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">6.06299000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">5.35433000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">4.60630000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">3.74016000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">2.83465000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.96850000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">1.49606000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">1.06299000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">7.87402000e-02</span><span class="p">,</span>  <span class="o">-</span><span class="mf">7.87402000e-03</span><span class="p">,</span>   <span class="mf">1.18110000e-02</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">3.93701000e-03</span><span class="p">,</span>  <span class="o">-</span><span class="mf">9.84252000e-02</span><span class="p">,</span>  <span class="o">-</span><span class="mf">1.77165000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">2.71654000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">3.81890000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">5.00000000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">6.06299000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">7.24409000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">7.95276000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">7.16535000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">6.41732000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">5.66929000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">4.44882000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">3.81890000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">4.44882000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">6.53543000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">7.44094000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">7.71654000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">7.51969000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">7.00787000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">6.37795000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">5.62992000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">4.80315000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">3.93701000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">3.22835000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">2.48031000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">1.77165000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">9.84252000e-02</span><span class="p">,</span>  <span class="o">-</span><span class="mf">5.11811000e-02</span><span class="p">,</span>  <span class="o">-</span><span class="mf">2.75591000e-02</span><span class="p">,</span>
         <span class="mf">1.96850000e-02</span><span class="p">,</span>   <span class="mf">3.54331000e-02</span><span class="p">,</span>   <span class="mf">2.75591000e-02</span><span class="p">,</span>
         <span class="mf">2.75591000e-02</span><span class="p">,</span>   <span class="mf">3.54331000e-02</span><span class="p">,</span>   <span class="mf">3.54331000e-02</span><span class="p">,</span>
         <span class="mf">1.57480000e-02</span><span class="p">,</span>   <span class="mf">2.36220000e-02</span><span class="p">,</span>   <span class="mf">4.33071000e-02</span><span class="p">,</span>
         <span class="mf">1.96850000e-02</span><span class="p">,</span>   <span class="mf">1.96850000e-02</span><span class="p">,</span>   <span class="mf">3.14961000e-02</span><span class="p">,</span>
         <span class="mf">7.87402000e-03</span><span class="p">,</span>   <span class="mf">1.57480000e-02</span><span class="p">,</span>   <span class="mf">3.54331000e-02</span><span class="p">,</span>
         <span class="mf">1.57480000e-02</span><span class="p">,</span>   <span class="mf">3.54331000e-02</span><span class="p">,</span>   <span class="mf">1.18110000e-02</span><span class="p">,</span>
         <span class="mf">2.75591000e-02</span><span class="p">,</span>   <span class="mf">3.14961000e-02</span><span class="p">,</span>   <span class="mf">5.51181000e-02</span><span class="p">,</span>
         <span class="mf">4.33071000e-02</span><span class="p">,</span>   <span class="mf">6.29921000e-02</span><span class="p">,</span>   <span class="mf">3.14961000e-02</span><span class="p">,</span>
         <span class="mf">1.57480000e-02</span><span class="p">,</span>  <span class="o">-</span><span class="mf">3.93701000e-02</span><span class="p">,</span>  <span class="o">-</span><span class="mf">9.05512000e-02</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.69291000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">3.70079000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">4.76378000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">5.90551000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">6.88976000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">7.59843000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">7.20472000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">6.45669000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">5.59055000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">4.84252000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">4.33071000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">3.62205000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">3.93701000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">4.56693000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">5.31496000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">6.37795000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">7.28346000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">7.75591000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">7.36220000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">6.88976000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">6.10236000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">4.44882000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">3.66142000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">2.83465000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">2.08661000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">1.33858000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">7.87402000e-02</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">2.75591000e-02</span><span class="p">,</span>   <span class="mf">3.93701000e-03</span><span class="p">,</span>  <span class="o">-</span><span class="mf">1.18110000e-02</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">9.84252000e-02</span><span class="p">,</span>  <span class="o">-</span><span class="mf">1.73228000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">2.71654000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">3.62205000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">4.72441000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">5.78740000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">6.92913000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">7.44094000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">7.04724000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">5.55118000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">5.55118000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">4.33071000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">3.77953000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">3.34646000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">3.11024000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">3.50394000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">4.01575000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">4.80315000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">5.59055000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">6.45669000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">5.82677000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">5.47244000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">4.29134000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">3.50394000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">2.63780000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">1.96850000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">9.05512000e-02</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">6.69291000e-02</span><span class="p">,</span>  <span class="o">-</span><span class="mf">4.33071000e-02</span><span class="p">,</span>  <span class="o">-</span><span class="mf">1.18110000e-02</span><span class="p">,</span>
         <span class="mf">1.18110000e-02</span><span class="p">,</span>   <span class="mf">3.93701000e-02</span><span class="p">,</span>   <span class="mf">2.36220000e-02</span><span class="p">,</span>
         <span class="mf">2.22045000e-16</span><span class="p">,</span>   <span class="mf">7.87402000e-03</span><span class="p">,</span>   <span class="mf">2.75591000e-02</span><span class="p">,</span>
         <span class="mf">1.18110000e-02</span><span class="p">,</span>  <span class="o">-</span><span class="mf">1.57480000e-02</span><span class="p">,</span>   <span class="mf">1.18110000e-02</span><span class="p">,</span>
         <span class="mf">3.93701000e-02</span><span class="p">,</span>   <span class="mf">7.87402000e-03</span><span class="p">,</span>   <span class="mf">2.36220000e-02</span><span class="p">,</span>
         <span class="mf">2.75591000e-02</span><span class="p">,</span>  <span class="o">-</span><span class="mf">3.93701000e-03</span><span class="p">,</span>   <span class="mf">3.93701000e-03</span><span class="p">,</span>
         <span class="mf">2.36220000e-02</span><span class="p">,</span>   <span class="mf">2.22045000e-16</span><span class="p">,</span>   <span class="mf">1.57480000e-02</span><span class="p">,</span>
         <span class="mf">1.57480000e-02</span><span class="p">,</span>   <span class="mf">2.75591000e-02</span><span class="p">,</span>   <span class="mf">1.57480000e-02</span><span class="p">,</span>
         <span class="mf">3.93701000e-02</span><span class="p">,</span>   <span class="mf">3.93701000e-02</span><span class="p">,</span>   <span class="mf">3.54331000e-02</span><span class="p">,</span>
         <span class="mf">4.33071000e-02</span><span class="p">,</span>   <span class="mf">2.22045000e-16</span><span class="p">,</span>  <span class="o">-</span><span class="mf">5.11811000e-02</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.18110000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">1.85039000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">2.67717000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">4.76378000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">5.98425000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">7.04724000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">7.59843000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">6.85039000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">6.14173000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">5.51181000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">4.76378000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">3.77953000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">3.46457000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">4.25197000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">5.31496000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">6.25984000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">6.96850000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">7.24409000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">6.92913000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">6.33858000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">5.47244000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">4.64567000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">4.01575000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">3.42520000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">2.75591000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">2.04724000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">1.77165000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.02362000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">5.51181000e-02</span><span class="p">,</span>  <span class="o">-</span><span class="mf">1.18110000e-02</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">4.33071000e-02</span><span class="p">,</span>  <span class="o">-</span><span class="mf">1.65354000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">2.40157000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">3.46457000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">5.82677000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">6.81102000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">7.36220000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">6.96850000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">5.82677000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">5.27559000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">4.64567000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">3.50394000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">3.85827000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">4.48819000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">5.19685000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">6.22047000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">7.28346000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">8.62205000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">8.26772000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">7.28346000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">6.33858000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">5.51181000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">3.85827000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">3.14961000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">2.36220000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">1.65354000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">9.05512000e-02</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">3.93701000e-02</span><span class="p">,</span>  <span class="o">-</span><span class="mf">1.18110000e-02</span><span class="p">,</span>   <span class="mf">1.57480000e-02</span><span class="p">,</span>
         <span class="mf">3.93701000e-02</span><span class="p">,</span>   <span class="mf">1.57480000e-02</span><span class="p">,</span>   <span class="mf">2.36220000e-02</span><span class="p">,</span>
         <span class="mf">1.96850000e-02</span><span class="p">,</span>   <span class="mf">1.18110000e-02</span><span class="p">,</span>   <span class="mf">3.93701000e-02</span><span class="p">,</span>
         <span class="mf">7.87402000e-03</span><span class="p">,</span>   <span class="mf">2.75591000e-02</span><span class="p">,</span>   <span class="mf">7.87402000e-03</span><span class="p">,</span>
         <span class="mf">3.14961000e-02</span><span class="p">,</span>   <span class="mf">1.57480000e-02</span><span class="p">,</span>   <span class="mf">3.14961000e-02</span><span class="p">,</span>
         <span class="mf">1.57480000e-02</span><span class="p">,</span>   <span class="mf">2.75591000e-02</span><span class="p">,</span>   <span class="mf">3.14961000e-02</span><span class="p">,</span>
         <span class="mf">5.51181000e-02</span><span class="p">,</span>   <span class="mf">2.75591000e-02</span><span class="p">,</span>   <span class="mf">2.22045000e-16</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">9.84252000e-02</span><span class="p">,</span>  <span class="o">-</span><span class="mf">1.96850000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">3.07087000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">3.93701000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">4.84252000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">7.00787000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">7.75591000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">7.00787000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">5.47244000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">4.60630000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">3.77953000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">3.54331000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">3.70079000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">4.21260000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">6.25984000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">6.81102000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">6.65354000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">5.51181000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">3.77953000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">5.74803000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">4.64567000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">2.12598000e-01</span><span class="p">,</span>   <span class="mf">3.93701000e-02</span><span class="p">,</span>  <span class="o">-</span><span class="mf">3.54331000e-02</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.57480000e-02</span><span class="p">,</span>  <span class="o">-</span><span class="mf">5.11811000e-02</span><span class="p">,</span>  <span class="o">-</span><span class="mf">1.69291000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">2.63780000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">3.50394000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">4.64567000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">6.06299000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">6.92913000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">6.41732000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">5.70866000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">4.96063000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">4.21260000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">3.74016000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">3.26772000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">3.77953000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">3.77953000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">5.47244000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">6.22047000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">7.16535000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">6.41732000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">5.55118000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">4.72441000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">3.97638000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">2.44094000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.77165000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">1.41732000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">1.06299000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">6.69291000e-02</span><span class="p">,</span>  <span class="o">-</span><span class="mf">3.14961000e-02</span><span class="p">,</span>   <span class="mf">7.87402000e-03</span><span class="p">,</span>
         <span class="mf">1.57480000e-02</span><span class="p">,</span>   <span class="mf">4.33071000e-02</span><span class="p">,</span>   <span class="mf">3.54331000e-02</span><span class="p">,</span>
         <span class="mf">4.33071000e-02</span><span class="p">,</span>   <span class="mf">1.96850000e-02</span><span class="p">,</span>   <span class="mf">7.87402000e-03</span><span class="p">,</span>
         <span class="mf">3.14961000e-02</span><span class="p">,</span>   <span class="mf">5.51181000e-02</span><span class="p">,</span>   <span class="mf">1.57480000e-02</span><span class="p">,</span>
         <span class="mf">1.57480000e-02</span><span class="p">,</span>   <span class="mf">4.72441000e-02</span><span class="p">,</span>   <span class="mf">3.54331000e-02</span><span class="p">,</span>
         <span class="mf">3.93701000e-03</span><span class="p">,</span>   <span class="mf">4.72441000e-02</span><span class="p">,</span>   <span class="mf">2.75591000e-02</span><span class="p">,</span>
         <span class="mf">2.75591000e-02</span><span class="p">,</span>   <span class="mf">4.72441000e-02</span><span class="p">,</span>   <span class="mf">3.14961000e-02</span><span class="p">,</span>
         <span class="mf">2.75591000e-02</span><span class="p">,</span>   <span class="mf">3.93701000e-02</span><span class="p">,</span>   <span class="mf">5.90551000e-02</span><span class="p">,</span>
         <span class="mf">6.29921000e-02</span><span class="p">,</span>   <span class="mf">4.72441000e-02</span><span class="p">,</span>   <span class="mf">3.93701000e-03</span><span class="p">,</span>
         <span class="mf">3.93701000e-03</span><span class="p">,</span>  <span class="o">-</span><span class="mf">1.14173000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">1.88976000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">2.79528000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">3.77953000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">4.92126000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">6.33858000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">7.48031000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">8.11024000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">7.55906000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">6.81102000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">5.94488000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">5.31496000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">4.05512000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">3.26772000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">3.46457000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">3.81890000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">4.25197000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">4.80315000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">5.39370000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">5.98425000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">6.88976000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">6.14173000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">5.51181000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">3.89764000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">3.26772000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">2.83465000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">2.08661000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">1.33858000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">7.08661000e-02</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.57480000e-02</span><span class="p">,</span>   <span class="mf">3.14961000e-02</span><span class="p">,</span>   <span class="mf">7.87402000e-03</span><span class="p">,</span>
         <span class="mf">4.72441000e-02</span><span class="p">,</span>   <span class="mf">1.57480000e-02</span><span class="p">,</span>   <span class="mf">3.54331000e-02</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">7.87402000e-03</span><span class="p">,</span>   <span class="mf">5.51181000e-02</span><span class="p">,</span>  <span class="o">-</span><span class="mf">2.75591000e-02</span><span class="p">,</span>
         <span class="mf">8.26772000e-02</span><span class="p">,</span>  <span class="o">-</span><span class="mf">3.54331000e-02</span><span class="p">,</span>  <span class="o">-</span><span class="mf">1.18110000e-01</span><span class="p">,</span>
         <span class="mf">1.14173000e-01</span><span class="p">,</span>   <span class="mf">2.04724000e-01</span><span class="p">,</span>   <span class="mf">2.83465000e-01</span><span class="p">,</span>
         <span class="mf">2.83465000e-01</span><span class="p">,</span>   <span class="mf">1.25984000e-01</span><span class="p">,</span>   <span class="mf">2.75591000e-02</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.25984000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">3.14961000e-02</span><span class="p">,</span>  <span class="o">-</span><span class="mf">1.25984000e-01</span><span class="p">,</span>
         <span class="mf">8.26772000e-02</span><span class="p">,</span>  <span class="o">-</span><span class="mf">3.54331000e-02</span><span class="p">,</span>   <span class="mf">5.51181000e-02</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">3.93701000e-03</span><span class="p">,</span>   <span class="mf">5.51181000e-02</span><span class="p">,</span>   <span class="mf">2.22045000e-16</span><span class="p">,</span>
         <span class="mf">1.96850000e-02</span><span class="p">,</span>   <span class="mf">3.54331000e-02</span><span class="p">,</span>  <span class="o">-</span><span class="mf">3.93701000e-03</span><span class="p">,</span>
         <span class="mf">2.36220000e-02</span><span class="p">,</span>   <span class="mf">4.33071000e-02</span><span class="p">,</span>   <span class="mf">3.93701000e-03</span><span class="p">,</span>
         <span class="mf">2.75591000e-02</span><span class="p">,</span>   <span class="mf">1.96850000e-02</span><span class="p">,</span>   <span class="mf">1.57480000e-02</span><span class="p">,</span>
         <span class="mf">2.36220000e-02</span><span class="p">,</span>   <span class="mf">1.18110000e-02</span><span class="p">,</span>   <span class="mf">7.87402000e-03</span><span class="p">,</span>
         <span class="mf">2.36220000e-02</span><span class="p">,</span>   <span class="mf">1.57480000e-02</span><span class="p">,</span>   <span class="mf">1.96850000e-02</span><span class="p">,</span>
         <span class="mf">1.96850000e-02</span><span class="p">,</span>   <span class="mf">3.54331000e-02</span><span class="p">,</span>   <span class="mf">3.14961000e-02</span><span class="p">,</span>
         <span class="mf">1.57480000e-02</span><span class="p">,</span>   <span class="mf">2.36220000e-02</span><span class="p">,</span>   <span class="mf">1.57480000e-02</span><span class="p">,</span>
         <span class="mf">2.36220000e-02</span><span class="p">,</span>   <span class="mf">4.33071000e-02</span><span class="p">,</span>   <span class="mf">2.75591000e-02</span><span class="p">,</span>
         <span class="mf">2.75591000e-02</span><span class="p">,</span>   <span class="mf">4.33071000e-02</span><span class="p">,</span>   <span class="mf">2.75591000e-02</span><span class="p">,</span>
         <span class="mf">2.36220000e-02</span><span class="p">,</span>   <span class="mf">3.54331000e-02</span><span class="p">,</span>   <span class="mf">1.57480000e-02</span><span class="p">,</span>
         <span class="mf">2.75591000e-02</span><span class="p">,</span>   <span class="mf">1.18110000e-02</span><span class="p">,</span>   <span class="mf">1.57480000e-02</span><span class="p">,</span>
         <span class="mf">3.54331000e-02</span><span class="p">,</span>   <span class="mf">1.96850000e-02</span><span class="p">,</span>   <span class="mf">3.54331000e-02</span><span class="p">,</span>
         <span class="mf">1.96850000e-02</span><span class="p">,</span>   <span class="mf">3.93701000e-02</span><span class="p">,</span>   <span class="mf">4.72441000e-02</span><span class="p">,</span>
         <span class="mf">2.36220000e-02</span><span class="p">,</span>   <span class="mf">2.75591000e-02</span><span class="p">,</span>   <span class="mf">3.14961000e-02</span><span class="p">,</span>
         <span class="mf">3.54331000e-02</span><span class="p">,</span>   <span class="mf">4.72441000e-02</span><span class="p">,</span>   <span class="mf">3.14961000e-02</span><span class="p">,</span>
         <span class="mf">2.75591000e-02</span><span class="p">,</span>   <span class="mf">2.75591000e-02</span><span class="p">,</span>   <span class="mf">3.93701000e-02</span><span class="p">,</span>
         <span class="mf">3.14961000e-02</span><span class="p">,</span>   <span class="mf">3.93701000e-02</span><span class="p">,</span>   <span class="mf">3.54331000e-02</span><span class="p">,</span>
         <span class="mf">2.36220000e-02</span><span class="p">])</span>

    <span class="n">fig14bot_t_raw</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
      <span class="p">[</span> <span class="mf">0.578169</span><span class="p">,</span>  <span class="mf">0.584338</span><span class="p">,</span>  <span class="mf">0.592563</span><span class="p">,</span>  <span class="mf">0.600788</span><span class="p">,</span>  <span class="mf">0.613126</span><span class="p">,</span>  <span class="mf">0.621351</span><span class="p">,</span>
        <span class="mf">0.629576</span><span class="p">,</span>  <span class="mf">0.639857</span><span class="p">,</span>  <span class="mf">0.648082</span><span class="p">,</span>  <span class="mf">0.654251</span><span class="p">,</span>  <span class="mf">0.662476</span><span class="p">,</span>  <span class="mf">0.670701</span><span class="p">,</span>
        <span class="mf">0.67687</span> <span class="p">,</span>  <span class="mf">0.683039</span><span class="p">,</span>  <span class="mf">0.689208</span><span class="p">,</span>  <span class="mf">0.691264</span><span class="p">,</span>  <span class="mf">0.695377</span><span class="p">,</span>  <span class="mf">0.699489</span><span class="p">,</span>
        <span class="mf">0.705658</span><span class="p">,</span>  <span class="mf">0.709771</span><span class="p">,</span>  <span class="mf">0.713883</span><span class="p">,</span>  <span class="mf">0.720052</span><span class="p">,</span>  <span class="mf">0.728277</span><span class="p">,</span>  <span class="mf">0.738559</span><span class="p">,</span>
        <span class="mf">0.74884</span> <span class="p">,</span>  <span class="mf">0.759121</span><span class="p">,</span>  <span class="mf">0.763234</span><span class="p">,</span>  <span class="mf">0.771459</span><span class="p">,</span>  <span class="mf">0.773515</span><span class="p">,</span>  <span class="mf">0.777628</span><span class="p">,</span>
        <span class="mf">0.785853</span><span class="p">,</span>  <span class="mf">0.787909</span><span class="p">,</span>  <span class="mf">0.794078</span><span class="p">,</span>  <span class="mf">0.796134</span><span class="p">,</span>  <span class="mf">0.800247</span><span class="p">,</span>  <span class="mf">0.80436</span> <span class="p">,</span>
        <span class="mf">0.808472</span><span class="p">,</span>  <span class="mf">0.812585</span><span class="p">,</span>  <span class="mf">0.818754</span><span class="p">,</span>  <span class="mf">0.824922</span><span class="p">,</span>  <span class="mf">0.826979</span><span class="p">,</span>  <span class="mf">0.831091</span><span class="p">,</span>
        <span class="mf">0.839316</span><span class="p">,</span>  <span class="mf">0.845485</span><span class="p">,</span>  <span class="mf">0.847541</span><span class="p">,</span>  <span class="mf">0.851654</span><span class="p">,</span>  <span class="mf">0.85371</span> <span class="p">,</span>  <span class="mf">0.857823</span><span class="p">,</span>
        <span class="mf">0.861935</span><span class="p">,</span>  <span class="mf">0.866048</span><span class="p">,</span>  <span class="mf">0.870161</span><span class="p">,</span>  <span class="mf">0.872217</span><span class="p">,</span>  <span class="mf">0.876329</span><span class="p">,</span>  <span class="mf">0.880442</span><span class="p">,</span>
        <span class="mf">0.882498</span><span class="p">,</span>  <span class="mf">0.888667</span><span class="p">,</span>  <span class="mf">0.890723</span><span class="p">,</span>  <span class="mf">0.894836</span><span class="p">,</span>  <span class="mf">0.905117</span><span class="p">,</span>  <span class="mf">0.911286</span><span class="p">,</span>
        <span class="mf">0.919511</span><span class="p">,</span>  <span class="mf">0.927736</span><span class="p">,</span>  <span class="mf">0.938018</span><span class="p">,</span>  <span class="mf">0.946243</span><span class="p">,</span>  <span class="mf">0.956524</span><span class="p">,</span>  <span class="mf">0.970918</span><span class="p">,</span>
        <span class="mf">0.977087</span><span class="p">,</span>  <span class="mf">0.985312</span><span class="p">,</span>  <span class="mf">0.993537</span><span class="p">,</span>  <span class="mf">1.00382</span> <span class="p">,</span>  <span class="mf">1.00999</span> <span class="p">,</span>  <span class="mf">1.01616</span> <span class="p">,</span>
        <span class="mf">1.02438</span> <span class="p">,</span>  <span class="mf">1.04289</span> <span class="p">,</span>  <span class="mf">1.05111</span> <span class="p">,</span>  <span class="mf">1.06962</span> <span class="p">,</span>  <span class="mf">1.07579</span> <span class="p">,</span>  <span class="mf">1.07784</span> <span class="p">,</span>
        <span class="mf">1.08401</span> <span class="p">,</span>  <span class="mf">1.09224</span> <span class="p">,</span>  <span class="mf">1.09635</span> <span class="p">,</span>  <span class="mf">1.09841</span> <span class="p">,</span>  <span class="mf">1.10252</span> <span class="p">,</span>  <span class="mf">1.10458</span> <span class="p">,</span>
        <span class="mf">1.11075</span> <span class="p">,</span>  <span class="mf">1.1128</span>  <span class="p">,</span>  <span class="mf">1.11691</span> <span class="p">,</span>  <span class="mf">1.11897</span> <span class="p">,</span>  <span class="mf">1.12514</span> <span class="p">,</span>  <span class="mf">1.12925</span> <span class="p">,</span>
        <span class="mf">1.13336</span> <span class="p">,</span>  <span class="mf">1.13542</span> <span class="p">,</span>  <span class="mf">1.13748</span> <span class="p">,</span>  <span class="mf">1.14159</span> <span class="p">,</span>  <span class="mf">1.14776</span> <span class="p">,</span>  <span class="mf">1.15187</span> <span class="p">,</span>
        <span class="mf">1.15393</span> <span class="p">,</span>  <span class="mf">1.15804</span> <span class="p">,</span>  <span class="mf">1.1601</span>  <span class="p">,</span>  <span class="mf">1.16215</span> <span class="p">,</span>  <span class="mf">1.16421</span> <span class="p">,</span>  <span class="mf">1.16626</span> <span class="p">,</span>
        <span class="mf">1.17243</span> <span class="p">,</span>  <span class="mf">1.17449</span> <span class="p">,</span>  <span class="mf">1.17655</span> <span class="p">,</span>  <span class="mf">1.18066</span> <span class="p">,</span>  <span class="mf">1.18683</span> <span class="p">,</span>  <span class="mf">1.18888</span> <span class="p">,</span>
        <span class="mf">1.19094</span> <span class="p">,</span>  <span class="mf">1.193</span>   <span class="p">,</span>  <span class="mf">1.193</span>   <span class="p">,</span>  <span class="mf">1.19711</span> <span class="p">,</span>  <span class="mf">1.20122</span> <span class="p">,</span>  <span class="mf">1.20945</span> <span class="p">,</span>
        <span class="mf">1.21356</span> <span class="p">,</span>  <span class="mf">1.21562</span> <span class="p">,</span>  <span class="mf">1.21767</span> <span class="p">,</span>  <span class="mf">1.22178</span> <span class="p">,</span>  <span class="mf">1.22384</span> <span class="p">,</span>  <span class="mf">1.2259</span>  <span class="p">,</span>
        <span class="mf">1.23207</span> <span class="p">,</span>  <span class="mf">1.23412</span> <span class="p">,</span>  <span class="mf">1.23823</span> <span class="p">,</span>  <span class="mf">1.2444</span>  <span class="p">,</span>  <span class="mf">1.24646</span> <span class="p">,</span>  <span class="mf">1.25057</span> <span class="p">,</span>
        <span class="mf">1.25057</span> <span class="p">,</span>  <span class="mf">1.25263</span> <span class="p">,</span>  <span class="mf">1.25674</span> <span class="p">,</span>  <span class="mf">1.2588</span>  <span class="p">,</span>  <span class="mf">1.26497</span> <span class="p">,</span>  <span class="mf">1.26702</span> <span class="p">,</span>
        <span class="mf">1.27319</span> <span class="p">,</span>  <span class="mf">1.2773</span>  <span class="p">,</span>  <span class="mf">1.27936</span> <span class="p">,</span>  <span class="mf">1.28142</span> <span class="p">,</span>  <span class="mf">1.28964</span> <span class="p">,</span>  <span class="mf">1.2917</span>  <span class="p">,</span>
        <span class="mf">1.29375</span> <span class="p">,</span>  <span class="mf">1.29581</span> <span class="p">,</span>  <span class="mf">1.30198</span> <span class="p">,</span>  <span class="mf">1.30404</span> <span class="p">,</span>  <span class="mf">1.3102</span>  <span class="p">,</span>  <span class="mf">1.31432</span> <span class="p">,</span>
        <span class="mf">1.31843</span> <span class="p">,</span>  <span class="mf">1.32871</span> <span class="p">,</span>  <span class="mf">1.33488</span> <span class="p">,</span>  <span class="mf">1.33899</span> <span class="p">,</span>  <span class="mf">1.34927</span> <span class="p">,</span>  <span class="mf">1.35339</span> <span class="p">,</span>
        <span class="mf">1.36367</span> <span class="p">,</span>  <span class="mf">1.36984</span> <span class="p">,</span>  <span class="mf">1.37806</span> <span class="p">,</span>  <span class="mf">1.38629</span> <span class="p">,</span>  <span class="mf">1.39451</span> <span class="p">,</span>  <span class="mf">1.40274</span> <span class="p">,</span>
        <span class="mf">1.41096</span> <span class="p">,</span>  <span class="mf">1.41919</span> <span class="p">,</span>  <span class="mf">1.43152</span> <span class="p">,</span>  <span class="mf">1.43769</span> <span class="p">,</span>  <span class="mf">1.44592</span> <span class="p">,</span>  <span class="mf">1.44798</span> <span class="p">,</span>
        <span class="mf">1.45209</span> <span class="p">,</span>  <span class="mf">1.4562</span>  <span class="p">,</span>  <span class="mf">1.46031</span> <span class="p">,</span>  <span class="mf">1.46237</span> <span class="p">,</span>  <span class="mf">1.46854</span> <span class="p">,</span>  <span class="mf">1.47676</span> <span class="p">,</span>
        <span class="mf">1.48499</span> <span class="p">,</span>  <span class="mf">1.4891</span>  <span class="p">,</span>  <span class="mf">1.50349</span> <span class="p">,</span>  <span class="mf">1.51583</span> <span class="p">,</span>  <span class="mf">1.51994</span> <span class="p">,</span>  <span class="mf">1.522</span>   <span class="p">,</span>
        <span class="mf">1.52611</span> <span class="p">,</span>  <span class="mf">1.52817</span> <span class="p">,</span>  <span class="mf">1.53228</span> <span class="p">,</span>  <span class="mf">1.5364</span>  <span class="p">,</span>  <span class="mf">1.53845</span> <span class="p">,</span>  <span class="mf">1.54256</span> <span class="p">,</span>
        <span class="mf">1.54462</span> <span class="p">,</span>  <span class="mf">1.54668</span> <span class="p">,</span>  <span class="mf">1.5549</span>  <span class="p">,</span>  <span class="mf">1.55901</span> <span class="p">,</span>  <span class="mf">1.56724</span> <span class="p">,</span>  <span class="mf">1.57341</span> <span class="p">,</span>
        <span class="mf">1.57546</span> <span class="p">,</span>  <span class="mf">1.57752</span> <span class="p">,</span>  <span class="mf">1.57958</span> <span class="p">,</span>  <span class="mf">1.58163</span> <span class="p">,</span>  <span class="mf">1.58369</span> <span class="p">,</span>  <span class="mf">1.58575</span> <span class="p">,</span>
        <span class="mf">1.59191</span> <span class="p">,</span>  <span class="mf">1.59808</span> <span class="p">,</span>  <span class="mf">1.60014</span> <span class="p">,</span>  <span class="mf">1.60631</span> <span class="p">,</span>  <span class="mf">1.60836</span> <span class="p">,</span>  <span class="mf">1.61042</span> <span class="p">,</span>
        <span class="mf">1.61453</span> <span class="p">,</span>  <span class="mf">1.6207</span>  <span class="p">,</span>  <span class="mf">1.62893</span> <span class="p">,</span>  <span class="mf">1.63715</span> <span class="p">,</span>  <span class="mf">1.63921</span> <span class="p">,</span>  <span class="mf">1.64127</span> <span class="p">,</span>
        <span class="mf">1.64332</span> <span class="p">,</span>  <span class="mf">1.64743</span> <span class="p">,</span>  <span class="mf">1.65155</span> <span class="p">,</span>  <span class="mf">1.6536</span>  <span class="p">,</span>  <span class="mf">1.65566</span> <span class="p">,</span>  <span class="mf">1.65977</span> <span class="p">,</span>
        <span class="mf">1.66388</span> <span class="p">,</span>  <span class="mf">1.668</span>   <span class="p">,</span>  <span class="mf">1.67005</span> <span class="p">,</span>  <span class="mf">1.67211</span> <span class="p">,</span>  <span class="mf">1.67828</span> <span class="p">,</span>  <span class="mf">1.6865</span>  <span class="p">,</span>
        <span class="mf">1.68856</span> <span class="p">,</span>  <span class="mf">1.69062</span> <span class="p">,</span>  <span class="mf">1.69473</span> <span class="p">,</span>  <span class="mf">1.69884</span> <span class="p">,</span>  <span class="mf">1.7009</span>  <span class="p">,</span>  <span class="mf">1.70501</span> <span class="p">,</span>
        <span class="mf">1.71118</span> <span class="p">,</span>  <span class="mf">1.71324</span> <span class="p">,</span>  <span class="mf">1.71529</span> <span class="p">,</span>  <span class="mf">1.71735</span> <span class="p">,</span>  <span class="mf">1.72352</span> <span class="p">,</span>  <span class="mf">1.72557</span> <span class="p">,</span>
        <span class="mf">1.72969</span> <span class="p">,</span>  <span class="mf">1.73585</span> <span class="p">,</span>  <span class="mf">1.74202</span> <span class="p">,</span>  <span class="mf">1.74614</span> <span class="p">,</span>  <span class="mf">1.7523</span>  <span class="p">,</span>  <span class="mf">1.75642</span> <span class="p">,</span>
        <span class="mf">1.76053</span> <span class="p">,</span>  <span class="mf">1.76259</span> <span class="p">,</span>  <span class="mf">1.7667</span>  <span class="p">,</span>  <span class="mf">1.77492</span> <span class="p">,</span>  <span class="mf">1.78315</span> <span class="p">,</span>  <span class="mf">1.79343</span> <span class="p">,</span>
        <span class="mf">1.7996</span>  <span class="p">,</span>  <span class="mf">1.81194</span> <span class="p">,</span>  <span class="mf">1.82016</span> <span class="p">,</span>  <span class="mf">1.8325</span>  <span class="p">,</span>  <span class="mf">1.84484</span> <span class="p">,</span>  <span class="mf">1.85306</span> <span class="p">,</span>
        <span class="mf">1.8654</span>  <span class="p">,</span>  <span class="mf">1.87568</span> <span class="p">,</span>  <span class="mf">1.88185</span> <span class="p">,</span>  <span class="mf">1.88802</span> <span class="p">,</span>  <span class="mf">1.89624</span> <span class="p">,</span>  <span class="mf">1.90036</span> <span class="p">,</span>
        <span class="mf">1.91064</span> <span class="p">,</span>  <span class="mf">1.92092</span> <span class="p">,</span>  <span class="mf">1.92503</span> <span class="p">,</span>  <span class="mf">1.93326</span> <span class="p">,</span>  <span class="mf">1.94148</span> <span class="p">,</span>  <span class="mf">1.94354</span> <span class="p">,</span>
        <span class="mf">1.94765</span> <span class="p">,</span>  <span class="mf">1.95176</span> <span class="p">,</span>  <span class="mf">1.95588</span> <span class="p">,</span>  <span class="mf">1.95793</span> <span class="p">,</span>  <span class="mf">1.96205</span> <span class="p">,</span>  <span class="mf">1.9641</span>  <span class="p">,</span>
        <span class="mf">1.96616</span> <span class="p">,</span>  <span class="mf">1.97027</span> <span class="p">,</span>  <span class="mf">1.9785</span>  <span class="p">,</span>  <span class="mf">1.98055</span> <span class="p">,</span>  <span class="mf">1.98261</span> <span class="p">,</span>  <span class="mf">1.98878</span> <span class="p">,</span>
        <span class="mf">1.99495</span> <span class="p">,</span>  <span class="mf">1.99906</span> <span class="p">,</span>  <span class="mf">2.00317</span> <span class="p">,</span>  <span class="mf">2.00523</span> <span class="p">,</span>  <span class="mf">2.00728</span> <span class="p">,</span>  <span class="mf">2.00934</span> <span class="p">,</span>
        <span class="mf">2.01345</span> <span class="p">,</span>  <span class="mf">2.02168</span> <span class="p">,</span>  <span class="mf">2.02373</span> <span class="p">,</span>  <span class="mf">2.0299</span>  <span class="p">,</span>  <span class="mf">2.03196</span> <span class="p">,</span>  <span class="mf">2.03401</span> <span class="p">,</span>
        <span class="mf">2.03607</span> <span class="p">,</span>  <span class="mf">2.04224</span> <span class="p">,</span>  <span class="mf">2.04635</span> <span class="p">,</span>  <span class="mf">2.05252</span> <span class="p">,</span>  <span class="mf">2.05663</span> <span class="p">,</span>  <span class="mf">2.0628</span>  <span class="p">,</span>
        <span class="mf">2.06692</span> <span class="p">,</span>  <span class="mf">2.07103</span> <span class="p">,</span>  <span class="mf">2.07308</span> <span class="p">,</span>  <span class="mf">2.07514</span> <span class="p">,</span>  <span class="mf">2.0772</span>  <span class="p">,</span>  <span class="mf">2.07925</span> <span class="p">,</span>
        <span class="mf">2.08337</span> <span class="p">,</span>  <span class="mf">2.08953</span> <span class="p">,</span>  <span class="mf">2.09159</span> <span class="p">,</span>  <span class="mf">2.09365</span> <span class="p">,</span>  <span class="mf">2.09776</span> <span class="p">,</span>  <span class="mf">2.10187</span> <span class="p">,</span>
        <span class="mf">2.10598</span> <span class="p">,</span>  <span class="mf">2.11215</span> <span class="p">,</span>  <span class="mf">2.11832</span> <span class="p">,</span>  <span class="mf">2.12038</span> <span class="p">,</span>  <span class="mf">2.12243</span> <span class="p">,</span>  <span class="mf">2.12243</span> <span class="p">,</span>
        <span class="mf">2.1286</span>  <span class="p">,</span>  <span class="mf">2.13477</span> <span class="p">,</span>  <span class="mf">2.13683</span> <span class="p">,</span>  <span class="mf">2.13889</span> <span class="p">,</span>  <span class="mf">2.143</span>   <span class="p">,</span>  <span class="mf">2.14711</span> <span class="p">,</span>
        <span class="mf">2.14917</span> <span class="p">,</span>  <span class="mf">2.15122</span> <span class="p">,</span>  <span class="mf">2.15328</span> <span class="p">,</span>  <span class="mf">2.15534</span> <span class="p">,</span>  <span class="mf">2.1615</span>  <span class="p">,</span>  <span class="mf">2.16562</span> <span class="p">,</span>
        <span class="mf">2.16973</span> <span class="p">,</span>  <span class="mf">2.18207</span> <span class="p">,</span>  <span class="mf">2.18412</span> <span class="p">,</span>  <span class="mf">2.19235</span> <span class="p">,</span>  <span class="mf">2.19852</span> <span class="p">,</span>  <span class="mf">2.20263</span> <span class="p">,</span>
        <span class="mf">2.21085</span> <span class="p">,</span>  <span class="mf">2.21908</span> <span class="p">,</span>  <span class="mf">2.22731</span> <span class="p">,</span>  <span class="mf">2.23347</span> <span class="p">,</span>  <span class="mf">2.23759</span> <span class="p">,</span>  <span class="mf">2.24581</span> <span class="p">,</span>
        <span class="mf">2.25198</span> <span class="p">,</span>  <span class="mf">2.26226</span> <span class="p">,</span>  <span class="mf">2.27049</span> <span class="p">,</span>  <span class="mf">2.28077</span> <span class="p">,</span>  <span class="mf">2.28694</span> <span class="p">,</span>  <span class="mf">2.29722</span> <span class="p">,</span>
        <span class="mf">2.30133</span> <span class="p">,</span>  <span class="mf">2.30544</span> <span class="p">,</span>  <span class="mf">2.31367</span> <span class="p">,</span>  <span class="mf">2.31984</span> <span class="p">,</span>  <span class="mf">2.32806</span> <span class="p">,</span>  <span class="mf">2.33834</span> <span class="p">,</span>
        <span class="mf">2.34451</span> <span class="p">,</span>  <span class="mf">2.35479</span> <span class="p">,</span>  <span class="mf">2.36302</span> <span class="p">,</span>  <span class="mf">2.36713</span> <span class="p">,</span>  <span class="mf">2.37124</span> <span class="p">,</span>  <span class="mf">2.37536</span> <span class="p">,</span>
        <span class="mf">2.37947</span> <span class="p">,</span>  <span class="mf">2.38153</span> <span class="p">,</span>  <span class="mf">2.38564</span> <span class="p">,</span>  <span class="mf">2.38975</span> <span class="p">,</span>  <span class="mf">2.39181</span> <span class="p">,</span>  <span class="mf">2.40003</span> <span class="p">,</span>
        <span class="mf">2.40415</span> <span class="p">,</span>  <span class="mf">2.4062</span>  <span class="p">,</span>  <span class="mf">2.41237</span> <span class="p">,</span>  <span class="mf">2.4206</span>  <span class="p">,</span>  <span class="mf">2.42265</span> <span class="p">,</span>  <span class="mf">2.42676</span> <span class="p">,</span>
        <span class="mf">2.43088</span> <span class="p">,</span>  <span class="mf">2.43293</span> <span class="p">,</span>  <span class="mf">2.4391</span>  <span class="p">,</span>  <span class="mf">2.44733</span> <span class="p">,</span>  <span class="mf">2.45144</span> <span class="p">,</span>  <span class="mf">2.45555</span> <span class="p">,</span>
        <span class="mf">2.45966</span> <span class="p">,</span>  <span class="mf">2.46172</span> <span class="p">,</span>  <span class="mf">2.46378</span> <span class="p">,</span>  <span class="mf">2.46583</span> <span class="p">,</span>  <span class="mf">2.472</span>   <span class="p">,</span>  <span class="mf">2.47817</span> <span class="p">,</span>
        <span class="mf">2.48023</span> <span class="p">,</span>  <span class="mf">2.4864</span>  <span class="p">,</span>  <span class="mf">2.49051</span> <span class="p">,</span>  <span class="mf">2.49668</span> <span class="p">,</span>  <span class="mf">2.49873</span> <span class="p">,</span>  <span class="mf">2.50079</span> <span class="p">,</span>
        <span class="mf">2.50696</span> <span class="p">,</span>  <span class="mf">2.51313</span> <span class="p">,</span>  <span class="mf">2.51724</span> <span class="p">,</span>  <span class="mf">2.51724</span> <span class="p">,</span>  <span class="mf">2.52135</span> <span class="p">,</span>  <span class="mf">2.53369</span> <span class="p">,</span>
        <span class="mf">2.5378</span>  <span class="p">,</span>  <span class="mf">2.53986</span> <span class="p">,</span>  <span class="mf">2.54192</span> <span class="p">,</span>  <span class="mf">2.54397</span> <span class="p">,</span>  <span class="mf">2.54808</span> <span class="p">,</span>  <span class="mf">2.55631</span> <span class="p">,</span>
        <span class="mf">2.55837</span> <span class="p">,</span>  <span class="mf">2.56248</span> <span class="p">,</span>  <span class="mf">2.56453</span> <span class="p">,</span>  <span class="mf">2.56865</span> <span class="p">,</span>  <span class="mf">2.57276</span> <span class="p">,</span>  <span class="mf">2.57482</span> <span class="p">,</span>
        <span class="mf">2.57893</span> <span class="p">,</span>  <span class="mf">2.5851</span>  <span class="p">,</span>  <span class="mf">2.59127</span> <span class="p">,</span>  <span class="mf">2.59538</span> <span class="p">,</span>  <span class="mf">2.60772</span> <span class="p">,</span>  <span class="mf">2.61594</span> <span class="p">,</span>
        <span class="mf">2.62828</span> <span class="p">,</span>  <span class="mf">2.63445</span> <span class="p">,</span>  <span class="mf">2.64062</span> <span class="p">,</span>  <span class="mf">2.6509</span>  <span class="p">,</span>  <span class="mf">2.65707</span> <span class="p">,</span>  <span class="mf">2.66735</span> <span class="p">,</span>
        <span class="mf">2.67969</span> <span class="p">,</span>  <span class="mf">2.6838</span>  <span class="p">,</span>  <span class="mf">2.68997</span> <span class="p">,</span>  <span class="mf">2.70025</span> <span class="p">,</span>  <span class="mf">2.70847</span> <span class="p">,</span>  <span class="mf">2.71876</span> <span class="p">,</span>
        <span class="mf">2.72904</span> <span class="p">,</span>  <span class="mf">2.74754</span> <span class="p">,</span>  <span class="mf">2.75577</span> <span class="p">,</span>  <span class="mf">2.76194</span> <span class="p">,</span>  <span class="mf">2.77428</span> <span class="p">,</span>  <span class="mf">2.78456</span> <span class="p">,</span>
        <span class="mf">2.78867</span> <span class="p">,</span>  <span class="mf">2.79278</span> <span class="p">,</span>  <span class="mf">2.79484</span> <span class="p">,</span>  <span class="mf">2.79895</span> <span class="p">,</span>  <span class="mf">2.80306</span> <span class="p">,</span>  <span class="mf">2.80512</span> <span class="p">,</span>
        <span class="mf">2.80718</span> <span class="p">,</span>  <span class="mf">2.81129</span> <span class="p">,</span>  <span class="mf">2.81334</span> <span class="p">,</span>  <span class="mf">2.82157</span> <span class="p">,</span>  <span class="mf">2.82568</span> <span class="p">,</span>  <span class="mf">2.82774</span> <span class="p">,</span>
        <span class="mf">2.8298</span>  <span class="p">,</span>  <span class="mf">2.83596</span> <span class="p">,</span>  <span class="mf">2.84213</span> <span class="p">,</span>  <span class="mf">2.84625</span> <span class="p">,</span>  <span class="mf">2.8483</span>  <span class="p">,</span>  <span class="mf">2.85036</span> <span class="p">,</span>
        <span class="mf">2.85241</span> <span class="p">,</span>  <span class="mf">2.85653</span> <span class="p">,</span>  <span class="mf">2.85858</span> <span class="p">,</span>  <span class="mf">2.86475</span> <span class="p">,</span>  <span class="mf">2.87092</span> <span class="p">,</span>  <span class="mf">2.87298</span> <span class="p">,</span>
        <span class="mf">2.87709</span> <span class="p">,</span>  <span class="mf">2.8812</span>  <span class="p">,</span>  <span class="mf">2.88531</span> <span class="p">,</span>  <span class="mf">2.88737</span> <span class="p">,</span>  <span class="mf">2.89354</span> <span class="p">,</span>  <span class="mf">2.89971</span> <span class="p">,</span>
        <span class="mf">2.90382</span> <span class="p">,</span>  <span class="mf">2.90588</span> <span class="p">,</span>  <span class="mf">2.90999</span> <span class="p">,</span>  <span class="mf">2.9141</span>  <span class="p">,</span>  <span class="mf">2.91616</span> <span class="p">,</span>  <span class="mf">2.91822</span> <span class="p">,</span>
        <span class="mf">2.92027</span> <span class="p">,</span>  <span class="mf">2.92233</span> <span class="p">,</span>  <span class="mf">2.9285</span>  <span class="p">,</span>  <span class="mf">2.93261</span> <span class="p">,</span>  <span class="mf">2.93878</span> <span class="p">,</span>  <span class="mf">2.94083</span> <span class="p">,</span>
        <span class="mf">2.94495</span> <span class="p">,</span>  <span class="mf">2.94906</span> <span class="p">,</span>  <span class="mf">2.95112</span> <span class="p">,</span>  <span class="mf">2.95523</span> <span class="p">,</span>  <span class="mf">2.95728</span> <span class="p">,</span>  <span class="mf">2.9614</span>  <span class="p">,</span>
        <span class="mf">2.96345</span> <span class="p">,</span>  <span class="mf">2.96551</span> <span class="p">,</span>  <span class="mf">2.96757</span> <span class="p">,</span>  <span class="mf">2.96962</span> <span class="p">,</span>  <span class="mf">2.97373</span> <span class="p">,</span>  <span class="mf">2.9799</span>  <span class="p">,</span>
        <span class="mf">2.98196</span> <span class="p">,</span>  <span class="mf">2.98402</span> <span class="p">,</span>  <span class="mf">2.98813</span> <span class="p">,</span>  <span class="mf">2.99018</span> <span class="p">,</span>  <span class="mf">2.9943</span>  <span class="p">,</span>  <span class="mf">2.99635</span> <span class="p">,</span>
        <span class="mf">2.99841</span> <span class="p">,</span>  <span class="mf">3.00458</span> <span class="p">,</span>  <span class="mf">3.0128</span>  <span class="p">,</span>  <span class="mf">3.01486</span> <span class="p">,</span>  <span class="mf">3.0272</span>  <span class="p">,</span>  <span class="mf">3.03954</span> <span class="p">,</span>
        <span class="mf">3.05187</span> <span class="p">,</span>  <span class="mf">3.05599</span> <span class="p">,</span>  <span class="mf">3.07449</span> <span class="p">,</span>  <span class="mf">3.08066</span> <span class="p">,</span>  <span class="mf">3.08683</span> <span class="p">,</span>  <span class="mf">3.10122</span> <span class="p">,</span>
        <span class="mf">3.10739</span> <span class="p">,</span>  <span class="mf">3.11562</span> <span class="p">,</span>  <span class="mf">3.11973</span> <span class="p">,</span>  <span class="mf">3.1259</span>  <span class="p">,</span>  <span class="mf">3.13001</span> <span class="p">,</span>  <span class="mf">3.14441</span> <span class="p">,</span>
        <span class="mf">3.15469</span> <span class="p">,</span>  <span class="mf">3.16086</span> <span class="p">,</span>  <span class="mf">3.16291</span> <span class="p">,</span>  <span class="mf">3.17319</span> <span class="p">,</span>  <span class="mf">3.17731</span> <span class="p">,</span>  <span class="mf">3.18759</span> <span class="p">,</span>
        <span class="mf">3.19581</span> <span class="p">,</span>  <span class="mf">3.20404</span> <span class="p">,</span>  <span class="mf">3.21226</span> <span class="p">,</span>  <span class="mf">3.21432</span> <span class="p">,</span>  <span class="mf">3.21843</span> <span class="p">,</span>  <span class="mf">3.22049</span> <span class="p">,</span>
        <span class="mf">3.22254</span> <span class="p">,</span>  <span class="mf">3.22666</span> <span class="p">,</span>  <span class="mf">3.23077</span> <span class="p">,</span>  <span class="mf">3.23283</span> <span class="p">,</span>  <span class="mf">3.23488</span> <span class="p">,</span>  <span class="mf">3.23694</span> <span class="p">,</span>
        <span class="mf">3.24311</span> <span class="p">,</span>  <span class="mf">3.24928</span> <span class="p">,</span>  <span class="mf">3.24928</span> <span class="p">,</span>  <span class="mf">3.25133</span> <span class="p">,</span>  <span class="mf">3.25339</span> <span class="p">,</span>  <span class="mf">3.2575</span>  <span class="p">,</span>
        <span class="mf">3.26573</span> <span class="p">,</span>  <span class="mf">3.27395</span> <span class="p">,</span>  <span class="mf">3.27806</span> <span class="p">,</span>  <span class="mf">3.28218</span> <span class="p">,</span>  <span class="mf">3.28423</span> <span class="p">,</span>  <span class="mf">3.28629</span> <span class="p">,</span>
        <span class="mf">3.28835</span> <span class="p">,</span>  <span class="mf">3.29451</span> <span class="p">,</span>  <span class="mf">3.29657</span> <span class="p">,</span>  <span class="mf">3.30274</span> <span class="p">,</span>  <span class="mf">3.30685</span> <span class="p">,</span>  <span class="mf">3.30891</span> <span class="p">,</span>
        <span class="mf">3.31096</span> <span class="p">,</span>  <span class="mf">3.31508</span> <span class="p">,</span>  <span class="mf">3.3233</span>  <span class="p">,</span>  <span class="mf">3.33564</span> <span class="p">,</span>  <span class="mf">3.34798</span> <span class="p">,</span>  <span class="mf">3.3562</span>  <span class="p">,</span>
        <span class="mf">3.36854</span> <span class="p">,</span>  <span class="mf">3.37882</span> <span class="p">,</span>  <span class="mf">3.39322</span> <span class="p">,</span>  <span class="mf">3.4035</span>  <span class="p">,</span>  <span class="mf">3.41378</span> <span class="p">,</span>  <span class="mf">3.42406</span> <span class="p">,</span>
        <span class="mf">3.43228</span> <span class="p">,</span>  <span class="mf">3.4364</span>  <span class="p">,</span>  <span class="mf">3.44051</span> <span class="p">,</span>  <span class="mf">3.44257</span> <span class="p">,</span>  <span class="mf">3.44874</span> <span class="p">,</span>  <span class="mf">3.46313</span> <span class="p">,</span>
        <span class="mf">3.47135</span> <span class="p">,</span>  <span class="mf">3.48369</span> <span class="p">,</span>  <span class="mf">3.48575</span> <span class="p">,</span>  <span class="mf">3.49397</span> <span class="p">,</span>  <span class="mf">3.49809</span> <span class="p">,</span>  <span class="mf">3.50837</span> <span class="p">,</span>
        <span class="mf">3.51248</span> <span class="p">,</span>  <span class="mf">3.5207</span>  <span class="p">,</span>  <span class="mf">3.53099</span> <span class="p">,</span>  <span class="mf">3.53921</span> <span class="p">,</span>  <span class="mf">3.55361</span> <span class="p">,</span>  <span class="mf">3.568</span>   <span class="p">,</span>
        <span class="mf">3.57417</span> <span class="p">,</span>  <span class="mf">3.58239</span> <span class="p">,</span>  <span class="mf">3.58856</span> <span class="p">,</span>  <span class="mf">3.59473</span> <span class="p">,</span>  <span class="mf">3.60296</span> <span class="p">,</span>  <span class="mf">3.61118</span> <span class="p">,</span>
        <span class="mf">3.62146</span> <span class="p">,</span>  <span class="mf">3.62969</span> <span class="p">,</span>  <span class="mf">3.64408</span> <span class="p">,</span>  <span class="mf">3.65025</span> <span class="p">,</span>  <span class="mf">3.65642</span> <span class="p">,</span>  <span class="mf">3.66053</span> <span class="p">,</span>
        <span class="mf">3.68109</span> <span class="p">,</span>  <span class="mf">3.69138</span> <span class="p">,</span>  <span class="mf">3.69755</span> <span class="p">,</span>  <span class="mf">3.70166</span> <span class="p">,</span>  <span class="mf">3.70988</span> <span class="p">,</span>  <span class="mf">3.72428</span> <span class="p">,</span>
        <span class="mf">3.73456</span> <span class="p">,</span>  <span class="mf">3.75101</span> <span class="p">,</span>  <span class="mf">3.76335</span> <span class="p">,</span>  <span class="mf">3.79213</span> <span class="p">,</span>  <span class="mf">3.81064</span> <span class="p">,</span>  <span class="mf">3.82298</span> <span class="p">,</span>
        <span class="mf">3.83532</span> <span class="p">,</span>  <span class="mf">3.84148</span> <span class="p">,</span>  <span class="mf">3.85177</span> <span class="p">,</span>  <span class="mf">3.85588</span> <span class="p">,</span>  <span class="mf">3.85999</span> <span class="p">,</span>  <span class="mf">3.87233</span> <span class="p">,</span>
        <span class="mf">3.87644</span> <span class="p">,</span>  <span class="mf">3.88467</span> <span class="p">,</span>  <span class="mf">3.89084</span> <span class="p">,</span>  <span class="mf">3.897</span>   <span class="p">,</span>  <span class="mf">3.90317</span> <span class="p">,</span>  <span class="mf">3.9114</span>  <span class="p">,</span>
        <span class="mf">3.92168</span> <span class="p">,</span>  <span class="mf">3.93402</span> <span class="p">,</span>  <span class="mf">3.94224</span> <span class="p">,</span>  <span class="mf">3.95458</span> <span class="p">,</span>  <span class="mf">3.96075</span> <span class="p">,</span>  <span class="mf">3.96692</span> <span class="p">,</span>
        <span class="mf">3.97103</span> <span class="p">,</span>  <span class="mf">3.97926</span> <span class="p">,</span>  <span class="mf">3.98748</span> <span class="p">,</span>  <span class="mf">3.99571</span> <span class="p">,</span>  <span class="mf">4.00393</span> <span class="p">,</span>  <span class="mf">4.02038</span> <span class="p">,</span>
        <span class="mf">4.03066</span> <span class="p">,</span>  <span class="mf">4.04094</span> <span class="p">])</span>
    <span class="n">fig14bot_w_raw</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
      <span class="p">[</span>  <span class="mf">3.65926000e-02</span><span class="p">,</span>   <span class="mf">6.91201000e-02</span><span class="p">,</span>   <span class="mf">2.84794000e-02</span><span class="p">,</span>
         <span class="mf">1.22288000e-02</span><span class="p">,</span>   <span class="mf">2.85034000e-02</span><span class="p">,</span>   <span class="mf">1.22529000e-02</span><span class="p">,</span>
         <span class="mf">3.25878000e-02</span><span class="p">,</span>  <span class="o">-</span><span class="mf">3.98557000e-03</span><span class="p">,</span>   <span class="mf">4.07395000e-02</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.20988000e-02</span><span class="p">,</span>   <span class="mf">2.04312000e-02</span><span class="p">,</span>  <span class="o">-</span><span class="mf">3.94945000e-03</span><span class="p">,</span>
         <span class="mf">1.63830000e-02</span><span class="p">,</span>   <span class="mf">8.26012000e-03</span><span class="p">,</span>   <span class="mf">3.67226000e-02</span><span class="p">,</span>
         <span class="mf">4.89202000e-02</span><span class="p">,</span>   <span class="mf">3.26648000e-02</span><span class="p">,</span>  <span class="o">-</span><span class="mf">3.91573000e-03</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">3.90851000e-03</span><span class="p">,</span>   <span class="mf">4.48768000e-02</span><span class="p">,</span>   <span class="mf">2.45564000e-02</span><span class="p">,</span>
         <span class="mf">3.26937000e-02</span><span class="p">,</span>   <span class="mf">2.05082000e-02</span><span class="p">,</span>   <span class="mf">3.27154000e-02</span><span class="p">,</span>
         <span class="mf">1.24022000e-02</span><span class="p">,</span>   <span class="mf">3.68045000e-02</span><span class="p">,</span>  <span class="o">-</span><span class="mf">1.60362000e-02</span><span class="p">,</span>
         <span class="mf">6.93393000e-02</span><span class="p">,</span>   <span class="mf">9.77970000e-02</span><span class="p">,</span>   <span class="mf">3.27611000e-02</span><span class="p">,</span>
         <span class="mf">1.24456000e-02</span><span class="p">,</span>  <span class="o">-</span><span class="mf">4.44626000e-02</span><span class="p">,</span>  <span class="o">-</span><span class="mf">1.29821000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.78599000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">2.07050000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">2.68021000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">4.55008000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">4.91588000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">4.99711000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">4.79379000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">4.10270000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">2.72054000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">2.88305000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">3.65533000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">4.18376000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">4.95607000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">5.52516000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">5.76901000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">5.97221000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">5.60631000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">4.22415000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">3.41112000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">2.55741000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">1.74436000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.41913000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">8.09300000e-02</span><span class="p">,</span>  <span class="o">-</span><span class="mf">1.18219000e-02</span><span class="p">,</span>
         <span class="mf">4.50935000e-02</span><span class="p">,</span>  <span class="o">-</span><span class="mf">3.21302000e-02</span><span class="p">,</span>   <span class="mf">6.95030000e-02</span><span class="p">,</span>
         <span class="mf">8.53707000e-03</span><span class="p">,</span>   <span class="mf">3.70020000e-02</span><span class="p">,</span>   <span class="mf">1.26238000e-02</span><span class="p">,</span>
         <span class="mf">4.10887000e-02</span><span class="p">,</span>   <span class="mf">2.48406000e-02</span><span class="p">,</span>   <span class="mf">4.92477000e-02</span><span class="p">,</span>
         <span class="mf">1.26695000e-02</span><span class="p">,</span>   <span class="mf">4.51995000e-02</span><span class="p">,</span>   <span class="mf">2.08189000e-02</span><span class="p">,</span>
         <span class="mf">2.89610000e-02</span><span class="p">,</span>   <span class="mf">1.67731000e-02</span><span class="p">,</span>  <span class="o">-</span><span class="mf">1.98050000e-02</span><span class="p">,</span>
         <span class="mf">2.89851000e-02</span><span class="p">,</span>   <span class="mf">5.51478000e-04</span><span class="p">,</span>   <span class="mf">4.12115000e-02</span><span class="p">,</span>
         <span class="mf">1.27779000e-02</span><span class="p">,</span>   <span class="mf">7.78258000e-02</span><span class="p">,</span>   <span class="mf">9.81534000e-02</span><span class="p">,</span>
         <span class="mf">4.93801000e-02</span><span class="p">,</span>   <span class="mf">8.19101000e-02</span><span class="p">,</span>   <span class="mf">4.67913000e-03</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">7.25542000e-02</span><span class="p">,</span>  <span class="o">-</span><span class="mf">1.41655000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">1.86368000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">2.39206000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">3.24570000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">3.97736000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">4.87164000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">5.44068000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">5.03412000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">4.50562000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">3.77389000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">3.20476000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">2.59496000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">2.14773000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">2.26963000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">2.71676000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">3.40777000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">4.13945000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">4.87114000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">5.27762000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">5.88735000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">5.72468000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">5.19620000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">4.22056000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">3.32621000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">2.71638000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">2.06595000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.37487000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">8.87036000e-02</span><span class="p">,</span>  <span class="o">-</span><span class="mf">8.87036000e-02</span><span class="p">,</span>
         <span class="mf">8.86217000e-03</span><span class="p">,</span>   <span class="mf">3.32572000e-02</span><span class="p">,</span>   <span class="mf">2.10717000e-02</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.95738000e-02</span><span class="p">,</span>  <span class="o">-</span><span class="mf">6.02218000e-02</span><span class="p">,</span>  <span class="o">-</span><span class="mf">1.49650000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">2.02491000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">2.79724000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">3.56958000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">4.66707000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">5.23615000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">5.72390000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">5.35798000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">4.95145000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">3.97579000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">3.97579000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">3.04081000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">2.43101000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">2.10578000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">2.91871000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">3.28454000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">4.01618000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">5.43889000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">6.73968000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">7.18681000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">6.73956000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">5.07287000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">4.21919000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">3.32486000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">2.34917000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">7.63785000e-02</span><span class="p">,</span>  <span class="o">-</span><span class="mf">2.35257000e-02</span><span class="p">,</span>   <span class="mf">8.69360000e-04</span><span class="p">,</span>
         <span class="mf">2.11994000e-02</span><span class="p">,</span>   <span class="mf">2.93415000e-02</span><span class="p">,</span>   <span class="mf">6.59341000e-02</span><span class="p">,</span>
         <span class="mf">5.78088000e-02</span><span class="p">,</span>   <span class="mf">7.00160000e-02</span><span class="p">,</span>   <span class="mf">4.56306000e-02</span><span class="p">,</span>
         <span class="mf">5.37727000e-02</span><span class="p">,</span>   <span class="mf">2.53246000e-02</span><span class="p">,</span>   <span class="mf">3.75294000e-02</span><span class="p">,</span>
         <span class="mf">5.01869000e-03</span><span class="p">,</span>   <span class="mf">6.19389000e-02</span><span class="p">,</span>   <span class="mf">3.75583000e-02</span><span class="p">,</span>
         <span class="mf">6.60232000e-02</span><span class="p">,</span>   <span class="mf">3.35125000e-02</span><span class="p">,</span>   <span class="mf">4.16570000e-02</span><span class="p">,</span>
         <span class="mf">2.13391000e-02</span><span class="p">,</span>   <span class="mf">3.35438000e-02</span><span class="p">,</span>   <span class="mf">5.79365000e-02</span><span class="p">,</span>
         <span class="mf">2.54210000e-02</span><span class="p">,</span>   <span class="mf">1.03553000e-03</span><span class="p">,</span>   <span class="mf">3.76257000e-02</span><span class="p">,</span>
         <span class="mf">7.01484000e-02</span><span class="p">,</span>   <span class="mf">2.13752000e-02</span><span class="p">,</span>   <span class="mf">5.39051000e-02</span><span class="p">,</span>
         <span class="mf">4.17196000e-02</span><span class="p">,</span>   <span class="mf">6.20497000e-02</span><span class="p">,</span>   <span class="mf">8.64568000e-02</span><span class="p">,</span>
         <span class="mf">5.80159000e-02</span><span class="p">,</span>  <span class="o">-</span><span class="mf">2.32801000e-02</span><span class="p">,</span>  <span class="o">-</span><span class="mf">8.83183000e-02</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.37094000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">1.89937000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">2.42778000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">3.03749000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">3.48462000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">3.97237000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">4.66341000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">4.98859000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">4.54133000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">3.24047000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">2.71192000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">2.14274000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">2.58987000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">3.32156000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">3.84999000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">4.78492000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">5.11010000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">5.63853000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">5.96367000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">5.23189000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">4.37820000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">3.52447000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">2.79274000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">2.06101000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.20730000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">6.90190000e-03</span><span class="p">,</span>   <span class="mf">1.74980000e-02</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">8.41184000e-02</span><span class="p">,</span>  <span class="o">-</span><span class="mf">6.88023000e-03</span><span class="p">,</span>  <span class="o">-</span><span class="mf">1.57284000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">2.22323000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">2.71098000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">3.28004000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">3.76782000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">4.33690000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">5.02791000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">4.78396000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">4.45871000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">4.13348000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">3.72695000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">2.95452000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">2.30402000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">2.91375000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">3.40153000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">4.29579000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">4.90550000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">6.08434000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">6.49080000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">6.16552000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">5.67769000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">4.37685000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">3.84837000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">3.07594000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">1.93771000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.24660000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">2.70200000e-03</span><span class="p">,</span>  <span class="o">-</span><span class="mf">1.89549000e-02</span><span class="p">,</span>
         <span class="mf">5.01556000e-02</span><span class="p">,</span>   <span class="mf">8.67482000e-02</span><span class="p">,</span>   <span class="mf">3.79725000e-02</span><span class="p">,</span>
         <span class="mf">1.76521000e-02</span><span class="p">,</span>   <span class="mf">5.42399000e-02</span><span class="p">,</span>   <span class="mf">8.67650000e-02</span><span class="p">,</span>
         <span class="mf">4.20592000e-02</span><span class="p">,</span>   <span class="mf">5.42640000e-02</span><span class="p">,</span>   <span class="mf">9.56055000e-03</span><span class="p">,</span>
         <span class="mf">2.58279000e-02</span><span class="p">,</span>  <span class="o">-</span><span class="mf">1.88731000e-02</span><span class="p">,</span>   <span class="mf">9.59186000e-03</span><span class="p">,</span>
         <span class="mf">9.60631000e-03</span><span class="p">,</span>  <span class="o">-</span><span class="mf">2.28996000e-02</span><span class="p">,</span>   <span class="mf">3.80857000e-02</span><span class="p">,</span>
         <span class="mf">5.02952000e-02</span><span class="p">,</span>  <span class="o">-</span><span class="mf">1.06683000e-02</span><span class="p">,</span>   <span class="mf">8.28348000e-02</span><span class="p">,</span>
         <span class="mf">3.81266000e-02</span><span class="p">,</span>   <span class="mf">4.22013000e-02</span><span class="p">,</span>   <span class="mf">2.18809000e-02</span><span class="p">,</span>
         <span class="mf">7.06734000e-02</span><span class="p">,</span>   <span class="mf">6.25554000e-02</span><span class="p">,</span>   <span class="mf">9.50805000e-02</span><span class="p">,</span>
         <span class="mf">6.66349000e-02</span><span class="p">,</span>   <span class="mf">5.03843000e-02</span><span class="p">,</span>  <span class="o">-</span><span class="mf">6.74994000e-02</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.40665000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">1.85376000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">2.34152000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">2.95125000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">4.21136000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">4.73979000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">5.18692000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">5.63403000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">5.22743000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">4.29245000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">3.56072000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">3.03219000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">2.46301000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">3.15402000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">4.17023000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">4.61736000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">5.06449000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">5.67422000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">6.20263000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">5.83668000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">5.06430000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">3.43821000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">2.70648000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">1.60889000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">9.17813000e-02</span><span class="p">,</span>  <span class="o">-</span><span class="mf">5.92537000e-02</span><span class="p">,</span>  <span class="o">-</span><span class="mf">1.85985000e-02</span><span class="p">,</span>
         <span class="mf">6.67746000e-02</span><span class="p">,</span>   <span class="mf">1.73872000e-03</span><span class="p">,</span>  <span class="o">-</span><span class="mf">1.20205000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.73046000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">2.34017000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">3.07185000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">3.76288000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">4.41327000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">4.94170000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">5.26685000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">5.06353000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">4.65700000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">4.16917000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">3.35611000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">2.78696000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">2.21781000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">2.42099000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">3.59978000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">4.29081000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">5.14444000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">5.14444000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">6.36388000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">6.11991000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">5.42883000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">4.16864000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">3.55884000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">2.78643000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">2.21730000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">1.44492000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">5.91237000e-02</span><span class="p">,</span>
         <span class="mf">1.40494000e-02</span><span class="p">,</span>   <span class="mf">2.62518000e-02</span><span class="p">,</span>   <span class="mf">5.47119000e-02</span><span class="p">,</span>
         <span class="mf">8.72370000e-02</span><span class="p">,</span>   <span class="mf">5.87962000e-02</span><span class="p">,</span>   <span class="mf">7.50588000e-02</span><span class="p">,</span>
         <span class="mf">4.66131000e-02</span><span class="p">,</span>   <span class="mf">3.84903000e-02</span><span class="p">,</span>   <span class="mf">5.47552000e-02</span><span class="p">,</span>
         <span class="mf">3.03746000e-02</span><span class="p">,</span>   <span class="mf">5.07095000e-02</span><span class="p">,</span>   <span class="mf">2.63288000e-02</span><span class="p">,</span>
         <span class="mf">4.66613000e-02</span><span class="p">,</span>   <span class="mf">7.91864000e-02</span><span class="p">,</span>   <span class="mf">5.07408000e-02</span><span class="p">,</span>
         <span class="mf">9.13984000e-02</span><span class="p">,</span>   <span class="mf">3.85649000e-02</span><span class="p">,</span>   <span class="mf">1.03615000e-01</span><span class="p">,</span>
         <span class="mf">3.04565000e-02</span><span class="p">,</span>   <span class="mf">6.70491000e-02</span><span class="p">,</span>  <span class="o">-</span><span class="mf">6.10960000e-03</span><span class="p">,</span>
         <span class="mf">5.89359000e-02</span><span class="p">,</span>   <span class="mf">8.73960000e-02</span><span class="p">,</span>   <span class="mf">2.64300000e-02</span><span class="p">,</span>
         <span class="mf">6.30226000e-02</span><span class="p">,</span>   <span class="mf">4.27070000e-02</span><span class="p">,</span>   <span class="mf">6.71093000e-02</span><span class="p">,</span>
         <span class="mf">5.49214000e-02</span><span class="p">,</span>   <span class="mf">8.33887000e-02</span><span class="p">,</span>   <span class="mf">3.05528000e-02</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">5.48082000e-02</span><span class="p">,</span>  <span class="o">-</span><span class="mf">1.27974000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">2.21465000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">2.90566000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">3.63734000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">4.40965000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">5.22261000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">6.27950000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">5.34444000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">4.04358000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">3.55575000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">2.90528000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">3.06778000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">3.47426000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">4.00267000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">4.69368000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">5.91317000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">6.52285000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">5.34389000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">3.51457000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">2.74217000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.92911000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">1.40063000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">6.28251000e-02</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">5.91213000e-03</span><span class="p">,</span>   <span class="mf">2.25504000e-02</span><span class="p">,</span>  <span class="o">-</span><span class="mf">5.89768000e-03</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">5.87408000e-02</span><span class="p">,</span>  <span class="o">-</span><span class="mf">1.19709000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">2.01005000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">2.94494000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">4.48963000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">5.05871000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">5.46514000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">5.30247000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">4.77397000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">4.77397000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">2.98530000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">3.31036000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">4.40787000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">5.05825000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">5.50538000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">6.31837000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">6.92808000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">6.39953000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">5.58649000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">4.65149000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">3.71650000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">3.02540000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">2.04974000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">1.39931000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">8.30155000e-02</span><span class="p">,</span>  <span class="o">-</span><span class="mf">3.01627000e-02</span><span class="p">,</span>  <span class="o">-</span><span class="mf">5.76523000e-03</span><span class="p">,</span>
         <span class="mf">2.67599000e-02</span><span class="p">,</span>   <span class="mf">4.30345000e-02</span><span class="p">,</span>   <span class="mf">1.86539000e-02</span><span class="p">,</span>
         <span class="mf">4.30586000e-02</span><span class="p">,</span>   <span class="mf">1.46105000e-02</span><span class="p">,</span>   <span class="mf">3.08779000e-02</span><span class="p">,</span>
         <span class="mf">1.46298000e-02</span><span class="p">,</span>   <span class="mf">4.71574000e-02</span><span class="p">,</span>   <span class="mf">3.90393000e-02</span><span class="p">,</span>
         <span class="mf">1.05985000e-02</span><span class="p">,</span>  <span class="o">-</span><span class="mf">5.65686000e-03</span><span class="p">,</span>   <span class="mf">5.53260000e-02</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">5.63759000e-03</span><span class="p">,</span>   <span class="mf">7.16078000e-02</span><span class="p">,</span>  <span class="o">-</span><span class="mf">9.68096000e-03</span><span class="p">,</span>
         <span class="mf">1.06563000e-02</span><span class="p">,</span>  <span class="o">-</span><span class="mf">9.64725000e-03</span><span class="p">,</span>   <span class="mf">1.47526000e-02</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">5.56535000e-03</span><span class="p">,</span>   <span class="mf">1.88393000e-02</span><span class="p">,</span>   <span class="mf">2.69815000e-02</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">4.21194000e-02</span><span class="p">,</span>  <span class="o">-</span><span class="mf">1.39676000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">2.04714000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">2.45359000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">3.10395000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">3.83564000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">4.48602000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">4.93312000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">5.66481000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">6.47772000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">5.66466000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">4.89228000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">4.32315000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">3.14422000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">2.65634000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">3.26605000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">3.87578000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">4.48551000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">5.01394000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">5.50170000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">5.94883000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">6.68047000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">5.94869000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">4.52590000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">3.87544000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">3.18434000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">2.28998000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">2.16786000e-02</span><span class="p">,</span>  <span class="o">-</span><span class="mf">4.60616000e-02</span><span class="p">,</span>  <span class="o">-</span><span class="mf">6.23146000e-02</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">8.26350000e-02</span><span class="p">,</span>  <span class="o">-</span><span class="mf">1.35478000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">1.88319000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">2.41159000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">2.94003000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">3.59041000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">4.11884000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">4.48467000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">4.93175000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">5.09431000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">4.48448000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">3.79340000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">3.22424000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">2.85834000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">2.65506000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">2.81762000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">3.38670000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">3.95576000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">4.60614000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">5.09392000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">5.70365000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">6.35403000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">6.84179000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">6.11001000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">5.45958000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">4.64655000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">3.79284000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">3.22371000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">2.57326000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">1.31307000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">6.21990000e-02</span><span class="p">,</span>  <span class="o">-</span><span class="mf">2.56064000e-02</span><span class="p">,</span>  <span class="o">-</span><span class="mf">9.33659000e-03</span><span class="p">,</span>
         <span class="mf">4.35113000e-02</span><span class="p">,</span>   <span class="mf">2.72656000e-02</span><span class="p">,</span>   <span class="mf">1.10199000e-02</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">5.22579000e-03</span><span class="p">,</span>  <span class="o">-</span><span class="mf">1.33511000e-02</span><span class="p">,</span>   <span class="mf">1.91909000e-02</span><span class="p">,</span>
         <span class="mf">5.17185000e-02</span><span class="p">,</span>   <span class="mf">2.73355000e-02</span><span class="p">,</span>   <span class="mf">2.32873000e-02</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">2.14209000e-02</span><span class="p">,</span>  <span class="o">-</span><span class="mf">1.08610000e-03</span><span class="p">,</span>  <span class="o">-</span><span class="mf">3.36016000e-02</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">2.54643000e-02</span><span class="p">,</span>   <span class="mf">1.11259000e-02</span><span class="p">,</span>  <span class="o">-</span><span class="mf">5.11742000e-03</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">4.16907000e-02</span><span class="p">,</span>  <span class="o">-</span><span class="mf">1.72933000e-02</span><span class="p">,</span>   <span class="mf">7.09937000e-03</span><span class="p">,</span>
         <span class="mf">3.04637000e-03</span><span class="p">,</span>   <span class="mf">2.74414000e-02</span><span class="p">,</span>   <span class="mf">2.33884000e-02</span><span class="p">,</span>
         <span class="mf">3.15281000e-02</span><span class="p">,</span>  <span class="o">-</span><span class="mf">9.82545000e-04</span><span class="p">,</span>  <span class="o">-</span><span class="mf">1.72331000e-02</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">9.04014000e-02</span><span class="p">,</span>  <span class="o">-</span><span class="mf">1.79827000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">2.44866000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">3.01774000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">3.70875000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">4.39976000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">5.65989000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">7.04198000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">7.57042000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">7.89555000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">7.32637000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">7.32637000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">5.70033000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">4.92795000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">4.39944000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">3.62699000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">3.99275000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">4.43985000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">5.13086000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">5.82189000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">6.63488000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">6.91941000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">6.18763000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">4.84614000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">4.03306000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">2.24439000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">1.67526000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.22809000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">7.80883000e-02</span><span class="p">,</span>  <span class="o">-</span><span class="mf">4.90791000e-03</span><span class="p">,</span>
         <span class="mf">2.35618000e-02</span><span class="p">,</span>  <span class="o">-</span><span class="mf">2.11392000e-02</span><span class="p">,</span>   <span class="mf">3.26070000e-03</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.29850000e-02</span><span class="p">,</span>   <span class="mf">1.95474000e-02</span><span class="p">,</span>  <span class="o">-</span><span class="mf">1.29561000e-02</span><span class="p">,</span>
         <span class="mf">3.31609000e-03</span><span class="p">,</span>  <span class="o">-</span><span class="mf">1.29320000e-02</span><span class="p">,</span>  <span class="o">-</span><span class="mf">5.76354000e-02</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.14536000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">1.42987000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">1.10462000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">6.57438000e-02</span><span class="p">,</span>  <span class="o">-</span><span class="mf">4.54114000e-02</span><span class="p">,</span>  <span class="o">-</span><span class="mf">7.38498000e-02</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">6.57101000e-02</span><span class="p">,</span>  <span class="o">-</span><span class="mf">6.16306000e-02</span><span class="p">,</span>  <span class="o">-</span><span class="mf">4.13030000e-02</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">3.72284000e-02</span><span class="p">,</span>  <span class="o">-</span><span class="mf">6.38173000e-04</span><span class="p">,</span>  <span class="o">-</span><span class="mf">4.12765000e-02</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.68815000e-02</span><span class="p">,</span>  <span class="o">-</span><span class="mf">3.71970000e-02</span><span class="p">,</span>  <span class="o">-</span><span class="mf">4.93801000e-02</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">6.15656000e-02</span><span class="p">,</span>  <span class="o">-</span><span class="mf">2.90284000e-02</span><span class="p">,</span>  <span class="o">-</span><span class="mf">5.56294000e-04</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">2.08743000e-02</span><span class="p">,</span>  <span class="o">-</span><span class="mf">5.39437000e-04</span><span class="p">,</span>  <span class="o">-</span><span class="mf">2.89875000e-02</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.27201000e-02</span><span class="p">,</span>  <span class="o">-</span><span class="mf">2.89706000e-02</span><span class="p">,</span>  <span class="o">-</span><span class="mf">1.27008000e-02</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">2.08189000e-02</span><span class="p">,</span>  <span class="o">-</span><span class="mf">5.33296000e-02</span><span class="p">,</span>  <span class="o">-</span><span class="mf">4.11176000e-02</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">4.51754000e-02</span><span class="p">,</span>  <span class="o">-</span><span class="mf">2.89080000e-02</span><span class="p">,</span>  <span class="o">-</span><span class="mf">4.51297000e-03</span><span class="p">,</span>
         <span class="mf">3.64120000e-03</span><span class="p">,</span>   <span class="mf">1.17833000e-02</span><span class="p">,</span>  <span class="o">-</span><span class="mf">4.04578000e-04</span><span class="p">,</span>
         <span class="mf">1.99254000e-02</span><span class="p">,</span>  <span class="o">-</span><span class="mf">1.25853000e-02</span><span class="p">,</span>   <span class="mf">2.80820000e-02</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.25564000e-02</span><span class="p">,</span>   <span class="mf">1.59182000e-02</span><span class="p">,</span>  <span class="o">-</span><span class="mf">3.27515000e-04</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">2.93800000e-04</span><span class="p">,</span>  <span class="o">-</span><span class="mf">1.65323000e-02</span><span class="p">,</span>   <span class="mf">1.60025000e-02</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">4.30827000e-03</span><span class="p">,</span>  <span class="o">-</span><span class="mf">5.71466000e-02</span><span class="p">,</span>  <span class="o">-</span><span class="mf">4.28900000e-03</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.24143000e-02</span><span class="p">,</span>   <span class="mf">2.01109000e-02</span><span class="p">,</span>   <span class="mf">3.63855000e-02</span><span class="p">,</span>
         <span class="mf">3.86998000e-03</span><span class="p">,</span>   <span class="mf">2.42048000e-02</span><span class="p">,</span>   <span class="mf">1.20169000e-02</span><span class="p">,</span>
         <span class="mf">4.04794000e-02</span><span class="p">,</span>   <span class="mf">2.82915000e-02</span><span class="p">,</span>   <span class="mf">5.26914000e-02</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.42084000e-04</span><span class="p">,</span>   <span class="mf">1.20675000e-02</span><span class="p">,</span>   <span class="mf">4.86625000e-02</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.03553000e-04</span><span class="p">,</span>   <span class="mf">4.86842000e-02</span><span class="p">,</span>   <span class="mf">3.24312000e-02</span><span class="p">,</span>
         <span class="mf">4.46312000e-02</span><span class="p">,</span>   <span class="mf">2.83806000e-02</span><span class="p">,</span>   <span class="mf">3.65203000e-02</span><span class="p">,</span>
         <span class="mf">1.62048000e-02</span><span class="p">,</span>   <span class="mf">3.24746000e-02</span><span class="p">,</span>   <span class="mf">8.10359000e-03</span><span class="p">,</span>
         <span class="mf">2.84408000e-02</span><span class="p">,</span>   <span class="mf">2.84529000e-02</span><span class="p">])</span>


    <span class="n">fig15top_t_raw</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
      <span class="p">[</span> <span class="mf">1.01862</span><span class="p">,</span>  <span class="mf">1.04636</span><span class="p">,</span>  <span class="mf">1.05823</span><span class="p">,</span>  <span class="mf">1.06221</span><span class="p">,</span>  <span class="mf">1.07013</span><span class="p">,</span>  <span class="mf">1.07807</span><span class="p">,</span>
        <span class="mf">1.08598</span><span class="p">,</span>  <span class="mf">1.08997</span><span class="p">,</span>  <span class="mf">1.09985</span><span class="p">,</span>  <span class="mf">1.10979</span><span class="p">,</span>  <span class="mf">1.11571</span><span class="p">,</span>  <span class="mf">1.12365</span><span class="p">,</span>
        <span class="mf">1.14149</span><span class="p">,</span>  <span class="mf">1.15932</span><span class="p">,</span>  <span class="mf">1.16919</span><span class="p">,</span>  <span class="mf">1.17913</span><span class="p">,</span>  <span class="mf">1.18899</span><span class="p">,</span>  <span class="mf">1.19684</span><span class="p">,</span>
        <span class="mf">1.2047</span> <span class="p">,</span>  <span class="mf">1.20672</span><span class="p">,</span>  <span class="mf">1.21058</span><span class="p">,</span>  <span class="mf">1.22052</span><span class="p">,</span>  <span class="mf">1.22055</span><span class="p">,</span>  <span class="mf">1.22458</span><span class="p">,</span>
        <span class="mf">1.22662</span><span class="p">,</span>  <span class="mf">1.23065</span><span class="p">,</span>  <span class="mf">1.23078</span><span class="p">,</span>  <span class="mf">1.23095</span><span class="p">,</span>  <span class="mf">1.23717</span><span class="p">,</span>  <span class="mf">1.23938</span><span class="p">,</span>
        <span class="mf">1.24354</span><span class="p">,</span>  <span class="mf">1.24761</span><span class="p">,</span>  <span class="mf">1.25735</span><span class="p">,</span>  <span class="mf">1.25922</span><span class="p">,</span>  <span class="mf">1.26111</span><span class="p">,</span>  <span class="mf">1.26297</span><span class="p">,</span>
        <span class="mf">1.26684</span><span class="p">,</span>  <span class="mf">1.27479</span><span class="p">,</span>  <span class="mf">1.27686</span><span class="p">,</span>  <span class="mf">1.28095</span><span class="p">,</span>  <span class="mf">1.28511</span><span class="p">,</span>  <span class="mf">1.28735</span><span class="p">,</span>
        <span class="mf">1.2915</span> <span class="p">,</span>  <span class="mf">1.29735</span><span class="p">,</span>  <span class="mf">1.30115</span><span class="p">,</span>  <span class="mf">1.30297</span><span class="p">,</span>  <span class="mf">1.3068</span> <span class="p">,</span>  <span class="mf">1.30866</span><span class="p">,</span>
        <span class="mf">1.31053</span><span class="p">,</span>  <span class="mf">1.31438</span><span class="p">,</span>  <span class="mf">1.31824</span><span class="p">,</span>  <span class="mf">1.32199</span><span class="p">,</span>  <span class="mf">1.32209</span><span class="p">,</span>  <span class="mf">1.32586</span><span class="p">,</span>
        <span class="mf">1.32976</span><span class="p">,</span>  <span class="mf">1.33171</span><span class="p">,</span>  <span class="mf">1.33364</span><span class="p">,</span>  <span class="mf">1.34151</span><span class="p">,</span>  <span class="mf">1.34744</span><span class="p">,</span>  <span class="mf">1.35736</span><span class="p">,</span>
        <span class="mf">1.36329</span><span class="p">,</span>  <span class="mf">1.37124</span><span class="p">,</span>  <span class="mf">1.37915</span><span class="p">,</span>  <span class="mf">1.38711</span><span class="p">,</span>  <span class="mf">1.395</span>  <span class="p">,</span>  <span class="mf">1.4069</span> <span class="p">,</span>
        <span class="mf">1.41483</span><span class="p">,</span>  <span class="mf">1.43461</span><span class="p">,</span>  <span class="mf">1.44255</span><span class="p">,</span>  <span class="mf">1.44847</span><span class="p">,</span>  <span class="mf">1.4584</span> <span class="p">,</span>  <span class="mf">1.49011</span><span class="p">,</span>
        <span class="mf">1.49799</span><span class="p">,</span>  <span class="mf">1.50786</span><span class="p">,</span>  <span class="mf">1.51375</span><span class="p">,</span>  <span class="mf">1.51767</span><span class="p">,</span>  <span class="mf">1.52556</span><span class="p">,</span>  <span class="mf">1.52956</span><span class="p">,</span>
        <span class="mf">1.52961</span><span class="p">,</span>  <span class="mf">1.53366</span><span class="p">,</span>  <span class="mf">1.53774</span><span class="p">,</span>  <span class="mf">1.53983</span><span class="p">,</span>  <span class="mf">1.54399</span><span class="p">,</span>  <span class="mf">1.54423</span><span class="p">,</span>
        <span class="mf">1.55047</span><span class="p">,</span>  <span class="mf">1.55268</span><span class="p">,</span>  <span class="mf">1.55878</span><span class="p">,</span>  <span class="mf">1.56463</span><span class="p">,</span>  <span class="mf">1.56649</span><span class="p">,</span>  <span class="mf">1.56821</span><span class="p">,</span>
        <span class="mf">1.56834</span><span class="p">,</span>  <span class="mf">1.57402</span><span class="p">,</span>  <span class="mf">1.57592</span><span class="p">,</span>  <span class="mf">1.5838</span> <span class="p">,</span>  <span class="mf">1.58781</span><span class="p">,</span>  <span class="mf">1.59194</span><span class="p">,</span>
        <span class="mf">1.59421</span><span class="p">,</span>  <span class="mf">1.60038</span><span class="p">,</span>  <span class="mf">1.60812</span><span class="p">,</span>  <span class="mf">1.61198</span><span class="p">,</span>  <span class="mf">1.61384</span><span class="p">,</span>  <span class="mf">1.6157</span> <span class="p">,</span>
        <span class="mf">1.61755</span><span class="p">,</span>  <span class="mf">1.6214</span> <span class="p">,</span>  <span class="mf">1.62527</span><span class="p">,</span>  <span class="mf">1.62903</span><span class="p">,</span>  <span class="mf">1.62914</span><span class="p">,</span>  <span class="mf">1.63287</span><span class="p">,</span>
        <span class="mf">1.63476</span><span class="p">,</span>  <span class="mf">1.63865</span><span class="p">,</span>  <span class="mf">1.64656</span><span class="p">,</span>  <span class="mf">1.65053</span><span class="p">,</span>  <span class="mf">1.65062</span><span class="p">,</span>  <span class="mf">1.65276</span><span class="p">,</span>
        <span class="mf">1.65698</span><span class="p">,</span>  <span class="mf">1.65924</span><span class="p">,</span>  <span class="mf">1.66344</span><span class="p">,</span>  <span class="mf">1.66561</span><span class="p">,</span>  <span class="mf">1.6736</span> <span class="p">,</span>  <span class="mf">1.6775</span> <span class="p">,</span>
        <span class="mf">1.67928</span><span class="p">,</span>  <span class="mf">1.68318</span><span class="p">,</span>  <span class="mf">1.68502</span><span class="p">,</span>  <span class="mf">1.68691</span><span class="p">,</span>  <span class="mf">1.69279</span><span class="p">,</span>  <span class="mf">1.70274</span><span class="p">,</span>
        <span class="mf">1.70283</span><span class="p">,</span>  <span class="mf">1.70498</span><span class="p">,</span>  <span class="mf">1.7072</span> <span class="p">,</span>  <span class="mf">1.71137</span><span class="p">,</span>  <span class="mf">1.71543</span><span class="p">,</span>  <span class="mf">1.71931</span><span class="p">,</span>
        <span class="mf">1.72118</span><span class="p">,</span>  <span class="mf">1.72305</span><span class="p">,</span>  <span class="mf">1.72688</span><span class="p">,</span>  <span class="mf">1.7287</span> <span class="p">,</span>  <span class="mf">1.73251</span><span class="p">,</span>  <span class="mf">1.73435</span><span class="p">,</span>
        <span class="mf">1.73826</span><span class="p">,</span>  <span class="mf">1.74214</span><span class="p">,</span>  <span class="mf">1.74591</span><span class="p">,</span>  <span class="mf">1.74602</span><span class="p">,</span>  <span class="mf">1.74979</span><span class="p">,</span>  <span class="mf">1.75173</span><span class="p">,</span>
        <span class="mf">1.75564</span><span class="p">,</span>  <span class="mf">1.75755</span><span class="p">,</span>  <span class="mf">1.76345</span><span class="p">,</span>  <span class="mf">1.76942</span><span class="p">,</span>  <span class="mf">1.77732</span><span class="p">,</span>  <span class="mf">1.78528</span><span class="p">,</span>
        <span class="mf">1.79915</span><span class="p">,</span>  <span class="mf">1.813</span>  <span class="p">,</span>  <span class="mf">1.81897</span><span class="p">,</span>  <span class="mf">1.82488</span><span class="p">,</span>  <span class="mf">1.83282</span><span class="p">,</span>  <span class="mf">1.8467</span> <span class="p">,</span>
        <span class="mf">1.8546</span> <span class="p">,</span>  <span class="mf">1.86252</span><span class="p">,</span>  <span class="mf">1.87642</span><span class="p">,</span>  <span class="mf">1.91208</span><span class="p">,</span>  <span class="mf">1.91995</span><span class="p">,</span>  <span class="mf">1.92588</span><span class="p">,</span>
        <span class="mf">1.92982</span><span class="p">,</span>  <span class="mf">1.93967</span><span class="p">,</span>  <span class="mf">1.94357</span><span class="p">,</span>  <span class="mf">1.94753</span><span class="p">,</span>  <span class="mf">1.95151</span><span class="p">,</span>  <span class="mf">1.95352</span><span class="p">,</span>
        <span class="mf">1.95555</span><span class="p">,</span>  <span class="mf">1.95957</span><span class="p">,</span>  <span class="mf">1.96166</span><span class="p">,</span>  <span class="mf">1.96377</span><span class="p">,</span>  <span class="mf">1.96792</span><span class="p">,</span>  <span class="mf">1.97017</span><span class="p">,</span>
        <span class="mf">1.97436</span><span class="p">,</span>  <span class="mf">1.97654</span><span class="p">,</span>  <span class="mf">1.98057</span><span class="p">,</span>  <span class="mf">1.98844</span><span class="p">,</span>  <span class="mf">1.99021</span><span class="p">,</span>  <span class="mf">1.99232</span><span class="p">,</span>
        <span class="mf">1.996</span>  <span class="p">,</span>  <span class="mf">1.99787</span><span class="p">,</span>  <span class="mf">2.00374</span><span class="p">,</span>  <span class="mf">2.0117</span> <span class="p">,</span>  <span class="mf">2.01377</span><span class="p">,</span>  <span class="mf">2.01595</span><span class="p">,</span>
        <span class="mf">2.02019</span><span class="p">,</span>  <span class="mf">2.0223</span> <span class="p">,</span>  <span class="mf">2.02432</span><span class="p">,</span>  <span class="mf">2.03021</span><span class="p">,</span>  <span class="mf">2.03208</span><span class="p">,</span>  <span class="mf">2.03392</span><span class="p">,</span>
        <span class="mf">2.03579</span><span class="p">,</span>  <span class="mf">2.03964</span><span class="p">,</span>  <span class="mf">2.04349</span><span class="p">,</span>  <span class="mf">2.04532</span><span class="p">,</span>  <span class="mf">2.04718</span><span class="p">,</span>  <span class="mf">2.05104</span><span class="p">,</span>
        <span class="mf">2.05491</span><span class="p">,</span>  <span class="mf">2.05679</span><span class="p">,</span>  <span class="mf">2.05865</span><span class="p">,</span>  <span class="mf">2.06256</span><span class="p">,</span>  <span class="mf">2.06444</span><span class="p">,</span>  <span class="mf">2.0704</span> <span class="p">,</span>
        <span class="mf">2.07445</span><span class="p">,</span>  <span class="mf">2.07657</span><span class="p">,</span>  <span class="mf">2.0787</span> <span class="p">,</span>  <span class="mf">2.0808</span> <span class="p">,</span>  <span class="mf">2.08295</span><span class="p">,</span>  <span class="mf">2.08718</span><span class="p">,</span>
        <span class="mf">2.08735</span><span class="p">,</span>  <span class="mf">2.09151</span><span class="p">,</span>  <span class="mf">2.09359</span><span class="p">,</span>  <span class="mf">2.10519</span><span class="p">,</span>  <span class="mf">2.10897</span><span class="p">,</span>  <span class="mf">2.11279</span><span class="p">,</span>
        <span class="mf">2.11867</span><span class="p">,</span>  <span class="mf">2.1227</span> <span class="p">,</span>  <span class="mf">2.12274</span><span class="p">,</span>  <span class="mf">2.12682</span><span class="p">,</span>  <span class="mf">2.129</span>  <span class="p">,</span>  <span class="mf">2.13122</span><span class="p">,</span>
        <span class="mf">2.13537</span><span class="p">,</span>  <span class="mf">2.13936</span><span class="p">,</span>  <span class="mf">2.14324</span><span class="p">,</span>  <span class="mf">2.14705</span><span class="p">,</span>  <span class="mf">2.14894</span><span class="p">,</span>  <span class="mf">2.15082</span><span class="p">,</span>
        <span class="mf">2.15464</span><span class="p">,</span>  <span class="mf">2.1565</span> <span class="p">,</span>  <span class="mf">2.15829</span><span class="p">,</span>  <span class="mf">2.1584</span> <span class="p">,</span>  <span class="mf">2.16217</span><span class="p">,</span>  <span class="mf">2.16607</span><span class="p">,</span>
        <span class="mf">2.16796</span><span class="p">,</span>  <span class="mf">2.17183</span><span class="p">,</span>  <span class="mf">2.17372</span><span class="p">,</span>  <span class="mf">2.17763</span><span class="p">,</span>  <span class="mf">2.17956</span><span class="p">,</span>  <span class="mf">2.18348</span><span class="p">,</span>
        <span class="mf">2.18937</span><span class="p">,</span>  <span class="mf">2.19931</span><span class="p">,</span>  <span class="mf">2.20523</span><span class="p">,</span>  <span class="mf">2.21123</span><span class="p">,</span>  <span class="mf">2.22308</span><span class="p">,</span>  <span class="mf">2.22905</span><span class="p">,</span>
        <span class="mf">2.23497</span><span class="p">,</span>  <span class="mf">2.24093</span><span class="p">,</span>  <span class="mf">2.24882</span><span class="p">,</span>  <span class="mf">2.25677</span><span class="p">,</span>  <span class="mf">2.2627</span> <span class="p">,</span>  <span class="mf">2.28055</span><span class="p">,</span>
        <span class="mf">2.29242</span><span class="p">,</span>  <span class="mf">2.29636</span><span class="p">,</span>  <span class="mf">2.30232</span><span class="p">,</span>  <span class="mf">2.30432</span><span class="p">,</span>  <span class="mf">2.31622</span><span class="p">,</span>  <span class="mf">2.3202</span> <span class="p">,</span>
        <span class="mf">2.32612</span><span class="p">,</span>  <span class="mf">2.33997</span><span class="p">,</span>  <span class="mf">2.34786</span><span class="p">,</span>  <span class="mf">2.35178</span><span class="p">,</span>  <span class="mf">2.35569</span><span class="p">,</span>  <span class="mf">2.36552</span><span class="p">,</span>
        <span class="mf">2.36946</span><span class="p">,</span>  <span class="mf">2.37748</span><span class="p">,</span>  <span class="mf">2.37953</span><span class="p">,</span>  <span class="mf">2.38357</span><span class="p">,</span>  <span class="mf">2.38765</span><span class="p">,</span>  <span class="mf">2.38977</span><span class="p">,</span>
        <span class="mf">2.39202</span><span class="p">,</span>  <span class="mf">2.39435</span><span class="p">,</span>  <span class="mf">2.3966</span> <span class="p">,</span>  <span class="mf">2.40267</span><span class="p">,</span>  <span class="mf">2.41053</span><span class="p">,</span>  <span class="mf">2.41242</span><span class="p">,</span>
        <span class="mf">2.4143</span> <span class="p">,</span>  <span class="mf">2.41618</span><span class="p">,</span>  <span class="mf">2.41801</span><span class="p">,</span>  <span class="mf">2.42185</span><span class="p">,</span>  <span class="mf">2.42574</span><span class="p">,</span>  <span class="mf">2.43168</span><span class="p">,</span>
        <span class="mf">2.43765</span><span class="p">,</span>  <span class="mf">2.43776</span><span class="p">,</span>  <span class="mf">2.43993</span><span class="p">,</span>  <span class="mf">2.44218</span><span class="p">,</span>  <span class="mf">2.44828</span><span class="p">,</span>  <span class="mf">2.45414</span><span class="p">,</span>
        <span class="mf">2.45601</span><span class="p">,</span>  <span class="mf">2.45987</span><span class="p">,</span>  <span class="mf">2.46171</span><span class="p">,</span>  <span class="mf">2.46354</span><span class="p">,</span>  <span class="mf">2.46538</span><span class="p">,</span>  <span class="mf">2.46923</span><span class="p">,</span>
        <span class="mf">2.47113</span><span class="p">,</span>  <span class="mf">2.47687</span><span class="p">,</span>  <span class="mf">2.47698</span><span class="p">,</span>  <span class="mf">2.47874</span><span class="p">,</span>  <span class="mf">2.48457</span><span class="p">,</span>  <span class="mf">2.49042</span><span class="p">,</span>
        <span class="mf">2.49646</span><span class="p">,</span>  <span class="mf">2.50055</span><span class="p">,</span>  <span class="mf">2.50264</span><span class="p">,</span>  <span class="mf">2.50472</span><span class="p">,</span>  <span class="mf">2.50692</span><span class="p">,</span>  <span class="mf">2.509</span>  <span class="p">,</span>
        <span class="mf">2.50922</span><span class="p">,</span>  <span class="mf">2.51143</span><span class="p">,</span>  <span class="mf">2.51353</span><span class="p">,</span>  <span class="mf">2.52143</span><span class="p">,</span>  <span class="mf">2.52528</span><span class="p">,</span>  <span class="mf">2.52914</span><span class="p">,</span>
        <span class="mf">2.53099</span><span class="p">,</span>  <span class="mf">2.53286</span><span class="p">,</span>  <span class="mf">2.53674</span><span class="p">,</span>  <span class="mf">2.54459</span><span class="p">,</span>  <span class="mf">2.54664</span><span class="p">,</span>  <span class="mf">2.54879</span><span class="p">,</span>
        <span class="mf">2.55498</span><span class="p">,</span>  <span class="mf">2.55716</span><span class="p">,</span>  <span class="mf">2.56122</span><span class="p">,</span>  <span class="mf">2.5651</span> <span class="p">,</span>  <span class="mf">2.56704</span><span class="p">,</span>  <span class="mf">2.57089</span><span class="p">,</span>
        <span class="mf">2.57279</span><span class="p">,</span>  <span class="mf">2.57662</span><span class="p">,</span>  <span class="mf">2.57845</span><span class="p">,</span>  <span class="mf">2.5803</span> <span class="p">,</span>  <span class="mf">2.58222</span><span class="p">,</span>  <span class="mf">2.58613</span><span class="p">,</span>
        <span class="mf">2.59002</span><span class="p">,</span>  <span class="mf">2.59385</span><span class="p">,</span>  <span class="mf">2.59573</span><span class="p">,</span>  <span class="mf">2.59763</span><span class="p">,</span>  <span class="mf">2.60155</span><span class="p">,</span>  <span class="mf">2.60347</span><span class="p">,</span>
        <span class="mf">2.60738</span><span class="p">,</span>  <span class="mf">2.61533</span><span class="p">,</span>  <span class="mf">2.62524</span><span class="p">,</span>  <span class="mf">2.63119</span><span class="p">,</span>  <span class="mf">2.63512</span><span class="p">,</span>  <span class="mf">2.64701</span><span class="p">,</span>
        <span class="mf">2.651</span>  <span class="p">,</span>  <span class="mf">2.6609</span> <span class="p">,</span>  <span class="mf">2.66484</span><span class="p">,</span>  <span class="mf">2.67475</span><span class="p">,</span>  <span class="mf">2.68465</span><span class="p">,</span>  <span class="mf">2.69456</span><span class="p">,</span>
        <span class="mf">2.70448</span><span class="p">,</span>  <span class="mf">2.71238</span><span class="p">,</span>  <span class="mf">2.71833</span><span class="p">,</span>  <span class="mf">2.72624</span><span class="p">,</span>  <span class="mf">2.7322</span> <span class="p">,</span>  <span class="mf">2.74011</span><span class="p">,</span>
        <span class="mf">2.75003</span><span class="p">,</span>  <span class="mf">2.76189</span><span class="p">,</span>  <span class="mf">2.77177</span><span class="p">,</span>  <span class="mf">2.77768</span><span class="p">,</span>  <span class="mf">2.77962</span><span class="p">,</span>  <span class="mf">2.78556</span><span class="p">,</span>
        <span class="mf">2.78945</span><span class="p">,</span>  <span class="mf">2.79338</span><span class="p">,</span>  <span class="mf">2.80139</span><span class="p">,</span>  <span class="mf">2.80343</span><span class="p">,</span>  <span class="mf">2.80548</span><span class="p">,</span>  <span class="mf">2.8095</span> <span class="p">,</span>
        <span class="mf">2.81158</span><span class="p">,</span>  <span class="mf">2.81574</span><span class="p">,</span>  <span class="mf">2.81593</span><span class="p">,</span>  <span class="mf">2.81831</span><span class="p">,</span>  <span class="mf">2.82251</span><span class="p">,</span>  <span class="mf">2.82857</span><span class="p">,</span>
        <span class="mf">2.83437</span><span class="p">,</span>  <span class="mf">2.83443</span><span class="p">,</span>  <span class="mf">2.84006</span><span class="p">,</span>  <span class="mf">2.84021</span><span class="p">,</span>  <span class="mf">2.84387</span><span class="p">,</span>  <span class="mf">2.84576</span><span class="p">,</span>
        <span class="mf">2.85165</span><span class="p">,</span>  <span class="mf">2.86158</span><span class="p">,</span>  <span class="mf">2.8617</span> <span class="p">,</span>  <span class="mf">2.86392</span><span class="p">,</span>  <span class="mf">2.86816</span><span class="p">,</span>  <span class="mf">2.8722</span> <span class="p">,</span>
        <span class="mf">2.87999</span><span class="p">,</span>  <span class="mf">2.88181</span><span class="p">,</span>  <span class="mf">2.88559</span><span class="p">,</span>  <span class="mf">2.88727</span><span class="p">,</span>  <span class="mf">2.88741</span><span class="p">,</span>  <span class="mf">2.89313</span><span class="p">,</span>
        <span class="mf">2.89503</span><span class="p">,</span>  <span class="mf">2.89888</span><span class="p">,</span>  <span class="mf">2.90074</span><span class="p">,</span>  <span class="mf">2.90462</span><span class="p">,</span>  <span class="mf">2.90851</span><span class="p">,</span>  <span class="mf">2.91237</span><span class="p">,</span>
        <span class="mf">2.92039</span><span class="p">,</span>  <span class="mf">2.92248</span><span class="p">,</span>  <span class="mf">2.92663</span><span class="p">,</span>  <span class="mf">2.93081</span><span class="p">,</span>  <span class="mf">2.93502</span><span class="p">,</span>  <span class="mf">2.93724</span><span class="p">,</span>
        <span class="mf">2.94134</span><span class="p">,</span>  <span class="mf">2.94914</span><span class="p">,</span>  <span class="mf">2.95296</span><span class="p">,</span>  <span class="mf">2.95485</span><span class="p">,</span>  <span class="mf">2.95867</span><span class="p">,</span>  <span class="mf">2.96257</span><span class="p">,</span>
        <span class="mf">2.97053</span><span class="p">,</span>  <span class="mf">2.97061</span><span class="p">,</span>  <span class="mf">2.97276</span><span class="p">,</span>  <span class="mf">2.97893</span><span class="p">,</span>  <span class="mf">2.98113</span><span class="p">,</span>  <span class="mf">2.98525</span><span class="p">,</span>
        <span class="mf">2.99296</span><span class="p">,</span>  <span class="mf">2.9931</span> <span class="p">,</span>  <span class="mf">2.99873</span><span class="p">,</span>  <span class="mf">3.00041</span><span class="p">,</span>  <span class="mf">3.00054</span><span class="p">,</span>  <span class="mf">3.00615</span><span class="p">,</span>
        <span class="mf">3.00625</span><span class="p">,</span>  <span class="mf">3.01002</span><span class="p">,</span>  <span class="mf">3.01387</span><span class="p">,</span>  <span class="mf">3.01772</span><span class="p">,</span>  <span class="mf">3.01963</span><span class="p">,</span>  <span class="mf">3.02353</span><span class="p">,</span>
        <span class="mf">3.02742</span><span class="p">,</span>  <span class="mf">3.03134</span><span class="p">,</span>  <span class="mf">3.03527</span><span class="p">,</span>  <span class="mf">3.04121</span><span class="p">,</span>  <span class="mf">3.05115</span><span class="p">,</span>  <span class="mf">3.06104</span><span class="p">,</span>
        <span class="mf">3.067</span>  <span class="p">,</span>  <span class="mf">3.0749</span> <span class="p">,</span>  <span class="mf">3.08088</span><span class="p">,</span>  <span class="mf">3.09077</span><span class="p">,</span>  <span class="mf">3.09476</span><span class="p">,</span>  <span class="mf">3.12841</span><span class="p">,</span>
        <span class="mf">3.13634</span><span class="p">,</span>  <span class="mf">3.14426</span><span class="p">,</span>  <span class="mf">3.15215</span><span class="p">,</span>  <span class="mf">3.16009</span><span class="p">,</span>  <span class="mf">3.17198</span><span class="p">,</span>  <span class="mf">3.17791</span><span class="p">,</span>
        <span class="mf">3.1819</span> <span class="p">,</span>  <span class="mf">3.1878</span> <span class="p">,</span>  <span class="mf">3.19965</span><span class="p">,</span>  <span class="mf">3.20356</span><span class="p">,</span>  <span class="mf">3.21144</span><span class="p">,</span>  <span class="mf">3.21533</span><span class="p">,</span>
        <span class="mf">3.22528</span><span class="p">,</span>  <span class="mf">3.22533</span><span class="p">,</span>  <span class="mf">3.22739</span><span class="p">,</span>  <span class="mf">3.23145</span><span class="p">,</span>  <span class="mf">3.23357</span><span class="p">,</span>  <span class="mf">3.23774</span><span class="p">,</span>
        <span class="mf">3.24193</span><span class="p">,</span>  <span class="mf">3.2442</span> <span class="p">,</span>  <span class="mf">3.24643</span><span class="p">,</span>  <span class="mf">3.25256</span><span class="p">,</span>  <span class="mf">3.2584</span> <span class="p">,</span>  <span class="mf">3.26027</span><span class="p">,</span>
        <span class="mf">3.2621</span> <span class="p">,</span>  <span class="mf">3.2678</span> <span class="p">,</span>  <span class="mf">3.26793</span><span class="p">,</span>  <span class="mf">3.27555</span><span class="p">,</span>  <span class="mf">3.28357</span><span class="p">,</span>  <span class="mf">3.28569</span><span class="p">,</span>
        <span class="mf">3.28788</span><span class="p">,</span>  <span class="mf">3.29617</span><span class="p">,</span>  <span class="mf">3.302</span>  <span class="p">,</span>  <span class="mf">3.30388</span><span class="p">,</span>  <span class="mf">3.30773</span><span class="p">,</span>  <span class="mf">3.30956</span><span class="p">,</span>
        <span class="mf">3.31334</span><span class="p">,</span>  <span class="mf">3.31515</span><span class="p">,</span>  <span class="mf">3.32096</span><span class="p">,</span>  <span class="mf">3.32283</span><span class="p">,</span>  <span class="mf">3.32289</span><span class="p">,</span>  <span class="mf">3.32473</span><span class="p">,</span>
        <span class="mf">3.33056</span><span class="p">,</span>  <span class="mf">3.33244</span><span class="p">,</span>  <span class="mf">3.33435</span><span class="p">,</span>  <span class="mf">3.34224</span><span class="p">,</span>  <span class="mf">3.34634</span><span class="p">,</span>  <span class="mf">3.34848</span><span class="p">,</span>
        <span class="mf">3.35461</span><span class="p">,</span>  <span class="mf">3.35487</span><span class="p">,</span>  <span class="mf">3.35711</span><span class="p">,</span>  <span class="mf">3.36127</span><span class="p">,</span>  <span class="mf">3.36532</span><span class="p">,</span>  <span class="mf">3.3712</span> <span class="p">,</span>
        <span class="mf">3.37508</span><span class="p">,</span>  <span class="mf">3.37695</span><span class="p">,</span>  <span class="mf">3.37881</span><span class="p">,</span>  <span class="mf">3.38066</span><span class="p">,</span>  <span class="mf">3.38073</span><span class="p">,</span>  <span class="mf">3.38651</span><span class="p">,</span>
        <span class="mf">3.39447</span><span class="p">,</span>  <span class="mf">3.39849</span><span class="p">,</span>  <span class="mf">3.39864</span><span class="p">,</span>  <span class="mf">3.40284</span><span class="p">,</span>  <span class="mf">3.40506</span><span class="p">,</span>  <span class="mf">3.40716</span><span class="p">,</span>
        <span class="mf">3.41688</span><span class="p">,</span>  <span class="mf">3.41873</span><span class="p">,</span>  <span class="mf">3.4206</span> <span class="p">,</span>  <span class="mf">3.42246</span><span class="p">,</span>  <span class="mf">3.42428</span><span class="p">,</span>  <span class="mf">3.43</span>   <span class="p">,</span>
        <span class="mf">3.43206</span><span class="p">,</span>  <span class="mf">3.43589</span><span class="p">,</span>  <span class="mf">3.4378</span> <span class="p">,</span>  <span class="mf">3.43968</span><span class="p">,</span>  <span class="mf">3.44552</span><span class="p">,</span>  <span class="mf">3.44743</span><span class="p">,</span>
        <span class="mf">3.45129</span><span class="p">,</span>  <span class="mf">3.45134</span><span class="p">,</span>  <span class="mf">3.45521</span><span class="p">,</span>  <span class="mf">3.46315</span><span class="p">,</span>  <span class="mf">3.47705</span><span class="p">,</span>  <span class="mf">3.48694</span><span class="p">,</span>
        <span class="mf">3.49886</span><span class="p">,</span>  <span class="mf">3.50678</span><span class="p">,</span>  <span class="mf">3.52063</span><span class="p">,</span>  <span class="mf">3.53058</span><span class="p">,</span>  <span class="mf">3.54046</span><span class="p">,</span>  <span class="mf">3.54638</span><span class="p">,</span>
        <span class="mf">3.55627</span><span class="p">,</span>  <span class="mf">3.56019</span><span class="p">,</span>  <span class="mf">3.57605</span><span class="p">,</span>  <span class="mf">3.58401</span><span class="p">,</span>  <span class="mf">3.59192</span><span class="p">,</span>  <span class="mf">3.59788</span><span class="p">,</span>
        <span class="mf">3.60581</span><span class="p">,</span>  <span class="mf">3.60975</span><span class="p">,</span>  <span class="mf">3.61565</span><span class="p">,</span>  <span class="mf">3.62355</span><span class="p">,</span>  <span class="mf">3.6255</span> <span class="p">,</span>  <span class="mf">3.63338</span><span class="p">,</span>
        <span class="mf">3.63732</span><span class="p">,</span>  <span class="mf">3.63926</span><span class="p">,</span>  <span class="mf">3.64518</span><span class="p">,</span>  <span class="mf">3.64919</span><span class="p">,</span>  <span class="mf">3.65123</span><span class="p">,</span>  <span class="mf">3.6533</span> <span class="p">,</span>
        <span class="mf">3.65537</span><span class="p">,</span>  <span class="mf">3.65746</span><span class="p">,</span>  <span class="mf">3.66357</span><span class="p">,</span>  <span class="mf">3.66379</span><span class="p">,</span>  <span class="mf">3.66607</span><span class="p">,</span>  <span class="mf">3.67034</span><span class="p">,</span>
        <span class="mf">3.67645</span><span class="p">,</span>  <span class="mf">3.68227</span><span class="p">,</span>  <span class="mf">3.68409</span><span class="p">,</span>  <span class="mf">3.68592</span><span class="p">,</span>  <span class="mf">3.68971</span><span class="p">,</span>  <span class="mf">3.68979</span><span class="p">,</span>
        <span class="mf">3.69357</span><span class="p">,</span>  <span class="mf">3.69942</span><span class="p">,</span>  <span class="mf">3.70543</span><span class="p">,</span>  <span class="mf">3.71144</span><span class="p">,</span>  <span class="mf">3.71157</span><span class="p">,</span>  <span class="mf">3.71372</span><span class="p">,</span>
        <span class="mf">3.71591</span><span class="p">,</span>  <span class="mf">3.71796</span><span class="p">,</span>  <span class="mf">3.72382</span><span class="p">,</span>  <span class="mf">3.72944</span><span class="p">,</span>  <span class="mf">3.72959</span><span class="p">,</span>  <span class="mf">3.72968</span><span class="p">,</span>
        <span class="mf">3.73525</span><span class="p">,</span>  <span class="mf">3.73909</span><span class="p">,</span>  <span class="mf">3.74297</span><span class="p">,</span>  <span class="mf">3.74489</span><span class="p">,</span>  <span class="mf">3.74874</span><span class="p">,</span>  <span class="mf">3.7526</span> <span class="p">,</span>
        <span class="mf">3.75451</span><span class="p">,</span>  <span class="mf">3.75843</span><span class="p">,</span>  <span class="mf">3.76233</span><span class="p">,</span>  <span class="mf">3.76625</span><span class="p">,</span>  <span class="mf">3.77814</span><span class="p">,</span>  <span class="mf">3.78209</span><span class="p">,</span>
        <span class="mf">3.796</span>  <span class="p">,</span>  <span class="mf">3.8039</span> <span class="p">,</span>  <span class="mf">3.80985</span><span class="p">,</span>  <span class="mf">3.81774</span><span class="p">,</span>  <span class="mf">3.83163</span><span class="p">,</span>  <span class="mf">3.8376</span> <span class="p">,</span>
        <span class="mf">3.84749</span><span class="p">,</span>  <span class="mf">3.85343</span><span class="p">,</span>  <span class="mf">3.86333</span><span class="p">,</span>  <span class="mf">3.87723</span><span class="p">,</span>  <span class="mf">3.8911</span> <span class="p">,</span>  <span class="mf">3.90695</span><span class="p">,</span>
        <span class="mf">3.91883</span><span class="p">,</span>  <span class="mf">3.92673</span><span class="p">,</span>  <span class="mf">3.93266</span><span class="p">,</span>  <span class="mf">3.94658</span><span class="p">,</span>  <span class="mf">3.9743</span> <span class="p">,</span>  <span class="mf">3.98417</span><span class="p">,</span>
        <span class="mf">3.98815</span><span class="p">,</span>  <span class="mf">4.00202</span><span class="p">,</span>  <span class="mf">4.00398</span><span class="p">,</span>  <span class="mf">4.01388</span><span class="p">,</span>  <span class="mf">4.01984</span><span class="p">,</span>  <span class="mf">4.03172</span><span class="p">,</span>
        <span class="mf">4.04757</span><span class="p">,</span>  <span class="mf">4.05154</span><span class="p">,</span>  <span class="mf">4.06741</span><span class="p">,</span>  <span class="mf">4.07929</span><span class="p">,</span>  <span class="mf">4.08322</span><span class="p">,</span>  <span class="mf">4.09117</span><span class="p">,</span>
        <span class="mf">4.09711</span><span class="p">,</span>  <span class="mf">4.111</span>  <span class="p">,</span>  <span class="mf">4.11495</span><span class="p">,</span>  <span class="mf">4.12288</span><span class="p">,</span>  <span class="mf">4.13078</span><span class="p">,</span>  <span class="mf">4.13672</span><span class="p">,</span>
        <span class="mf">4.14462</span><span class="p">,</span>  <span class="mf">4.1664</span> <span class="p">,</span>  <span class="mf">4.18226</span><span class="p">,</span>  <span class="mf">4.19611</span><span class="p">,</span>  <span class="mf">4.20009</span><span class="p">,</span>  <span class="mf">4.20999</span><span class="p">,</span>
        <span class="mf">4.21395</span><span class="p">,</span>  <span class="mf">4.22784</span><span class="p">,</span>  <span class="mf">4.23776</span><span class="p">,</span>  <span class="mf">4.24767</span><span class="p">,</span>  <span class="mf">4.25163</span><span class="p">,</span>  <span class="mf">4.27342</span><span class="p">,</span>
        <span class="mf">4.28731</span><span class="p">,</span>  <span class="mf">4.3091</span> <span class="p">,</span>  <span class="mf">4.33091</span><span class="p">,</span>  <span class="mf">4.34478</span><span class="p">,</span>  <span class="mf">4.35664</span><span class="p">,</span>  <span class="mf">4.37645</span><span class="p">,</span>
        <span class="mf">4.3824</span> <span class="p">,</span>  <span class="mf">4.39229</span><span class="p">,</span>  <span class="mf">4.40417</span><span class="p">,</span>  <span class="mf">4.4121</span> <span class="p">,</span>  <span class="mf">4.41607</span><span class="p">,</span>  <span class="mf">4.42398</span><span class="p">,</span>
        <span class="mf">4.43589</span><span class="p">,</span>  <span class="mf">4.44378</span><span class="p">,</span>  <span class="mf">4.46163</span><span class="p">,</span>  <span class="mf">4.47746</span><span class="p">])</span>
    <span class="n">fig15top_w_raw</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
      <span class="p">[</span> <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">0.00383142</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.00383142</span><span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>
       <span class="o">-</span><span class="mf">0.0114943</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.00383142</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0153257</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.00383142</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0191571</span> <span class="p">,</span>
       <span class="o">-</span><span class="mf">0.00766284</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0191571</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.0229885</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.0268199</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.00766284</span><span class="p">,</span>
       <span class="o">-</span><span class="mf">0.0268199</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.00383142</span><span class="p">,</span>  <span class="mf">0.0344828</span> <span class="p">,</span>  <span class="mf">0.0689655</span> <span class="p">,</span>  <span class="mf">0.045977</span>  <span class="p">,</span>
        <span class="mf">0.0996169</span> <span class="p">,</span>  <span class="mf">0.0842912</span> <span class="p">,</span>  <span class="mf">0.0689655</span> <span class="p">,</span>  <span class="mf">0.0344828</span> <span class="p">,</span>  <span class="mf">0.00383142</span><span class="p">,</span>
       <span class="o">-</span><span class="mf">0.0306513</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.0957854</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.183908</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.321839</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.440613</span>  <span class="p">,</span>
       <span class="o">-</span><span class="mf">0.536398</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.59387</span>   <span class="p">,</span> <span class="o">-</span><span class="mf">0.509579</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.455939</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.40613</span>   <span class="p">,</span>
       <span class="o">-</span><span class="mf">0.348659</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.298851</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.314176</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.356322</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.425287</span>  <span class="p">,</span>
       <span class="o">-</span><span class="mf">0.524904</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.655172</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.747126</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.701149</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.62069</span>   <span class="p">,</span>
       <span class="o">-</span><span class="mf">0.54023</span>   <span class="p">,</span> <span class="o">-</span><span class="mf">0.471264</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.409962</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.356322</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.298851</span>  <span class="p">,</span>
       <span class="o">-</span><span class="mf">0.245211</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.141762</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.191571</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.0957854</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.0613027</span> <span class="p">,</span>
       <span class="o">-</span><span class="mf">0.045977</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.0191571</span> <span class="p">,</span>  <span class="mf">0.00766284</span><span class="p">,</span>  <span class="mf">0.0114943</span> <span class="p">,</span>  <span class="mf">0.00383142</span><span class="p">,</span>
        <span class="mf">0.0114943</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.00383142</span><span class="p">,</span>  <span class="mf">0.00383142</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0114943</span> <span class="p">,</span>  <span class="mf">0.00383142</span><span class="p">,</span>
       <span class="o">-</span><span class="mf">0.00383142</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.00383142</span><span class="p">,</span>  <span class="mf">0.0114943</span> <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">0.0114943</span> <span class="p">,</span>
        <span class="mf">0.</span>        <span class="p">,</span> <span class="o">-</span><span class="mf">0.00766284</span><span class="p">,</span>  <span class="mf">0.0153257</span> <span class="p">,</span>  <span class="mf">0.0344828</span> <span class="p">,</span>  <span class="mf">0.0613027</span> <span class="p">,</span>
        <span class="mf">0.0804598</span> <span class="p">,</span>  <span class="mf">0.0957854</span> <span class="p">,</span>  <span class="mf">0.0766284</span> <span class="p">,</span>  <span class="mf">0.0536398</span> <span class="p">,</span>  <span class="mf">0.00766284</span><span class="p">,</span>
       <span class="o">-</span><span class="mf">0.0498084</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.10728</span>   <span class="p">,</span> <span class="o">-</span><span class="mf">0.206897</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.329502</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.475096</span>  <span class="p">,</span>
       <span class="o">-</span><span class="mf">0.59387</span>   <span class="p">,</span> <span class="o">-</span><span class="mf">0.670498</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.624521</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.563218</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.43295</span>   <span class="p">,</span>
       <span class="o">-</span><span class="mf">0.498084</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.363985</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.32567</span>   <span class="p">,</span> <span class="o">-</span><span class="mf">0.302682</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.32567</span>   <span class="p">,</span>
       <span class="o">-</span><span class="mf">0.409962</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.555556</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.670498</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.578544</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.528736</span>  <span class="p">,</span>
       <span class="o">-</span><span class="mf">0.467433</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.40613</span>   <span class="p">,</span> <span class="o">-</span><span class="mf">0.340996</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.283525</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.237548</span>  <span class="p">,</span>
       <span class="o">-</span><span class="mf">0.1341</span>    <span class="p">,</span> <span class="o">-</span><span class="mf">0.191571</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.0727969</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.0268199</span> <span class="p">,</span>  <span class="mf">0.00766284</span><span class="p">,</span>
        <span class="mf">0.0191571</span> <span class="p">,</span>  <span class="mf">0.0114943</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.0306513</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.114943</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.241379</span>  <span class="p">,</span>
       <span class="o">-</span><span class="mf">0.383142</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.505747</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.597701</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.632184</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.601533</span>  <span class="p">,</span>
       <span class="o">-</span><span class="mf">0.501916</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.467433</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.398467</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.35249</span>   <span class="p">,</span> <span class="o">-</span><span class="mf">0.318008</span>  <span class="p">,</span>
       <span class="o">-</span><span class="mf">0.344828</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.390805</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.475096</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.59387</span>   <span class="p">,</span> <span class="o">-</span><span class="mf">0.701149</span>  <span class="p">,</span>
       <span class="o">-</span><span class="mf">0.747126</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.708812</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.651341</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.59387</span>   <span class="p">,</span> <span class="o">-</span><span class="mf">0.528736</span>  <span class="p">,</span>
       <span class="o">-</span><span class="mf">0.448276</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.371648</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.298851</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.275862</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.233716</span>  <span class="p">,</span>
       <span class="o">-</span><span class="mf">0.1341</span>    <span class="p">,</span> <span class="o">-</span><span class="mf">0.191571</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.0957854</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.0727969</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.045977</span>  <span class="p">,</span>
       <span class="o">-</span><span class="mf">0.0114943</span> <span class="p">,</span>  <span class="mf">0.0114943</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.00383142</span><span class="p">,</span>  <span class="mf">0.00766284</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.00766284</span><span class="p">,</span>
       <span class="o">-</span><span class="mf">0.0114943</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.00383142</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0153257</span> <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span> <span class="o">-</span><span class="mf">0.00766284</span><span class="p">,</span>
       <span class="o">-</span><span class="mf">0.0114943</span> <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span> <span class="o">-</span><span class="mf">0.0153257</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.0153257</span> <span class="p">,</span>
        <span class="mf">0.0114943</span> <span class="p">,</span>  <span class="mf">0.0153257</span> <span class="p">,</span>  <span class="mf">0.0268199</span> <span class="p">,</span>  <span class="mf">0.0536398</span> <span class="p">,</span>  <span class="mf">0.0881226</span> <span class="p">,</span>
        <span class="mf">0.0881226</span> <span class="p">,</span>  <span class="mf">0.0766284</span> <span class="p">,</span>  <span class="mf">0.0613027</span> <span class="p">,</span>  <span class="mf">0.0383142</span> <span class="p">,</span>  <span class="mf">0.00766284</span><span class="p">,</span>
       <span class="o">-</span><span class="mf">0.045977</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.111111</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.206897</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.340996</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.455939</span>  <span class="p">,</span>
       <span class="o">-</span><span class="mf">0.555556</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.590038</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.563218</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.45977</span>   <span class="p">,</span> <span class="o">-</span><span class="mf">0.521073</span>  <span class="p">,</span>
       <span class="o">-</span><span class="mf">0.37931</span>   <span class="p">,</span> <span class="o">-</span><span class="mf">0.32567</span>   <span class="p">,</span> <span class="o">-</span><span class="mf">0.287356</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.306513</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.35249</span>   <span class="p">,</span>
       <span class="o">-</span><span class="mf">0.452107</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.590038</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.655172</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.678161</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.651341</span>  <span class="p">,</span>
       <span class="o">-</span><span class="mf">0.59387</span>   <span class="p">,</span> <span class="o">-</span><span class="mf">0.524904</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.467433</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.409962</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.35249</span>   <span class="p">,</span>
       <span class="o">-</span><span class="mf">0.279693</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.214559</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.164751</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.118774</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.0651341</span> <span class="p">,</span>
       <span class="o">-</span><span class="mf">0.00766284</span><span class="p">,</span>  <span class="mf">0.0191571</span> <span class="p">,</span>  <span class="mf">0.0727969</span> <span class="p">,</span>  <span class="mf">0.0613027</span> <span class="p">,</span>  <span class="mf">0.0191571</span> <span class="p">,</span>
       <span class="o">-</span><span class="mf">0.0536398</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.126437</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.187739</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.272031</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.409962</span>  <span class="p">,</span>
       <span class="o">-</span><span class="mf">0.494253</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.59387</span>   <span class="p">,</span> <span class="o">-</span><span class="mf">0.643678</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.498084</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.409962</span>  <span class="p">,</span>
       <span class="o">-</span><span class="mf">0.337165</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.306513</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.337165</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.360153</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.417625</span>  <span class="p">,</span>
       <span class="o">-</span><span class="mf">0.521073</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.639847</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.735632</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.747126</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.704981</span>  <span class="p">,</span>
       <span class="o">-</span><span class="mf">0.632184</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.582375</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.532567</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.45977</span>   <span class="p">,</span> <span class="o">-</span><span class="mf">0.402299</span>  <span class="p">,</span>
       <span class="o">-</span><span class="mf">0.302682</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.360153</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.264368</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.233716</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.183908</span>  <span class="p">,</span>
       <span class="o">-</span><span class="mf">0.137931</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.0957854</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.0651341</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.0421456</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.0191571</span> <span class="p">,</span>
        <span class="mf">0.00383142</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0114943</span> <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span> <span class="o">-</span><span class="mf">0.0268199</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.0114943</span> <span class="p">,</span>
       <span class="o">-</span><span class="mf">0.0268199</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.0114943</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.0229885</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.00383142</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0191571</span> <span class="p">,</span>
       <span class="o">-</span><span class="mf">0.0114943</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.0229885</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.0153257</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.00383142</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0114943</span> <span class="p">,</span>
       <span class="o">-</span><span class="mf">0.0229885</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.0268199</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.0344828</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.0268199</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.0153257</span> <span class="p">,</span>
        <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">0.0229885</span> <span class="p">,</span>  <span class="mf">0.0498084</span> <span class="p">,</span>  <span class="mf">0.0842912</span> <span class="p">,</span>  <span class="mf">0.0957854</span> <span class="p">,</span>
        <span class="mf">0.0498084</span> <span class="p">,</span>  <span class="mf">0.0114943</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.0268199</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.0842912</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.157088</span>  <span class="p">,</span>
       <span class="o">-</span><span class="mf">0.291188</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.467433</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.601533</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.666667</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.636015</span>  <span class="p">,</span>
       <span class="o">-</span><span class="mf">0.590038</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.54023</span>   <span class="p">,</span> <span class="o">-</span><span class="mf">0.48659</span>   <span class="p">,</span> <span class="o">-</span><span class="mf">0.409962</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.348659</span>  <span class="p">,</span>
       <span class="o">-</span><span class="mf">0.314176</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.310345</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.32567</span>   <span class="p">,</span> <span class="o">-</span><span class="mf">0.37931</span>   <span class="p">,</span> <span class="o">-</span><span class="mf">0.478927</span>  <span class="p">,</span>
       <span class="o">-</span><span class="mf">0.613027</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.689655</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.651341</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.59387</span>   <span class="p">,</span> <span class="o">-</span><span class="mf">0.54023</span>   <span class="p">,</span>
       <span class="o">-</span><span class="mf">0.471264</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.394636</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.321839</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.268199</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.226054</span>  <span class="p">,</span>
       <span class="o">-</span><span class="mf">0.126437</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.180077</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.0689655</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.0114943</span> <span class="p">,</span>  <span class="mf">0.0344828</span> <span class="p">,</span>
       <span class="o">-</span><span class="mf">0.0153257</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.0766284</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.1341</span>    <span class="p">,</span> <span class="o">-</span><span class="mf">0.183908</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.291188</span>  <span class="p">,</span>
       <span class="o">-</span><span class="mf">0.340996</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.455939</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.570881</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.632184</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.616858</span>  <span class="p">,</span>
       <span class="o">-</span><span class="mf">0.563218</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.509579</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.444444</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.386973</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.344828</span>  <span class="p">,</span>
       <span class="o">-</span><span class="mf">0.306513</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.344828</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.429119</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.551724</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.655172</span>  <span class="p">,</span>
       <span class="o">-</span><span class="mf">0.704981</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.662835</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.639847</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.586207</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.544061</span>  <span class="p">,</span>
       <span class="o">-</span><span class="mf">0.478927</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.402299</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.337165</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.302682</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.279693</span>  <span class="p">,</span>
       <span class="o">-</span><span class="mf">0.241379</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.176245</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.122605</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.0842912</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.0613027</span> <span class="p">,</span>
       <span class="o">-</span><span class="mf">0.0306513</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.00766284</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0191571</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.0191571</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.0229885</span> <span class="p">,</span>
       <span class="o">-</span><span class="mf">0.00766284</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0114943</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.0229885</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.0229885</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.0114943</span> <span class="p">,</span>
       <span class="o">-</span><span class="mf">0.0153257</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.0114943</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.0153257</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.0229885</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.00766284</span><span class="p">,</span>
       <span class="o">-</span><span class="mf">0.0153257</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.00766284</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0153257</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.00766284</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0153257</span> <span class="p">,</span>
        <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">0.0114943</span> <span class="p">,</span>  <span class="mf">0.0268199</span> <span class="p">,</span>  <span class="mf">0.045977</span>  <span class="p">,</span>  <span class="mf">0.0498084</span> <span class="p">,</span>
        <span class="mf">0.0842912</span> <span class="p">,</span>  <span class="mf">0.0996169</span> <span class="p">,</span>  <span class="mf">0.0574713</span> <span class="p">,</span>  <span class="mf">0.0268199</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.00383142</span><span class="p">,</span>
       <span class="o">-</span><span class="mf">0.0344828</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.0881226</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.183908</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.283525</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.482759</span>  <span class="p">,</span>
       <span class="o">-</span><span class="mf">0.605364</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.662835</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.590038</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.62069</span>   <span class="p">,</span> <span class="o">-</span><span class="mf">0.463602</span>  <span class="p">,</span>
       <span class="o">-</span><span class="mf">0.536398</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.386973</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.340996</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.314176</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.32567</span>   <span class="p">,</span>
       <span class="o">-</span><span class="mf">0.386973</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.505747</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.64751</span>   <span class="p">,</span> <span class="o">-</span><span class="mf">0.685824</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.62069</span>   <span class="p">,</span>
       <span class="o">-</span><span class="mf">0.536398</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.448276</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.295019</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.363985</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.252874</span>  <span class="p">,</span>
       <span class="o">-</span><span class="mf">0.210728</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.157088</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.0957854</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.0536398</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.0153257</span> <span class="p">,</span>
        <span class="mf">0.0344828</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.0114943</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.0689655</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.16092</span>   <span class="p">,</span> <span class="o">-</span><span class="mf">0.272031</span>  <span class="p">,</span>
       <span class="o">-</span><span class="mf">0.398467</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.521073</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.586207</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.524904</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.452107</span>  <span class="p">,</span>
       <span class="o">-</span><span class="mf">0.40613</span>   <span class="p">,</span> <span class="o">-</span><span class="mf">0.337165</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.306513</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.32567</span>   <span class="p">,</span> <span class="o">-</span><span class="mf">0.363985</span>  <span class="p">,</span>
       <span class="o">-</span><span class="mf">0.448276</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.563218</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.67433</span>   <span class="p">,</span> <span class="o">-</span><span class="mf">0.754789</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.64751</span>   <span class="p">,</span>
       <span class="o">-</span><span class="mf">0.716475</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.559387</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.40613</span>   <span class="p">,</span> <span class="o">-</span><span class="mf">0.475096</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.306513</span>  <span class="p">,</span>
       <span class="o">-</span><span class="mf">0.356322</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.260536</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.203065</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.145594</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.10728</span>   <span class="p">,</span>
       <span class="o">-</span><span class="mf">0.0766284</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.0421456</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.0191571</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.00383142</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.00383142</span><span class="p">,</span>
       <span class="o">-</span><span class="mf">0.0229885</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.0153257</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.0229885</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.0114943</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.0268199</span> <span class="p">,</span>
       <span class="o">-</span><span class="mf">0.0229885</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.0344828</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.0229885</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.0268199</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.0229885</span> <span class="p">,</span>
       <span class="o">-</span><span class="mf">0.00766284</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0153257</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.0153257</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.00766284</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0229885</span> <span class="p">,</span>
       <span class="o">-</span><span class="mf">0.00383142</span><span class="p">,</span>  <span class="mf">0.0153257</span> <span class="p">,</span>  <span class="mf">0.0421456</span> <span class="p">,</span>  <span class="mf">0.0651341</span> <span class="p">,</span>  <span class="mf">0.0996169</span> <span class="p">,</span>
        <span class="mf">0.0766284</span> <span class="p">,</span>  <span class="mf">0.0536398</span> <span class="p">,</span>  <span class="mf">0.0153257</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.0344828</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.10728</span>   <span class="p">,</span>
       <span class="o">-</span><span class="mf">0.210728</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.32567</span>   <span class="p">,</span> <span class="o">-</span><span class="mf">0.471264</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.597701</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.693487</span>  <span class="p">,</span>
       <span class="o">-</span><span class="mf">0.639847</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.582375</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.509579</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.386973</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.452107</span>  <span class="p">,</span>
       <span class="o">-</span><span class="mf">0.298851</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.344828</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.417625</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.521073</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.704981</span>  <span class="p">,</span>
       <span class="o">-</span><span class="mf">0.64751</span>   <span class="p">,</span> <span class="o">-</span><span class="mf">0.597701</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.54023</span>   <span class="p">,</span> <span class="o">-</span><span class="mf">0.467433</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.371648</span>  <span class="p">,</span>
       <span class="o">-</span><span class="mf">0.287356</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.222222</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.164751</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.195402</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.122605</span>  <span class="p">,</span>
       <span class="o">-</span><span class="mf">0.0651341</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.0153257</span> <span class="p">,</span>  <span class="mf">0.0191571</span> <span class="p">,</span>  <span class="mf">0.0383142</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.0306513</span> <span class="p">,</span>
       <span class="o">-</span><span class="mf">0.111111</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.206897</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.337165</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.467433</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.570881</span>  <span class="p">,</span>
       <span class="o">-</span><span class="mf">0.613027</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.582375</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.54023</span>   <span class="p">,</span> <span class="o">-</span><span class="mf">0.482759</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.425287</span>  <span class="p">,</span>
       <span class="o">-</span><span class="mf">0.356322</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.390805</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.310345</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.329502</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.360153</span>  <span class="p">,</span>
       <span class="o">-</span><span class="mf">0.43295</span>   <span class="p">,</span> <span class="o">-</span><span class="mf">0.555556</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.67433</span>   <span class="p">,</span> <span class="o">-</span><span class="mf">0.735632</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.639847</span>  <span class="p">,</span>
       <span class="o">-</span><span class="mf">0.574713</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.521073</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.45977</span>   <span class="p">,</span> <span class="o">-</span><span class="mf">0.375479</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.264368</span>  <span class="p">,</span>
       <span class="o">-</span><span class="mf">0.306513</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.237548</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.199234</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.149425</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.0996169</span> <span class="p">,</span>
       <span class="o">-</span><span class="mf">0.0613027</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.0114943</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.0383142</span> <span class="p">,</span>  <span class="mf">0.0114943</span> <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>
       <span class="o">-</span><span class="mf">0.0153257</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.00766284</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0229885</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.0229885</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.0153257</span> <span class="p">,</span>
       <span class="o">-</span><span class="mf">0.0383142</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.0229885</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.0114943</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.00766284</span><span class="p">,</span>  <span class="mf">0.0153257</span> <span class="p">,</span>
        <span class="mf">0.00766284</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.00766284</span><span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span> <span class="o">-</span><span class="mf">0.0114943</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.0114943</span> <span class="p">,</span>
        <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">0.0191571</span> <span class="p">,</span>  <span class="mf">0.0306513</span> <span class="p">,</span>  <span class="mf">0.045977</span>  <span class="p">,</span>  <span class="mf">0.0689655</span> <span class="p">,</span>
        <span class="mf">0.0804598</span> <span class="p">,</span>  <span class="mf">0.0996169</span> <span class="p">,</span>  <span class="mf">0.114943</span>  <span class="p">,</span>  <span class="mf">0.0881226</span> <span class="p">,</span>  <span class="mf">0.0574713</span> <span class="p">,</span>
        <span class="mf">0.0153257</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.0306513</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.0881226</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.172414</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.283525</span>  <span class="p">,</span>
       <span class="o">-</span><span class="mf">0.43295</span>   <span class="p">,</span> <span class="o">-</span><span class="mf">0.586207</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.67433</span>   <span class="p">,</span> <span class="o">-</span><span class="mf">0.609195</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.528736</span>  <span class="p">,</span>
       <span class="o">-</span><span class="mf">0.452107</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.367816</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.40613</span>   <span class="p">,</span> <span class="o">-</span><span class="mf">0.314176</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.268199</span>  <span class="p">,</span>
       <span class="o">-</span><span class="mf">0.298851</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.337165</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.398467</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.48659</span>   <span class="p">,</span> <span class="o">-</span><span class="mf">0.59387</span>   <span class="p">,</span>
       <span class="o">-</span><span class="mf">0.624521</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.586207</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.421456</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.498084</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.544061</span>  <span class="p">,</span>
       <span class="o">-</span><span class="mf">0.35249</span>   <span class="p">,</span> <span class="o">-</span><span class="mf">0.291188</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.252874</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.218391</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.164751</span>  <span class="p">,</span>
       <span class="o">-</span><span class="mf">0.111111</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.0766284</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.0536398</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.0229885</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.00383142</span><span class="p">,</span>
       <span class="o">-</span><span class="mf">0.00766284</span><span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span> <span class="o">-</span><span class="mf">0.0191571</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.00766284</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0114943</span> <span class="p">,</span>
        <span class="mf">0.00383142</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.00766284</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0229885</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.0153257</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.0114943</span> <span class="p">,</span>
       <span class="o">-</span><span class="mf">0.0114943</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.0268199</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.0268199</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.0268199</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.0268199</span> <span class="p">,</span>
       <span class="o">-</span><span class="mf">0.0114943</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.00766284</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0344828</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.0268199</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.00766284</span><span class="p">,</span>
       <span class="o">-</span><span class="mf">0.0191571</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.0191571</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.00766284</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.00766284</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0153257</span> <span class="p">,</span>
       <span class="o">-</span><span class="mf">0.0114943</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.0114943</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.0191571</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.0268199</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.0268199</span> <span class="p">,</span>
       <span class="o">-</span><span class="mf">0.0114943</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.0229885</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.0229885</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.0344828</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.0268199</span> <span class="p">,</span>
       <span class="o">-</span><span class="mf">0.0306513</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.0191571</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.0153257</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.00383142</span><span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>
       <span class="o">-</span><span class="mf">0.00383142</span><span class="p">,</span>  <span class="mf">0.00383142</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.00766284</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.00383142</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.00383142</span><span class="p">,</span>
       <span class="o">-</span><span class="mf">0.0153257</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.0229885</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.0229885</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.0229885</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.0229885</span> <span class="p">,</span>
       <span class="o">-</span><span class="mf">0.0344828</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.0344828</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.0421456</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.045977</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.0306513</span> <span class="p">,</span>
       <span class="o">-</span><span class="mf">0.0306513</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.0383142</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.0306513</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.0268199</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.0268199</span> <span class="p">,</span>
       <span class="o">-</span><span class="mf">0.0344828</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.0229885</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.0383142</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.0229885</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.0306513</span> <span class="p">,</span>
       <span class="o">-</span><span class="mf">0.0229885</span> <span class="p">])</span>

    <span class="n">fig15bot_t_raw</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
      <span class="p">[</span> <span class="mf">0.817702</span><span class="p">,</span>  <span class="mf">0.825628</span><span class="p">,</span>  <span class="mf">0.835535</span><span class="p">,</span>  <span class="mf">0.839498</span><span class="p">,</span>  <span class="mf">0.849406</span><span class="p">,</span>  <span class="mf">0.853369</span><span class="p">,</span>
        <span class="mf">0.863276</span><span class="p">,</span>  <span class="mf">0.869221</span><span class="p">,</span>  <span class="mf">0.879128</span><span class="p">,</span>  <span class="mf">0.891017</span><span class="p">,</span>  <span class="mf">0.896962</span><span class="p">,</span>  <span class="mf">0.910832</span><span class="p">,</span>
        <span class="mf">0.918758</span><span class="p">,</span>  <span class="mf">0.928666</span><span class="p">,</span>  <span class="mf">0.936592</span><span class="p">,</span>  <span class="mf">0.940555</span><span class="p">,</span>  <span class="mf">0.944518</span><span class="p">,</span>  <span class="mf">0.952444</span><span class="p">,</span>
        <span class="mf">0.958389</span><span class="p">,</span>  <span class="mf">0.968296</span><span class="p">,</span>  <span class="mf">0.976222</span><span class="p">,</span>  <span class="mf">0.980185</span><span class="p">,</span>  <span class="mf">0.990093</span><span class="p">,</span>  <span class="mf">0.996037</span><span class="p">,</span>
        <span class="mf">1.00198</span> <span class="p">,</span>  <span class="mf">1.00594</span> <span class="p">,</span>  <span class="mf">1.01189</span> <span class="p">,</span>  <span class="mf">1.01387</span> <span class="p">,</span>  <span class="mf">1.01783</span> <span class="p">,</span>  <span class="mf">1.0218</span>  <span class="p">,</span>
        <span class="mf">1.02576</span> <span class="p">,</span>  <span class="mf">1.02972</span> <span class="p">,</span>  <span class="mf">1.0317</span>  <span class="p">,</span>  <span class="mf">1.03567</span> <span class="p">,</span>  <span class="mf">1.03765</span> <span class="p">,</span>  <span class="mf">1.04161</span> <span class="p">,</span>
        <span class="mf">1.04557</span> <span class="p">,</span>  <span class="mf">1.04954</span> <span class="p">,</span>  <span class="mf">1.0535</span>  <span class="p">,</span>  <span class="mf">1.05548</span> <span class="p">,</span>  <span class="mf">1.06341</span> <span class="p">,</span>  <span class="mf">1.06737</span> <span class="p">,</span>
        <span class="mf">1.07133</span> <span class="p">,</span>  <span class="mf">1.0753</span>  <span class="p">,</span>  <span class="mf">1.07728</span> <span class="p">,</span>  <span class="mf">1.07926</span> <span class="p">,</span>  <span class="mf">1.08124</span> <span class="p">,</span>  <span class="mf">1.0852</span>  <span class="p">,</span>
        <span class="mf">1.09115</span> <span class="p">,</span>  <span class="mf">1.09511</span> <span class="p">,</span>  <span class="mf">1.09709</span> <span class="p">,</span>  <span class="mf">1.10106</span> <span class="p">,</span>  <span class="mf">1.10304</span> <span class="p">,</span>  <span class="mf">1.10502</span> <span class="p">,</span>
        <span class="mf">1.10898</span> <span class="p">,</span>  <span class="mf">1.12087</span> <span class="p">,</span>  <span class="mf">1.13276</span> <span class="p">,</span>  <span class="mf">1.13871</span> <span class="p">,</span>  <span class="mf">1.14663</span> <span class="p">,</span>  <span class="mf">1.1605</span>  <span class="p">,</span>
        <span class="mf">1.16645</span> <span class="p">,</span>  <span class="mf">1.17041</span> <span class="p">,</span>  <span class="mf">1.17834</span> <span class="p">,</span>  <span class="mf">1.18626</span> <span class="p">,</span>  <span class="mf">1.19815</span> <span class="p">,</span>  <span class="mf">1.20608</span> <span class="p">,</span>
        <span class="mf">1.21797</span> <span class="p">,</span>  <span class="mf">1.22985</span> <span class="p">,</span>  <span class="mf">1.24174</span> <span class="p">,</span>  <span class="mf">1.25165</span> <span class="p">,</span>  <span class="mf">1.26552</span> <span class="p">,</span>  <span class="mf">1.27345</span> <span class="p">,</span>
        <span class="mf">1.28336</span> <span class="p">,</span>  <span class="mf">1.29326</span> <span class="p">,</span>  <span class="mf">1.30119</span> <span class="p">,</span>  <span class="mf">1.30713</span> <span class="p">,</span>  <span class="mf">1.31506</span> <span class="p">,</span>  <span class="mf">1.31902</span> <span class="p">,</span>
        <span class="mf">1.321</span>   <span class="p">,</span>  <span class="mf">1.32497</span> <span class="p">,</span>  <span class="mf">1.32695</span> <span class="p">,</span>  <span class="mf">1.33091</span> <span class="p">,</span>  <span class="mf">1.33686</span> <span class="p">,</span>  <span class="mf">1.33884</span> <span class="p">,</span>
        <span class="mf">1.3428</span>  <span class="p">,</span>  <span class="mf">1.34478</span> <span class="p">,</span>  <span class="mf">1.35073</span> <span class="p">,</span>  <span class="mf">1.35667</span> <span class="p">,</span>  <span class="mf">1.35865</span> <span class="p">,</span>  <span class="mf">1.36063</span> <span class="p">,</span>
        <span class="mf">1.36262</span> <span class="p">,</span>  <span class="mf">1.36658</span> <span class="p">,</span>  <span class="mf">1.37252</span> <span class="p">,</span>  <span class="mf">1.37649</span> <span class="p">,</span>  <span class="mf">1.37847</span> <span class="p">,</span>  <span class="mf">1.38243</span> <span class="p">,</span>
        <span class="mf">1.38639</span> <span class="p">,</span>  <span class="mf">1.38838</span> <span class="p">,</span>  <span class="mf">1.38838</span> <span class="p">,</span>  <span class="mf">1.39432</span> <span class="p">,</span>  <span class="mf">1.39828</span> <span class="p">,</span>  <span class="mf">1.40225</span> <span class="p">,</span>
        <span class="mf">1.40423</span> <span class="p">,</span>  <span class="mf">1.40621</span> <span class="p">,</span>  <span class="mf">1.41017</span> <span class="p">,</span>  <span class="mf">1.41414</span> <span class="p">,</span>  <span class="mf">1.41612</span> <span class="p">,</span>  <span class="mf">1.42008</span> <span class="p">,</span>
        <span class="mf">1.42206</span> <span class="p">,</span>  <span class="mf">1.42602</span> <span class="p">,</span>  <span class="mf">1.43197</span> <span class="p">,</span>  <span class="mf">1.43395</span> <span class="p">,</span>  <span class="mf">1.43989</span> <span class="p">,</span>  <span class="mf">1.44584</span> <span class="p">,</span>
        <span class="mf">1.44782</span> <span class="p">,</span>  <span class="mf">1.4498</span>  <span class="p">,</span>  <span class="mf">1.45178</span> <span class="p">,</span>  <span class="mf">1.45377</span> <span class="p">,</span>  <span class="mf">1.45773</span> <span class="p">,</span>  <span class="mf">1.45971</span> <span class="p">,</span>
        <span class="mf">1.46367</span> <span class="p">,</span>  <span class="mf">1.46764</span> <span class="p">,</span>  <span class="mf">1.46962</span> <span class="p">,</span>  <span class="mf">1.4716</span>  <span class="p">,</span>  <span class="mf">1.47358</span> <span class="p">,</span>  <span class="mf">1.47754</span> <span class="p">,</span>
        <span class="mf">1.47952</span> <span class="p">,</span>  <span class="mf">1.48349</span> <span class="p">,</span>  <span class="mf">1.48745</span> <span class="p">,</span>  <span class="mf">1.48943</span> <span class="p">,</span>  <span class="mf">1.49736</span> <span class="p">,</span>  <span class="mf">1.50132</span> <span class="p">,</span>
        <span class="mf">1.5033</span>  <span class="p">,</span>  <span class="mf">1.50727</span> <span class="p">,</span>  <span class="mf">1.51321</span> <span class="p">,</span>  <span class="mf">1.51519</span> <span class="p">,</span>  <span class="mf">1.51717</span> <span class="p">,</span>  <span class="mf">1.52114</span> <span class="p">,</span>
        <span class="mf">1.52312</span> <span class="p">,</span>  <span class="mf">1.5251</span>  <span class="p">,</span>  <span class="mf">1.52906</span> <span class="p">,</span>  <span class="mf">1.53303</span> <span class="p">,</span>  <span class="mf">1.53501</span> <span class="p">,</span>  <span class="mf">1.54293</span> <span class="p">,</span>
        <span class="mf">1.55284</span> <span class="p">,</span>  <span class="mf">1.56275</span> <span class="p">,</span>  <span class="mf">1.56869</span> <span class="p">,</span>  <span class="mf">1.5786</span>  <span class="p">,</span>  <span class="mf">1.58454</span> <span class="p">,</span>  <span class="mf">1.58851</span> <span class="p">,</span>
        <span class="mf">1.59247</span> <span class="p">,</span>  <span class="mf">1.59842</span> <span class="p">,</span>  <span class="mf">1.6103</span>  <span class="p">,</span>  <span class="mf">1.61427</span> <span class="p">,</span>  <span class="mf">1.62219</span> <span class="p">,</span>  <span class="mf">1.62814</span> <span class="p">,</span>
        <span class="mf">1.63805</span> <span class="p">,</span>  <span class="mf">1.65192</span> <span class="p">,</span>  <span class="mf">1.66182</span> <span class="p">,</span>  <span class="mf">1.66975</span> <span class="p">,</span>  <span class="mf">1.67569</span> <span class="p">,</span>  <span class="mf">1.67768</span> <span class="p">,</span>
        <span class="mf">1.68164</span> <span class="p">,</span>  <span class="mf">1.6856</span>  <span class="p">,</span>  <span class="mf">1.69353</span> <span class="p">,</span>  <span class="mf">1.69551</span> <span class="p">,</span>  <span class="mf">1.70344</span> <span class="p">,</span>  <span class="mf">1.71136</span> <span class="p">,</span>
        <span class="mf">1.71731</span> <span class="p">,</span>  <span class="mf">1.71929</span> <span class="p">,</span>  <span class="mf">1.72127</span> <span class="p">,</span>  <span class="mf">1.72523</span> <span class="p">,</span>  <span class="mf">1.73118</span> <span class="p">,</span>  <span class="mf">1.7391</span>  <span class="p">,</span>
        <span class="mf">1.74307</span> <span class="p">,</span>  <span class="mf">1.74703</span> <span class="p">,</span>  <span class="mf">1.74901</span> <span class="p">,</span>  <span class="mf">1.75297</span> <span class="p">,</span>  <span class="mf">1.75495</span> <span class="p">,</span>  <span class="mf">1.75694</span> <span class="p">,</span>
        <span class="mf">1.7609</span>  <span class="p">,</span>  <span class="mf">1.76486</span> <span class="p">,</span>  <span class="mf">1.76882</span> <span class="p">,</span>  <span class="mf">1.77279</span> <span class="p">,</span>  <span class="mf">1.77477</span> <span class="p">,</span>  <span class="mf">1.7827</span>  <span class="p">,</span>
        <span class="mf">1.78468</span> <span class="p">,</span>  <span class="mf">1.78864</span> <span class="p">,</span>  <span class="mf">1.7926</span>  <span class="p">,</span>  <span class="mf">1.79458</span> <span class="p">,</span>  <span class="mf">1.80449</span> <span class="p">,</span>  <span class="mf">1.80647</span> <span class="p">,</span>
        <span class="mf">1.80845</span> <span class="p">,</span>  <span class="mf">1.81242</span> <span class="p">,</span>  <span class="mf">1.8144</span>  <span class="p">,</span>  <span class="mf">1.82034</span> <span class="p">,</span>  <span class="mf">1.82431</span> <span class="p">,</span>  <span class="mf">1.82629</span> <span class="p">,</span>
        <span class="mf">1.82827</span> <span class="p">,</span>  <span class="mf">1.83223</span> <span class="p">,</span>  <span class="mf">1.8362</span>  <span class="p">,</span>  <span class="mf">1.83818</span> <span class="p">,</span>  <span class="mf">1.84214</span> <span class="p">,</span>  <span class="mf">1.84809</span> <span class="p">,</span>
        <span class="mf">1.85007</span> <span class="p">,</span>  <span class="mf">1.85205</span> <span class="p">,</span>  <span class="mf">1.85799</span> <span class="p">,</span>  <span class="mf">1.86196</span> <span class="p">,</span>  <span class="mf">1.86394</span> <span class="p">,</span>  <span class="mf">1.8679</span>  <span class="p">,</span>
        <span class="mf">1.86988</span> <span class="p">,</span>  <span class="mf">1.87384</span> <span class="p">,</span>  <span class="mf">1.87583</span> <span class="p">,</span>  <span class="mf">1.87979</span> <span class="p">,</span>  <span class="mf">1.88177</span> <span class="p">,</span>  <span class="mf">1.88375</span> <span class="p">,</span>
        <span class="mf">1.8897</span>  <span class="p">,</span>  <span class="mf">1.89366</span> <span class="p">,</span>  <span class="mf">1.89762</span> <span class="p">,</span>  <span class="mf">1.90159</span> <span class="p">,</span>  <span class="mf">1.90753</span> <span class="p">,</span>  <span class="mf">1.91149</span> <span class="p">,</span>
        <span class="mf">1.91347</span> <span class="p">,</span>  <span class="mf">1.91546</span> <span class="p">,</span>  <span class="mf">1.91942</span> <span class="p">,</span>  <span class="mf">1.92536</span> <span class="p">,</span>  <span class="mf">1.92735</span> <span class="p">,</span>  <span class="mf">1.93725</span> <span class="p">,</span>
        <span class="mf">1.93923</span> <span class="p">,</span>  <span class="mf">1.94122</span> <span class="p">,</span>  <span class="mf">1.9432</span>  <span class="p">,</span>  <span class="mf">1.94518</span> <span class="p">,</span>  <span class="mf">1.94914</span> <span class="p">,</span>  <span class="mf">1.95112</span> <span class="p">,</span>
        <span class="mf">1.95509</span> <span class="p">,</span>  <span class="mf">1.95707</span> <span class="p">,</span>  <span class="mf">1.96103</span> <span class="p">,</span>  <span class="mf">1.96499</span> <span class="p">,</span>  <span class="mf">1.96698</span> <span class="p">,</span>  <span class="mf">1.97292</span> <span class="p">,</span>
        <span class="mf">1.97886</span> <span class="p">,</span>  <span class="mf">1.99075</span> <span class="p">,</span>  <span class="mf">1.9967</span>  <span class="p">,</span>  <span class="mf">2.00462</span> <span class="p">,</span>  <span class="mf">2.01057</span> <span class="p">,</span>  <span class="mf">2.01453</span> <span class="p">,</span>
        <span class="mf">2.02642</span> <span class="p">,</span>  <span class="mf">2.03237</span> <span class="p">,</span>  <span class="mf">2.03633</span> <span class="p">,</span>  <span class="mf">2.04227</span> <span class="p">,</span>  <span class="mf">2.05614</span> <span class="p">,</span>  <span class="mf">2.07001</span> <span class="p">,</span>
        <span class="mf">2.07596</span> <span class="p">,</span>  <span class="mf">2.08587</span> <span class="p">,</span>  <span class="mf">2.1037</span>  <span class="p">,</span>  <span class="mf">2.11757</span> <span class="p">,</span>  <span class="mf">2.12946</span> <span class="p">,</span>  <span class="mf">2.1354</span>  <span class="p">,</span>
        <span class="mf">2.14333</span> <span class="p">,</span>  <span class="mf">2.14927</span> <span class="p">,</span>  <span class="mf">2.15918</span> <span class="p">,</span>  <span class="mf">2.16314</span> <span class="p">,</span>  <span class="mf">2.16711</span> <span class="p">,</span>  <span class="mf">2.16909</span> <span class="p">,</span>
        <span class="mf">2.17305</span> <span class="p">,</span>  <span class="mf">2.17702</span> <span class="p">,</span>  <span class="mf">2.18098</span> <span class="p">,</span>  <span class="mf">2.18296</span> <span class="p">,</span>  <span class="mf">2.18494</span> <span class="p">,</span>  <span class="mf">2.18692</span> <span class="p">,</span>
        <span class="mf">2.19089</span> <span class="p">,</span>  <span class="mf">2.19485</span> <span class="p">,</span>  <span class="mf">2.19683</span> <span class="p">,</span>  <span class="mf">2.20079</span> <span class="p">,</span>  <span class="mf">2.20476</span> <span class="p">,</span>  <span class="mf">2.20674</span> <span class="p">,</span>
        <span class="mf">2.20872</span> <span class="p">,</span>  <span class="mf">2.21268</span> <span class="p">,</span>  <span class="mf">2.22061</span> <span class="p">,</span>  <span class="mf">2.22457</span> <span class="p">,</span>  <span class="mf">2.22655</span> <span class="p">,</span>  <span class="mf">2.23052</span> <span class="p">,</span>
        <span class="mf">2.23646</span> <span class="p">,</span>  <span class="mf">2.24042</span> <span class="p">,</span>  <span class="mf">2.24439</span> <span class="p">,</span>  <span class="mf">2.24637</span> <span class="p">,</span>  <span class="mf">2.24835</span> <span class="p">,</span>  <span class="mf">2.25231</span> <span class="p">,</span>
        <span class="mf">2.25628</span> <span class="p">,</span>  <span class="mf">2.26024</span> <span class="p">,</span>  <span class="mf">2.26222</span> <span class="p">,</span>  <span class="mf">2.2642</span>  <span class="p">,</span>  <span class="mf">2.26816</span> <span class="p">,</span>  <span class="mf">2.27411</span> <span class="p">,</span>
        <span class="mf">2.27807</span> <span class="p">,</span>  <span class="mf">2.28005</span> <span class="p">,</span>  <span class="mf">2.28402</span> <span class="p">,</span>  <span class="mf">2.286</span>   <span class="p">,</span>  <span class="mf">2.29591</span> <span class="p">,</span>  <span class="mf">2.29987</span> <span class="p">,</span>
        <span class="mf">2.30185</span> <span class="p">,</span>  <span class="mf">2.30383</span> <span class="p">,</span>  <span class="mf">2.30779</span> <span class="p">,</span>  <span class="mf">2.31176</span> <span class="p">,</span>  <span class="mf">2.3177</span>  <span class="p">,</span>  <span class="mf">2.32167</span> <span class="p">,</span>
        <span class="mf">2.32365</span> <span class="p">,</span>  <span class="mf">2.32563</span> <span class="p">,</span>  <span class="mf">2.33554</span> <span class="p">,</span>  <span class="mf">2.33752</span> <span class="p">,</span>  <span class="mf">2.34148</span> <span class="p">,</span>  <span class="mf">2.34346</span> <span class="p">,</span>
        <span class="mf">2.34544</span> <span class="p">,</span>  <span class="mf">2.34941</span> <span class="p">,</span>  <span class="mf">2.35337</span> <span class="p">,</span>  <span class="mf">2.3613</span>  <span class="p">,</span>  <span class="mf">2.36526</span> <span class="p">,</span>  <span class="mf">2.36922</span> <span class="p">,</span>
        <span class="mf">2.3712</span>  <span class="p">,</span>  <span class="mf">2.37318</span> <span class="p">,</span>  <span class="mf">2.37517</span> <span class="p">,</span>  <span class="mf">2.37913</span> <span class="p">,</span>  <span class="mf">2.38507</span> <span class="p">,</span>  <span class="mf">2.38705</span> <span class="p">,</span>
        <span class="mf">2.39102</span> <span class="p">,</span>  <span class="mf">2.39696</span> <span class="p">,</span>  <span class="mf">2.40291</span> <span class="p">,</span>  <span class="mf">2.41083</span> <span class="p">,</span>  <span class="mf">2.4148</span>  <span class="p">,</span>  <span class="mf">2.42669</span> <span class="p">,</span>
        <span class="mf">2.43263</span> <span class="p">,</span>  <span class="mf">2.43857</span> <span class="p">,</span>  <span class="mf">2.45046</span> <span class="p">,</span>  <span class="mf">2.4683</span>  <span class="p">,</span>  <span class="mf">2.48019</span> <span class="p">,</span>  <span class="mf">2.48613</span> <span class="p">,</span>
        <span class="mf">2.5</span>     <span class="p">,</span>  <span class="mf">2.50396</span> <span class="p">,</span>  <span class="mf">2.51387</span> <span class="p">,</span>  <span class="mf">2.5218</span>  <span class="p">,</span>  <span class="mf">2.52972</span> <span class="p">,</span>  <span class="mf">2.54161</span> <span class="p">,</span>
        <span class="mf">2.55152</span> <span class="p">,</span>  <span class="mf">2.56539</span> <span class="p">,</span>  <span class="mf">2.5753</span>  <span class="p">,</span>  <span class="mf">2.58322</span> <span class="p">,</span>  <span class="mf">2.58917</span> <span class="p">,</span>  <span class="mf">2.59313</span> <span class="p">,</span>
        <span class="mf">2.59709</span> <span class="p">,</span>  <span class="mf">2.60304</span> <span class="p">,</span>  <span class="mf">2.60502</span> <span class="p">,</span>  <span class="mf">2.607</span>   <span class="p">,</span>  <span class="mf">2.60898</span> <span class="p">,</span>  <span class="mf">2.61295</span> <span class="p">,</span>
        <span class="mf">2.61493</span> <span class="p">,</span>  <span class="mf">2.61691</span> <span class="p">,</span>  <span class="mf">2.62087</span> <span class="p">,</span>  <span class="mf">2.62682</span> <span class="p">,</span>  <span class="mf">2.6288</span>  <span class="p">,</span>  <span class="mf">2.63078</span> <span class="p">,</span>
        <span class="mf">2.63474</span> <span class="p">,</span>  <span class="mf">2.63672</span> <span class="p">,</span>  <span class="mf">2.64267</span> <span class="p">,</span>  <span class="mf">2.64663</span> <span class="p">,</span>  <span class="mf">2.6506</span>  <span class="p">,</span>  <span class="mf">2.65258</span> <span class="p">,</span>
        <span class="mf">2.65852</span> <span class="p">,</span>  <span class="mf">2.66248</span> <span class="p">,</span>  <span class="mf">2.66645</span> <span class="p">,</span>  <span class="mf">2.67239</span> <span class="p">,</span>  <span class="mf">2.67635</span> <span class="p">,</span>  <span class="mf">2.67834</span> <span class="p">,</span>
        <span class="mf">2.6823</span>  <span class="p">,</span>  <span class="mf">2.68428</span> <span class="p">,</span>  <span class="mf">2.68626</span> <span class="p">,</span>  <span class="mf">2.69023</span> <span class="p">,</span>  <span class="mf">2.69419</span> <span class="p">,</span>  <span class="mf">2.70013</span> <span class="p">,</span>
        <span class="mf">2.70211</span> <span class="p">,</span>  <span class="mf">2.7041</span>  <span class="p">,</span>  <span class="mf">2.70608</span> <span class="p">,</span>  <span class="mf">2.71202</span> <span class="p">,</span>  <span class="mf">2.71797</span> <span class="p">,</span>  <span class="mf">2.71995</span> <span class="p">,</span>
        <span class="mf">2.72193</span> <span class="p">,</span>  <span class="mf">2.72787</span> <span class="p">,</span>  <span class="mf">2.72986</span> <span class="p">,</span>  <span class="mf">2.73382</span> <span class="p">,</span>  <span class="mf">2.74174</span> <span class="p">,</span>  <span class="mf">2.74571</span> <span class="p">,</span>
        <span class="mf">2.74571</span> <span class="p">,</span>  <span class="mf">2.74967</span> <span class="p">,</span>  <span class="mf">2.7576</span>  <span class="p">,</span>  <span class="mf">2.76354</span> <span class="p">,</span>  <span class="mf">2.7675</span>  <span class="p">,</span>  <span class="mf">2.7675</span>  <span class="p">,</span>
        <span class="mf">2.77147</span> <span class="p">,</span>  <span class="mf">2.77345</span> <span class="p">,</span>  <span class="mf">2.77741</span> <span class="p">,</span>  <span class="mf">2.78336</span> <span class="p">,</span>  <span class="mf">2.78732</span> <span class="p">,</span>  <span class="mf">2.7893</span>  <span class="p">,</span>
        <span class="mf">2.79128</span> <span class="p">,</span>  <span class="mf">2.79525</span> <span class="p">,</span>  <span class="mf">2.79723</span> <span class="p">,</span>  <span class="mf">2.80119</span> <span class="p">,</span>  <span class="mf">2.80317</span> <span class="p">,</span>  <span class="mf">2.80515</span> <span class="p">,</span>
        <span class="mf">2.81902</span> <span class="p">,</span>  <span class="mf">2.82893</span> <span class="p">,</span>  <span class="mf">2.83289</span> <span class="p">,</span>  <span class="mf">2.8428</span>  <span class="p">,</span>  <span class="mf">2.85469</span> <span class="p">,</span>  <span class="mf">2.8646</span>  <span class="p">,</span>
        <span class="mf">2.87054</span> <span class="p">,</span>  <span class="mf">2.87252</span> <span class="p">,</span>  <span class="mf">2.87847</span> <span class="p">,</span>  <span class="mf">2.88243</span> <span class="p">,</span>  <span class="mf">2.88838</span> <span class="p">,</span>  <span class="mf">2.89432</span> <span class="p">,</span>
        <span class="mf">2.89828</span> <span class="p">,</span>  <span class="mf">2.90423</span> <span class="p">,</span>  <span class="mf">2.90819</span> <span class="p">,</span>  <span class="mf">2.91414</span> <span class="p">,</span>  <span class="mf">2.92206</span> <span class="p">,</span>  <span class="mf">2.92404</span> <span class="p">,</span>
        <span class="mf">2.9399</span>  <span class="p">,</span>  <span class="mf">2.94584</span> <span class="p">,</span>  <span class="mf">2.95178</span> <span class="p">,</span>  <span class="mf">2.95971</span> <span class="p">,</span>  <span class="mf">2.96962</span> <span class="p">,</span>  <span class="mf">2.97358</span> <span class="p">,</span>
        <span class="mf">2.98745</span> <span class="p">,</span>  <span class="mf">2.99538</span> <span class="p">,</span>  <span class="mf">3.00132</span> <span class="p">,</span>  <span class="mf">3.00529</span> <span class="p">,</span>  <span class="mf">3.01321</span> <span class="p">,</span>  <span class="mf">3.01519</span> <span class="p">,</span>
        <span class="mf">3.01916</span> <span class="p">,</span>  <span class="mf">3.02114</span> <span class="p">,</span>  <span class="mf">3.0251</span>  <span class="p">,</span>  <span class="mf">3.02708</span> <span class="p">,</span>  <span class="mf">3.03104</span> <span class="p">,</span>  <span class="mf">3.03501</span> <span class="p">,</span>
        <span class="mf">3.03699</span> <span class="p">,</span>  <span class="mf">3.03897</span> <span class="p">,</span>  <span class="mf">3.04293</span> <span class="p">,</span>  <span class="mf">3.05086</span> <span class="p">,</span>  <span class="mf">3.05284</span> <span class="p">,</span>  <span class="mf">3.0568</span>  <span class="p">,</span>
        <span class="mf">3.05879</span> <span class="p">,</span>  <span class="mf">3.06077</span> <span class="p">,</span>  <span class="mf">3.06671</span> <span class="p">,</span>  <span class="mf">3.07067</span> <span class="p">,</span>  <span class="mf">3.07266</span> <span class="p">,</span>  <span class="mf">3.07464</span> <span class="p">,</span>
        <span class="mf">3.08058</span> <span class="p">,</span>  <span class="mf">3.08653</span> <span class="p">,</span>  <span class="mf">3.08851</span> <span class="p">,</span>  <span class="mf">3.09643</span> <span class="p">,</span>  <span class="mf">3.09842</span> <span class="p">,</span>  <span class="mf">3.1004</span>  <span class="p">,</span>
        <span class="mf">3.10238</span> <span class="p">,</span>  <span class="mf">3.10436</span> <span class="p">,</span>  <span class="mf">3.10832</span> <span class="p">,</span>  <span class="mf">3.1103</span>  <span class="p">,</span>  <span class="mf">3.11625</span> <span class="p">,</span>  <span class="mf">3.12418</span> <span class="p">,</span>
        <span class="mf">3.12814</span> <span class="p">,</span>  <span class="mf">3.13012</span> <span class="p">,</span>  <span class="mf">3.13408</span> <span class="p">,</span>  <span class="mf">3.13606</span> <span class="p">,</span>  <span class="mf">3.14399</span> <span class="p">,</span>  <span class="mf">3.14795</span> <span class="p">,</span>
        <span class="mf">3.14994</span> <span class="p">,</span>  <span class="mf">3.1539</span>  <span class="p">,</span>  <span class="mf">3.15588</span> <span class="p">,</span>  <span class="mf">3.16579</span> <span class="p">,</span>  <span class="mf">3.16777</span> <span class="p">,</span>  <span class="mf">3.16975</span> <span class="p">,</span>
        <span class="mf">3.17768</span> <span class="p">,</span>  <span class="mf">3.18362</span> <span class="p">,</span>  <span class="mf">3.18758</span> <span class="p">,</span>  <span class="mf">3.19155</span> <span class="p">,</span>  <span class="mf">3.19749</span> <span class="p">,</span>  <span class="mf">3.19749</span> <span class="p">,</span>
        <span class="mf">3.20542</span> <span class="p">,</span>  <span class="mf">3.20938</span> <span class="p">,</span>  <span class="mf">3.21136</span> <span class="p">,</span>  <span class="mf">3.21334</span> <span class="p">,</span>  <span class="mf">3.21731</span> <span class="p">,</span>  <span class="mf">3.21929</span> <span class="p">,</span>
        <span class="mf">3.22325</span> <span class="p">,</span>  <span class="mf">3.22523</span> <span class="p">,</span>  <span class="mf">3.22721</span> <span class="p">,</span>  <span class="mf">3.2292</span>  <span class="p">,</span>  <span class="mf">3.2391</span>  <span class="p">,</span>  <span class="mf">3.24505</span> <span class="p">,</span>
        <span class="mf">3.25099</span> <span class="p">,</span>  <span class="mf">3.26486</span> <span class="p">,</span>  <span class="mf">3.27081</span> <span class="p">,</span>  <span class="mf">3.27873</span> <span class="p">,</span>  <span class="mf">3.29062</span> <span class="p">,</span>  <span class="mf">3.30053</span> <span class="p">,</span>
        <span class="mf">3.30449</span> <span class="p">,</span>  <span class="mf">3.30846</span> <span class="p">,</span>  <span class="mf">3.31836</span> <span class="p">,</span>  <span class="mf">3.32233</span> <span class="p">,</span>  <span class="mf">3.32827</span> <span class="p">,</span>  <span class="mf">3.3362</span>  <span class="p">,</span>
        <span class="mf">3.34214</span> <span class="p">,</span>  <span class="mf">3.35799</span> <span class="p">,</span>  <span class="mf">3.37979</span> <span class="p">,</span>  <span class="mf">3.39564</span> <span class="p">,</span>  <span class="mf">3.40555</span> <span class="p">,</span>  <span class="mf">3.41149</span> <span class="p">,</span>
        <span class="mf">3.41942</span> <span class="p">,</span>  <span class="mf">3.42933</span> <span class="p">,</span>  <span class="mf">3.43527</span> <span class="p">,</span>  <span class="mf">3.43924</span> <span class="p">,</span>  <span class="mf">3.4432</span>  <span class="p">,</span>  <span class="mf">3.44716</span> <span class="p">,</span>
        <span class="mf">3.44914</span> <span class="p">,</span>  <span class="mf">3.45112</span> <span class="p">,</span>  <span class="mf">3.45509</span> <span class="p">,</span>  <span class="mf">3.45905</span> <span class="p">,</span>  <span class="mf">3.46103</span> <span class="p">,</span>  <span class="mf">3.46301</span> <span class="p">,</span>
        <span class="mf">3.47094</span> <span class="p">,</span>  <span class="mf">3.4749</span>  <span class="p">,</span>  <span class="mf">3.47688</span> <span class="p">,</span>  <span class="mf">3.47887</span> <span class="p">,</span>  <span class="mf">3.48283</span> <span class="p">,</span>  <span class="mf">3.48481</span> <span class="p">,</span>
        <span class="mf">3.49075</span> <span class="p">,</span>  <span class="mf">3.49472</span> <span class="p">,</span>  <span class="mf">3.50066</span> <span class="p">,</span>  <span class="mf">3.50661</span> <span class="p">,</span>  <span class="mf">3.50859</span> <span class="p">,</span>  <span class="mf">3.51453</span> <span class="p">,</span>
        <span class="mf">3.52048</span> <span class="p">,</span>  <span class="mf">3.52246</span> <span class="p">,</span>  <span class="mf">3.52642</span> <span class="p">,</span>  <span class="mf">3.53038</span> <span class="p">,</span>  <span class="mf">3.53435</span> <span class="p">,</span>  <span class="mf">3.53831</span> <span class="p">,</span>
        <span class="mf">3.54029</span> <span class="p">,</span>  <span class="mf">3.54227</span> <span class="p">,</span>  <span class="mf">3.54624</span> <span class="p">,</span>  <span class="mf">3.5502</span>  <span class="p">,</span>  <span class="mf">3.55614</span> <span class="p">,</span>  <span class="mf">3.55813</span> <span class="p">,</span>
        <span class="mf">3.56605</span> <span class="p">,</span>  <span class="mf">3.572</span>   <span class="p">,</span>  <span class="mf">3.57992</span> <span class="p">,</span>  <span class="mf">3.58587</span> <span class="p">,</span>  <span class="mf">3.59181</span> <span class="p">,</span>  <span class="mf">3.59776</span> <span class="p">,</span>
        <span class="mf">3.6037</span>  <span class="p">,</span>  <span class="mf">3.60766</span> <span class="p">,</span>  <span class="mf">3.61955</span> <span class="p">,</span>  <span class="mf">3.63144</span> <span class="p">,</span>  <span class="mf">3.64729</span> <span class="p">,</span>  <span class="mf">3.6572</span>  <span class="p">,</span>
        <span class="mf">3.66513</span> <span class="p">,</span>  <span class="mf">3.68296</span> <span class="p">,</span>  <span class="mf">3.69485</span> <span class="p">,</span>  <span class="mf">3.70278</span> <span class="p">,</span>  <span class="mf">3.71268</span> <span class="p">,</span>  <span class="mf">3.72655</span> <span class="p">,</span>
        <span class="mf">3.74042</span> <span class="p">,</span>  <span class="mf">3.77015</span> <span class="p">,</span>  <span class="mf">3.77213</span> <span class="p">,</span>  <span class="mf">3.77609</span> <span class="p">,</span>  <span class="mf">3.786</span>   <span class="p">,</span>  <span class="mf">3.79392</span> <span class="p">,</span>
        <span class="mf">3.80185</span> <span class="p">,</span>  <span class="mf">3.80581</span> <span class="p">,</span>  <span class="mf">3.81176</span> <span class="p">,</span>  <span class="mf">3.82563</span> <span class="p">,</span>  <span class="mf">3.83554</span> <span class="p">,</span>  <span class="mf">3.84941</span> <span class="p">,</span>
        <span class="mf">3.87913</span> <span class="p">,</span>  <span class="mf">3.88706</span> <span class="p">,</span>  <span class="mf">3.90885</span> <span class="p">,</span>  <span class="mf">3.91678</span> <span class="p">,</span>  <span class="mf">3.93857</span> <span class="p">,</span>  <span class="mf">3.9465</span>  <span class="p">,</span>
        <span class="mf">3.95641</span> <span class="p">,</span>  <span class="mf">3.97226</span> <span class="p">,</span>  <span class="mf">3.98019</span> <span class="p">,</span>  <span class="mf">3.99208</span> <span class="p">,</span>  <span class="mf">4.00991</span> <span class="p">,</span>  <span class="mf">4.03567</span> <span class="p">,</span>
        <span class="mf">4.04558</span> <span class="p">,</span>  <span class="mf">4.06143</span> <span class="p">,</span>  <span class="mf">4.06539</span> <span class="p">,</span>  <span class="mf">4.07332</span> <span class="p">,</span>  <span class="mf">4.08124</span> <span class="p">,</span>  <span class="mf">4.08719</span> <span class="p">,</span>
        <span class="mf">4.10106</span> <span class="p">,</span>  <span class="mf">4.11097</span> <span class="p">,</span>  <span class="mf">4.11889</span> <span class="p">,</span>  <span class="mf">4.12682</span> <span class="p">,</span>  <span class="mf">4.13276</span> <span class="p">,</span>  <span class="mf">4.13673</span> <span class="p">,</span>
        <span class="mf">4.14663</span> <span class="p">,</span>  <span class="mf">4.16447</span> <span class="p">,</span>  <span class="mf">4.17636</span> <span class="p">,</span>  <span class="mf">4.1823</span>  <span class="p">,</span>  <span class="mf">4.2041</span>  <span class="p">,</span>  <span class="mf">4.20806</span> <span class="p">,</span>
        <span class="mf">4.23184</span> <span class="p">,</span>  <span class="mf">4.24967</span> <span class="p">,</span>  <span class="mf">4.2576</span>  <span class="p">,</span>  <span class="mf">4.27543</span> <span class="p">,</span>  <span class="mf">4.28138</span> <span class="p">])</span>
    <span class="n">fig15bot_w_raw</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
      <span class="p">[</span> <span class="mf">0.00387597</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0193798</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.00775194</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0193798</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.00387597</span><span class="p">,</span>
       <span class="o">-</span><span class="mf">0.0155039</span> <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span> <span class="o">-</span><span class="mf">0.0155039</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.0387597</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.0232558</span> <span class="p">,</span>
       <span class="o">-</span><span class="mf">0.0503876</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.0310078</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.0310078</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.0155039</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.0542636</span> <span class="p">,</span>
       <span class="o">-</span><span class="mf">0.0426357</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.00387597</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.00775194</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0348837</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.0310078</span> <span class="p">,</span>
       <span class="o">-</span><span class="mf">0.0465116</span> <span class="p">,</span>  <span class="mf">0.0116279</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.0116279</span> <span class="p">,</span>  <span class="mf">0.0310078</span> <span class="p">,</span>  <span class="mf">0.0271318</span> <span class="p">,</span>
        <span class="mf">0.0116279</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.0542636</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.104651</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.155039</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.205426</span>  <span class="p">,</span>
       <span class="o">-</span><span class="mf">0.244186</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.302326</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.352713</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.426357</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.391473</span>  <span class="p">,</span>
       <span class="o">-</span><span class="mf">0.453488</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.372093</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.306202</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.27907</span>   <span class="p">,</span> <span class="o">-</span><span class="mf">0.244186</span>  <span class="p">,</span>
       <span class="o">-</span><span class="mf">0.182171</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.228682</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.317829</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.364341</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.399225</span>  <span class="p">,</span>
       <span class="o">-</span><span class="mf">0.430233</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.488372</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.523256</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.484496</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.29845</span>   <span class="p">,</span>
       <span class="o">-</span><span class="mf">0.232558</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.170543</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.0891473</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.0348837</span> <span class="p">,</span>  <span class="mf">0.00387597</span><span class="p">,</span>
        <span class="mf">0.0426357</span> <span class="p">,</span>  <span class="mf">0.0232558</span> <span class="p">,</span>  <span class="mf">0.0310078</span> <span class="p">,</span>  <span class="mf">0.0193798</span> <span class="p">,</span>  <span class="mf">0.0387597</span> <span class="p">,</span>
        <span class="mf">0.0232558</span> <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">0.0155039</span> <span class="p">,</span>  <span class="mf">0.00775194</span><span class="p">,</span>  <span class="mf">0.0271318</span> <span class="p">,</span>
        <span class="mf">0.0116279</span> <span class="p">,</span>  <span class="mf">0.00775194</span><span class="p">,</span>  <span class="mf">0.0232558</span> <span class="p">,</span>  <span class="mf">0.0155039</span> <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>
       <span class="o">-</span><span class="mf">0.00387597</span><span class="p">,</span>  <span class="mf">0.0155039</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.0116279</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.0271318</span> <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>
        <span class="mf">0.0193798</span> <span class="p">,</span>  <span class="mf">0.0116279</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.0348837</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.100775</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.162791</span>  <span class="p">,</span>
       <span class="o">-</span><span class="mf">0.186047</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.217054</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.275194</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.348837</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.406977</span>  <span class="p">,</span>
       <span class="o">-</span><span class="mf">0.465116</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.546512</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.5</span>       <span class="p">,</span> <span class="o">-</span><span class="mf">0.434109</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.352713</span>  <span class="p">,</span>
       <span class="o">-</span><span class="mf">0.27907</span>   <span class="p">,</span> <span class="o">-</span><span class="mf">0.224806</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.213178</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.236434</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.267442</span>  <span class="p">,</span>
       <span class="o">-</span><span class="mf">0.294574</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.379845</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.496124</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.496124</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.569767</span>  <span class="p">,</span>
       <span class="o">-</span><span class="mf">0.492248</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.437984</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.317829</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.25969</span>   <span class="p">,</span> <span class="o">-</span><span class="mf">0.170543</span>  <span class="p">,</span>
       <span class="o">-</span><span class="mf">0.100775</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.0658915</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.0232558</span> <span class="p">,</span>  <span class="mf">0.0348837</span> <span class="p">,</span>  <span class="mf">0.0697674</span> <span class="p">,</span>
        <span class="mf">0.0348837</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.108527</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.186047</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.24031</span>   <span class="p">,</span> <span class="o">-</span><span class="mf">0.27907</span>   <span class="p">,</span>
       <span class="o">-</span><span class="mf">0.317829</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.360465</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.399225</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.449612</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.503876</span>  <span class="p">,</span>
       <span class="o">-</span><span class="mf">0.593023</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.542636</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.434109</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.496124</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.379845</span>  <span class="p">,</span>
       <span class="o">-</span><span class="mf">0.313953</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.267442</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.232558</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.263566</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.310078</span>  <span class="p">,</span>
       <span class="o">-</span><span class="mf">0.321705</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.496124</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.600775</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.639535</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.534884</span>  <span class="p">,</span>
       <span class="o">-</span><span class="mf">0.604651</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.44186</span>   <span class="p">,</span> <span class="o">-</span><span class="mf">0.352713</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.27907</span>   <span class="p">,</span> <span class="o">-</span><span class="mf">0.209302</span>  <span class="p">,</span>
       <span class="o">-</span><span class="mf">0.139535</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.0891473</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.0155039</span> <span class="p">,</span>  <span class="mf">0.00387597</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0116279</span> <span class="p">,</span>
        <span class="mf">0.0116279</span> <span class="p">,</span>  <span class="mf">0.0155039</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.0116279</span> <span class="p">,</span>  <span class="mf">0.00387597</span><span class="p">,</span>  <span class="mf">0.0542636</span> <span class="p">,</span>
        <span class="mf">0.0155039</span> <span class="p">,</span>  <span class="mf">0.0348837</span> <span class="p">,</span>  <span class="mf">0.0387597</span> <span class="p">,</span>  <span class="mf">0.0581395</span> <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>
        <span class="mf">0.0271318</span> <span class="p">,</span>  <span class="mf">0.00387597</span><span class="p">,</span>  <span class="mf">0.0426357</span> <span class="p">,</span>  <span class="mf">0.0116279</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.0155039</span> <span class="p">,</span>
       <span class="o">-</span><span class="mf">0.0116279</span> <span class="p">,</span>  <span class="mf">0.00775194</span><span class="p">,</span>  <span class="mf">0.0193798</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.0155039</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.0193798</span> <span class="p">,</span>
        <span class="mf">0.00775194</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.00387597</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.00775194</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0271318</span> <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>
        <span class="mf">0.0193798</span> <span class="p">,</span>  <span class="mf">0.0465116</span> <span class="p">,</span>  <span class="mf">0.0232558</span> <span class="p">,</span>  <span class="mf">0.0155039</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.0426357</span> <span class="p">,</span>
       <span class="o">-</span><span class="mf">0.0891473</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.116279</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.151163</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.20155</span>   <span class="p">,</span> <span class="o">-</span><span class="mf">0.263566</span>  <span class="p">,</span>
       <span class="o">-</span><span class="mf">0.310078</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.372093</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.445736</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.511628</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.531008</span>  <span class="p">,</span>
       <span class="o">-</span><span class="mf">0.468992</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.325581</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.290698</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.244186</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.20155</span>   <span class="p">,</span>
       <span class="o">-</span><span class="mf">0.255814</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.302326</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.352713</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.410853</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.476744</span>  <span class="p">,</span>
       <span class="o">-</span><span class="mf">0.565891</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.48062</span>   <span class="p">,</span> <span class="o">-</span><span class="mf">0.364341</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.418605</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.27907</span>   <span class="p">,</span>
       <span class="o">-</span><span class="mf">0.182171</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.116279</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.0503876</span> <span class="p">,</span>  <span class="mf">0.0271318</span> <span class="p">,</span>  <span class="mf">0.0465116</span> <span class="p">,</span>
        <span class="mf">0.0620155</span> <span class="p">,</span>  <span class="mf">0.0387597</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.0581395</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.124031</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.158915</span>  <span class="p">,</span>
       <span class="o">-</span><span class="mf">0.197674</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.248062</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.317829</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.383721</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.44186</span>   <span class="p">,</span>
       <span class="o">-</span><span class="mf">0.488372</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.46124</span>   <span class="p">,</span> <span class="o">-</span><span class="mf">0.422481</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.313953</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.255814</span>  <span class="p">,</span>
       <span class="o">-</span><span class="mf">0.162791</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.213178</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.27907</span>   <span class="p">,</span> <span class="o">-</span><span class="mf">0.329457</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.368217</span>  <span class="p">,</span>
       <span class="o">-</span><span class="mf">0.51938</span>   <span class="p">,</span> <span class="o">-</span><span class="mf">0.585271</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.53876</span>   <span class="p">,</span> <span class="o">-</span><span class="mf">0.484496</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.44186</span>   <span class="p">,</span>
       <span class="o">-</span><span class="mf">0.368217</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.271318</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.193798</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.124031</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.0736434</span> <span class="p">,</span>
       <span class="o">-</span><span class="mf">0.0193798</span> <span class="p">,</span>  <span class="mf">0.00775194</span><span class="p">,</span>  <span class="mf">0.0193798</span> <span class="p">,</span>  <span class="mf">0.0310078</span> <span class="p">,</span>  <span class="mf">0.0620155</span> <span class="p">,</span>
        <span class="mf">0.0271318</span> <span class="p">,</span>  <span class="mf">0.0542636</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.0232558</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.0155039</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.0155039</span> <span class="p">,</span>
        <span class="mf">0.00775194</span><span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span> <span class="o">-</span><span class="mf">0.0232558</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.00775194</span><span class="p">,</span>  <span class="mf">0.0116279</span> <span class="p">,</span>
        <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">0.0116279</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.00387597</span><span class="p">,</span>  <span class="mf">0.0310078</span> <span class="p">,</span>
        <span class="mf">0.0155039</span> <span class="p">,</span>  <span class="mf">0.0310078</span> <span class="p">,</span>  <span class="mf">0.0116279</span> <span class="p">,</span>  <span class="mf">0.0503876</span> <span class="p">,</span>  <span class="mf">0.0736434</span> <span class="p">,</span>
        <span class="mf">0.0426357</span> <span class="p">,</span>  <span class="mf">0.0155039</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.0930233</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.155039</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.193798</span>  <span class="p">,</span>
       <span class="o">-</span><span class="mf">0.217054</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.255814</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.306202</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.360465</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.403101</span>  <span class="p">,</span>
       <span class="o">-</span><span class="mf">0.457364</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.534884</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.589147</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.542636</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.472868</span>  <span class="p">,</span>
       <span class="o">-</span><span class="mf">0.426357</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.337209</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.282946</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.209302</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.271318</span>  <span class="p">,</span>
       <span class="o">-</span><span class="mf">0.321705</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.360465</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.430233</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.507752</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.488372</span>  <span class="p">,</span>
       <span class="o">-</span><span class="mf">0.445736</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.360465</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.313953</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.217054</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.131783</span>  <span class="p">,</span>
       <span class="o">-</span><span class="mf">0.0503876</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.00775194</span><span class="p">,</span>  <span class="mf">0.0271318</span> <span class="p">,</span>  <span class="mf">0.0620155</span> <span class="p">,</span>  <span class="mf">0.0348837</span> <span class="p">,</span>
       <span class="o">-</span><span class="mf">0.0193798</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.0968992</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.139535</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.178295</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.267442</span>  <span class="p">,</span>
       <span class="o">-</span><span class="mf">0.387597</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.434109</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.476744</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.531008</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.406977</span>  <span class="p">,</span>
       <span class="o">-</span><span class="mf">0.317829</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.275194</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.224806</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.25969</span>   <span class="p">,</span> <span class="o">-</span><span class="mf">0.290698</span>  <span class="p">,</span>
       <span class="o">-</span><span class="mf">0.325581</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.360465</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.414729</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.496124</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.577519</span>  <span class="p">,</span>
       <span class="o">-</span><span class="mf">0.434109</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.372093</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.317829</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.275194</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.224806</span>  <span class="p">,</span>
       <span class="o">-</span><span class="mf">0.0968992</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.0465116</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.0155039</span> <span class="p">,</span>  <span class="mf">0.00387597</span><span class="p">,</span>  <span class="mf">0.0503876</span> <span class="p">,</span>
        <span class="mf">0.0271318</span> <span class="p">,</span>  <span class="mf">0.0736434</span> <span class="p">,</span>  <span class="mf">0.0465116</span> <span class="p">,</span>  <span class="mf">0.0155039</span> <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>
        <span class="mf">0.0271318</span> <span class="p">,</span>  <span class="mf">0.0542636</span> <span class="p">,</span>  <span class="mf">0.00387597</span><span class="p">,</span>  <span class="mf">0.0310078</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.0271318</span> <span class="p">,</span>
        <span class="mf">0.0193798</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.0116279</span> <span class="p">,</span>  <span class="mf">0.0193798</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.0465116</span> <span class="p">,</span>  <span class="mf">0.00775194</span><span class="p">,</span>
       <span class="o">-</span><span class="mf">0.0310078</span> <span class="p">,</span>  <span class="mf">0.0193798</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.0271318</span> <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span> <span class="o">-</span><span class="mf">0.0155039</span> <span class="p">,</span>
       <span class="o">-</span><span class="mf">0.00775194</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0310078</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.0930233</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.182171</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.193798</span>  <span class="p">,</span>
       <span class="o">-</span><span class="mf">0.228682</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.27907</span>   <span class="p">,</span> <span class="o">-</span><span class="mf">0.337209</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.410853</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.468992</span>  <span class="p">,</span>
       <span class="o">-</span><span class="mf">0.550388</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.600775</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.554264</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.48062</span>   <span class="p">,</span> <span class="o">-</span><span class="mf">0.337209</span>  <span class="p">,</span>
       <span class="o">-</span><span class="mf">0.282946</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.236434</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.209302</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.189922</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.282946</span>  <span class="p">,</span>
       <span class="o">-</span><span class="mf">0.341085</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.468992</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.593023</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.658915</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.488372</span>  <span class="p">,</span>
       <span class="o">-</span><span class="mf">0.410853</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.294574</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.24031</span>   <span class="p">,</span> <span class="o">-</span><span class="mf">0.166667</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.112403</span>  <span class="p">,</span>
       <span class="o">-</span><span class="mf">0.0852713</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.0503876</span> <span class="p">,</span>  <span class="mf">0.0542636</span> <span class="p">,</span>  <span class="mf">0.0116279</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.0581395</span> <span class="p">,</span>
       <span class="o">-</span><span class="mf">0.162791</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.205426</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.232558</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.302326</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.387597</span>  <span class="p">,</span>
       <span class="o">-</span><span class="mf">0.44186</span>   <span class="p">,</span> <span class="o">-</span><span class="mf">0.492248</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.550388</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.488372</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.282946</span>  <span class="p">,</span>
       <span class="o">-</span><span class="mf">0.282946</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.244186</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.205426</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.282946</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.391473</span>  <span class="p">,</span>
       <span class="o">-</span><span class="mf">0.391473</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.46124</span>   <span class="p">,</span> <span class="o">-</span><span class="mf">0.523256</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.577519</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.515504</span>  <span class="p">,</span>
       <span class="o">-</span><span class="mf">0.418605</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.317829</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.248062</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.197674</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.158915</span>  <span class="p">,</span>
       <span class="o">-</span><span class="mf">0.104651</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.0581395</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.0155039</span> <span class="p">,</span>  <span class="mf">0.0271318</span> <span class="p">,</span>  <span class="mf">0.00387597</span><span class="p">,</span>
        <span class="mf">0.0813953</span> <span class="p">,</span>  <span class="mf">0.0116279</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.00775194</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0271318</span> <span class="p">,</span>  <span class="mf">0.00775194</span><span class="p">,</span>
       <span class="o">-</span><span class="mf">0.0193798</span> <span class="p">,</span>  <span class="mf">0.0465116</span> <span class="p">,</span>  <span class="mf">0.0155039</span> <span class="p">,</span>  <span class="mf">0.0310078</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.00387597</span><span class="p">,</span>
       <span class="o">-</span><span class="mf">0.0232558</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.00775194</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0155039</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.0658915</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.0348837</span> <span class="p">,</span>
       <span class="o">-</span><span class="mf">0.00775194</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0348837</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.0310078</span> <span class="p">,</span>  <span class="mf">0.0193798</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.0232558</span> <span class="p">,</span>
       <span class="o">-</span><span class="mf">0.00387597</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0271318</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.00387597</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0193798</span> <span class="p">,</span>  <span class="mf">0.0116279</span> <span class="p">,</span>
        <span class="mf">0.0348837</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.0271318</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.0930233</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.158915</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.213178</span>  <span class="p">,</span>
       <span class="o">-</span><span class="mf">0.255814</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.275194</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.310078</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.352713</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.410853</span>  <span class="p">,</span>
       <span class="o">-</span><span class="mf">0.476744</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.523256</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.503876</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.437984</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.356589</span>  <span class="p">,</span>
       <span class="o">-</span><span class="mf">0.294574</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.25969</span>   <span class="p">,</span> <span class="o">-</span><span class="mf">0.228682</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.286822</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.24031</span>   <span class="p">,</span>
       <span class="o">-</span><span class="mf">0.337209</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.360465</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.430233</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.51938</span>   <span class="p">,</span> <span class="o">-</span><span class="mf">0.496124</span>  <span class="p">,</span>
       <span class="o">-</span><span class="mf">0.406977</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.286822</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.224806</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.166667</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.0968992</span> <span class="p">,</span>
       <span class="o">-</span><span class="mf">0.0426357</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.00387597</span><span class="p">,</span>  <span class="mf">0.0775194</span> <span class="p">,</span>  <span class="mf">0.0271318</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.0581395</span> <span class="p">,</span>
       <span class="o">-</span><span class="mf">0.131783</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.162791</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.213178</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.321705</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.368217</span>  <span class="p">,</span>
       <span class="o">-</span><span class="mf">0.445736</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.531008</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.472868</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.383721</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.313953</span>  <span class="p">,</span>
       <span class="o">-</span><span class="mf">0.24031</span>   <span class="p">,</span> <span class="o">-</span><span class="mf">0.275194</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.325581</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.356589</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.465116</span>  <span class="p">,</span>
       <span class="o">-</span><span class="mf">0.465116</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.647287</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.608527</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.527132</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.437984</span>  <span class="p">,</span>
       <span class="o">-</span><span class="mf">0.325581</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.24031</span>   <span class="p">,</span> <span class="o">-</span><span class="mf">0.158915</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.100775</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.0542636</span> <span class="p">,</span>
       <span class="o">-</span><span class="mf">0.0155039</span> <span class="p">,</span>  <span class="mf">0.00775194</span><span class="p">,</span>  <span class="mf">0.0542636</span> <span class="p">,</span>  <span class="mf">0.0232558</span> <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>
        <span class="mf">0.</span>        <span class="p">,</span> <span class="o">-</span><span class="mf">0.0155039</span> <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">0.0581395</span> <span class="p">,</span>  <span class="mf">0.0232558</span> <span class="p">,</span>
        <span class="mf">0.00387597</span><span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">0.0310078</span> <span class="p">,</span>  <span class="mf">0.0465116</span> <span class="p">,</span>  <span class="mf">0.0155039</span> <span class="p">,</span>
        <span class="mf">0.0465116</span> <span class="p">,</span>  <span class="mf">0.0620155</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.00387597</span><span class="p">,</span>  <span class="mf">0.0155039</span> <span class="p">,</span>  <span class="mf">0.0348837</span> <span class="p">,</span>
        <span class="mf">0.0658915</span> <span class="p">,</span>  <span class="mf">0.0542636</span> <span class="p">,</span>  <span class="mf">0.0658915</span> <span class="p">,</span>  <span class="mf">0.0503876</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.0658915</span> <span class="p">,</span>
       <span class="o">-</span><span class="mf">0.112403</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.166667</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.232558</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.275194</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.321705</span>  <span class="p">,</span>
       <span class="o">-</span><span class="mf">0.368217</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.44186</span>   <span class="p">,</span> <span class="o">-</span><span class="mf">0.527132</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.581395</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.515504</span>  <span class="p">,</span>
       <span class="o">-</span><span class="mf">0.430233</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.352713</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.27907</span>   <span class="p">,</span> <span class="o">-</span><span class="mf">0.224806</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.197674</span>  <span class="p">,</span>
       <span class="o">-</span><span class="mf">0.248062</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.302326</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.368217</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.44186</span>   <span class="p">,</span> <span class="o">-</span><span class="mf">0.488372</span>  <span class="p">,</span>
       <span class="o">-</span><span class="mf">0.44186</span>   <span class="p">,</span> <span class="o">-</span><span class="mf">0.360465</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.209302</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.158915</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.112403</span>  <span class="p">,</span>
       <span class="o">-</span><span class="mf">0.0542636</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.0232558</span> <span class="p">,</span>  <span class="mf">0.0155039</span> <span class="p">,</span>  <span class="mf">0.0465116</span> <span class="p">,</span>  <span class="mf">0.0813953</span> <span class="p">,</span>
        <span class="mf">0.0658915</span> <span class="p">,</span>  <span class="mf">0.0310078</span> <span class="p">,</span>  <span class="mf">0.0542636</span> <span class="p">,</span>  <span class="mf">0.0387597</span> <span class="p">,</span>  <span class="mf">0.0387597</span> <span class="p">,</span>
        <span class="mf">0.0271318</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.0193798</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.00387597</span><span class="p">,</span>  <span class="mf">0.0116279</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.0232558</span> <span class="p">,</span>
        <span class="mf">0.</span>        <span class="p">,</span> <span class="o">-</span><span class="mf">0.0232558</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.0232558</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.00387597</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0271318</span> <span class="p">,</span>
       <span class="o">-</span><span class="mf">0.00387597</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0271318</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.0155039</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.0310078</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.0426357</span> <span class="p">,</span>
       <span class="o">-</span><span class="mf">0.0193798</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.0232558</span> <span class="p">,</span>  <span class="mf">0.0155039</span> <span class="p">,</span>  <span class="mf">0.0271318</span> <span class="p">,</span>  <span class="mf">0.0116279</span> <span class="p">,</span>
        <span class="mf">0.0155039</span> <span class="p">,</span>  <span class="mf">0.00775194</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0465116</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.0155039</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.0465116</span> <span class="p">,</span>
       <span class="o">-</span><span class="mf">0.0155039</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.00387597</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.00387597</span><span class="p">,</span>  <span class="mf">0.00775194</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0310078</span> <span class="p">,</span>
        <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">0.00387597</span><span class="p">,</span>  <span class="mf">0.00387597</span><span class="p">,</span>  <span class="mf">0.00387597</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0232558</span> <span class="p">,</span>
       <span class="o">-</span><span class="mf">0.00775194</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0116279</span> <span class="p">,</span>  <span class="mf">0.0116279</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.0310078</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.0155039</span> <span class="p">,</span>
       <span class="o">-</span><span class="mf">0.0387597</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.0155039</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.0310078</span> <span class="p">,</span>  <span class="mf">0.00387597</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0232558</span> <span class="p">,</span>
        <span class="mf">0.00387597</span><span class="p">,</span>  <span class="mf">0.0232558</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.0155039</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.00387597</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0310078</span> <span class="p">,</span>
       <span class="o">-</span><span class="mf">0.00387597</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0348837</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.0193798</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.0271318</span> <span class="p">,</span>  <span class="mf">0.00387597</span><span class="p">,</span>
       <span class="o">-</span><span class="mf">0.0387597</span> <span class="p">,</span>  <span class="mf">0.00387597</span><span class="p">,</span>  <span class="mf">0.00775194</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.00387597</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0193798</span> <span class="p">,</span>
        <span class="mf">0.</span>        <span class="p">,</span> <span class="o">-</span><span class="mf">0.00775194</span><span class="p">])</span>



    <span class="n">fig19b_bridge_to_emb_x_raw</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
      <span class="p">[</span> <span class="o">-</span><span class="mf">4.92072000e+00</span><span class="p">,</span>  <span class="o">-</span><span class="mf">4.90682000e+00</span><span class="p">,</span>  <span class="o">-</span><span class="mf">4.71917000e+00</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">4.70637000e+00</span><span class="p">,</span>  <span class="o">-</span><span class="mf">4.58438000e+00</span><span class="p">,</span>  <span class="o">-</span><span class="mf">4.50665000e+00</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">4.38320000e+00</span><span class="p">,</span>  <span class="o">-</span><span class="mf">4.37332000e+00</span><span class="p">,</span>  <span class="o">-</span><span class="mf">4.23944000e+00</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">4.18165000e+00</span><span class="p">,</span>  <span class="o">-</span><span class="mf">4.10538000e+00</span><span class="p">,</span>  <span class="o">-</span><span class="mf">3.98010000e+00</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">3.97169000e+00</span><span class="p">,</span>  <span class="o">-</span><span class="mf">3.84549000e+00</span><span class="p">,</span>  <span class="o">-</span><span class="mf">3.77142000e+00</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">3.64413000e+00</span><span class="p">,</span>  <span class="o">-</span><span class="mf">3.63828000e+00</span><span class="p">,</span>  <span class="o">-</span><span class="mf">3.50952000e+00</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">3.43874000e+00</span><span class="p">,</span>  <span class="o">-</span><span class="mf">3.30816000e+00</span><span class="p">,</span>  <span class="o">-</span><span class="mf">3.17208000e+00</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">3.04040000e+00</span><span class="p">,</span>  <span class="o">-</span><span class="mf">3.03821000e+00</span><span class="p">,</span>  <span class="o">-</span><span class="mf">2.83739000e+00</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">2.70351000e+00</span><span class="p">,</span>  <span class="o">-</span><span class="mf">2.63968000e+00</span><span class="p">,</span>  <span class="o">-</span><span class="mf">2.50251000e+00</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">2.43905000e+00</span><span class="p">,</span>  <span class="o">-</span><span class="mf">2.23787000e+00</span><span class="p">,</span>  <span class="o">-</span><span class="mf">2.23494000e+00</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">2.10308000e+00</span><span class="p">,</span>  <span class="o">-</span><span class="mf">1.96755000e+00</span><span class="p">,</span>  <span class="o">-</span><span class="mf">1.90135000e+00</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.76674000e+00</span><span class="p">,</span>  <span class="o">-</span><span class="mf">1.69998000e+00</span><span class="p">,</span>  <span class="o">-</span><span class="mf">1.50008000e+00</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.36694000e+00</span><span class="p">,</span>  <span class="o">-</span><span class="mf">1.23397000e+00</span><span class="p">,</span>  <span class="o">-</span><span class="mf">1.16722000e+00</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">9.68049000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">9.00379000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">8.35635000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">6.36282000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">5.67149000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">4.34735000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">3.70357000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">3.02138000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">2.36114000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">3.67613000e-02</span><span class="p">,</span>   <span class="mf">2.96285000e-02</span><span class="p">,</span>   <span class="mf">9.56527000e-02</span><span class="p">,</span>
         <span class="mf">4.96918000e-01</span><span class="p">,</span>   <span class="mf">7.63941000e-01</span><span class="p">,</span>   <span class="mf">1.16466000e+00</span><span class="p">,</span>
         <span class="mf">1.36383000e+00</span><span class="p">,</span>   <span class="mf">1.63176000e+00</span><span class="p">,</span>   <span class="mf">2.03212000e+00</span><span class="p">,</span>
         <span class="mf">2.09869000e+00</span><span class="p">,</span>   <span class="mf">2.63219000e+00</span><span class="p">,</span>   <span class="mf">2.63237000e+00</span><span class="p">,</span>
         <span class="mf">3.16641000e+00</span><span class="p">,</span>   <span class="mf">3.23207000e+00</span><span class="p">,</span>   <span class="mf">3.49964000e+00</span><span class="p">,</span>
         <span class="mf">3.76539000e+00</span><span class="p">,</span>   <span class="mf">3.96620000e+00</span><span class="p">,</span>   <span class="mf">4.29888000e+00</span><span class="p">,</span>
         <span class="mf">4.56645000e+00</span><span class="p">,</span>   <span class="mf">5.09922000e+00</span><span class="p">,</span>   <span class="mf">5.23346000e+00</span><span class="p">,</span>
         <span class="mf">5.76623000e+00</span><span class="p">,</span>   <span class="mf">5.83371000e+00</span><span class="p">,</span>   <span class="mf">6.43415000e+00</span><span class="p">,</span>
         <span class="mf">6.76683000e+00</span><span class="p">,</span>   <span class="mf">7.10134000e+00</span><span class="p">,</span>   <span class="mf">7.63465000e+00</span><span class="p">,</span>
         <span class="mf">7.70178000e+00</span><span class="p">,</span>   <span class="mf">8.30221000e+00</span><span class="p">,</span>   <span class="mf">8.83552000e+00</span><span class="p">,</span>
         <span class="mf">8.90283000e+00</span><span class="p">,</span>   <span class="mf">9.50345000e+00</span><span class="p">,</span>   <span class="mf">9.90307000e+00</span><span class="p">,</span>
         <span class="mf">1.01706000e+01</span><span class="p">,</span>   <span class="mf">1.11049000e+01</span><span class="p">,</span>   <span class="mf">1.11712000e+01</span><span class="p">,</span>
         <span class="mf">1.19057000e+01</span><span class="p">,</span>   <span class="mf">1.21726000e+01</span><span class="p">,</span>   <span class="mf">1.26399000e+01</span><span class="p">,</span>
         <span class="mf">1.30404000e+01</span><span class="p">,</span>   <span class="mf">1.34409000e+01</span><span class="p">,</span>   <span class="mf">1.43088000e+01</span><span class="p">,</span>
         <span class="mf">1.44423000e+01</span><span class="p">,</span>   <span class="mf">1.51098000e+01</span><span class="p">,</span>   <span class="mf">1.59107000e+01</span><span class="p">,</span>
         <span class="mf">1.59775000e+01</span><span class="p">,</span>   <span class="mf">1.69788000e+01</span><span class="p">,</span>   <span class="mf">1.69790000e+01</span><span class="p">,</span>
         <span class="mf">1.78464000e+01</span><span class="p">,</span>   <span class="mf">1.79132000e+01</span><span class="p">,</span>   <span class="mf">1.85808000e+01</span><span class="p">,</span>
         <span class="mf">1.87810000e+01</span><span class="p">,</span>   <span class="mf">1.91814000e+01</span><span class="p">,</span>   <span class="mf">1.92483000e+01</span><span class="p">,</span>
         <span class="mf">1.94484000e+01</span><span class="p">,</span>   <span class="mf">1.98478000e+01</span><span class="p">,</span>   <span class="mf">1.99151000e+01</span><span class="p">,</span>
         <span class="mf">2.04486000e+01</span><span class="p">,</span>   <span class="mf">2.05141000e+01</span><span class="p">,</span>   <span class="mf">2.08483000e+01</span><span class="p">,</span>
         <span class="mf">2.13135000e+01</span><span class="p">,</span>   <span class="mf">2.15147000e+01</span><span class="p">,</span>   <span class="mf">2.20478000e+01</span><span class="p">,</span>
         <span class="mf">2.21799000e+01</span><span class="p">,</span>   <span class="mf">2.25144000e+01</span><span class="p">,</span>   <span class="mf">2.28478000e+01</span><span class="p">,</span>
         <span class="mf">2.29131000e+01</span><span class="p">,</span>   <span class="mf">2.36480000e+01</span><span class="p">,</span>   <span class="mf">2.37131000e+01</span><span class="p">,</span>
         <span class="mf">2.44481000e+01</span><span class="p">,</span>   <span class="mf">2.46469000e+01</span><span class="p">,</span>   <span class="mf">2.52485000e+01</span><span class="p">,</span>
         <span class="mf">2.55806000e+01</span><span class="p">,</span>   <span class="mf">2.58485000e+01</span><span class="p">,</span>   <span class="mf">2.65810000e+01</span><span class="p">,</span>
         <span class="mf">2.67156000e+01</span><span class="p">,</span>   <span class="mf">2.73161000e+01</span><span class="p">,</span>   <span class="mf">2.73815000e+01</span><span class="p">,</span>
         <span class="mf">2.78496000e+01</span><span class="p">,</span>   <span class="mf">2.81822000e+01</span><span class="p">,</span>   <span class="mf">2.84500000e+01</span><span class="p">,</span>
         <span class="mf">2.89167000e+01</span><span class="p">,</span>   <span class="mf">2.92496000e+01</span><span class="p">,</span>   <span class="mf">2.95843000e+01</span><span class="p">,</span>
         <span class="mf">2.98504000e+01</span><span class="p">,</span>   <span class="mf">3.01180000e+01</span><span class="p">,</span>   <span class="mf">3.05843000e+01</span><span class="p">,</span>
         <span class="mf">3.07182000e+01</span><span class="p">,</span>   <span class="mf">3.16521000e+01</span><span class="p">,</span>   <span class="mf">3.17192000e+01</span><span class="p">,</span>
         <span class="mf">3.24533000e+01</span><span class="p">,</span>   <span class="mf">3.27869000e+01</span><span class="p">,</span>   <span class="mf">3.31874000e+01</span><span class="p">,</span>
         <span class="mf">3.35874000e+01</span><span class="p">,</span>   <span class="mf">3.40551000e+01</span><span class="p">,</span>   <span class="mf">3.46557000e+01</span><span class="p">,</span>
         <span class="mf">3.56569000e+01</span><span class="p">,</span>   <span class="mf">3.58573000e+01</span><span class="p">,</span>   <span class="mf">3.65913000e+01</span><span class="p">,</span>
         <span class="mf">3.69920000e+01</span><span class="p">,</span>   <span class="mf">3.76595000e+01</span><span class="p">,</span>   <span class="mf">3.77263000e+01</span><span class="p">,</span>
         <span class="mf">3.86607000e+01</span><span class="p">,</span>   <span class="mf">3.93281000e+01</span><span class="p">,</span>   <span class="mf">3.99958000e+01</span><span class="p">,</span>
         <span class="mf">4.11306000e+01</span><span class="p">,</span>   <span class="mf">4.11308000e+01</span><span class="p">,</span>   <span class="mf">4.19319000e+01</span><span class="p">,</span>
         <span class="mf">4.28663000e+01</span><span class="p">,</span>   <span class="mf">4.29330000e+01</span><span class="p">,</span>   <span class="mf">4.40011000e+01</span><span class="p">,</span>
         <span class="mf">4.50692000e+01</span><span class="p">,</span>   <span class="mf">4.52697000e+01</span><span class="p">,</span>   <span class="mf">4.64043000e+01</span><span class="p">,</span>
         <span class="mf">4.66044000e+01</span><span class="p">,</span>   <span class="mf">4.70053000e+01</span><span class="p">,</span>   <span class="mf">4.72050000e+01</span><span class="p">,</span>
         <span class="mf">4.81393000e+01</span><span class="p">,</span>   <span class="mf">4.88737000e+01</span><span class="p">,</span>   <span class="mf">4.90744000e+01</span><span class="p">,</span>
         <span class="mf">4.94746000e+01</span><span class="p">,</span>   <span class="mf">4.98087000e+01</span><span class="p">,</span>   <span class="mf">4.98755000e+01</span><span class="p">])</span>

    <span class="n">fig19b_bridge_to_emb_w_raw</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
      <span class="p">[</span><span class="o">-</span><span class="mf">0.712329</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.711006</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.693151</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.691329</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.673973</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.66868</span> <span class="p">,</span>
       <span class="o">-</span><span class="mf">0.660274</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.659334</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.646595</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.641096</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.633839</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.621918</span><span class="p">,</span>
       <span class="o">-</span><span class="mf">0.62089</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.605479</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.599433</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.589041</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.588326</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.572603</span><span class="p">,</span>
       <span class="o">-</span><span class="mf">0.566825</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.556164</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.550595</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.545205</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.54519</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.543817</span><span class="p">,</span>
       <span class="o">-</span><span class="mf">0.542902</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.542466</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.53872</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.536986</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.523288</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.522871</span><span class="p">,</span>
       <span class="o">-</span><span class="mf">0.50411</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.489385</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.482192</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.471203</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.465753</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.472331</span><span class="p">,</span>
       <span class="o">-</span><span class="mf">0.476712</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.482184</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.484932</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.486976</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.487671</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.489268</span><span class="p">,</span>
       <span class="o">-</span><span class="mf">0.494185</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.49589</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.512329</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.51898</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.526027</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.536986</span><span class="p">,</span>
       <span class="o">-</span><span class="mf">0.550685</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.558927</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.567123</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.560543</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.556164</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.565315</span><span class="p">,</span>
       <span class="o">-</span><span class="mf">0.569863</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.565469</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.558904</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.559816</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.567121</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.567123</span><span class="p">,</span>
       <span class="o">-</span><span class="mf">0.567123</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.568743</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.575342</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.581584</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.586301</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.590857</span><span class="p">,</span>
       <span class="o">-</span><span class="mf">0.594521</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.601086</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.60274</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.610035</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.610959</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.616438</span><span class="p">,</span>
       <span class="o">-</span><span class="mf">0.619171</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.621918</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.626785</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.627397</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.632877</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.635309</span><span class="p">,</span>
       <span class="o">-</span><span class="mf">0.635616</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.638356</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.641638</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.643836</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.649315</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.649542</span><span class="p">,</span>
       <span class="o">-</span><span class="mf">0.652055</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.653051</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.654795</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.654795</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.654795</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.654795</span><span class="p">,</span>
       <span class="o">-</span><span class="mf">0.654795</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.654795</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.657323</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.657534</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.657534</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.657535</span><span class="p">,</span>
       <span class="o">-</span><span class="mf">0.660274</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.660274</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.660274</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.660274</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.660274</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.660274</span><span class="p">,</span>
       <span class="o">-</span><span class="mf">0.663014</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.670048</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.671233</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.679452</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.681696</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.693151</span><span class="p">,</span>
       <span class="o">-</span><span class="mf">0.704627</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.709589</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.723288</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.726389</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.734247</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.739726</span><span class="p">,</span>
       <span class="o">-</span><span class="mf">0.740844</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.753425</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.754539</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.767123</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.769845</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.778082</span><span class="p">,</span>
       <span class="o">-</span><span class="mf">0.784148</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.789041</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.798299</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.8</span>     <span class="p">,</span> <span class="o">-</span><span class="mf">0.805479</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.806488</span><span class="p">,</span>
       <span class="o">-</span><span class="mf">0.813699</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.816735</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.819178</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.827397</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.827397</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.827397</span><span class="p">,</span>
       <span class="o">-</span><span class="mf">0.830129</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.832877</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.839263</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.841096</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.846208</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.846575</span><span class="p">,</span>
       <span class="o">-</span><span class="mf">0.849315</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.85056</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.852055</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.853318</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.854795</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.855708</span><span class="p">,</span>
       <span class="o">-</span><span class="mf">0.85723</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.857534</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.859306</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.860274</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.860274</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.860274</span><span class="p">,</span>
       <span class="o">-</span><span class="mf">0.86347</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.865753</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.864739</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.863014</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.863014</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.863014</span><span class="p">,</span>
       <span class="o">-</span><span class="mf">0.863014</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.863014</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.863014</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.863014</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.86273</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.861124</span><span class="p">,</span>
       <span class="o">-</span><span class="mf">0.860841</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.860274</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.860803</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.863277</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.865222</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.865753</span><span class="p">,</span>
       <span class="o">-</span><span class="mf">0.865753</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.865753</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.865753</span><span class="p">])</span>

    <span class="n">fig19b_emb_to_bridge_x_raw</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
      <span class="p">[</span> <span class="o">-</span><span class="mf">4.92072000e+00</span><span class="p">,</span>  <span class="o">-</span><span class="mf">4.90682000e+00</span><span class="p">,</span>  <span class="o">-</span><span class="mf">4.71917000e+00</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">4.70637000e+00</span><span class="p">,</span>  <span class="o">-</span><span class="mf">4.58438000e+00</span><span class="p">,</span>  <span class="o">-</span><span class="mf">4.50665000e+00</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">4.38320000e+00</span><span class="p">,</span>  <span class="o">-</span><span class="mf">4.37332000e+00</span><span class="p">,</span>  <span class="o">-</span><span class="mf">4.23944000e+00</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">4.18165000e+00</span><span class="p">,</span>  <span class="o">-</span><span class="mf">4.10538000e+00</span><span class="p">,</span>  <span class="o">-</span><span class="mf">3.98010000e+00</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">3.97169000e+00</span><span class="p">,</span>  <span class="o">-</span><span class="mf">3.84549000e+00</span><span class="p">,</span>  <span class="o">-</span><span class="mf">3.77142000e+00</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">3.64413000e+00</span><span class="p">,</span>  <span class="o">-</span><span class="mf">3.63828000e+00</span><span class="p">,</span>  <span class="o">-</span><span class="mf">3.50952000e+00</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">3.43874000e+00</span><span class="p">,</span>  <span class="o">-</span><span class="mf">3.30816000e+00</span><span class="p">,</span>  <span class="o">-</span><span class="mf">3.17208000e+00</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">3.04040000e+00</span><span class="p">,</span>  <span class="o">-</span><span class="mf">3.03821000e+00</span><span class="p">,</span>  <span class="o">-</span><span class="mf">2.83739000e+00</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">2.70351000e+00</span><span class="p">,</span>  <span class="o">-</span><span class="mf">2.63968000e+00</span><span class="p">,</span>  <span class="o">-</span><span class="mf">2.50251000e+00</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">2.43905000e+00</span><span class="p">,</span>  <span class="o">-</span><span class="mf">2.23787000e+00</span><span class="p">,</span>  <span class="o">-</span><span class="mf">2.23494000e+00</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">2.10308000e+00</span><span class="p">,</span>  <span class="o">-</span><span class="mf">1.96755000e+00</span><span class="p">,</span>  <span class="o">-</span><span class="mf">1.90135000e+00</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.76674000e+00</span><span class="p">,</span>  <span class="o">-</span><span class="mf">1.69998000e+00</span><span class="p">,</span>  <span class="o">-</span><span class="mf">1.50008000e+00</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.36694000e+00</span><span class="p">,</span>  <span class="o">-</span><span class="mf">1.23397000e+00</span><span class="p">,</span>  <span class="o">-</span><span class="mf">1.16722000e+00</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">9.68049000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">9.00379000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">8.35635000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">6.36282000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">5.67149000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">4.34735000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">3.70357000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">3.02138000e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">2.36114000e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">3.67613000e-02</span><span class="p">,</span>   <span class="mf">2.96285000e-02</span><span class="p">,</span>   <span class="mf">9.56527000e-02</span><span class="p">,</span>
         <span class="mf">4.96918000e-01</span><span class="p">,</span>   <span class="mf">7.63941000e-01</span><span class="p">,</span>   <span class="mf">1.16466000e+00</span><span class="p">,</span>
         <span class="mf">1.36383000e+00</span><span class="p">,</span>   <span class="mf">1.63176000e+00</span><span class="p">,</span>   <span class="mf">2.03212000e+00</span><span class="p">,</span>
         <span class="mf">2.09869000e+00</span><span class="p">,</span>   <span class="mf">2.63219000e+00</span><span class="p">,</span>   <span class="mf">2.63237000e+00</span><span class="p">,</span>
         <span class="mf">3.16641000e+00</span><span class="p">,</span>   <span class="mf">3.23207000e+00</span><span class="p">,</span>   <span class="mf">3.49964000e+00</span><span class="p">,</span>
         <span class="mf">3.76539000e+00</span><span class="p">,</span>   <span class="mf">3.96620000e+00</span><span class="p">,</span>   <span class="mf">4.29888000e+00</span><span class="p">,</span>
         <span class="mf">4.56645000e+00</span><span class="p">,</span>   <span class="mf">5.09922000e+00</span><span class="p">,</span>   <span class="mf">5.23346000e+00</span><span class="p">,</span>
         <span class="mf">5.76623000e+00</span><span class="p">,</span>   <span class="mf">5.83371000e+00</span><span class="p">,</span>   <span class="mf">6.43415000e+00</span><span class="p">,</span>
         <span class="mf">6.76683000e+00</span><span class="p">,</span>   <span class="mf">7.10134000e+00</span><span class="p">,</span>   <span class="mf">7.63465000e+00</span><span class="p">,</span>
         <span class="mf">7.70178000e+00</span><span class="p">,</span>   <span class="mf">8.30221000e+00</span><span class="p">,</span>   <span class="mf">8.83552000e+00</span><span class="p">,</span>
         <span class="mf">8.90283000e+00</span><span class="p">,</span>   <span class="mf">9.50345000e+00</span><span class="p">,</span>   <span class="mf">9.90307000e+00</span><span class="p">,</span>
         <span class="mf">1.01706000e+01</span><span class="p">,</span>   <span class="mf">1.11049000e+01</span><span class="p">,</span>   <span class="mf">1.11712000e+01</span><span class="p">,</span>
         <span class="mf">1.19057000e+01</span><span class="p">,</span>   <span class="mf">1.21726000e+01</span><span class="p">,</span>   <span class="mf">1.26399000e+01</span><span class="p">,</span>
         <span class="mf">1.30404000e+01</span><span class="p">,</span>   <span class="mf">1.34409000e+01</span><span class="p">,</span>   <span class="mf">1.43088000e+01</span><span class="p">,</span>
         <span class="mf">1.44423000e+01</span><span class="p">,</span>   <span class="mf">1.51098000e+01</span><span class="p">,</span>   <span class="mf">1.59107000e+01</span><span class="p">,</span>
         <span class="mf">1.59775000e+01</span><span class="p">,</span>   <span class="mf">1.69788000e+01</span><span class="p">,</span>   <span class="mf">1.69790000e+01</span><span class="p">,</span>
         <span class="mf">1.78464000e+01</span><span class="p">,</span>   <span class="mf">1.79132000e+01</span><span class="p">,</span>   <span class="mf">1.85808000e+01</span><span class="p">,</span>
         <span class="mf">1.87810000e+01</span><span class="p">,</span>   <span class="mf">1.91814000e+01</span><span class="p">,</span>   <span class="mf">1.92483000e+01</span><span class="p">,</span>
         <span class="mf">1.94484000e+01</span><span class="p">,</span>   <span class="mf">1.98478000e+01</span><span class="p">,</span>   <span class="mf">1.99151000e+01</span><span class="p">,</span>
         <span class="mf">2.04486000e+01</span><span class="p">,</span>   <span class="mf">2.05141000e+01</span><span class="p">,</span>   <span class="mf">2.08483000e+01</span><span class="p">,</span>
         <span class="mf">2.13135000e+01</span><span class="p">,</span>   <span class="mf">2.15147000e+01</span><span class="p">,</span>   <span class="mf">2.20478000e+01</span><span class="p">,</span>
         <span class="mf">2.21799000e+01</span><span class="p">,</span>   <span class="mf">2.25144000e+01</span><span class="p">,</span>   <span class="mf">2.28478000e+01</span><span class="p">,</span>
         <span class="mf">2.29131000e+01</span><span class="p">,</span>   <span class="mf">2.36480000e+01</span><span class="p">,</span>   <span class="mf">2.37131000e+01</span><span class="p">,</span>
         <span class="mf">2.44481000e+01</span><span class="p">,</span>   <span class="mf">2.46469000e+01</span><span class="p">,</span>   <span class="mf">2.52485000e+01</span><span class="p">,</span>
         <span class="mf">2.55806000e+01</span><span class="p">,</span>   <span class="mf">2.58485000e+01</span><span class="p">,</span>   <span class="mf">2.65810000e+01</span><span class="p">,</span>
         <span class="mf">2.67156000e+01</span><span class="p">,</span>   <span class="mf">2.73161000e+01</span><span class="p">,</span>   <span class="mf">2.73815000e+01</span><span class="p">,</span>
         <span class="mf">2.78496000e+01</span><span class="p">,</span>   <span class="mf">2.81822000e+01</span><span class="p">,</span>   <span class="mf">2.84500000e+01</span><span class="p">,</span>
         <span class="mf">2.89167000e+01</span><span class="p">,</span>   <span class="mf">2.92496000e+01</span><span class="p">,</span>   <span class="mf">2.95843000e+01</span><span class="p">,</span>
         <span class="mf">2.98504000e+01</span><span class="p">,</span>   <span class="mf">3.01180000e+01</span><span class="p">,</span>   <span class="mf">3.05843000e+01</span><span class="p">,</span>
         <span class="mf">3.07182000e+01</span><span class="p">,</span>   <span class="mf">3.16521000e+01</span><span class="p">,</span>   <span class="mf">3.17192000e+01</span><span class="p">,</span>
         <span class="mf">3.24533000e+01</span><span class="p">,</span>   <span class="mf">3.27869000e+01</span><span class="p">,</span>   <span class="mf">3.31874000e+01</span><span class="p">,</span>
         <span class="mf">3.35874000e+01</span><span class="p">,</span>   <span class="mf">3.40551000e+01</span><span class="p">,</span>   <span class="mf">3.46557000e+01</span><span class="p">,</span>
         <span class="mf">3.56569000e+01</span><span class="p">,</span>   <span class="mf">3.58573000e+01</span><span class="p">,</span>   <span class="mf">3.65913000e+01</span><span class="p">,</span>
         <span class="mf">3.69920000e+01</span><span class="p">,</span>   <span class="mf">3.76595000e+01</span><span class="p">,</span>   <span class="mf">3.77263000e+01</span><span class="p">,</span>
         <span class="mf">3.86607000e+01</span><span class="p">,</span>   <span class="mf">3.93281000e+01</span><span class="p">,</span>   <span class="mf">3.99958000e+01</span><span class="p">,</span>
         <span class="mf">4.11306000e+01</span><span class="p">,</span>   <span class="mf">4.11308000e+01</span><span class="p">,</span>   <span class="mf">4.19319000e+01</span><span class="p">,</span>
         <span class="mf">4.28663000e+01</span><span class="p">,</span>   <span class="mf">4.29330000e+01</span><span class="p">,</span>   <span class="mf">4.40011000e+01</span><span class="p">,</span>
         <span class="mf">4.50692000e+01</span><span class="p">,</span>   <span class="mf">4.52697000e+01</span><span class="p">,</span>   <span class="mf">4.64043000e+01</span><span class="p">,</span>
         <span class="mf">4.66044000e+01</span><span class="p">,</span>   <span class="mf">4.70053000e+01</span><span class="p">,</span>   <span class="mf">4.72050000e+01</span><span class="p">,</span>
         <span class="mf">4.81393000e+01</span><span class="p">,</span>   <span class="mf">4.88737000e+01</span><span class="p">,</span>   <span class="mf">4.90744000e+01</span><span class="p">,</span>
         <span class="mf">4.94746000e+01</span><span class="p">,</span>   <span class="mf">4.98087000e+01</span><span class="p">,</span>   <span class="mf">4.98755000e+01</span><span class="p">])</span>

    <span class="n">fig19b_emb_to_bridge_w_raw</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
      <span class="p">[</span><span class="o">-</span><span class="mf">0.5043</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.50411</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.501545</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.50137</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.50639</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.509589</span><span class="p">,</span>
       <span class="o">-</span><span class="mf">0.512126</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.512329</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.506849</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.503306</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.49863</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.496063</span><span class="p">,</span>
       <span class="o">-</span><span class="mf">0.49589</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.49589</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.49589</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.501129</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.50137</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.508441</span><span class="p">,</span>
       <span class="o">-</span><span class="mf">0.512329</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.515012</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.517808</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.512419</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.512329</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.50411</span> <span class="p">,</span>
       <span class="o">-</span><span class="mf">0.49863</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.49515</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.487671</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.485722</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.479542</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.479452</span><span class="p">,</span>
       <span class="o">-</span><span class="mf">0.47675</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.473973</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.471263</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.465753</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.467125</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.471233</span><span class="p">,</span>
       <span class="o">-</span><span class="mf">0.478087</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.484932</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.489058</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.50137</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.509771</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.517808</span><span class="p">,</span>
       <span class="o">-</span><span class="mf">0.531507</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.53578</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.543966</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.547945</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.549347</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.550704</span><span class="p">,</span>
       <span class="o">-</span><span class="mf">0.5548</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.556164</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.556164</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.556164</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.555069</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.553425</span><span class="p">,</span>
       <span class="o">-</span><span class="mf">0.554593</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.556164</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.560863</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.561644</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.569863</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.569867</span><span class="p">,</span>
       <span class="o">-</span><span class="mf">0.582062</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.583562</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.58906</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.594521</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.597614</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.60274</span> <span class="p">,</span>
       <span class="o">-</span><span class="mf">0.606404</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.613699</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.615353</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.621918</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.622657</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.629233</span><span class="p">,</span>
       <span class="o">-</span><span class="mf">0.632877</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.632877</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.632877</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.633489</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.638969</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.643836</span><span class="p">,</span>
       <span class="o">-</span><span class="mf">0.644354</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.648978</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.652055</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.652633</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.654651</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.654795</span><span class="p">,</span>
       <span class="o">-</span><span class="mf">0.654795</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.654795</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.654795</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.654795</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.654795</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.654795</span><span class="p">,</span>
       <span class="o">-</span><span class="mf">0.654795</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.65604</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.657534</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.657363</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.654795</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.654795</span><span class="p">,</span>
       <span class="o">-</span><span class="mf">0.659882</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.660274</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.660274</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.660274</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.663014</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.664665</span><span class="p">,</span>
       <span class="o">-</span><span class="mf">0.6696</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.679452</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.681389</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.696745</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.69863</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.708937</span><span class="p">,</span>
       <span class="o">-</span><span class="mf">0.723288</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.728377</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.741865</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.745205</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.752705</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.76018</span> <span class="p">,</span>
       <span class="o">-</span><span class="mf">0.761644</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.776744</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.778082</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.786708</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.789041</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.797867</span><span class="p">,</span>
       <span class="o">-</span><span class="mf">0.80274</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.806409</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.816438</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.81782</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.823985</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.824658</span><span class="p">,</span>
       <span class="o">-</span><span class="mf">0.82786</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.830137</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.832886</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.837678</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.841096</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.841096</span><span class="p">,</span>
       <span class="o">-</span><span class="mf">0.841096</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.843094</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.846575</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.847262</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.852055</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.852055</span><span class="p">,</span>
       <span class="o">-</span><span class="mf">0.852055</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.852055</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.856167</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.860274</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.859075</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.857534</span><span class="p">,</span>
       <span class="o">-</span><span class="mf">0.860274</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.860862</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.863014</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.861986</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.860274</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.860457</span><span class="p">,</span>
       <span class="o">-</span><span class="mf">0.863014</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.863014</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.863014</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.860274</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.860274</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.860274</span><span class="p">,</span>
       <span class="o">-</span><span class="mf">0.863014</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.863014</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.863014</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.860707</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.860274</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.863014</span><span class="p">,</span>
       <span class="o">-</span><span class="mf">0.865753</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.867582</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.868493</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.873973</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.871233</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.871233</span><span class="p">,</span>
       <span class="o">-</span><span class="mf">0.871233</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.865753</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.864659</span><span class="p">])</span>


    <span class="n">fig12top_w</span> <span class="o">=</span> <span class="n">fig12top_w_raw</span>
    <span class="n">fig12top_t</span> <span class="o">=</span> <span class="n">fig12top_t_raw</span> <span class="o">+</span> <span class="mi">0</span>

    <span class="n">fig13top_w</span> <span class="o">=</span> <span class="n">fig13top_w_raw</span>
    <span class="n">fig13top_t</span> <span class="o">=</span> <span class="n">fig13top_t_raw</span> <span class="o">+</span> <span class="mi">0</span>
    <span class="n">fig13bot_w</span> <span class="o">=</span> <span class="n">fig13bot_w_raw</span>
    <span class="n">fig13bot_t</span> <span class="o">=</span> <span class="n">fig13bot_t_raw</span> <span class="o">+</span> <span class="mi">0</span>

    <span class="n">fig14top_w</span> <span class="o">=</span> <span class="n">fig14top_w_raw</span>
    <span class="n">fig14top_t</span> <span class="o">=</span> <span class="n">fig14top_t_raw</span> <span class="o">+</span> <span class="mi">0</span>
    <span class="n">fig14bot_w</span> <span class="o">=</span> <span class="n">fig14bot_w_raw</span>
    <span class="n">fig14bot_t</span> <span class="o">=</span> <span class="n">fig14bot_t_raw</span> <span class="o">+</span> <span class="mi">0</span>

    <span class="n">fig15top_w</span> <span class="o">=</span> <span class="n">fig15top_w_raw</span>
    <span class="n">fig15top_t</span> <span class="o">=</span> <span class="n">fig15top_t_raw</span> <span class="o">+</span> <span class="mi">0</span>
    <span class="n">fig15bot_w</span> <span class="o">=</span> <span class="n">fig15bot_w_raw</span>
    <span class="n">fig15bot_t</span> <span class="o">=</span> <span class="n">fig15bot_t_raw</span> <span class="o">+</span> <span class="mi">0</span>


    <span class="n">fig19b_emb_to_bridge_x</span> <span class="o">=</span> <span class="n">fig19b_emb_to_bridge_x_raw</span>
    <span class="n">fig19b_emb_to_bridge_w</span> <span class="o">=</span> <span class="n">fig19b_emb_to_bridge_w_raw</span>

    <span class="n">fig19b_bridge_to_emb_x</span> <span class="o">=</span> <span class="n">fig19b_bridge_to_emb_x_raw</span>
    <span class="n">fig19b_bridge_to_emb_w</span> <span class="o">=</span> <span class="n">fig19b_bridge_to_emb_w_raw</span>

    <span class="n">top_ts</span> <span class="o">=</span> <span class="p">[</span><span class="n">fig13top_t</span><span class="p">,</span> <span class="n">fig14top_t</span><span class="p">,</span> <span class="n">fig15top_t</span><span class="p">,</span> <span class="n">fig12top_t</span><span class="p">]</span>
    <span class="n">top_ws</span> <span class="o">=</span> <span class="p">[</span><span class="n">fig13top_w</span><span class="p">,</span> <span class="n">fig14top_w</span><span class="p">,</span> <span class="n">fig15top_w</span><span class="p">,</span> <span class="n">fig12top_w</span><span class="p">]</span>
    <span class="n">top_t_offset</span><span class="o">=</span><span class="p">[</span><span class="mf">0.03719</span><span class="p">,</span> <span class="mf">0.173177</span><span class="p">,</span> <span class="mf">0.23286</span><span class="o">-</span><span class="mf">0.01137</span><span class="p">,</span><span class="o">-</span><span class="mf">0.456988</span> <span class="p">]</span>

    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">ftime</span> <span class="o">+</span> <span class="s2">&quot;.txt&quot;</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">ftime</span> <span class="o">+</span> <span class="n">os</span><span class="o">.</span><span class="n">linesep</span><span class="p">)</span>

        <span class="n">matplotlib</span><span class="o">.</span><span class="n">rcParams</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s1">&#39;font.size&#39;</span><span class="p">:</span> <span class="mi">11</span><span class="p">})</span>
        <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mf">3.54</span><span class="p">,</span><span class="mf">4.5</span><span class="p">))</span>

        <span class="n">gs0</span> <span class="o">=</span> <span class="n">matplotlib</span><span class="o">.</span><span class="n">gridspec</span><span class="o">.</span><span class="n">GridSpec</span><span class="p">(</span>
                   <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span>
<span class="c1">#                  width_ratios=[1, 2],</span>
                   <span class="n">height_ratios</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span>
<span class="c1">#                   hspace=0.05,</span>
                   <span class="p">)</span>
        <span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs0</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">ax2</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs0</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="n">sharex</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>


        <span class="n">fig2</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>
        <span class="n">ax3</span> <span class="o">=</span> <span class="n">fig2</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="s2">&quot;111&quot;</span><span class="p">)</span>
        <span class="c1">#fig2 = plt.figure(figsize=(3.54,3.54))</span>
        <span class="c1">#ax2 = fig2.add_subplot(&quot;111&quot;)</span>

        <span class="c1">#fig3 = plt.figure(figsize=(3.54,3.54))</span>
        <span class="c1">#ax3 = fig3.add_subplot(&quot;111&quot;)</span>


        <span class="c1">#t_lengths = np.linspace(25,0,6)</span>
        <span class="c1">#betas = [0, 0.05, 0.1, 0.3, 1.1, 2.0]</span>

        <span class="n">fig4</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mf">3.54</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>
        <span class="n">gs</span> <span class="o">=</span> <span class="n">matplotlib</span><span class="o">.</span><span class="n">gridspec</span><span class="o">.</span><span class="n">GridSpec</span><span class="p">(</span>
                   <span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span>
<span class="c1">#                  width_ratios=[1, 2],</span>
<span class="c1">#                   height_ratios=[1,4],</span>
<span class="c1">#                   hspace=0.05,</span>
<span class="c1">#                   hspace = 0.05,</span>
<span class="c1">#                   top=0.05,</span>
                   <span class="p">)</span>
        <span class="n">axs</span> <span class="o">=</span><span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">):</span>
            <span class="n">axs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">fig4</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">0</span><span class="p">]))</span>
<span class="c1">#            if i==0:</span>
<span class="c1">#</span>
<span class="c1">#            else:</span>
<span class="c1">#                axs.append(fig4.add_subplot(gs[i,0], sharex=axs[0]))</span>

            <span class="k">if</span> <span class="n">i</span><span class="o">!=</span><span class="mi">3</span><span class="p">:</span>
                <span class="n">axs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">get_xaxis</span><span class="p">()</span><span class="o">.</span><span class="n">set_ticks</span><span class="p">([])</span>

            <span class="n">axs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">1.2</span><span class="p">,</span><span class="mf">0.2</span><span class="p">)</span>
            <span class="n">axs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span>

            <span class="n">axs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Rail displ. (mm)&quot;</span><span class="p">)</span>

        <span class="n">axs</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Time (s)&quot;</span><span class="p">)</span>







        <span class="n">k1</span> <span class="o">=</span> <span class="mf">160e6</span><span class="o">*</span><span class="mf">0.5</span> <span class="c1">#N/m</span>
        <span class="n">step1</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="mf">0.684881633</span><span class="o">*.</span><span class="mi">9</span>
        <span class="n">step2</span> <span class="o">=</span> <span class="mi">3</span><span class="o">*</span><span class="mf">0.5</span><span class="o">*</span><span class="mf">0.9</span>
        <span class="c1">#1030</span>
        <span class="c1">#10000</span>

        <span class="n">pier_width</span> <span class="o">=</span> <span class="mf">0.5</span>
        <span class="n">pierk</span><span class="o">=</span><span class="mf">2.5</span><span class="c1">#10000/80/4</span>
        <span class="n">beamk</span><span class="o">=</span><span class="mi">2</span><span class="o">*</span><span class="mf">0.9</span><span class="c1">#10000/80/4</span>
        <span class="n">m1</span><span class="o">=</span><span class="mi">2</span>
        <span class="n">m2</span><span class="o">=</span><span class="mi">2</span>
                                    <span class="c1">#x,     k1bar,  mubar,  rho_bar</span>
        <span class="n">xp</span><span class="p">,</span><span class="n">kp</span><span class="p">,</span><span class="n">mup</span><span class="p">,</span><span class="n">rhop</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
                                  <span class="p">[[</span><span class="mf">0.0</span><span class="p">,</span>                <span class="mf">1.</span><span class="p">,</span>     <span class="mi">1</span><span class="p">,</span>      <span class="mi">1</span><span class="p">],</span> <span class="c1">#start</span>
                                   <span class="p">[</span><span class="mi">30</span><span class="p">,</span>                 <span class="mf">1.</span><span class="p">,</span>     <span class="mf">1.</span><span class="p">,</span>     <span class="mi">1</span><span class="p">],</span><span class="c1">#start of UGM wedge,</span>
                                   <span class="p">[</span><span class="mi">30</span><span class="o">+</span><span class="p">(</span><span class="mi">40</span><span class="o">-</span><span class="mi">30</span><span class="p">)</span><span class="o">*</span><span class="mf">0.25</span><span class="p">,</span>       <span class="mi">1</span><span class="o">+</span><span class="p">(</span><span class="n">step1</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mf">0.25</span><span class="o">**</span><span class="n">m1</span><span class="p">,</span>   <span class="mi">1</span><span class="p">,</span>   <span class="mi">1</span><span class="p">],</span>
                                   <span class="p">[</span><span class="mi">30</span><span class="o">+</span><span class="p">(</span><span class="mi">40</span><span class="o">-</span><span class="mi">30</span><span class="p">)</span><span class="o">*</span><span class="mf">0.50</span><span class="p">,</span>       <span class="mi">1</span><span class="o">+</span><span class="p">(</span><span class="n">step1</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mf">0.50</span><span class="o">**</span><span class="n">m1</span><span class="p">,</span>   <span class="mi">1</span><span class="p">,</span>   <span class="mi">1</span><span class="p">],</span>
                                   <span class="p">[</span><span class="mi">30</span><span class="o">+</span><span class="p">(</span><span class="mi">40</span><span class="o">-</span><span class="mi">30</span><span class="p">)</span><span class="o">*</span><span class="mf">0.75</span><span class="p">,</span>       <span class="mi">1</span><span class="o">+</span><span class="p">(</span><span class="n">step1</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mf">0.75</span><span class="o">**</span><span class="n">m1</span><span class="p">,</span>   <span class="mi">1</span><span class="p">,</span>   <span class="mi">1</span><span class="p">],</span>
                                   <span class="p">[</span><span class="mi">40</span><span class="p">,</span>                 <span class="n">step1</span><span class="p">,</span>     <span class="mf">1.</span><span class="p">,</span>     <span class="mi">1</span><span class="p">],</span>     <span class="c1">#end of UGM wedge,</span>
                                   <span class="p">[</span><span class="mi">50</span><span class="p">,</span>                 <span class="n">step1</span><span class="p">,</span>     <span class="mf">1.</span><span class="p">,</span>     <span class="mi">1</span><span class="p">],</span> <span class="c1">#start of CBM,</span>
                                   <span class="p">[</span><span class="mi">50</span><span class="o">+</span><span class="p">(</span><span class="mi">57</span><span class="o">-</span><span class="mi">50</span><span class="p">)</span><span class="o">*</span><span class="mf">0.25</span><span class="p">,</span>       <span class="n">step1</span><span class="o">+</span><span class="p">(</span><span class="n">step2</span><span class="o">-</span><span class="n">step1</span><span class="p">)</span><span class="o">*</span><span class="mf">0.25</span><span class="o">**</span><span class="n">m2</span><span class="p">,</span>   <span class="mi">1</span><span class="p">,</span>   <span class="mi">1</span><span class="p">],</span>
                                   <span class="p">[</span><span class="mi">50</span><span class="o">+</span><span class="p">(</span><span class="mi">57</span><span class="o">-</span><span class="mi">50</span><span class="p">)</span><span class="o">*</span><span class="mf">0.50</span><span class="p">,</span>       <span class="n">step1</span><span class="o">+</span><span class="p">(</span><span class="n">step2</span><span class="o">-</span><span class="n">step1</span><span class="p">)</span><span class="o">*</span><span class="mf">0.50</span><span class="o">**</span><span class="n">m2</span><span class="p">,</span>   <span class="mi">1</span><span class="p">,</span>   <span class="mi">1</span><span class="p">],</span>
                                   <span class="p">[</span><span class="mi">50</span><span class="o">+</span><span class="p">(</span><span class="mi">57</span><span class="o">-</span><span class="mi">50</span><span class="p">)</span><span class="o">*</span><span class="mf">0.75</span><span class="p">,</span>       <span class="n">step1</span><span class="o">+</span><span class="p">(</span><span class="n">step2</span><span class="o">-</span><span class="n">step1</span><span class="p">)</span><span class="o">*</span><span class="mf">0.75</span><span class="o">**</span><span class="n">m2</span><span class="p">,</span>   <span class="mi">1</span><span class="p">,</span>   <span class="mi">1</span><span class="p">],</span>
                                   <span class="p">[</span><span class="mi">57</span><span class="p">,</span>                 <span class="n">step2</span><span class="p">,</span>     <span class="mf">1.</span><span class="p">,</span>     <span class="mi">1</span><span class="p">],</span> <span class="c1">#end of CBM</span>
                                   <span class="p">[</span><span class="mi">60</span><span class="p">,</span>                 <span class="n">step2</span><span class="p">,</span>     <span class="mf">1.</span><span class="p">,</span>     <span class="mi">1</span><span class="p">],</span><span class="c1">#Start abutment pier1</span>
                                   <span class="p">[</span><span class="mi">60</span><span class="p">,</span>                 <span class="n">pierk</span><span class="p">,</span>     <span class="mf">1.</span><span class="p">,</span>     <span class="mi">1</span><span class="p">],</span>
                                   <span class="p">[</span><span class="mi">60</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">pier_width</span><span class="p">,</span>    <span class="n">pierk</span><span class="p">,</span>     <span class="mf">1.</span><span class="p">,</span>     <span class="mi">1</span><span class="p">],</span>
                                   <span class="p">[</span><span class="mi">60</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">pier_width</span><span class="p">,</span>    <span class="n">beamk</span><span class="p">,</span>     <span class="mf">1.</span><span class="p">,</span>     <span class="mi">1</span><span class="p">],</span> <span class="c1">#end abutment pier 1</span>
                                   <span class="p">[</span><span class="mf">97.5</span><span class="o">-</span><span class="n">pier_width</span><span class="p">,</span>    <span class="n">beamk</span><span class="p">,</span>     <span class="mf">1.</span><span class="p">,</span>     <span class="mi">1</span><span class="p">],</span><span class="c1">#Start abutment pier 2</span>
                                   <span class="p">[</span><span class="mf">97.5</span><span class="o">-</span><span class="n">pier_width</span><span class="p">,</span>    <span class="n">pierk</span><span class="p">,</span>     <span class="mf">1.</span><span class="p">,</span>     <span class="mi">1</span><span class="p">],</span>
                                   <span class="p">[</span><span class="mf">97.5</span><span class="p">,</span>               <span class="n">pierk</span><span class="p">,</span>     <span class="mf">1.</span><span class="p">,</span>     <span class="mi">1</span><span class="p">],</span>
<span class="c1">#                                   [97.5+pier_width,    pierk,     1.,     1],</span>
<span class="c1">#                                   [97.5+pier_width,    beamk,     1.,     1], #end abutment pier 2</span>
<span class="c1">#                                   [135-pier_width,     beamk,     1.,     1],#Start abutment pier 3</span>
<span class="c1">#                                   [135-pier_width,     pierk,     1.,     1],</span>
<span class="c1">#                                   [135+pier_width,     pierk,     1.,     1],</span>
<span class="c1">#                                   [135+pier_width,     beamk,     1.,     1], #end abutment pier 3</span>
<span class="c1">#                                   [172.5-pier_width,   beamk,     1.,     1],#Start abutment pier 4</span>
<span class="c1">#                                   [172.5-pier_width,   pierk,     1.,     1],</span>
<span class="c1">#                                   [172.5,              pierk,     1.,     1], # end of beam</span>
                                   <span class="p">])</span><span class="o">.</span><span class="n">T</span>


<span class="c1">#                                   [60-pier_width,      step2,     1.,     1],#Start abutment pier1</span>
<span class="c1">#                                   [60-pier_width,      pierk,     1.,     1],</span>
<span class="c1">#                                   [60+pier_width,      pierk,     1.,     1],</span>
<span class="c1">#                                   [60+pier_width,      beamk,     1.,     1], #end abutment pier 1</span>
<span class="c1">#                                   [97.5-pier_width,    beamk,     1.,     1],#Start abutment pier 2</span>
<span class="c1">#                                   [97.5-pier_width,    pierk,     1.,     1],</span>
<span class="c1">#                                   [97.5,               pierk,     1.,     1],</span>


<span class="c1">#xp,kp,mup,rhop = np.array(</span>
<span class="c1">#                                  [[0.0,                1.,     1,      1], #start</span>
<span class="c1">#                                   [30,                 1.,     1.,     1],#start of UGM wedge,</span>
<span class="c1">#                                   [40,                 step1,     1.,     1],     #end of UGM wedge,</span>
<span class="c1">#                                   [50,                 step1,     1.,     1], #start of CBM,</span>
<span class="c1">#                                   [57,                 step2,     1.,     1], #end of CBM</span>
<span class="c1">#                                   [60,                 step2,     1.,     1],#Start abutment pier1</span>
<span class="c1">#                                   [60,                 pierk,     1.,     1],</span>
<span class="c1">#                                   [60+2*pier_width,    pierk,     1.,     1],</span>
<span class="c1">#                                   [60+2*pier_width,    beamk,     1.,     1], #end abutment pier 1</span>
<span class="c1">#                                   [97.5-pier_width,    beamk,     1.,     1],#Start abutment pier 2</span>
<span class="c1">#                                   [97.5-pier_width,    pierk,     1.,     1],</span>
<span class="c1">#                                   [97.5,               pierk,     1.,     1],</span>
<span class="c1">##                                   [97.5+pier_width,    pierk,     1.,     1],</span>
<span class="c1">##                                   [97.5+pier_width,    beamk,     1.,     1], #end abutment pier 2</span>
<span class="c1">##                                   [135-pier_width,     beamk,     1.,     1],#Start abutment pier 3</span>
<span class="c1">##                                   [135-pier_width,     pierk,     1.,     1],</span>
<span class="c1">##                                   [135+pier_width,     pierk,     1.,     1],</span>
<span class="c1">##                                   [135+pier_width,     beamk,     1.,     1], #end abutment pier 3</span>
<span class="c1">##                                   [172.5-pier_width,   beamk,     1.,     1],#Start abutment pier 4</span>
<span class="c1">##                                   [172.5-pier_width,   pierk,     1.,     1],</span>
<span class="c1">##                                   [172.5,              pierk,     1.,     1], # end of beam</span>
<span class="c1">#                                   ]).T</span>
<span class="c1">#</span>
<span class="c1">#</span>
<span class="c1">##                                   [60-pier_width,      step2,     1.,     1],#Start abutment pier1</span>
<span class="c1">##                                   [60-pier_width,      pierk,     1.,     1],</span>
<span class="c1">##                                   [60+pier_width,      pierk,     1.,     1],</span>
<span class="c1">##                                   [60+pier_width,      beamk,     1.,     1], #end abutment pier 1</span>
<span class="c1">##                                   [97.5-pier_width,    beamk,     1.,     1],#Start abutment pier 2</span>
<span class="c1">##                                   [97.5-pier_width,    pierk,     1.,     1],</span>
<span class="c1">##                                   [97.5,               pierk,     1.,     1],</span>



        <span class="c1">#6 train cars distance in (m), load in (kN)</span>
        <span class="n">train_x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
        <span class="p">[</span>  <span class="o">-</span><span class="mf">3.85</span><span class="p">,</span>   <span class="o">-</span><span class="mf">6.55</span><span class="p">,</span>  <span class="o">-</span><span class="mf">22.85</span><span class="p">,</span>  <span class="o">-</span><span class="mf">25.55</span><span class="p">,</span>  <span class="o">-</span><span class="mf">29.75</span><span class="p">,</span>  <span class="o">-</span><span class="mf">32.45</span><span class="p">,</span>  <span class="o">-</span><span class="mf">48.75</span><span class="p">,</span>
           <span class="o">-</span><span class="mf">51.45</span><span class="p">,</span>  <span class="o">-</span><span class="mf">55.65</span><span class="p">,</span>  <span class="o">-</span><span class="mf">58.35</span><span class="p">,</span>  <span class="o">-</span><span class="mf">74.65</span><span class="p">,</span>  <span class="o">-</span><span class="mf">77.35</span><span class="p">,</span>  <span class="o">-</span><span class="mf">81.55</span><span class="p">,</span>  <span class="o">-</span><span class="mf">84.25</span><span class="p">,</span>
           <span class="o">-</span><span class="mf">100.55</span><span class="p">,</span> <span class="o">-</span><span class="mf">103.25</span><span class="p">,</span> <span class="o">-</span><span class="mf">107.45</span><span class="p">,</span> <span class="o">-</span><span class="mf">110.15</span><span class="p">,</span> <span class="o">-</span><span class="mf">126.45</span><span class="p">,</span> <span class="o">-</span><span class="mf">129.15</span><span class="p">,</span> <span class="o">-</span><span class="mf">133.35</span><span class="p">,</span>
           <span class="o">-</span><span class="mf">136.05</span><span class="p">,</span> <span class="o">-</span><span class="mf">152.35</span><span class="p">,</span> <span class="o">-</span><span class="mf">155.05</span><span class="p">])</span>
        <span class="n">train_f</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
        <span class="p">[</span><span class="o">-</span><span class="mf">129.8</span><span class="p">,</span> <span class="o">-</span><span class="mf">133.2</span><span class="p">,</span> <span class="o">-</span><span class="mf">132.6</span><span class="p">,</span> <span class="o">-</span><span class="mf">129.2</span><span class="p">,</span> <span class="o">-</span><span class="mf">131.5</span><span class="p">,</span> <span class="o">-</span><span class="mf">134.9</span><span class="p">,</span> <span class="o">-</span><span class="mf">134.9</span><span class="p">,</span> <span class="o">-</span><span class="mf">131.5</span><span class="p">,</span>
           <span class="o">-</span><span class="mf">128.8</span><span class="p">,</span> <span class="o">-</span><span class="mf">128.8</span><span class="p">,</span> <span class="o">-</span><span class="mf">128.</span> <span class="p">,</span> <span class="o">-</span><span class="mf">128.8</span><span class="p">,</span> <span class="o">-</span><span class="mf">132.7</span><span class="p">,</span> <span class="o">-</span><span class="mf">132.7</span><span class="p">,</span> <span class="o">-</span><span class="mf">132.7</span><span class="p">,</span> <span class="o">-</span><span class="mf">132.7</span><span class="p">,</span>
           <span class="o">-</span><span class="mf">133.2</span><span class="p">,</span> <span class="o">-</span><span class="mf">136.6</span><span class="p">,</span> <span class="o">-</span><span class="mf">136.6</span><span class="p">,</span> <span class="o">-</span><span class="mf">133.2</span><span class="p">,</span> <span class="o">-</span><span class="mf">130.2</span><span class="p">,</span> <span class="o">-</span><span class="mf">133.6</span><span class="p">,</span> <span class="o">-</span><span class="mf">134.2</span><span class="p">,</span> <span class="o">-</span><span class="mf">130.8</span><span class="p">])</span><span class="o">*</span><span class="mi">1000</span>



        <span class="n">L</span> <span class="o">=</span> <span class="n">xp</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

        <span class="n">train_v</span> <span class="o">=</span> <span class="mi">220</span><span class="o">*</span><span class="mi">1000</span><span class="o">/</span><span class="mi">60</span><span class="o">/</span><span class="mi">60</span> <span class="c1">#m/s</span>
        <span class="n">tstart</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">tend</span> <span class="o">=</span> <span class="p">(</span><span class="mf">64.5</span> <span class="o">+</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">train_x</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> <span class="o">/</span> <span class="n">train_v</span>

        <span class="n">tvals</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">tstart</span><span class="p">,</span> <span class="n">tend</span><span class="p">,</span> <span class="n">nt</span><span class="p">)</span>


        <span class="c1"># x=64.5--&gt; Paix -4.5</span>
        <span class="c1"># x=18.9--&gt; Paix 41.1</span>
        <span class="c1"># x=45.3--&gt; Paix 14.7</span>
        <span class="c1"># x=59.1--&gt; Paix 0.9</span>
        <span class="c1">#i.e. xrohan = 64.5 - xpaix -4.5 ; need to check</span>
        <span class="c1">#xpaix = -4.5 + (64.5-xrohan)</span>

        <span class="n">x_interest</span> <span class="o">=</span> <span class="p">[</span><span class="mf">18.9</span><span class="p">,</span> <span class="mf">45.3</span><span class="p">,</span> <span class="mf">59.1</span><span class="p">,</span> <span class="mf">64.5</span><span class="p">]</span>

        <span class="n">xvals</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mf">64.5</span><span class="p">,</span><span class="n">nx</span><span class="p">),</span> <span class="n">x_interest</span><span class="p">)</span>
        <span class="n">xvals</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
        <span class="n">i_interest</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">searchsorted</span><span class="p">(</span><span class="n">xvals</span><span class="p">,</span> <span class="n">x_interest</span><span class="p">)</span>

        <span class="n">pdict</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">(</span>
                    <span class="n">E</span> <span class="o">=</span> <span class="mf">210e9</span><span class="p">,</span> <span class="c1">#Pa</span>
                    <span class="n">rho</span> <span class="o">=</span> <span class="mi">7850</span><span class="p">,</span> <span class="c1">#kg/m^3</span>
                    <span class="n">L</span> <span class="o">=</span> <span class="n">L</span><span class="p">,</span> <span class="c1">#m</span>
                    <span class="n">A</span> <span class="o">=</span> <span class="mf">0.3</span><span class="o">*</span><span class="mf">0.12</span><span class="o">*</span><span class="mf">7.7e-3</span><span class="p">,</span> <span class="c1"># m^2</span>
                    <span class="n">I</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="mf">30.55e-6</span><span class="p">,</span><span class="c1">#m^4</span>
                    <span class="n">k1</span> <span class="o">=</span> <span class="n">k1</span><span class="p">,</span><span class="c1">#160e6,#N/m</span>
                    <span class="n">mu</span> <span class="o">=</span> <span class="mf">17e3</span><span class="p">,</span>
<span class="c1">#                    kf=5.41e-4,</span>
                    <span class="c1">#Fz_norm=1.013e-4,</span>
<span class="c1">#                    mu_norm=39.263/4/2/1000,</span>
<span class="c1">#                    mubar=PolyLine([0,0.05,0.05,.95,.95,1],[1,1,1,1,1,1]),</span>
<span class="c1">#                    k1_norm=97.552,</span>
    <span class="c1">#                k1bar=PolyLine([0,0.2,0.3,1],[1.0,1,0.1,0.1]),</span>
<span class="c1">#                    k1bar=PolyLine([0,0.2,0.2,1],[1.0,1,1,1]),</span>

    <span class="c1">#                k3_norm=2.497e6,</span>

                    <span class="n">k1bar</span> <span class="o">=</span> <span class="n">PolyLine</span><span class="p">(</span><span class="n">xp</span><span class="o">/</span><span class="n">L</span><span class="p">,</span> <span class="n">kp</span><span class="p">),</span>
                    <span class="n">moving_loads_x</span> <span class="o">=</span> <span class="p">[</span><span class="n">train_x</span><span class="p">],</span> <span class="c1">#m</span>
                    <span class="n">moving_loads_Fz</span> <span class="o">=</span> <span class="p">[</span><span class="n">train_f</span><span class="p">],</span> <span class="c1">#N</span>
                    <span class="n">moving_loads_v</span> <span class="o">=</span> <span class="p">[</span><span class="n">train_v</span><span class="p">],</span> <span class="c1">#m/s</span>
                    <span class="n">nterms</span><span class="o">=</span><span class="n">nterms</span><span class="p">,</span>
                    <span class="n">BC</span><span class="o">=</span><span class="s2">&quot;SS&quot;</span><span class="p">,</span>
<span class="c1">#                    nquad=20,</span>
<span class="c1">#                    moving_loads_x_norm=[[0]],</span>
<span class="c1">#                    moving_loads_Fz_norm=[[1.013e-4]],</span>
<span class="c1">#                    moving_loads_v_norm=[v,],#[0.01165,],</span>
                    <span class="n">tvals</span><span class="o">=</span><span class="n">tvals</span><span class="p">,</span>
                    <span class="n">xvals_norm</span><span class="o">=</span><span class="n">xvals</span><span class="o">/</span><span class="n">L</span><span class="p">,</span>
                    <span class="n">use_analytical</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                    <span class="n">implementation</span><span class="o">=</span><span class="s2">&quot;fortran&quot;</span><span class="p">,</span>
                    <span class="n">force_calc</span><span class="o">=</span><span class="n">force_calc</span><span class="p">,</span>

                    <span class="p">)</span>


        <span class="c1">#zmax = np.zeros((len(alphas), len(t_lengths)), dtype=float)</span>
        <span class="c1">#zmin = np.zeros((len(alphas), len(t_lengths)), dtype=float)</span>



        <span class="n">start_time1</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>

        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;*&quot;</span> <span class="o">*</span> <span class="mi">70</span> <span class="o">+</span> <span class="n">os</span><span class="o">.</span><span class="n">linesep</span><span class="p">)</span>
        <span class="n">vequals</span> <span class="o">=</span> <span class="s2">&quot;Paixao et al 2016&quot;</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">vequals</span> <span class="o">+</span> <span class="n">os</span><span class="o">.</span><span class="n">linesep</span><span class="p">);</span> <span class="nb">print</span><span class="p">(</span><span class="n">vequals</span><span class="p">)</span>


        <span class="n">pdict</span><span class="p">[</span><span class="s2">&quot;file_stem&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Paixaoet al_n</span><span class="si">{:d}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">nterms</span><span class="p">)</span>

        <span class="n">a</span> <span class="o">=</span> <span class="n">SpecBeam</span><span class="p">(</span><span class="o">**</span><span class="n">pdict</span><span class="p">)</span>
        <span class="n">a</span><span class="o">.</span><span class="n">runme</span><span class="p">()</span>
        <span class="n">a</span><span class="o">.</span><span class="n">saveme</span><span class="p">()</span>
        <span class="n">a</span><span class="o">.</span><span class="n">animateme</span><span class="p">()</span>
        <span class="c1">#w_now_max = np.max(a.defl)</span>
        <span class="c1">#w_now_min = np.min(a.defl)</span>

        <span class="n">defl_max_envelope</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">defl</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">defl_min_envelope</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">defl</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>


        <span class="c1">#xpaix = -4.5 + (64.5-xrohan)</span>
        <span class="n">dist_from_abut</span> <span class="o">=</span> <span class="o">-</span><span class="mf">4.5</span> <span class="o">+</span> <span class="p">(</span><span class="mf">64.5</span><span class="o">-</span><span class="n">pdict</span><span class="p">[</span><span class="s2">&quot;xvals_norm&quot;</span><span class="p">]</span><span class="o">*</span><span class="n">L</span><span class="p">)</span>
<span class="c1">#        line, =ax.plot(pdict[&quot;xvals_norm&quot;]*L, defl_max_envelope*1000,</span>
<span class="c1">#                 label=&quot;hello&quot;)</span>
<span class="c1">#        ax.plot(pdict[&quot;xvals_norm&quot;]*L, defl_min_envelope*1000,</span>
<span class="c1">#                 color = line.get_color(),</span>
<span class="c1">#                 )</span>

        <span class="n">line</span><span class="p">,</span> <span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">dist_from_abut</span><span class="p">,</span> <span class="n">defl_min_envelope</span><span class="o">*</span><span class="mi">1000</span><span class="p">,</span>
                 <span class="n">label</span><span class="o">=</span><span class="s2">&quot;specbeam&quot;</span><span class="p">)</span>

        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">fig19b_emb_to_bridge_x</span><span class="p">,</span><span class="n">fig19b_emb_to_bridge_w</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;axle FEM (Paixao)&quot;</span><span class="p">,</span>
                <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;s&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;green&quot;</span><span class="p">,</span><span class="n">markerfacecolor</span><span class="o">=</span><span class="s2">&quot;none&quot;</span><span class="p">,</span>
                <span class="n">markevery</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span><span class="n">ms</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span><span class="n">markeredgecolor</span><span class="o">=</span><span class="s2">&quot;green&quot;</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">ii</span><span class="p">,</span><span class="n">xx</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">i_interest</span><span class="p">,</span><span class="n">x_interest</span><span class="p">)):</span>

            <span class="n">axs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">tvals</span><span class="p">,</span> <span class="n">a</span><span class="o">.</span><span class="n">defl</span><span class="p">[</span><span class="n">ii</span><span class="p">,:]</span><span class="o">*</span><span class="mi">1000</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;specbeam&#39;</span><span class="p">)</span>

            <span class="n">offset_t</span> <span class="o">=</span> <span class="n">top_t_offset</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="n">axs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">top_ts</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">-</span><span class="n">offset_t</span><span class="p">,</span><span class="n">top_ws</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;measured x=</span><span class="si">{:.1f}</span><span class="s2">m&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="o">-</span><span class="mf">4.5</span> <span class="o">+</span> <span class="p">(</span><span class="mf">64.5</span><span class="o">-</span><span class="n">xx</span><span class="p">)))</span>

            <span class="n">ax3</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">tvals</span><span class="p">,</span><span class="n">a</span><span class="o">.</span><span class="n">defl</span><span class="p">[</span><span class="n">ii</span><span class="p">,:]</span><span class="o">*</span><span class="mi">1000</span><span class="p">,</span>
                     <span class="n">label</span><span class="o">=</span><span class="s2">&quot;x=</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">xx</span><span class="p">))</span>



        <span class="n">end_time1</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
        <span class="n">elapsed_time</span> <span class="o">=</span> <span class="p">(</span><span class="n">end_time1</span> <span class="o">-</span> <span class="n">start_time1</span><span class="p">);</span> <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Run time=</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">timedelta</span><span class="p">(</span><span class="n">seconds</span><span class="o">=</span><span class="n">elapsed_time</span><span class="p">))))</span>



        <span class="n">adjust</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">top</span><span class="o">=</span><span class="mf">0.9</span><span class="p">,</span> <span class="n">bottom</span><span class="o">=</span><span class="mf">0.13</span><span class="p">,</span> <span class="n">left</span><span class="o">=</span><span class="mf">0.19</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="mf">0.95</span><span class="p">)</span>
        <span class="c1">#peak envelope plot</span>
        <span class="c1">###################</span>
        <span class="c1">#ax.set_title(&quot;$\\beta={},k_1/k_2={}$&quot;.format(beta, k_ratio))</span>
<span class="c1">#        ax.set_xlabel(&quot;x&quot;)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Peak displacement (mm)&quot;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="c1">#        leg = ax3.legend(title=&quot;$\\alpha$&quot;,</span>
<span class="c1">#                        loc=&quot;upper right&quot;,</span>
<span class="c1">##                        ncol=2,</span>
<span class="c1">#                        labelspacing=.2,</span>
<span class="c1">#                        handlelength=2,</span>
<span class="c1">#                        fontsize=8</span>
<span class="c1">#                        )</span>
<span class="c1">#        leg.draggable()</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">labelpad</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">labelpad</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">50</span><span class="p">,</span> <span class="o">-</span><span class="mi">5</span><span class="p">)</span>
        <span class="n">leg</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span>
                        <span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper left&#39;</span><span class="p">)</span>
        <span class="n">leg</span><span class="o">.</span><span class="n">draggable</span><span class="p">()</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">top</span><span class="o">=</span><span class="mf">0.95</span><span class="p">,</span> <span class="n">bottom</span><span class="o">=</span><span class="mf">0.13</span><span class="p">,</span> <span class="n">left</span><span class="o">=</span><span class="mf">0.19</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="mf">0.9</span><span class="p">)</span>
        <span class="c1">####################</span>
        <span class="c1">#Kplot</span>
        <span class="n">dist_from_abut</span> <span class="o">=</span> <span class="o">-</span><span class="mf">4.5</span> <span class="o">+</span> <span class="p">(</span><span class="mf">64.5</span><span class="o">-</span><span class="n">xp</span><span class="p">)</span>
        <span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">dist_from_abut</span><span class="p">,</span> <span class="n">kp</span><span class="p">)</span><span class="c1">#xp, kp)</span>
        <span class="n">ax2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Distance from abutment (m)&quot;</span><span class="p">)</span>
        <span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;$k/k_</span><span class="si">{ref}</span><span class="s2">$&quot;</span><span class="p">)</span>
        <span class="n">ax2</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mf">0.9</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">x_interest</span><span class="p">):</span>
            <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">interp</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">xp</span><span class="p">,</span><span class="n">kp</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">i</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span>
                <span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="o">-</span><span class="mf">4.5</span> <span class="o">+</span> <span class="p">(</span><span class="mf">64.5</span><span class="o">-</span><span class="n">x</span><span class="p">),</span><span class="n">y</span><span class="p">,</span><span class="n">ls</span><span class="o">=</span><span class="s1">&#39;:&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;defl. vs time evaluation point&quot;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="o">-</span><span class="mf">4.5</span> <span class="o">+</span> <span class="p">(</span><span class="mf">64.5</span><span class="o">-</span><span class="n">x</span><span class="p">),</span><span class="n">y</span><span class="p">,</span><span class="n">ls</span><span class="o">=</span><span class="s1">&#39;:&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">)</span>

            <span class="n">leg</span> <span class="o">=</span> <span class="n">axs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span>
                    <span class="n">loc</span><span class="o">=</span><span class="s1">&#39;lower left&#39;</span><span class="p">)</span>
            <span class="n">leg</span><span class="o">.</span><span class="n">draggable</span><span class="p">()</span>

        <span class="n">leg</span> <span class="o">=</span> <span class="n">ax2</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span>
                        <span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper left&#39;</span><span class="p">,</span>
                        <span class="n">numpoints</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">leg</span><span class="o">.</span><span class="n">draggable</span><span class="p">()</span>

        <span class="c1">#displacemetn vs tiem at points plot</span>
        <span class="c1">###################</span>
        <span class="c1">#ax3.set_title(&quot;$\\beta={},k_1/k_2={}$&quot;.format(beta, k_ratio))</span>
        <span class="n">ax3</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;time (s)&quot;</span><span class="p">)</span>
        <span class="n">ax3</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Displacement (mm)&quot;</span><span class="p">)</span>
<span class="c1">#        ax3.grid()</span>
        <span class="n">leg</span> <span class="o">=</span> <span class="n">ax3</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s2">&quot;$</span><span class="se">\\</span><span class="s2">alpha$&quot;</span><span class="p">,</span>
                        <span class="n">loc</span><span class="o">=</span><span class="s2">&quot;upper right&quot;</span><span class="p">,</span>
<span class="c1">#                        ncol=2,</span>
                        <span class="n">labelspacing</span><span class="o">=.</span><span class="mi">2</span><span class="p">,</span>
                        <span class="n">handlelength</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
                        <span class="n">fontsize</span><span class="o">=</span><span class="mi">8</span>
                        <span class="p">)</span>
<span class="c1">#        leg.draggable()</span>
        <span class="n">ax3</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">labelpad</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
        <span class="n">ax3</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">labelpad</span> <span class="o">=</span> <span class="mi">0</span>


        <span class="c1">#compare with field</span>
        <span class="n">fig4</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">top</span><span class="o">=</span><span class="mf">0.98</span><span class="p">,</span> <span class="n">bottom</span><span class="o">=</span><span class="mf">0.08</span><span class="p">,</span> <span class="n">left</span><span class="o">=</span><span class="mf">0.19</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="mf">0.9</span><span class="p">,</span> <span class="n">hspace</span><span class="o">=</span><span class="mf">0.04</span><span class="p">)</span>

<span class="c1">#        fig.subplots_adjust(**adjust)</span>

        <span class="n">end_time0</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
        <span class="n">elapsed_time</span> <span class="o">=</span> <span class="p">(</span><span class="n">end_time0</span> <span class="o">-</span> <span class="n">start_time0</span><span class="p">);</span> <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Total run time=</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">timedelta</span><span class="p">(</span><span class="n">seconds</span><span class="o">=</span><span class="n">elapsed_time</span><span class="p">))))</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;Total run time=</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">timedelta</span><span class="p">(</span><span class="n">seconds</span><span class="o">=</span><span class="n">elapsed_time</span><span class="p">)))</span> <span class="o">+</span> <span class="n">os</span><span class="o">.</span><span class="n">linesep</span><span class="p">)</span>
<span class="c1">#        a.animateme()</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">saveas</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">save_figure</span><span class="p">(</span><span class="n">fig</span><span class="o">=</span><span class="n">fig</span><span class="p">,</span> <span class="n">fname</span><span class="o">=</span><span class="n">saveas</span><span class="o">+</span><span class="s2">&quot;_fig1&quot;</span><span class="p">)</span>
        <span class="n">save_figure</span><span class="p">(</span><span class="n">fig</span><span class="o">=</span><span class="n">fig4</span><span class="p">,</span> <span class="n">fname</span><span class="o">=</span><span class="n">saveas</span><span class="o">+</span><span class="s2">&quot;_fig2&quot;</span><span class="p">)</span>
<span class="c1">#        save_figure(fig=fig2, fname=saveas + &quot;_up&quot;)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">clf</span><span class="p">()</span></div>
<span class="c1">#    fig2.clf()</span>

<div class="viewcode-block" id="transition_DAF1"><a class="viewcode-back" href="../../../api/geotecha.beam_on_foundation.specbeam.html#geotecha.beam_on_foundation.specbeam.transition_DAF1">[docs]</a><span class="k">def</span> <span class="nf">transition_DAF1</span><span class="p">(</span><span class="n">saveas</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                    <span class="n">ax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                    <span class="n">kratios</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                    <span class="n">alpmax</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
                    <span class="n">npts</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span>
                    <span class="n">betas</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                    <span class="n">article_formatting</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                    <span class="n">DAFmax</span><span class="o">=</span><span class="mi">4</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Plot of Dynamic Amplification Factor (DAF) vs velocity ratio</span>
<span class="sd">    for different stiffness and damping values.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    saveas : string, optional</span>
<span class="sd">        Filename (not including extension) to save figure to.</span>
<span class="sd">        Default saveas=None, i.e. figure won&#39;t be saved to disk.</span>
<span class="sd">    ax : matplotlib.Axes object, optional</span>
<span class="sd">        Axes object to plot on. Default ax=None, i.e. figure and axis</span>
<span class="sd">        will be created.  Nb this might return an error if used as the function</span>
<span class="sd">        will try and return then figure.</span>
<span class="sd">    kratios : list of float, optional</span>
<span class="sd">        striffness ratio values. Default kratios=None which will</span>
<span class="sd">        mean kratios=[1,2].</span>
<span class="sd">    alpmax : float, optional</span>
<span class="sd">        maximum velocit ratio considered (i.e x-axis max).  Default alpmax=3</span>
<span class="sd">    npts : int, optional</span>
<span class="sd">        velocity ratios (i.e x-axis values) will be npts between</span>
<span class="sd">        0 and alpmax. Default npts=500.</span>
<span class="sd">    betas : list of float, optional</span>
<span class="sd">        list of damping ratios to consider.  Default betas=None which will</span>
<span class="sd">        mean betas=[0,0.05, 0.1, 0.3, 1.1, 2.0]</span>
<span class="sd">    article_formatting : [False, True], optional</span>
<span class="sd">        You should never need this.  It was a quick hack to do some</span>
<span class="sd">        custom formatting for a journal article.  Dont even try messing with</span>
<span class="sd">        it.  will ony work with 6 beta values or less.  Default=False,</span>
<span class="sd">        i.e. no special formatting.</span>
<span class="sd">    DAFmax : float, optional</span>
<span class="sd">        Y-axis max.  Default DAFmax=4</span>


<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    fig : matplotlib figure</span>
<span class="sd">        the figure</span>


<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="n">article_formatting</span><span class="p">:</span>
        <span class="n">mdc</span> <span class="o">=</span> <span class="n">MarkersDashesColors</span><span class="p">(</span><span class="n">markersize</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span><span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

        <span class="n">mdc</span><span class="o">.</span><span class="n">construct_styles</span><span class="p">(</span><span class="n">markers</span><span class="o">=</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">25</span><span class="p">,</span><span class="mi">11</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">15</span><span class="p">],</span>
                       <span class="n">dashes</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                       <span class="n">marker_colors</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">],</span>
                   <span class="n">line_colors</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">])</span>

        <span class="n">styles</span><span class="o">=</span><span class="n">mdc</span><span class="p">(</span><span class="n">markers</span><span class="o">=</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">25</span><span class="p">,</span><span class="mi">11</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">15</span><span class="p">],</span>
                       <span class="n">dashes</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                       <span class="n">marker_colors</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">],</span>
                   <span class="n">line_colors</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">])</span>
        <span class="c1">#a.demo_styles()</span>

    <span class="n">start_time0</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
    <span class="c1">#ftime = datetime.datetime.fromtimestamp(start_time0).strftime(&#39;%Y-%m-%d %H%M%S&#39;)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Started transition_DAF1&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">ax</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">fig</span><span class="p">,</span><span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mf">3.54</span><span class="p">,</span><span class="mf">3.54</span><span class="p">))</span>
    <span class="n">matplotlib</span><span class="o">.</span><span class="n">rcParams</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s1">&#39;font.size&#39;</span><span class="p">:</span> <span class="mi">11</span><span class="p">})</span>

    <span class="k">if</span> <span class="n">kratios</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">kratios</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span>

    <span class="k">if</span> <span class="n">betas</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">betas</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">]</span>

    <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">kratio</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">kratios</span><span class="p">):</span>
        <span class="n">start_time1</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;doing kratio=</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">kratio</span><span class="p">))</span>

        <span class="n">alpha</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">alpmax</span><span class="p">,</span><span class="n">npts</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">j</span><span class="p">,</span><span class="n">bet</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">betas</span><span class="p">):</span>
            <span class="n">DAF</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty_like</span><span class="p">(</span><span class="n">alpha</span><span class="p">)</span>

            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">alp</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">alpha</span><span class="p">):</span>
                <span class="n">DAF</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">DAFinfinite</span><span class="p">(</span><span class="n">alp</span><span class="p">,</span> <span class="n">bet</span><span class="o">=</span><span class="n">bet</span><span class="p">,</span><span class="n">kratio</span><span class="o">=</span><span class="n">kratio</span><span class="p">)</span>

            <span class="n">labela</span> <span class="o">=</span> <span class="s2">&quot;$k_2/k_1=</span><span class="si">{}</span><span class="s2">$&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">kratio</span><span class="p">)</span>
            <span class="n">labelb</span> <span class="o">=</span> <span class="s2">&quot;$</span><span class="se">\\</span><span class="s2">beta=</span><span class="si">{}</span><span class="s2">$&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">bet</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">k</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">j</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span>
                    <span class="n">label</span><span class="o">=</span><span class="n">labelb</span><span class="o">+</span><span class="s2">&quot;, &quot;</span> <span class="o">+</span> <span class="n">labela</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">label</span><span class="o">=</span><span class="n">labelb</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">j</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span>
                    <span class="n">label</span> <span class="o">=</span> <span class="n">labela</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">label</span><span class="o">=</span><span class="kc">None</span>

            <span class="k">if</span> <span class="n">j</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">article_formatting</span><span class="p">:</span>
                    <span class="n">line</span><span class="p">,</span> <span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">alpha</span><span class="p">,</span> <span class="n">DAF</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">label</span><span class="p">,</span><span class="n">markevery</span><span class="o">=</span><span class="p">(</span><span class="mf">0.03</span><span class="o">+</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="o">.</span><span class="mi">06</span><span class="p">][</span><span class="n">k</span><span class="p">],</span><span class="mf">500.0</span><span class="p">),</span><span class="o">**</span><span class="n">styles</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">line</span><span class="p">,</span> <span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">alpha</span><span class="p">,</span> <span class="n">DAF</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">label</span><span class="p">,</span>
                                   <span class="c1">#alpha=1,</span>
    <span class="c1">#                               marker=&#39;s&#39;,ms=2,</span>
                                   <span class="p">)</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">alpha</span><span class="p">,</span> <span class="n">DAF</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">label</span><span class="p">,</span>
                        <span class="c1">#alpha=0.8-0.5*j/len(betas),</span>
                               <span class="c1">#marker=&#39;s&#39;,ms=2,</span>
                               <span class="n">color</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">get_color</span><span class="p">())</span>

        <span class="n">end_time1</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
        <span class="n">elapsed_time</span> <span class="o">=</span> <span class="p">(</span><span class="n">end_time1</span> <span class="o">-</span> <span class="n">start_time1</span><span class="p">);</span> <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Run time=</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">timedelta</span><span class="p">(</span><span class="n">seconds</span><span class="o">=</span><span class="n">elapsed_time</span><span class="p">))))</span>

    <span class="n">leg</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span>
<span class="c1">#                    title=&quot;$\\beta$&quot;,</span>
<span class="c1">#                    loc=&quot;upper center&quot;,</span>
<span class="c1">#                    ncol=2,</span>
                    <span class="n">labelspacing</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                    <span class="n">handlelength</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
                    <span class="n">fontsize</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span>
                    <span class="n">numpoints</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                    <span class="p">)</span>


    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="n">DAFmax</span><span class="p">])</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="n">alpmax</span><span class="p">])</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>


    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;$DAF_</span><span class="si">{wrt1}</span><span class="s2">$&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;$</span><span class="se">\\</span><span class="s2">alpha_1$&quot;</span><span class="p">)</span>

    <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">labelpad</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">labelpad</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="n">fig</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">top</span><span class="o">=</span><span class="mf">0.95</span><span class="p">,</span> <span class="n">bottom</span><span class="o">=</span><span class="mf">0.13</span><span class="p">,</span> <span class="n">left</span><span class="o">=</span><span class="mf">0.14</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="mf">0.95</span><span class="p">)</span>


    <span class="n">end_time0</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
    <span class="n">elapsed_time</span> <span class="o">=</span> <span class="p">(</span><span class="n">end_time0</span> <span class="o">-</span> <span class="n">start_time0</span><span class="p">);</span> <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Total run time=</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">timedelta</span><span class="p">(</span><span class="n">seconds</span><span class="o">=</span><span class="n">elapsed_time</span><span class="p">))))</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">saveas</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">save_figure</span><span class="p">(</span><span class="n">fig</span><span class="o">=</span><span class="n">fig</span><span class="p">,</span> <span class="n">fname</span><span class="o">=</span><span class="n">saveas</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">fig</span></div>

<div class="viewcode-block" id="transition_DAF1_at_specific_alp"><a class="viewcode-back" href="../../../api/geotecha.beam_on_foundation.specbeam.html#geotecha.beam_on_foundation.specbeam.transition_DAF1_at_specific_alp">[docs]</a><span class="k">def</span> <span class="nf">transition_DAF1_at_specific_alp</span><span class="p">(</span><span class="n">saveas</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                                    <span class="n">ax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                                    <span class="n">alphas</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                                    <span class="n">kratios</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                                    <span class="n">betas</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                                    <span class="n">DAFmax</span><span class="o">=</span><span class="mi">4</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Plot of Dynamic Amplification Factor (DAF) vs stiffness ratio</span>
<span class="sd">    for different velocity ratios and damping values.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    saveas : string, optional</span>
<span class="sd">        Filename (not including extension) to save figure to.</span>
<span class="sd">        Default saveas=None, i.e. figure won&#39;t be saved to disk.</span>
<span class="sd">    ax : matplotlib.Axes object, optional</span>
<span class="sd">        Axes object to plot on. Default ax=None, i.e. figure and axis</span>
<span class="sd">        will be created.  Nb this might return an error if used as the function</span>
<span class="sd">        will try and return then figure.</span>
<span class="sd">    alphas : list of float,optional</span>
<span class="sd">        Specific velocity ratios to calc at.  Default alphas=None which will</span>
<span class="sd">        use [0.1, 0.5, 0.8].</span>
<span class="sd">    kratios : list of float, optional</span>
<span class="sd">        striffness ratio values. Default kratios=None which will</span>
<span class="sd">        mean kratios=np.logspace(np.log10(0.1), np.log10(100), 100), i.e</span>
<span class="sd">        100 points logspaced between 0.1 and 100.</span>
<span class="sd">    betas : list of float, optional</span>
<span class="sd">        list of damping ratios to consider.  Default betas=None which will</span>
<span class="sd">    DAFmax : float, optional</span>
<span class="sd">        Y-axis max.  Default DAFmax=4</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    fig : matplotlib figure</span>
<span class="sd">        the figure</span>


<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">start_time0</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Started transition_DAF1_at_specific_alp&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">ax</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">fig</span><span class="p">,</span><span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mf">3.54</span><span class="p">,</span><span class="mf">3.54</span><span class="p">))</span>
        <span class="n">matplotlib</span><span class="o">.</span><span class="n">rcParams</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s1">&#39;font.size&#39;</span><span class="p">:</span> <span class="mi">11</span><span class="p">})</span>

    <span class="k">if</span> <span class="n">kratios</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">kratios</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">logspace</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="mf">0.1</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="mi">100</span><span class="p">),</span> <span class="mi">100</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">alphas</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">alphas</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.1</span><span class="p">,</span><span class="mf">0.5</span><span class="p">,</span><span class="mf">0.8</span><span class="p">]</span>

    <span class="k">if</span> <span class="n">betas</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">betas</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">]</span>


    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">alp</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">alphas</span><span class="p">):</span>
        <span class="n">start_time1</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;doing alpha=</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">alp</span><span class="p">))</span>

        <span class="k">for</span> <span class="n">j</span><span class="p">,</span><span class="n">bet</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">betas</span><span class="p">):</span>
            <span class="n">DAF</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty_like</span><span class="p">(</span><span class="n">kratios</span><span class="p">)</span>

            <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">kratio</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">kratios</span><span class="p">):</span>
                <span class="n">DAF</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">DAFinfinite</span><span class="p">(</span><span class="n">alp</span><span class="o">/</span><span class="n">kratio</span><span class="o">**</span><span class="p">(</span><span class="mf">0.25</span><span class="p">),</span> <span class="n">bet</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">kratio</span><span class="p">)</span><span class="o">**</span><span class="mf">0.5</span><span class="p">)</span>
                <span class="n">DAF</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">*=</span> <span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">kratio</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="mf">0.75</span><span class="p">)</span>

            <span class="n">labela</span> <span class="o">=</span> <span class="s2">&quot;$</span><span class="se">\\</span><span class="s2">alpha=</span><span class="si">{}</span><span class="s2">$&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">alp</span><span class="p">)</span>

            <span class="n">labelb</span> <span class="o">=</span> <span class="s2">&quot;$</span><span class="se">\\</span><span class="s2">beta=</span><span class="si">{}</span><span class="s2">$&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">bet</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">i</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">j</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span>
                    <span class="n">label</span><span class="o">=</span><span class="n">labelb</span><span class="o">+</span><span class="s2">&quot;, &quot;</span> <span class="o">+</span> <span class="n">labela</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">label</span><span class="o">=</span><span class="n">labelb</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">j</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span>
                    <span class="n">label</span> <span class="o">=</span> <span class="n">labela</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">label</span><span class="o">=</span><span class="kc">None</span>

            <span class="k">if</span> <span class="n">j</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span>
                <span class="n">line</span><span class="p">,</span> <span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kratios</span><span class="p">,</span> <span class="n">DAF</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">label</span><span class="p">,</span>
<span class="c1">#                               marker=&#39;s&#39;,ms=2,</span>
                               <span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kratios</span><span class="p">,</span> <span class="n">DAF</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">label</span><span class="p">,</span>
<span class="c1">#                               marker=&#39;s&#39;,ms=2,</span>
                               <span class="n">color</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">get_color</span><span class="p">())</span>


        <span class="n">end_time1</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
        <span class="n">elapsed_time</span> <span class="o">=</span> <span class="p">(</span><span class="n">end_time1</span> <span class="o">-</span> <span class="n">start_time1</span><span class="p">);</span> <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Run time=</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">timedelta</span><span class="p">(</span><span class="n">seconds</span><span class="o">=</span><span class="n">elapsed_time</span><span class="p">))))</span>

    <span class="n">leg</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    <span class="n">leg</span><span class="o">.</span><span class="n">draggable</span><span class="p">()</span>
    <span class="n">leg</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span>
<span class="c1">#                    title=&quot;$\\beta$&quot;,</span>
<span class="c1">#                    loc=&quot;upper center&quot;,</span>
<span class="c1">#                    ncol=2,</span>
                    <span class="n">labelspacing</span><span class="o">=.</span><span class="mi">2</span><span class="p">,</span>
                    <span class="n">handlelength</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
                    <span class="n">fontsize</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span>
<span class="c1">#                    numpoints=1,</span>
                    <span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="n">DAFmax</span><span class="p">])</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>


    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Deflection amplification factor, w.r.t. k1&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;$k_2/k_1$&quot;</span><span class="p">)</span>

    <span class="n">end_time0</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
    <span class="n">elapsed_time</span> <span class="o">=</span> <span class="p">(</span><span class="n">end_time0</span> <span class="o">-</span> <span class="n">start_time0</span><span class="p">);</span> <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Total run time=</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">timedelta</span><span class="p">(</span><span class="n">seconds</span><span class="o">=</span><span class="n">elapsed_time</span><span class="p">))))</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">saveas</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">save_figure</span><span class="p">(</span><span class="n">fig</span><span class="o">=</span><span class="n">fig</span><span class="p">,</span> <span class="n">fname</span><span class="o">=</span><span class="n">saveas</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">ax</span></div>




<div class="viewcode-block" id="DAFinfinite"><a class="viewcode-back" href="../../../api/geotecha.beam_on_foundation.specbeam.html#geotecha.beam_on_foundation.specbeam.DAFinfinite">[docs]</a><span class="k">def</span> <span class="nf">DAFinfinite</span><span class="p">(</span><span class="n">alp</span><span class="p">,</span> <span class="n">bet</span><span class="p">,</span> <span class="n">kratio</span><span class="o">=</span><span class="mf">1.0</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Dynamic amplification factor for infinite beam on winkler foundation</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    alp : float</span>
<span class="sd">        Velocity ratio.  alp = v/vcr where critical velocity</span>
<span class="sd">        vcr=sqrt(2*sqrt(k*E*I)/(rho*A))**0.5</span>
<span class="sd">    bet : float</span>
<span class="sd">        Damping ratio.  bet=c/ccr where critical damping ccr=2*sqrt(rho*A*k).</span>
<span class="sd">        The damping ratio is with respect to the reference foundation stiffness.</span>
<span class="sd">    kratio : float, optional</span>
<span class="sd">        Ratio of foundation stiffness to reference value i.e. k2/k1 where</span>
<span class="sd">        k1 is the reference value. Default kratio=1</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    DAF : float</span>
<span class="sd">        Dynamic/deflection amplification factor with respect to the reference</span>
<span class="sd">        foundation stiffness, k1. i.e.</span>
<span class="sd">        deflection = DAF*[static deflection of point load  on beam on k1 ]</span>
<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    Only works for scalar input</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">s</span><span class="p">,</span> <span class="n">disp</span> <span class="o">=</span> <span class="n">moving_load_on_beam_on_elastic_foundation</span><span class="p">(</span>
                            <span class="n">alp</span><span class="o">/</span><span class="n">kratio</span><span class="o">**</span><span class="p">(</span><span class="mf">0.25</span><span class="p">),</span>
                            <span class="n">bet</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">kratio</span><span class="p">)</span><span class="o">**</span><span class="mf">0.5</span>
                            <span class="p">,</span><span class="n">slim</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">6</span><span class="p">,</span><span class="mi">6</span><span class="p">),</span><span class="n">npts</span><span class="o">=</span><span class="mi">1001</span><span class="p">)</span>
    <span class="n">DAF</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">disp</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">kratio</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="mf">0.75</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">DAF</span></div>

<div class="viewcode-block" id="transition_zones1"><a class="viewcode-back" href="../../../api/geotecha.beam_on_foundation.specbeam.html#geotecha.beam_on_foundation.specbeam.transition_zones1">[docs]</a><span class="k">def</span> <span class="nf">transition_zones1</span><span class="p">(</span>
            <span class="n">Lt_Lcs</span><span class="o">=</span><span class="p">[</span><span class="mf">0.1</span><span class="p">,</span><span class="mi">4</span><span class="p">],</span>
            <span class="n">alphas</span><span class="o">=</span><span class="p">[</span><span class="mf">0.8</span><span class="p">],</span>
            <span class="n">reverses</span><span class="o">=</span><span class="p">[</span><span class="kc">False</span><span class="p">,</span><span class="kc">True</span><span class="p">],</span>
            <span class="n">xi_Lc</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="c1">#ratio of xinterest over characteristic length</span>
            <span class="n">kratio</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span>
            <span class="n">beta</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span>
            <span class="n">alpha_design</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span>
            <span class="n">ntrans</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span>
            <span class="n">DAF_distribution</span><span class="o">=</span><span class="s2">&quot;linear&quot;</span><span class="p">,</span>
            <span class="n">tanhend</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span>
            <span class="n">xlim</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">),</span>
            <span class="n">nx</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span>     <span class="c1">#number of x points</span>
            <span class="n">nt</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="c1">#number of time values</span>
            <span class="n">t_extend</span> <span class="o">=</span> <span class="mf">1.2</span><span class="p">,</span> <span class="c1"># factor to extend maximum evalutated time.</span>
            <span class="n">nterms</span><span class="o">=</span><span class="mi">150</span><span class="p">,</span>
            <span class="n">ninterp</span> <span class="o">=</span> <span class="mi">15</span><span class="p">,</span> <span class="c1"># number of points to discretize the transition zone</span>
            <span class="n">nloads</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
            <span class="n">load_spacing</span> <span class="o">=</span> <span class="mf">0.03</span><span class="p">,</span>
            <span class="n">animateme</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="n">saveas</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="n">force_calc</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">article_formatting</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="p">):</span>

    <span class="sd">&quot;&quot;&quot;Exploration of deflection envelopes caused by point loads travelling</span>
<span class="sd">    through a stiffness transition zone on beam on visco-elastic foundation</span>
<span class="sd">    using Specbeam.</span>


<span class="sd">    - Transition between reference beam/foundation with stiffness k to beam on</span>
<span class="sd">    foundation with stiffness k*`kratio`.</span>
<span class="sd">    - Transition zone length Lt is a multiple of the characteristic length</span>
<span class="sd">    Lc of the reference beam/foundation. Lt = `Lt_Lc`*Lc</span>
<span class="sd">    - Transition zone divided into ntrans points.</span>
<span class="sd">    - Change in stiffness over transition zone is a calculated value based on</span>
<span class="sd">    a goal displacement profile.  The shape of the goal displacement profile</span>
<span class="sd">    is controlled be `DAF_distribution` which is usually linear.</span>
<span class="sd">    - At each evaluation point in transition zone the stiffness needed to</span>
<span class="sd">    achieve the desired  displacement value is back calcualted based on</span>
<span class="sd">    infinite beam theory with a point load travelling at velocity ratio</span>
<span class="sd">    of `alpha_design` with damping ratio `beta` (`alpha_design` and `beta`</span>
<span class="sd">    are w.r.t. the reference beam/foundation).</span>
<span class="sd">    - for input into specbeam the design stiffness profile piecewise linear</span>
<span class="sd">    interpolated at `ninterp` points to produce piecewise linear analysis</span>
<span class="sd">    profile.  `ninterp` should be less thatn or equal to `ntrans`</span>
<span class="sd">    - Moving load will then traverse the design stiffness profile and</span>
<span class="sd">    depending on dynamic effects the moving load displacement may or may not</span>
<span class="sd">    match the design displacements.  You can only design for one speed so</span>
<span class="sd">    deflection response might be differnt when actual speed is different</span>
<span class="sd">    to design speed.</span>
<span class="sd">    - Note only the stiffness changes.  We assume that damping determined</span>
<span class="sd">    by `beta` of the reference beam/foundation does not change in the</span>
<span class="sd">    transition zone.  Perhaps not realistic but simply an assumption to</span>
<span class="sd">    enable exploration.</span>

<span class="sd">    3 plots will be produced:</span>
<span class="sd">    - Line will be plotted based on permututions of `Lt_Lcs`, `alphas`,</span>
<span class="sd">    `reverses`.  So number of lines can quickly get out of hand.  Usually</span>
<span class="sd">    interested in varyin one of the parameters at a time.</span>
<span class="sd">    - Plot 1a) shows the design transtion stiffness profile</span>
<span class="sd">    Plot 1b) shows max deflection experienced at each point</span>
<span class="sd">    - Plot 2) is deflection vs time at the point which experiences the</span>
<span class="sd">        maximum deflection.  also plots a marker at the time when</span>
<span class="sd">        load passes the point.</span>
<span class="sd">    - Plot 3) is the deflection vs time curve under the moving point load.</span>


<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    Lt_Lcs : list of float, optional</span>
<span class="sd">        Transtion zone lengths as a mulitple of characteristic length.</span>
<span class="sd">        Default Lt_Lcs = [0.1,4].</span>
<span class="sd">    alphas : list of float, optional</span>
<span class="sd">        Velocity ratios to analyze.   Velocity rations are</span>
<span class="sd">        with respect to the reference beam/foundation.  Default alphas = [0.8]</span>
<span class="sd">    reverses : list of Bool, optional</span>
<span class="sd">        Directions of travel.  False means left to right from reference</span>
<span class="sd">        beam/foundation to other beam/foundation.  True means the reverse</span>
<span class="sd">        direction from right to left from the other beam/foundation to the</span>
<span class="sd">        reference beam foundation. Default reverses=[False,True].</span>
<span class="sd">    xi_Lc : [False, True], optional</span>
<span class="sd">        If True then deflection vs time will be plotted at the point where</span>
<span class="sd">        the maximum deflection was experienced. Default xi_Lc=None i.e. False</span>
<span class="sd">        and no plot will be created. Also plots a marker at the time when</span>
<span class="sd">        load passes the point.</span>
<span class="sd">    kratio : float optional</span>
<span class="sd">        stiffness ratio k2/k1 where k1 is the stiffness of the reference</span>
<span class="sd">        beam/foundation. Default kratio = 50.</span>
<span class="sd">    beta : float, optional</span>
<span class="sd">        Reference value of damping ratio. Default beta = 0.2</span>
<span class="sd">    alpha_design : float, optional</span>
<span class="sd">        Design velocity ratio used to back calculate the design stiffness</span>
<span class="sd">        ratio. Default alpha_design = 0.8.</span>
<span class="sd">    ntrans : int, optional</span>
<span class="sd">        Number of points to approximate the desired displacement</span>
<span class="sd">        transition profile into, to then back calculate the stiffness</span>
<span class="sd">        profile used for analysis. Default ntrans = 50 .</span>
<span class="sd">    DAF_distribution : [&quot;linear&quot;, &quot;tanh&quot;, &quot;reverse&quot;], optional</span>
<span class="sd">        Shape of goal transition deflection distrribution.</span>
<span class="sd">        &quot;linear&quot; isself explanatory and simplest.</span>
<span class="sd">        &quot;tanh&quot; is a hyperbolic tangent, with steepness of transtion</span>
<span class="sd">        controlled by `tanend`. Not well tested.</span>
<span class="sd">        &quot;reverse&quot; is a compund reverse curve of two curclar arcs tangent to</span>
<span class="sd">        the end points and tangent at the arc join. Not well tested</span>
<span class="sd">        Default DAF_distribution = &quot;linear&quot;.</span>
<span class="sd">    tanend : float, optional</span>
<span class="sd">        value controling the steepness of a &quot;tanh&quot; `DAF_distribution`.</span>
<span class="sd">        Say transitioning between points (-0.5, -1) and (0.5, 1).  Tanh</span>
<span class="sd">        curve will never actually hit valus of -1 and +1, it will approach</span>
<span class="sd">        those values as x goes to += infinity. Using tanend=0.01 will control</span>
<span class="sd">        transtion such that the tanh curve evalutes to y=1+0.01 and y=1-0.01</span>
<span class="sd">        at the start/end points.  This evaluated value is vever actually used</span>
<span class="sd">        because we have given start and end points but it does control the</span>
<span class="sd">        position of points just inside the start/end points and hence the</span>
<span class="sd">        steepness of transition.</span>
<span class="sd">    xlim : two element tuple of float, optional</span>
<span class="sd">        Distances on either side of the transtion zone midpoint to evaluate</span>
<span class="sd">        deflection at.  The mid point of the transition would be at 0.</span>
<span class="sd">        For example default xlim=(-8,8) which would be</span>
<span class="sd">        8 characteristic lenghts on either side of the transition zone</span>
<span class="sd">        midpoint.   Note: Characteristic lenth Lc is with respect to the</span>
<span class="sd">        reference beam/foundation. Default xlim=(-8, 8).</span>
<span class="sd">    nx : int, optional</span>
<span class="sd">        Number of points between `xlim[0]` and `xlim[1]` at which to</span>
<span class="sd">        calculate deflection.  Default nx = 100.</span>
<span class="sd">    nt : int, optional</span>
<span class="sd">        Number of evaluation times from when load enters `xlim[0]` and</span>
<span class="sd">        leaves `xlim[1]`.  Default nt=100</span>
<span class="sd">    t_extend : float, optional</span>
<span class="sd">        factor to extend maximum evalutated time.  As per `nt&#39; evaluation times</span>
<span class="sd">        are normally between first point entering `xlim[0]&#39; and leaving</span>
<span class="sd">        `xlim[1]`.  However, with mulitple loads, loads can still be on the</span>
<span class="sd">        beam at that point. max eval time can be extended fby a factor.</span>
<span class="sd">        t_extend = 1.2 .</span>
<span class="sd">    ninterp : int, optional</span>
<span class="sd">        For use in specbeam the back calculated stiffness and damping</span>
<span class="sd">        transitions profiles are interpoalted at `ninterp` points.  A coarser</span>
<span class="sd">        discretization will improve computation times but might no capture</span>
<span class="sd">        the changing properties approraitely.</span>
<span class="sd">        Note: `ninterp` should be less thatn or equal to `ntrans`.</span>
<span class="sd">        Default ninterp = 15 .</span>
<span class="sd">    nterms : int, optional</span>
<span class="sd">        Number of series terms in approximation.  More terms  leads to higher</span>
<span class="sd">        accuracy but also longer computation times.  Start of with a</span>
<span class="sd">        small enough value to observe behaviour and then increase</span>
<span class="sd">        to confirm. Default nterms=150 .</span>
<span class="sd">    nloads : int, optional</span>
<span class="sd">        Number of eqully spaced moving point loads.  Default nloads = 1 .</span>
<span class="sd">    load_spacing : float, optional</span>
<span class="sd">        Spacing between the multiple points loads.  Units are multiples of</span>
<span class="sd">        Lc characteristic length.  Default load_spacing = 0.03 .</span>
<span class="sd">    animateme : [False, True], optional</span>
<span class="sd">        If True the deflectons and moving loads will be animated.</span>
<span class="sd">        Default anmateme=False.</span>
<span class="sd">    saveas : string, optional</span>
<span class="sd">        Filename stem (not including extension) to save figure to.</span>
<span class="sd">        Default saveas=None, i.e. figure won&#39;t be saved to disk.</span>
<span class="sd">    force_calc : [True, False], optional</span>
<span class="sd">        When True all calcuations will be done from scratch. When False</span>
<span class="sd">        Current working directory will be searched for a results file</span>
<span class="sd">        named according to &quot;saveas&quot; and</span>
<span class="sd">        if found it will be loaded.  Be careful as name of results file may</span>
<span class="sd">        not be unique to your analysis parameters.  Safest to use</span>
<span class="sd">        force_calc = True, but if you are simply regenerating graphs then</span>
<span class="sd">        consider force_calc=False.  Default force_calc=True.</span>
<span class="sd">    article_formatting : [False, True], optional</span>
<span class="sd">        You should never need this.  It was a quick hack to do some</span>
<span class="sd">        custom formatting for a journal article.  Dont even try messing with</span>
<span class="sd">        it.  will ony work with 3 Lt_Lcs values values or less.  Default=False,</span>
<span class="sd">        i.e. no special formatting.</span>


<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    While all parameters are normalised the raw properties that all others</span>
<span class="sd">    are based on are:</span>
<span class="sd">    - E = 6.998*1e9, #Pa</span>
<span class="sd">    - rho = 2373, #kg/m3</span>
<span class="sd">    - L = 160, #m</span>
<span class="sd">    - A = 0.3*0.1, # m^2</span>
<span class="sd">    - I = 0.00022477900799999998,</span>
<span class="sd">    - k1 = 800002.6125,</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="n">article_formatting</span><span class="p">:</span>
        <span class="n">mdc</span> <span class="o">=</span> <span class="n">MarkersDashesColors</span><span class="p">(</span><span class="n">markersize</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span><span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="c1">#        mdc.demo_options()</span>
        <span class="n">mdc</span><span class="o">.</span><span class="n">construct_styles</span><span class="p">(</span><span class="n">markers</span><span class="o">=</span><span class="p">[</span><span class="mi">5</span><span class="p">,</span><span class="mi">15</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span>
                           <span class="n">dashes</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                           <span class="n">marker_colors</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span>
                       <span class="n">line_colors</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>

        <span class="n">styles</span><span class="o">=</span><span class="n">mdc</span><span class="p">(</span><span class="n">markers</span><span class="o">=</span><span class="p">[</span><span class="mi">5</span><span class="p">,</span><span class="mi">15</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span>
                           <span class="n">dashes</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                           <span class="n">marker_colors</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span>
                       <span class="n">line_colors</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
<span class="c1">#        mdc.demo_styles()</span>

    <span class="c1">#figure</span>
    <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mf">3.54</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
    <span class="n">gs</span> <span class="o">=</span> <span class="n">matplotlib</span><span class="o">.</span><span class="n">gridspec</span><span class="o">.</span><span class="n">GridSpec</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span>
<span class="c1">#                       width_ratios=[1, 2],</span>
                   <span class="n">height_ratios</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">],</span>
                   <span class="n">hspace</span><span class="o">=</span><span class="mf">0.05</span><span class="p">)</span>

    <span class="n">matplotlib</span><span class="o">.</span><span class="n">rcParams</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s1">&#39;font.size&#39;</span><span class="p">:</span> <span class="mi">11</span><span class="p">})</span>

    <span class="c1">#DAF vs kratio plot</span>
<span class="c1">#    ax1 = fig.add_subplot(gs[1,0])</span>
<span class="c1">#    transition_DAF1_at_specific_alp(ax=ax1)</span>
<span class="c1">#    ax1.set_ylim(0,2)</span>

    <span class="c1">#DAF vs xtrans plot</span>
    <span class="n">ax2</span> <span class="o">=</span> <span class="n">ax2</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;$w/w_</span><span class="si">{static1}</span><span class="s2">$&quot;</span><span class="p">)</span>
<span class="c1">#    ax2.set_xlim(-0.5,1.5)</span>

    <span class="n">ax2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;$x/L_c$&#39;</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="c1">#    ax1.set_ylim(-10, 10)</span>



    <span class="c1">#k/k1 vs xtrans plot</span>
    <span class="n">ax3</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="p">)</span><span class="c1">#sharex=ax2)</span>
<span class="c1">#        ax3.set_xlabel(&#39;$x/L_t$&#39;)</span>
    <span class="n">ax3</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;$k/k_1$&#39;</span><span class="p">)</span>

    <span class="n">ax3</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>

    <span class="n">ax3</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_ticklabels</span><span class="p">([])</span>

<span class="c1">#    xlim = (-.5,1.5)</span>
<span class="c1">#    xlim = (-8,8)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">*</span><span class="n">xlim</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>


    <span class="k">if</span> <span class="ow">not</span> <span class="n">xi_Lc</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">fig4</span><span class="p">,</span> <span class="n">ax4</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span> <span class="c1"># deflection vs time at point</span>

    <span class="n">fig5</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mf">3.54</span><span class="p">,</span> <span class="mf">3.54</span><span class="p">))</span>
    <span class="n">ax5</span> <span class="o">=</span> <span class="n">fig5</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="s1">&#39;111&#39;</span><span class="p">)</span>


    <span class="n">pdict</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">(</span>
                <span class="n">E</span> <span class="o">=</span> <span class="mf">6.998</span><span class="o">*</span><span class="mf">1e9</span><span class="p">,</span> <span class="c1">#Pa</span>
                <span class="n">rho</span> <span class="o">=</span> <span class="mi">2373</span><span class="p">,</span> <span class="c1">#kg/m3</span>
                <span class="n">L</span> <span class="o">=</span> <span class="mi">160</span><span class="p">,</span> <span class="c1">#m</span>
                <span class="n">A</span> <span class="o">=</span> <span class="mf">0.3</span><span class="o">*</span><span class="mf">0.1</span><span class="p">,</span> <span class="c1"># m^2</span>
                <span class="n">I</span> <span class="o">=</span> <span class="mf">0.00022477900799999998</span><span class="p">,</span>
                <span class="n">k1</span> <span class="o">=</span> <span class="mf">800002.6125</span><span class="p">,</span>
                <span class="n">nterms</span><span class="o">=</span><span class="n">nterms</span><span class="p">,</span>
                <span class="n">BC</span><span class="o">=</span><span class="s2">&quot;SS&quot;</span><span class="p">,</span>
<span class="c1">#                moving_loads_x_norm=[[0-vv*load_spacing for vv in range(nloads)]],</span>
<span class="c1">#                moving_loads_Fz_norm=[[1.013e-4]*nloads],</span>
<span class="c1">#                xvals_norm=np.linspace(xeval[0], xeval[1], nx),</span>
                <span class="n">use_analytical</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                <span class="n">implementation</span><span class="o">=</span><span class="s2">&quot;fortran&quot;</span><span class="p">,</span>
                <span class="n">force_calc</span><span class="o">=</span><span class="n">force_calc</span><span class="p">,</span>
                <span class="p">)</span>








    <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">Lt_Lc</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">Lt_Lcs</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;doing Lt_Lc=&quot;</span><span class="p">,</span> <span class="n">Lt_Lc</span><span class="p">)</span>
        <span class="n">trans_characteristic_factor</span> <span class="o">=</span> <span class="n">Lt_Lc</span><span class="c1"># multiple of k1 characteristic length</span>
        <span class="n">trans_middle</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="c1"># midpoint of transition is midpoint of beam</span>

        <span class="n">lam</span> <span class="o">=</span> <span class="p">(</span><span class="n">pdict</span><span class="p">[</span><span class="s1">&#39;k1&#39;</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="mi">4</span><span class="o">*</span><span class="n">pdict</span><span class="p">[</span><span class="s1">&#39;E&#39;</span><span class="p">]</span><span class="o">*</span><span class="n">pdict</span><span class="p">[</span><span class="s1">&#39;I&#39;</span><span class="p">]))</span><span class="o">**</span><span class="mf">0.25</span>
        <span class="n">trans_len_raw</span> <span class="o">=</span> <span class="n">trans_characteristic_factor</span> <span class="o">/</span> <span class="n">lam</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Characteristic len =</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">lam</span><span class="p">))</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;normalised:</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">lam</span><span class="o">/</span><span class="n">pdict</span><span class="p">[</span><span class="s2">&quot;L&quot;</span><span class="p">]))</span>
        <span class="n">trans_len</span> <span class="o">=</span> <span class="n">trans_len_raw</span> <span class="o">/</span> <span class="n">pdict</span><span class="p">[</span><span class="s2">&quot;L&quot;</span><span class="p">]</span>

    <span class="c1">#    trans_len=0.2  #normalised values w.r.t. L</span>

        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;tlen/char_len=</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">trans_len</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">lam</span><span class="o">/</span><span class="n">pdict</span><span class="p">[</span><span class="s2">&quot;L&quot;</span><span class="p">])))</span>

        <span class="n">trans_start</span> <span class="o">=</span> <span class="n">trans_middle</span> <span class="o">-</span> <span class="n">trans_len</span><span class="o">/</span><span class="mi">2</span>
        <span class="n">trans_end</span> <span class="o">=</span> <span class="n">trans_start</span> <span class="o">+</span> <span class="n">trans_len</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;tstart=</span><span class="si">{:8.3f}</span><span class="s2">,tend=</span><span class="si">{:8.3f}</span><span class="s2">,tlen=</span><span class="si">{:8.3f}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">trans_start</span><span class="p">,</span><span class="n">trans_end</span><span class="p">,</span> <span class="n">trans_len</span><span class="p">))</span>

        <span class="n">xeval</span> <span class="o">=</span> <span class="p">(</span><span class="n">trans_middle</span> <span class="o">-</span> <span class="nb">abs</span><span class="p">(</span><span class="n">xlim</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">/</span><span class="n">lam</span><span class="o">/</span><span class="n">pdict</span><span class="p">[</span><span class="s2">&quot;L&quot;</span><span class="p">],</span>
                 <span class="n">trans_middle</span> <span class="o">+</span> <span class="nb">abs</span><span class="p">(</span><span class="n">xlim</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">/</span><span class="n">lam</span><span class="o">/</span><span class="n">pdict</span><span class="p">[</span><span class="s2">&quot;L&quot;</span><span class="p">])</span> <span class="c1"># Points either side of midpoint to evluate between</span>

        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;xeval:&quot;</span><span class="p">,</span><span class="n">xeval</span><span class="p">)</span>

        <span class="n">xtrans</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ntrans</span><span class="p">)</span>


        <span class="k">if</span> <span class="n">nloads</span><span class="o">&gt;</span><span class="mi">1</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;loadspace/char_len=</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">load_spacing</span><span class="o">*</span><span class="n">pdict</span><span class="p">[</span><span class="s2">&quot;L&quot;</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">lam</span><span class="p">)))</span>


        <span class="c1"># work out goal displacement distribution</span>
        <span class="n">DAF1</span> <span class="o">=</span> <span class="n">DAFinfinite</span><span class="p">(</span><span class="n">alp</span><span class="o">=</span><span class="n">alpha_design</span><span class="p">,</span> <span class="n">bet</span><span class="o">=</span><span class="n">beta</span><span class="p">)</span>
        <span class="n">DAF2</span> <span class="o">=</span> <span class="n">DAFinfinite</span><span class="p">(</span><span class="n">alp</span><span class="o">=</span><span class="n">alpha_design</span><span class="p">,</span><span class="n">bet</span><span class="o">=</span><span class="n">beta</span><span class="p">,</span><span class="n">kratio</span><span class="o">=</span><span class="n">kratio</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">DAF_distribution</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">==</span><span class="s2">&quot;linear&quot;</span><span class="p">:</span>
            <span class="n">DAF_goal</span> <span class="o">=</span> <span class="n">DAF1</span> <span class="o">+</span> <span class="p">(</span><span class="n">DAF2</span><span class="o">-</span><span class="n">DAF1</span><span class="p">)</span><span class="o">*</span><span class="n">xtrans</span>
        <span class="k">elif</span> <span class="n">DAF_distribution</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">==</span><span class="s2">&quot;tanh&quot;</span><span class="p">:</span>

            <span class="n">b</span> <span class="o">=</span> <span class="n">tanhtranib</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">tanhend</span><span class="p">,</span> <span class="n">a</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;b:&quot;</span><span class="p">,</span><span class="n">b</span><span class="p">)</span>
            <span class="n">DAF_goal</span> <span class="o">=</span> <span class="p">(</span><span class="n">tanhtran</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">xtrans</span><span class="p">,</span> <span class="n">a</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="n">b</span><span class="p">)</span> <span class="o">-</span> <span class="mf">0.5</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">tanhend</span><span class="p">)</span> <span class="o">+</span> <span class="mf">0.5</span>

            <span class="n">DAF_goal</span> <span class="o">=</span> <span class="n">DAF_goal</span> <span class="o">*</span> <span class="n">DAF2</span> <span class="o">+</span> <span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">DAF_goal</span><span class="p">)</span> <span class="o">*</span> <span class="n">DAF1</span>

        <span class="k">elif</span> <span class="n">DAF_distribution</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">==</span><span class="s2">&quot;reverse&quot;</span><span class="p">:</span>
            <span class="n">DAF_goal</span> <span class="o">=</span> <span class="n">reverse_curve_transition</span><span class="p">(</span><span class="n">xtrans</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">DAF1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">DAF2</span><span class="p">)</span>

        <span class="n">DAF_goal</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">DAF1</span>
        <span class="n">DAF_goal</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">DAF2</span>

<span class="c1">#        figg,axx=plt.subplots()</span>
<span class="c1">#        axx.plot(xtrans,DAF_goal)</span>
<span class="c1">#        plt.show()</span>

        <span class="c1"># back calucatee the stiffness profile needed to get the displacemtn profile</span>
        <span class="n">kkk</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">kratio</span><span class="p">,</span><span class="mi">300</span><span class="p">,</span><span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
        <span class="n">yyy</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">kkk</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">iii</span><span class="p">,</span> <span class="n">krat</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">kkk</span><span class="p">):</span>
            <span class="n">yyy</span><span class="p">[</span><span class="n">iii</span><span class="p">]</span> <span class="o">=</span> <span class="n">DAFinfinite</span><span class="p">(</span><span class="n">alp</span><span class="o">=</span><span class="n">alpha_design</span><span class="p">,</span><span class="n">bet</span><span class="o">=</span><span class="n">beta</span><span class="p">,</span><span class="n">kratio</span><span class="o">=</span><span class="n">krat</span><span class="p">)</span>

<span class="c1">#        figg,axx=plt.subplots()</span>
<span class="c1">#        axx.plot(kkk,yyy,marker=&quot;o&quot;)</span>
<span class="c1">#        plt.show()</span>

        <span class="n">ktrans</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty_like</span><span class="p">(</span><span class="n">xtrans</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">iii</span><span class="p">,</span> <span class="n">DAF</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">DAF_goal</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">iii</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span>
                <span class="n">ktrans</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">=</span><span class="mi">1</span>
            <span class="k">elif</span> <span class="n">iii</span><span class="o">==</span><span class="n">ntrans</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span>
                <span class="n">ktrans</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">=</span><span class="n">kratio</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">ktrans</span><span class="p">[</span><span class="n">iii</span><span class="p">]</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">interp</span><span class="p">(</span><span class="n">DAF</span><span class="p">,</span> <span class="n">yyy</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">kkk</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>


        <span class="n">ctrans</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones_like</span><span class="p">(</span><span class="n">xtrans</span><span class="p">)</span>


        <span class="c1">#plot the stiffness profile</span>
        <span class="n">xx</span> <span class="o">=</span> <span class="p">[</span><span class="n">xlim</span><span class="p">[</span><span class="mi">0</span><span class="p">]];</span> <span class="n">xx</span><span class="o">.</span><span class="n">extend</span><span class="p">((</span><span class="n">xtrans</span><span class="o">-</span><span class="n">trans_middle</span><span class="p">)</span><span class="o">*</span><span class="n">trans_len</span><span class="o">*</span><span class="n">pdict</span><span class="p">[</span><span class="s2">&quot;L&quot;</span><span class="p">]</span><span class="o">*</span><span class="n">lam</span><span class="p">);</span> <span class="n">xx</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">xlim</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="n">yy</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">];</span> <span class="n">yy</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">ktrans</span><span class="p">);</span> <span class="n">yy</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">kratio</span><span class="p">)</span>
        <span class="n">ax3</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xx</span><span class="p">,</span> <span class="n">yy</span><span class="p">)</span>

        <span class="n">DAFtrans</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty_like</span><span class="p">(</span><span class="n">xtrans</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">alp</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">alphas</span><span class="p">):</span>


            <span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="n">krat</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">ktrans</span><span class="p">):</span>
                <span class="n">DAFtrans</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">DAFinfinite</span><span class="p">(</span><span class="n">alp</span><span class="o">=</span><span class="n">alp</span><span class="p">,</span><span class="n">bet</span><span class="o">=</span><span class="n">beta</span><span class="p">,</span><span class="n">kratio</span><span class="o">=</span><span class="n">krat</span><span class="p">)</span>


            <span class="n">yy</span> <span class="o">=</span> <span class="p">[</span><span class="n">DAFtrans</span><span class="p">[</span><span class="mi">0</span><span class="p">]];</span> <span class="n">yy</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">DAFtrans</span><span class="p">);</span> <span class="n">yy</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">DAFtrans</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
            <span class="n">label</span><span class="o">=</span><span class="s2">&quot;$L_t/L_c=</span><span class="si">{}</span><span class="s2">, ideal$&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">Lt_Lc</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">article_formatting</span><span class="p">:</span>
                <span class="n">line</span><span class="p">,</span><span class="o">=</span> <span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xx</span><span class="p">,</span><span class="n">yy</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="n">label</span><span class="p">,</span><span class="o">**</span><span class="n">styles</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">line</span><span class="p">,</span><span class="o">=</span> <span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xx</span><span class="p">,</span><span class="n">yy</span><span class="p">,</span><span class="n">ls</span><span class="o">=</span><span class="s2">&quot;-&quot;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="n">label</span><span class="p">)</span>

            <span class="c1">#sample the k value to form a poly line for specbeam</span>
            <span class="n">xtrans_spec</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ninterp</span><span class="p">)</span>

            <span class="n">ktrans_spec</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">interp</span><span class="p">(</span><span class="n">xtrans_spec</span><span class="p">,</span> <span class="n">xtrans</span><span class="p">,</span> <span class="n">ktrans</span><span class="p">)</span>

            <span class="n">pline_x</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">pline_x</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">trans_start</span> <span class="o">+</span> <span class="n">xtrans_spec</span> <span class="o">*</span> <span class="n">trans_len</span><span class="p">)</span>
            <span class="n">pline_x</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

            <span class="n">pline_k1</span> <span class="o">=</span> <span class="p">[</span><span class="n">ktrans_spec</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
            <span class="n">pline_k1</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">ktrans_spec</span><span class="p">)</span>
            <span class="n">pline_k1</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ktrans_spec</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>

            <span class="n">k1bar</span> <span class="o">=</span> <span class="n">PolyLine</span><span class="p">(</span><span class="n">pline_x</span><span class="p">,</span> <span class="n">pline_k1</span><span class="p">)</span>

            <span class="c1">#sample the c values to form a poly line</span>
            <span class="n">ctrans_spec</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">interp</span><span class="p">(</span><span class="n">xtrans_spec</span><span class="p">,</span> <span class="n">xtrans</span><span class="p">,</span> <span class="n">ctrans</span><span class="p">)</span>
            <span class="n">pline_mu</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">pline_mu</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">ctrans_spec</span><span class="p">)</span>
            <span class="n">pline_mu</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ctrans_spec</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
            <span class="n">mubar</span> <span class="o">=</span> <span class="n">PolyLine</span><span class="p">(</span><span class="n">pline_x</span><span class="p">,</span> <span class="n">pline_mu</span><span class="p">)</span>

            <span class="n">v_crit</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="o">/</span><span class="n">pdict</span><span class="p">[</span><span class="s2">&quot;rho&quot;</span><span class="p">]</span><span class="o">/</span><span class="n">pdict</span><span class="p">[</span><span class="s2">&quot;A&quot;</span><span class="p">]</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">pdict</span><span class="p">[</span><span class="s2">&quot;k1&quot;</span><span class="p">]</span><span class="o">*</span><span class="n">pdict</span><span class="p">[</span><span class="s2">&quot;E&quot;</span><span class="p">]</span><span class="o">*</span><span class="n">pdict</span><span class="p">[</span><span class="s2">&quot;I&quot;</span><span class="p">]))</span>
            <span class="n">v_raw</span> <span class="o">=</span> <span class="n">v_crit</span><span class="o">*</span><span class="n">alp</span>

            <span class="n">c_crit</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">4</span><span class="o">*</span><span class="n">pdict</span><span class="p">[</span><span class="s2">&quot;rho&quot;</span><span class="p">]</span><span class="o">*</span><span class="n">pdict</span><span class="p">[</span><span class="s2">&quot;A&quot;</span><span class="p">]</span><span class="o">*</span><span class="n">pdict</span><span class="p">[</span><span class="s2">&quot;k1&quot;</span><span class="p">])</span>
            <span class="n">c_raw</span> <span class="o">=</span> <span class="n">c_crit</span> <span class="o">*</span> <span class="n">beta</span>

            <span class="n">tmax</span> <span class="o">=</span> <span class="n">pdict</span><span class="p">[</span><span class="s2">&quot;L&quot;</span><span class="p">]</span> <span class="o">/</span> <span class="n">v_raw</span> <span class="c1"># time for first load to reach end of beam</span>

            <span class="n">pdict</span><span class="p">[</span><span class="s2">&quot;moving_loads_x_norm&quot;</span><span class="p">]</span><span class="o">=</span><span class="p">[[</span><span class="mi">0</span><span class="o">-</span><span class="n">vv</span><span class="o">*</span><span class="n">load_spacing</span> <span class="k">for</span> <span class="n">vv</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nloads</span><span class="p">)]]</span>
            <span class="n">pdict</span><span class="p">[</span><span class="s2">&quot;moving_loads_Fz_norm&quot;</span><span class="p">]</span><span class="o">=</span><span class="p">[[</span><span class="mf">1.013e-4</span><span class="p">]</span><span class="o">*</span><span class="n">nloads</span><span class="p">]</span>
            <span class="n">pdict</span><span class="p">[</span><span class="s2">&quot;xvals_norm&quot;</span><span class="p">]</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">xeval</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">xeval</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">nx</span><span class="p">)</span>


            <span class="n">pdict</span><span class="p">[</span><span class="s2">&quot;mu&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">c_raw</span>
            <span class="n">pdict</span><span class="p">[</span><span class="s2">&quot;tvals&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">tmax</span><span class="o">*</span><span class="n">xeval</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">tmax</span><span class="o">*</span><span class="n">xeval</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">t_extend</span><span class="p">,</span><span class="n">nt</span><span class="p">)</span>

            <span class="n">pdict</span><span class="p">[</span><span class="s1">&#39;k1bar&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">k1bar</span>
            <span class="n">pdict</span><span class="p">[</span><span class="s1">&#39;mubar&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">mubar</span>
            <span class="k">for</span> <span class="n">reverse</span> <span class="ow">in</span> <span class="n">reverses</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">reverse</span><span class="p">:</span>
                    <span class="n">pdict</span><span class="p">[</span><span class="s2">&quot;moving_loads_v_norm&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="o">*</span><span class="n">v_raw</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">pdict</span><span class="p">[</span><span class="s2">&quot;rho&quot;</span><span class="p">]</span><span class="o">/</span><span class="n">pdict</span><span class="p">[</span><span class="s2">&quot;E&quot;</span><span class="p">])]</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">pdict</span><span class="p">[</span><span class="s2">&quot;moving_loads_v_norm&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="o">*</span><span class="n">v_raw</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">pdict</span><span class="p">[</span><span class="s2">&quot;rho&quot;</span><span class="p">]</span><span class="o">/</span><span class="n">pdict</span><span class="p">[</span><span class="s2">&quot;E&quot;</span><span class="p">])]</span>
                <span class="c1">#pdict[&quot;file_stem&quot;] = prefix + &quot;DAF_alp{:5.3f}_bet{:5.3f}_n{:d}&quot;.format(alpha,beta,nterms)</span>

                <span class="n">a</span> <span class="o">=</span> <span class="n">SpecBeam</span><span class="p">(</span><span class="o">**</span><span class="n">pdict</span><span class="p">)</span>
                <span class="n">a</span><span class="o">.</span><span class="n">runme</span><span class="p">()</span>
                <span class="k">if</span> <span class="n">animateme</span><span class="p">:</span>
                    <span class="n">a</span><span class="o">.</span><span class="n">animateme</span><span class="p">()</span>
                <span class="c1">#a.saveme()</span>

                <span class="n">max_envelope</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">defl</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>


    <span class="c1">#            xplot = (pdict[&#39;xvals_norm&#39;]-trans_start)/trans_len</span>
                <span class="n">xplot</span> <span class="o">=</span> <span class="p">(</span><span class="n">pdict</span><span class="p">[</span><span class="s1">&#39;xvals_norm&#39;</span><span class="p">]</span><span class="o">-</span><span class="n">trans_middle</span><span class="p">)</span><span class="o">*</span><span class="n">pdict</span><span class="p">[</span><span class="s1">&#39;L&#39;</span><span class="p">]</span><span class="o">*</span><span class="n">lam</span>

        <span class="c1">#        print(pdict[&#39;xvals_norm&#39;])</span>
        <span class="c1">#        lam = (pdict[&#39;k1&#39;]/(4*pdict[&#39;E&#39;]*pdict[&#39;I&#39;]))**0.25</span>



                <span class="n">Q</span> <span class="o">=</span> <span class="n">pdict</span><span class="p">[</span><span class="s2">&quot;moving_loads_Fz_norm&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">pdict</span><span class="p">[</span><span class="s1">&#39;E&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">pdict</span><span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">]</span>

                <span class="n">wstatic</span> <span class="o">=</span> <span class="n">Q</span> <span class="o">*</span> <span class="n">lam</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">pdict</span><span class="p">[</span><span class="s1">&#39;k1&#39;</span><span class="p">])</span>

                <span class="c1"># account for multiple loads</span>
                <span class="c1"># pdict[&quot;moving_loads_x_norm&quot;]=[[0-vv*load_spacing for vv in range(nloads)]]</span>
                <span class="c1"># pdict[&quot;moving_loads_Fz_norm&quot;]=[[1.013e-4]*nloads]</span>

                <span class="n">xmultim</span><span class="p">,</span><span class="n">ymulti</span> <span class="o">=</span> <span class="n">multi_static</span><span class="p">(</span><span class="n">xc</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="o">-</span><span class="n">vv</span><span class="o">*</span><span class="p">(</span><span class="n">load_spacing</span><span class="o">*</span><span class="n">pdict</span><span class="p">[</span><span class="s2">&quot;L&quot;</span><span class="p">])</span> <span class="k">for</span> <span class="n">vv</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nloads</span><span class="p">)],</span>
                                              <span class="n">frel</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">nloads</span><span class="p">,</span>
                                              <span class="n">L</span><span class="o">=</span><span class="mi">1</span><span class="o">/</span><span class="n">lam</span><span class="p">,</span>
                                              <span class="n">xlim</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="o">-</span><span class="n">load_spacing</span><span class="o">*</span><span class="n">pdict</span><span class="p">[</span><span class="s2">&quot;L&quot;</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">nloads</span> <span class="o">+</span> <span class="mi">1</span><span class="p">),</span> <span class="n">load_spacing</span><span class="o">*</span><span class="n">pdict</span><span class="p">[</span><span class="s2">&quot;L&quot;</span><span class="p">]),</span>
                                              <span class="n">wsingle</span><span class="o">=</span><span class="n">wstatic</span><span class="p">)</span>
                <span class="n">wstatic</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">ymulti</span><span class="p">)</span>




        <span class="c1">#        print(lam, Q, wstatic)</span>
        <span class="c1">#        print(max_envelope)</span>

                <span class="n">yplot</span> <span class="o">=</span> <span class="n">max_envelope</span> <span class="o">/</span> <span class="n">wstatic</span>
        <span class="c1">#        print(xplot.shape, yplot.shape)</span>
        <span class="c1">#        print(xplot)</span>
                <span class="k">if</span> <span class="n">reverse</span><span class="p">:</span>
                    <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;$L_t/L_c=</span><span class="si">{}</span><span class="s2">,\ </span><span class="se">\\</span><span class="s2">leftarrow$&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">Lt_Lc</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">k</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span>
                        <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;$spec\ </span><span class="se">\\</span><span class="s2">leftarrow$&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">Lt_Lc</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">label</span><span class="o">=</span><span class="kc">None</span>
                    <span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xplot</span><span class="p">,</span> <span class="n">yplot</span><span class="p">,</span> <span class="n">dashes</span><span class="o">=</span><span class="p">[</span><span class="mi">4</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span>
                         <span class="n">color</span><span class="o">=</span><span class="n">line</span><span class="o">.</span><span class="n">get_color</span><span class="p">(),</span>
                        <span class="n">label</span> <span class="o">=</span> <span class="n">label</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;$L_t/L_c=</span><span class="si">{}</span><span class="s2">,\ </span><span class="se">\\</span><span class="s2">rightarrow$&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">Lt_Lc</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">k</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span>
                        <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;$spec\ </span><span class="se">\\</span><span class="s2">rightarrow$&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">Lt_Lc</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">label</span><span class="o">=</span><span class="kc">None</span>
                    <span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xplot</span><span class="p">,</span> <span class="n">yplot</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span>
                         <span class="n">color</span><span class="o">=</span><span class="n">line</span><span class="o">.</span><span class="n">get_color</span><span class="p">(),</span>
                         <span class="n">label</span> <span class="o">=</span> <span class="n">label</span><span class="p">)</span>



                <span class="c1">#point vs time plot</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">xi_Lc</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">max_position</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">unravel_index</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">defl</span><span class="o">.</span><span class="n">argmax</span><span class="p">(),</span> <span class="n">a</span><span class="o">.</span><span class="n">defl</span><span class="o">.</span><span class="n">shape</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
                    <span class="n">xeval</span><span class="o">=</span><span class="n">a</span><span class="o">.</span><span class="n">xvals_norm</span><span class="p">[</span><span class="n">max_position</span><span class="p">]</span>
<span class="c1">#                    xeval = trans_middle + xi_Lc / lam/pdict[&quot;L&quot;]</span>
                    <span class="n">xi_Lc_</span> <span class="o">=</span> <span class="p">(</span><span class="n">xeval</span><span class="o">-</span><span class="n">trans_middle</span><span class="p">)</span><span class="o">*</span><span class="n">lam</span><span class="o">*</span><span class="n">pdict</span><span class="p">[</span><span class="s2">&quot;L&quot;</span><span class="p">]</span>
                    <span class="n">ieval</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">searchsorted</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">xvals_norm</span><span class="p">,</span><span class="n">xeval</span><span class="p">)</span>
                    <span class="n">xplot</span><span class="o">=</span><span class="n">a</span><span class="o">.</span><span class="n">tvals</span><span class="c1">#tvals_norm</span>
                    <span class="n">yplot</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">defl</span><span class="p">[</span><span class="n">ieval</span><span class="o">-</span><span class="mi">1</span><span class="p">,:]</span> <span class="o">+</span> <span class="p">(</span><span class="n">xeval</span><span class="o">-</span><span class="n">a</span><span class="o">.</span><span class="n">xvals_norm</span><span class="p">[</span><span class="n">ieval</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span><span class="o">/</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">xvals_norm</span><span class="p">[</span><span class="n">ieval</span><span class="p">]</span><span class="o">-</span><span class="n">a</span><span class="o">.</span><span class="n">xvals_norm</span><span class="p">[</span><span class="n">ieval</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> <span class="o">*</span> <span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">defl</span><span class="p">[</span><span class="n">ieval</span><span class="p">,:]</span><span class="o">-</span><span class="n">a</span><span class="o">.</span><span class="n">defl</span><span class="p">[</span><span class="n">ieval</span><span class="o">-</span><span class="mi">1</span><span class="p">,:])</span>
<span class="c1">#                    yplot = a.defl[ieval,:] + (xeval-a.xvals_norm[ieval])/(a.xvals_norm[ieval+1]-a.xvals_norm[ieval]) * (a.defl[ieval+1,:]-a.defl[ieval,:])</span>
                    <span class="n">yplot</span> <span class="o">/=</span> <span class="n">wstatic</span>
                    <span class="k">if</span> <span class="n">article_formatting</span><span class="p">:</span>
                        <span class="n">ax4</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xplot</span><span class="p">,</span> <span class="n">yplot</span><span class="p">,</span>
                                <span class="n">label</span><span class="o">=</span><span class="s2">&quot;$L_t/L_c=</span><span class="si">{}</span><span class="s2">$&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">Lt_Lc</span><span class="p">),</span>
                                <span class="n">markevery</span><span class="o">=</span><span class="p">(</span><span class="n">k</span><span class="o">/</span><span class="mi">3</span><span class="o">*</span><span class="mf">0.09</span><span class="p">,</span><span class="mf">0.15</span><span class="p">),</span>
                                <span class="o">**</span><span class="n">styles</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">ax4</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xplot</span><span class="p">,</span> <span class="n">yplot</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">line</span><span class="o">.</span><span class="n">get_color</span><span class="p">(),</span>
                                <span class="n">label</span><span class="o">=</span><span class="s2">&quot;$L_t/L_c=</span><span class="si">{}</span><span class="s2">$&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">Lt_Lc</span><span class="p">)</span> <span class="p">)</span>
                    <span class="k">for</span> <span class="n">imvpl</span><span class="p">,</span> <span class="n">mvpl</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">moving_loads_norm</span><span class="p">):</span>
                        <span class="n">t_pass</span> <span class="o">=</span> <span class="n">mvpl</span><span class="o">.</span><span class="n">time_axles_pass_beam_point</span><span class="p">(</span><span class="n">xeval</span><span class="p">)</span>
                        <span class="n">t_pass</span> <span class="o">*=</span> <span class="n">pdict</span><span class="p">[</span><span class="s2">&quot;L&quot;</span><span class="p">]</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">pdict</span><span class="p">[</span><span class="s2">&quot;E&quot;</span><span class="p">]</span> <span class="o">/</span> <span class="n">pdict</span><span class="p">[</span><span class="s2">&quot;rho&quot;</span><span class="p">])</span>
                        <span class="n">ax4</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t_pass</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">interp</span><span class="p">(</span><span class="n">t_pass</span><span class="p">,</span><span class="n">xplot</span><span class="p">,</span><span class="n">yplot</span><span class="p">),</span>
                                     <span class="n">color</span><span class="o">=</span><span class="n">line</span><span class="o">.</span><span class="n">get_color</span><span class="p">(),</span>
                                     <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;o&quot;</span><span class="p">,</span> <span class="n">ms</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;:&#39;</span><span class="p">,</span>
                                     <span class="n">label</span><span class="o">=</span><span class="s2">&quot;$x/L_c=</span><span class="si">{:.1f}</span><span class="s2">$&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">xi_Lc_</span><span class="p">))</span>



                <span class="c1">#under loads</span>
                <span class="n">a</span><span class="o">.</span><span class="n">defl_vs_time_under_loads</span><span class="p">(</span><span class="n">xlim_norm</span><span class="o">=</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">xvals_norm</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">a</span><span class="o">.</span><span class="n">xvals_norm</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]))</span>
                <span class="n">dash_list</span><span class="o">=</span><span class="p">[(</span><span class="kc">None</span><span class="p">,</span><span class="kc">None</span><span class="p">),[</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">],[</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],[</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">]]</span>
                <span class="k">for</span> <span class="n">imvpl</span><span class="p">,</span> <span class="n">mvpl</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">moving_loads_norm</span><span class="p">):</span>
                    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">mvpl</span><span class="o">.</span><span class="n">x</span><span class="p">)):</span>
                        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">Lt_Lcs</span><span class="p">)</span><span class="o">==</span><span class="mi">1</span><span class="p">:</span>
                            <span class="n">label</span> <span class="o">=</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;$load </span><span class="si">{}</span><span class="s2">$&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="n">label</span> <span class="o">=</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;$L_t/L_c=</span><span class="si">{}</span><span class="s2">,\ load </span><span class="si">{}</span><span class="s2">$&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">Lt_Lc</span><span class="p">,</span> <span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>


                        <span class="n">ax5</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">tvals</span><span class="p">,</span> <span class="n">a</span><span class="o">.</span><span class="n">moving_load_w</span><span class="p">[</span><span class="n">imvpl</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">/</span> <span class="n">wstatic</span><span class="p">,</span>
                             <span class="n">color</span><span class="o">=</span><span class="n">line</span><span class="o">.</span><span class="n">get_color</span><span class="p">(),</span>
                             <span class="n">label</span><span class="o">=</span><span class="n">label</span><span class="p">,</span>
                             <span class="n">dashes</span><span class="o">=</span><span class="n">dash_list</span><span class="p">[</span><span class="n">j</span><span class="p">])</span>





    <span class="n">leg</span> <span class="o">=</span> <span class="n">ax2</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span>
<span class="c1">#                    title=&quot;$\\beta$&quot;,</span>
                    <span class="n">loc</span><span class="o">=</span><span class="s2">&quot;upper right&quot;</span><span class="p">,</span>
<span class="c1">#                    ncol=2,</span>
                    <span class="n">labelspacing</span><span class="o">=.</span><span class="mi">2</span><span class="p">,</span>
                    <span class="n">handlelength</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
                    <span class="n">fontsize</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span>
                    <span class="n">numpoints</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                        <span class="p">)</span>
    <span class="n">leg</span><span class="o">.</span><span class="n">draggable</span><span class="p">()</span>

    <span class="n">ax2</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">labelpad</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">labelpad</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">ax3</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">labelpad</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
    <span class="n">ax3</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">labelpad</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="n">yloc</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">MaxNLocator</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
    <span class="n">ax3</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_major_locator</span><span class="p">(</span><span class="n">yloc</span><span class="p">)</span>

    <span class="n">fig</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">top</span><span class="o">=</span><span class="mf">0.95</span><span class="p">,</span> <span class="n">bottom</span><span class="o">=</span><span class="mf">0.13</span><span class="p">,</span> <span class="n">left</span><span class="o">=</span><span class="mf">0.14</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="mf">0.95</span><span class="p">)</span>


    <span class="k">if</span> <span class="ow">not</span> <span class="n">xi_Lc</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">ax4</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;$Time (s)$&#39;</span><span class="p">)</span>
        <span class="n">ax4</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;$w/w_</span><span class="si">{static1}</span><span class="s1">$&#39;</span><span class="p">)</span>
        <span class="n">leg</span> <span class="o">=</span> <span class="n">ax4</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span>
<span class="c1">#                    title=&quot;&quot;,</span>
                    <span class="n">labelspacing</span><span class="o">=.</span><span class="mi">2</span><span class="p">,</span>
                    <span class="n">handlelength</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
                    <span class="n">fontsize</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span>
                    <span class="n">numpoints</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                    <span class="n">loc</span><span class="o">=</span><span class="s2">&quot;center left&quot;</span><span class="p">,)</span>
        <span class="n">leg</span><span class="o">.</span><span class="n">draggable</span><span class="p">()</span>

    <span class="n">ax5</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;$Time (s)$&#39;</span><span class="p">)</span>
    <span class="n">ax5</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;$w/w_</span><span class="si">{static1}</span><span class="s1">$&#39;</span><span class="p">)</span>
    <span class="n">leg</span> <span class="o">=</span> <span class="n">ax5</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span>
<span class="c1">#                    title=&quot;&quot;,</span>
                <span class="n">labelspacing</span><span class="o">=.</span><span class="mi">2</span><span class="p">,</span>
                <span class="n">handlelength</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
                <span class="n">fontsize</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span>
                <span class="n">numpoints</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                <span class="n">loc</span><span class="o">=</span><span class="s2">&quot;lower right&quot;</span><span class="p">,)</span>

    <span class="n">leg</span><span class="o">.</span><span class="n">draggable</span><span class="p">()</span>
    <span class="n">fig5</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">top</span><span class="o">=</span><span class="mf">0.95</span><span class="p">,</span> <span class="n">bottom</span><span class="o">=</span><span class="mf">0.13</span><span class="p">,</span> <span class="n">left</span><span class="o">=</span><span class="mf">0.15</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="mf">0.95</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">saveas</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>

        <span class="n">save_figure</span><span class="p">(</span><span class="n">fig</span><span class="o">=</span><span class="n">fig</span><span class="p">,</span> <span class="n">fname</span><span class="o">=</span><span class="n">saveas</span> <span class="o">+</span> <span class="s2">&quot;_fig1&quot;</span><span class="p">)</span>
        <span class="n">save_figure</span><span class="p">(</span><span class="n">fig</span><span class="o">=</span><span class="n">fig4</span><span class="p">,</span> <span class="n">fname</span><span class="o">=</span><span class="n">saveas</span> <span class="o">+</span> <span class="s2">&quot;_fig4&quot;</span><span class="p">)</span>
        <span class="n">save_figure</span><span class="p">(</span><span class="n">fig</span><span class="o">=</span><span class="n">fig5</span><span class="p">,</span> <span class="n">fname</span><span class="o">=</span><span class="n">saveas</span> <span class="o">+</span> <span class="s2">&quot;_fig5&quot;</span><span class="p">)</span>


    <span class="k">return</span> <span class="n">fig</span></div>


<div class="viewcode-block" id="transition_zones2"><a class="viewcode-back" href="../../../api/geotecha.beam_on_foundation.specbeam.html#geotecha.beam_on_foundation.specbeam.transition_zones2">[docs]</a><span class="k">def</span> <span class="nf">transition_zones2</span><span class="p">(</span><span class="n">animateme</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
           <span class="n">saveas</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
           <span class="n">xlim</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">),</span>
           <span class="n">ntrans</span> <span class="o">=</span> <span class="mi">50</span><span class="p">,</span> <span class="c1"># number of points to sample analytical trasnstion zone</span>
            <span class="n">kratio</span> <span class="o">=</span> <span class="mi">50</span><span class="p">,</span>
            <span class="n">beta</span> <span class="o">=</span> <span class="mf">0.2</span><span class="p">,</span>
            <span class="n">alphas</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.8</span><span class="p">],</span>
            <span class="n">nx</span> <span class="o">=</span> <span class="mi">100</span><span class="p">,</span>     <span class="c1">#number of x points</span>
            <span class="n">nt</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="c1">#number of time values</span>
            <span class="n">nterms</span><span class="o">=</span><span class="mi">150</span><span class="p">,</span>
            <span class="n">force_calc</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">ninterp</span> <span class="o">=</span> <span class="mi">15</span><span class="p">,</span> <span class="c1"># number of points to discretize the transition zone</span>
            <span class="n">nloads</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
            <span class="n">load_spacing</span> <span class="o">=</span> <span class="mf">0.03</span><span class="p">,</span>
            <span class="n">alpha_design</span> <span class="o">=</span> <span class="mf">0.8</span><span class="p">,</span> <span class="c1">#this will be ignored</span>
            <span class="n">Lt_Lcs</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.1</span><span class="p">,</span><span class="mi">4</span><span class="p">],</span>
            <span class="n">t_extend</span> <span class="o">=</span> <span class="mf">1.1</span><span class="p">,</span> <span class="c1"># factor to extend maximum evalutated time.</span>
            <span class="n">DAF_distribution</span> <span class="o">=</span> <span class="s2">&quot;linear&quot;</span><span class="p">,</span>
            <span class="n">tanhend</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span>
            <span class="n">reverses</span><span class="o">=</span><span class="p">[</span><span class="kc">False</span><span class="p">,</span><span class="kc">True</span><span class="p">],</span>
            <span class="n">xi_Lc</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="c1">#ratio of xinterest over characteristic length</span>
            <span class="n">prefix</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
            <span class="n">article_formatting</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Essentially a duplicate of transition_zones1 to get a DAF* vs Lt/Lc</span>
<span class="sd">    plot for forward and reverse plots</span>

<span class="sd">    Be warned that this can produce hundreds of plots and take hours to run</span>
<span class="sd">    when all you are interested is the single resulting plot.</span>

<span class="sd">    Basically a transtion_zones1 analysis will be run.  The maximum</span>
<span class="sd">    defelction (w.r.t. to the infinite beam deflection at same speed</span>
<span class="sd">    and damping) for that run will be recorded.  That will be one point for</span>
<span class="sd">    one alpha value for one Lt/Lc value.  Points will be joined to form</span>
<span class="sd">    a line for for each alphas and reverses combination.</span>


<span class="sd">    I used this once for a journal article figure.</span>



<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="n">article_formatting</span><span class="p">:</span>
        <span class="n">mdc1</span> <span class="o">=</span> <span class="n">MarkersDashesColors</span><span class="p">(</span><span class="n">markersize</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span><span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

        <span class="n">mdc1</span><span class="o">.</span><span class="n">construct_styles</span><span class="p">(</span><span class="n">markers</span><span class="o">=</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">25</span><span class="p">,</span><span class="mi">11</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">15</span><span class="p">],</span>
                           <span class="n">dashes</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                           <span class="n">marker_colors</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">],</span>
                       <span class="n">line_colors</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">])</span>

        <span class="n">styles1</span><span class="o">=</span><span class="n">mdc1</span><span class="p">(</span><span class="n">markers</span><span class="o">=</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">25</span><span class="p">,</span><span class="mi">11</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">15</span><span class="p">],</span>
                           <span class="n">dashes</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                           <span class="n">marker_colors</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">],</span>
                       <span class="n">line_colors</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">])</span>

        <span class="n">mdc2</span> <span class="o">=</span> <span class="n">MarkersDashesColors</span><span class="p">(</span><span class="n">markersize</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span><span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

        <span class="n">mdc2</span><span class="o">.</span><span class="n">construct_styles</span><span class="p">(</span><span class="n">markers</span><span class="o">=</span><span class="p">[</span><span class="mi">13</span><span class="p">,</span><span class="mi">18</span><span class="p">,</span><span class="mi">21</span><span class="p">,</span><span class="mi">9</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span>
                           <span class="n">dashes</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
                           <span class="n">marker_colors</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">],</span>
                       <span class="n">line_colors</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">])</span>

        <span class="n">styles2</span><span class="o">=</span><span class="n">mdc1</span><span class="p">(</span><span class="n">markers</span><span class="o">=</span><span class="p">[</span><span class="mi">13</span><span class="p">,</span><span class="mi">18</span><span class="p">,</span><span class="mi">21</span><span class="p">,</span><span class="mi">9</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span>
                           <span class="n">dashes</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
                           <span class="n">marker_colors</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">],</span>
                       <span class="n">line_colors</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">])</span>



    <span class="c1">#figure</span>
    <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mf">3.54</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
    <span class="n">gs</span> <span class="o">=</span> <span class="n">matplotlib</span><span class="o">.</span><span class="n">gridspec</span><span class="o">.</span><span class="n">GridSpec</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span>
<span class="c1">#                       width_ratios=[1, 2],</span>
                   <span class="n">height_ratios</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">],</span>
                   <span class="n">hspace</span><span class="o">=</span><span class="mf">0.05</span><span class="p">)</span>

    <span class="n">matplotlib</span><span class="o">.</span><span class="n">rcParams</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s1">&#39;font.size&#39;</span><span class="p">:</span> <span class="mi">11</span><span class="p">})</span>

    <span class="c1">#DAF vs kratio plot</span>
<span class="c1">#    ax1 = fig.add_subplot(gs[1,0])</span>
<span class="c1">#    transition_DAF1_at_specific_alp(ax=ax1)</span>
<span class="c1">#    ax1.set_ylim(0,2)</span>

    <span class="c1">#DAF vs xtrans plot</span>
    <span class="n">ax2</span> <span class="o">=</span> <span class="n">ax2</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;$w/w_</span><span class="si">{static1}</span><span class="s2">$&quot;</span><span class="p">)</span>
<span class="c1">#    ax2.set_xlim(-0.5,1.5)</span>

    <span class="n">ax2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;$x/L_c$&#39;</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="c1">#    ax1.set_ylim(-10, 10)</span>



    <span class="c1">#k/k1 vs xtrans plot</span>
    <span class="n">ax3</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="p">)</span><span class="c1">#sharex=ax2)</span>
<span class="c1">#        ax3.set_xlabel(&#39;$x/L_t$&#39;)</span>
    <span class="n">ax3</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;$k/k_1$&#39;</span><span class="p">)</span>
    <span class="n">ax3</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>

    <span class="n">ax3</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_ticklabels</span><span class="p">([])</span>

<span class="c1">#    xlim = (-.5,1.5)</span>
<span class="c1">#    xlim = (-8,8)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">*</span><span class="n">xlim</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>


    <span class="k">if</span> <span class="ow">not</span> <span class="n">xi_Lc</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">fig4</span><span class="p">,</span> <span class="n">ax4</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span> <span class="c1"># deflection vs time at point</span>

    <span class="n">fig5</span><span class="p">,</span> <span class="n">ax5</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>


    <span class="n">fig6</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mf">3.54</span><span class="p">,</span><span class="mf">3.54</span><span class="p">))</span>
    <span class="n">ax6</span> <span class="o">=</span> <span class="n">fig6</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="s1">&#39;111&#39;</span><span class="p">)</span>

    <span class="n">pdict</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">(</span>
                <span class="n">E</span> <span class="o">=</span> <span class="mf">6.998</span><span class="o">*</span><span class="mf">1e9</span><span class="p">,</span> <span class="c1">#Pa</span>
                <span class="n">rho</span> <span class="o">=</span> <span class="mi">2373</span><span class="p">,</span> <span class="c1">#kg/m3</span>
                <span class="n">L</span> <span class="o">=</span> <span class="mi">160</span><span class="p">,</span> <span class="c1">#m</span>
                <span class="n">A</span> <span class="o">=</span> <span class="mf">0.3</span><span class="o">*</span><span class="mf">0.1</span><span class="p">,</span> <span class="c1"># m^2</span>
                <span class="n">I</span> <span class="o">=</span> <span class="mf">0.00022477900799999998</span><span class="p">,</span>
                <span class="n">k1</span> <span class="o">=</span> <span class="mf">800002.6125</span><span class="p">,</span>
                <span class="n">nterms</span><span class="o">=</span><span class="n">nterms</span><span class="p">,</span>
                <span class="n">BC</span><span class="o">=</span><span class="s2">&quot;SS&quot;</span><span class="p">,</span>
<span class="c1">#                moving_loads_x_norm=[[0-vv*load_spacing for vv in range(nloads)]],</span>
<span class="c1">#                moving_loads_Fz_norm=[[1.013e-4]*nloads],</span>
<span class="c1">#                xvals_norm=np.linspace(xeval[0], xeval[1], nx),</span>
                <span class="n">use_analytical</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                <span class="n">implementation</span><span class="o">=</span><span class="s2">&quot;fortran&quot;</span><span class="p">,</span>
                <span class="n">force_calc</span><span class="o">=</span><span class="n">force_calc</span><span class="p">,</span>
                <span class="p">)</span>






    <span class="n">max_ratios</span><span class="o">=</span><span class="p">[]</span>
    <span class="k">for</span> <span class="n">reverse</span> <span class="ow">in</span> <span class="n">reverses</span><span class="p">:</span>
        <span class="n">max_ratios</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">alphas</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">Lt_Lcs</span><span class="p">))))</span>

    <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">Lt_Lc</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">Lt_Lcs</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;doing Lt_Lc=&quot;</span><span class="p">,</span> <span class="n">Lt_Lc</span><span class="p">)</span>
        <span class="n">trans_characteristic_factor</span> <span class="o">=</span> <span class="n">Lt_Lc</span><span class="c1"># multiple of k1 characteristic length</span>
        <span class="n">trans_middle</span> <span class="o">=</span> <span class="mf">0.5</span>
<span class="c1">#        t_extend = 1.1 # factor to extend maximum evalutated time.</span>
        <span class="n">lam</span> <span class="o">=</span> <span class="p">(</span><span class="n">pdict</span><span class="p">[</span><span class="s1">&#39;k1&#39;</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="mi">4</span><span class="o">*</span><span class="n">pdict</span><span class="p">[</span><span class="s1">&#39;E&#39;</span><span class="p">]</span><span class="o">*</span><span class="n">pdict</span><span class="p">[</span><span class="s1">&#39;I&#39;</span><span class="p">]))</span><span class="o">**</span><span class="mf">0.25</span>
        <span class="n">trans_len_raw</span> <span class="o">=</span> <span class="n">trans_characteristic_factor</span> <span class="o">/</span> <span class="n">lam</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Characteristic len =</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">lam</span><span class="p">))</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;normalised:</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">lam</span><span class="o">/</span><span class="n">pdict</span><span class="p">[</span><span class="s2">&quot;L&quot;</span><span class="p">]))</span>
        <span class="n">trans_len</span> <span class="o">=</span> <span class="n">trans_len_raw</span> <span class="o">/</span> <span class="n">pdict</span><span class="p">[</span><span class="s2">&quot;L&quot;</span><span class="p">]</span>

    <span class="c1">#    trans_len=0.2  #normalised values w.r.t. L</span>

        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;tlen/char_len=</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">trans_len</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">lam</span><span class="o">/</span><span class="n">pdict</span><span class="p">[</span><span class="s2">&quot;L&quot;</span><span class="p">])))</span>
        <span class="n">trans_start</span> <span class="o">=</span> <span class="n">trans_middle</span> <span class="o">-</span> <span class="n">trans_len</span><span class="o">/</span><span class="mi">2</span>
        <span class="n">trans_end</span> <span class="o">=</span> <span class="n">trans_start</span> <span class="o">+</span> <span class="n">trans_len</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;tstart=</span><span class="si">{:8.3f}</span><span class="s2">,tend=</span><span class="si">{:8.3f}</span><span class="s2">,tlen=</span><span class="si">{:8.3f}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">trans_start</span><span class="p">,</span><span class="n">trans_end</span><span class="p">,</span> <span class="n">trans_len</span><span class="p">))</span>

        <span class="n">xeval</span> <span class="o">=</span> <span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="mf">0.4</span><span class="p">,</span><span class="n">trans_start</span> <span class="o">-</span> <span class="p">(</span><span class="mi">0</span><span class="o">-</span><span class="n">xlim</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">*</span> <span class="n">trans_len</span><span class="p">),</span>
                     <span class="nb">max</span><span class="p">(</span><span class="mf">0.6</span><span class="p">,</span><span class="n">trans_end</span> <span class="o">+</span> <span class="p">(</span><span class="n">xlim</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span><span class="o">*</span> <span class="n">trans_len</span><span class="p">))</span>
        <span class="n">xeval</span> <span class="o">=</span> <span class="p">(</span><span class="n">trans_middle</span> <span class="o">-</span> <span class="nb">abs</span><span class="p">(</span><span class="n">xlim</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">/</span><span class="n">lam</span><span class="o">/</span><span class="n">pdict</span><span class="p">[</span><span class="s2">&quot;L&quot;</span><span class="p">],</span> <span class="n">trans_middle</span> <span class="o">+</span> <span class="nb">abs</span><span class="p">(</span><span class="n">xlim</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">/</span><span class="n">lam</span><span class="o">/</span><span class="n">pdict</span><span class="p">[</span><span class="s2">&quot;L&quot;</span><span class="p">])</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;xeval:&quot;</span><span class="p">,</span><span class="n">xeval</span><span class="p">)</span>

        <span class="n">xtrans</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ntrans</span><span class="p">)</span>













        <span class="n">DAFtrans</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty_like</span><span class="p">(</span><span class="n">xtrans</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">alp</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">alphas</span><span class="p">):</span>

            <span class="n">alpha_design</span> <span class="o">=</span> <span class="n">alp</span>
            <span class="n">DAF1</span> <span class="o">=</span> <span class="n">DAFinfinite</span><span class="p">(</span><span class="n">alp</span><span class="o">=</span><span class="n">alpha_design</span><span class="p">,</span> <span class="n">bet</span><span class="o">=</span><span class="n">beta</span><span class="p">)</span>
            <span class="n">DAF2</span> <span class="o">=</span> <span class="n">DAFinfinite</span><span class="p">(</span><span class="n">alp</span><span class="o">=</span><span class="n">alpha_design</span><span class="p">,</span><span class="n">bet</span><span class="o">=</span><span class="n">beta</span><span class="p">,</span><span class="n">kratio</span><span class="o">=</span><span class="n">kratio</span><span class="p">)</span>


            <span class="k">if</span> <span class="n">DAF_distribution</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">==</span><span class="s2">&quot;linear&quot;</span><span class="p">:</span>
                <span class="n">DAF_goal</span> <span class="o">=</span> <span class="n">DAF1</span> <span class="o">+</span> <span class="p">(</span><span class="n">DAF2</span><span class="o">-</span><span class="n">DAF1</span><span class="p">)</span><span class="o">*</span><span class="n">xtrans</span>
            <span class="k">elif</span> <span class="n">DAF_distribution</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">==</span><span class="s2">&quot;tanh&quot;</span><span class="p">:</span>
                <span class="c1">#ideal transition</span>
                <span class="n">b</span> <span class="o">=</span> <span class="n">tanhtranib</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">tanhend</span><span class="p">,</span> <span class="n">a</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;b:&quot;</span><span class="p">,</span><span class="n">b</span><span class="p">)</span>
                <span class="n">DAF_goal</span> <span class="o">=</span> <span class="p">(</span><span class="n">tanhtran</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">xtrans</span><span class="p">,</span> <span class="n">a</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="n">b</span><span class="p">)</span> <span class="o">-</span> <span class="mf">0.5</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">tanhend</span><span class="p">)</span> <span class="o">+</span> <span class="mf">0.5</span>

                <span class="n">DAF_goal</span> <span class="o">=</span> <span class="n">DAF_goal</span> <span class="o">*</span> <span class="n">DAF2</span> <span class="o">+</span> <span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">DAF_goal</span><span class="p">)</span> <span class="o">*</span> <span class="n">DAF1</span>

            <span class="k">elif</span> <span class="n">DAF_distribution</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">==</span><span class="s2">&quot;reverse&quot;</span><span class="p">:</span>
                <span class="n">DAF_goal</span> <span class="o">=</span> <span class="n">reverse_curve_transition</span><span class="p">(</span><span class="n">xtrans</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">DAF1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">DAF2</span><span class="p">)</span>

            <span class="n">DAF_goal</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">DAF1</span>
            <span class="n">DAF_goal</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">DAF2</span>

            <span class="n">kkk</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">kratio</span><span class="p">,</span><span class="mi">300</span><span class="p">,</span><span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
            <span class="n">yyy</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">kkk</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">iii</span><span class="p">,</span><span class="n">krat</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">kkk</span><span class="p">):</span>
                <span class="n">yyy</span><span class="p">[</span><span class="n">iii</span><span class="p">]</span><span class="o">=</span><span class="n">DAFinfinite</span><span class="p">(</span><span class="n">alp</span><span class="o">=</span><span class="n">alpha_design</span><span class="p">,</span><span class="n">bet</span><span class="o">=</span><span class="n">beta</span><span class="p">,</span><span class="n">kratio</span><span class="o">=</span><span class="n">krat</span><span class="p">)</span>

            <span class="n">ktrans</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty_like</span><span class="p">(</span><span class="n">xtrans</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">iii</span><span class="p">,</span> <span class="n">DAF</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">DAF_goal</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">iii</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span>
                    <span class="n">ktrans</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">=</span><span class="mi">1</span>
                <span class="k">elif</span> <span class="n">iii</span><span class="o">==</span><span class="n">ntrans</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span>
                    <span class="n">ktrans</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">=</span><span class="n">kratio</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">ktrans</span><span class="p">[</span><span class="n">iii</span><span class="p">]</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">interp</span><span class="p">(</span><span class="n">DAF</span><span class="p">,</span> <span class="n">yyy</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">kkk</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>




            <span class="n">ctrans</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones_like</span><span class="p">(</span><span class="n">xtrans</span><span class="p">)</span>



            <span class="n">xx</span> <span class="o">=</span> <span class="p">[</span><span class="n">xlim</span><span class="p">[</span><span class="mi">0</span><span class="p">]];</span> <span class="n">xx</span><span class="o">.</span><span class="n">extend</span><span class="p">((</span><span class="n">xtrans</span><span class="o">-</span><span class="n">trans_middle</span><span class="p">)</span><span class="o">*</span><span class="n">trans_len</span><span class="o">*</span><span class="n">pdict</span><span class="p">[</span><span class="s2">&quot;L&quot;</span><span class="p">]</span><span class="o">*</span><span class="n">lam</span><span class="p">);</span> <span class="n">xx</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">xlim</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
            <span class="n">yy</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">];</span> <span class="n">yy</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">ktrans</span><span class="p">);</span> <span class="n">yy</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">kratio</span><span class="p">)</span>


            <span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="n">krat</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">ktrans</span><span class="p">):</span>
                <span class="n">DAFtrans</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">DAFinfinite</span><span class="p">(</span><span class="n">alp</span><span class="o">=</span><span class="n">alp</span><span class="p">,</span><span class="n">bet</span><span class="o">=</span><span class="n">beta</span><span class="p">,</span><span class="n">kratio</span><span class="o">=</span><span class="n">krat</span><span class="p">)</span>


            <span class="n">yy</span> <span class="o">=</span> <span class="p">[</span><span class="n">DAFtrans</span><span class="p">[</span><span class="mi">0</span><span class="p">]];</span> <span class="n">yy</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">DAFtrans</span><span class="p">);</span> <span class="n">yy</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">DAFtrans</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
            <span class="n">label</span><span class="o">=</span><span class="s2">&quot;$L_t/L_c=</span><span class="si">{}</span><span class="s2">, idealized$&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">Lt_Lc</span><span class="p">)</span>
            <span class="n">line</span><span class="p">,</span><span class="o">=</span> <span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xx</span><span class="p">,</span><span class="n">yy</span><span class="p">,</span><span class="n">ls</span><span class="o">=</span><span class="s2">&quot;-&quot;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="n">label</span><span class="p">)</span>

            <span class="c1">#mymodel</span>



            <span class="c1">#sample the k value to form a poly line</span>

            <span class="n">xtrans_spec</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ninterp</span><span class="p">)</span>
    <span class="c1">#        if reverse:</span>
    <span class="c1">#            ktrans_spec = np.interp(xtrans_spec, xtrans, ktrans_reverse)</span>
    <span class="c1">#        else:</span>
            <span class="n">ktrans_spec</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">interp</span><span class="p">(</span><span class="n">xtrans_spec</span><span class="p">,</span> <span class="n">xtrans</span><span class="p">,</span> <span class="n">ktrans</span><span class="p">)</span>
    <span class="c1">#        print(ktrans_spec)</span>
            <span class="n">pline_x</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">pline_x</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">trans_start</span> <span class="o">+</span> <span class="n">xtrans_spec</span> <span class="o">*</span> <span class="n">trans_len</span><span class="p">)</span>
            <span class="n">pline_x</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

            <span class="n">pline_k1</span> <span class="o">=</span> <span class="p">[</span><span class="n">ktrans_spec</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
            <span class="n">pline_k1</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">ktrans_spec</span><span class="p">)</span>
            <span class="n">pline_k1</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ktrans_spec</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>

            <span class="n">k1bar</span> <span class="o">=</span> <span class="n">PolyLine</span><span class="p">(</span><span class="n">pline_x</span><span class="p">,</span> <span class="n">pline_k1</span><span class="p">)</span>
    <span class="c1">#        print(k1bar)</span>

            <span class="c1">#sample the c values to form a poly line</span>
            <span class="n">ctrans_spec</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">interp</span><span class="p">(</span><span class="n">xtrans_spec</span><span class="p">,</span> <span class="n">xtrans</span><span class="p">,</span> <span class="n">ctrans</span><span class="p">)</span>
            <span class="n">pline_mu</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">pline_mu</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">ctrans_spec</span><span class="p">)</span>
            <span class="n">pline_mu</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ctrans_spec</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
            <span class="n">mubar</span> <span class="o">=</span> <span class="n">PolyLine</span><span class="p">(</span><span class="n">pline_x</span><span class="p">,</span> <span class="n">pline_mu</span><span class="p">)</span>
    <span class="c1">#        print(mubar)</span>


    <span class="c1">#        xeval = (trans_start - (0-xlim[0]) * trans_len,</span>
    <span class="c1">#                 trans_end + (xlim[1] - 1)* trans_len)</span>
    <span class="c1">#        print(xeval)</span>
    <span class="c1">#</span>
    <span class="c1">##        xwindow = (xeval[0],xeval[1])</span>
    <span class="c1">#</span>
    <span class="c1">#        pdict = OrderedDict(</span>
    <span class="c1">#                    E = 6.998*1e9, #Pa</span>
    <span class="c1">#                    rho = 2373, #kg/m3</span>
    <span class="c1">#                    L = 160, #m</span>
    <span class="c1">#                    A = 0.3*0.1, # m^2</span>
    <span class="c1">#                    I = 0.00022477900799999998,</span>
    <span class="c1">#                    k1 = 800002.6125,</span>
    <span class="c1">#                    nterms=nterms,</span>
    <span class="c1">#                    BC=&quot;SS&quot;,</span>
    <span class="c1">#                    moving_loads_x_norm=[[0-vv*load_spacing for vv in range(nloads)]],</span>
    <span class="c1">#                    moving_loads_Fz_norm=[[1.013e-4]*nloads],</span>
    <span class="c1">#                    xvals_norm=np.linspace(xeval[0], xeval[1], nx),</span>
    <span class="c1">#                    use_analytical=True,</span>
    <span class="c1">#                    implementation=&quot;fortran&quot;,</span>
    <span class="c1">#                    force_calc=force_calc,</span>
    <span class="c1">#                    )</span>



            <span class="n">v_crit</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="o">/</span><span class="n">pdict</span><span class="p">[</span><span class="s2">&quot;rho&quot;</span><span class="p">]</span><span class="o">/</span><span class="n">pdict</span><span class="p">[</span><span class="s2">&quot;A&quot;</span><span class="p">]</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">pdict</span><span class="p">[</span><span class="s2">&quot;k1&quot;</span><span class="p">]</span><span class="o">*</span><span class="n">pdict</span><span class="p">[</span><span class="s2">&quot;E&quot;</span><span class="p">]</span><span class="o">*</span><span class="n">pdict</span><span class="p">[</span><span class="s2">&quot;I&quot;</span><span class="p">]))</span>
            <span class="n">v_raw</span> <span class="o">=</span> <span class="n">v_crit</span><span class="o">*</span><span class="n">alp</span>

            <span class="n">c_crit</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">4</span><span class="o">*</span><span class="n">pdict</span><span class="p">[</span><span class="s2">&quot;rho&quot;</span><span class="p">]</span><span class="o">*</span><span class="n">pdict</span><span class="p">[</span><span class="s2">&quot;A&quot;</span><span class="p">]</span><span class="o">*</span><span class="n">pdict</span><span class="p">[</span><span class="s2">&quot;k1&quot;</span><span class="p">])</span>
            <span class="n">c_raw</span> <span class="o">=</span> <span class="n">c_crit</span> <span class="o">*</span> <span class="n">beta</span>

            <span class="n">tmax</span> <span class="o">=</span> <span class="n">pdict</span><span class="p">[</span><span class="s2">&quot;L&quot;</span><span class="p">]</span> <span class="o">/</span> <span class="n">v_raw</span>


            <span class="n">pdict</span><span class="p">[</span><span class="s2">&quot;moving_loads_x_norm&quot;</span><span class="p">]</span><span class="o">=</span><span class="p">[[</span><span class="mi">0</span><span class="o">-</span><span class="n">vv</span><span class="o">*</span><span class="n">load_spacing</span> <span class="k">for</span> <span class="n">vv</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nloads</span><span class="p">)]]</span>
            <span class="n">pdict</span><span class="p">[</span><span class="s2">&quot;moving_loads_Fz_norm&quot;</span><span class="p">]</span><span class="o">=</span><span class="p">[[</span><span class="mf">1.013e-4</span><span class="p">]</span><span class="o">*</span><span class="n">nloads</span><span class="p">]</span>
            <span class="n">pdict</span><span class="p">[</span><span class="s2">&quot;xvals_norm&quot;</span><span class="p">]</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">xeval</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">xeval</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">nx</span><span class="p">)</span>


            <span class="n">pdict</span><span class="p">[</span><span class="s2">&quot;mu&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">c_raw</span>
            <span class="n">pdict</span><span class="p">[</span><span class="s2">&quot;tvals&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">tmax</span><span class="o">*</span><span class="n">xeval</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">tmax</span><span class="o">*</span><span class="n">xeval</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">t_extend</span><span class="p">,</span><span class="n">nt</span><span class="p">)</span>

            <span class="n">pdict</span><span class="p">[</span><span class="s1">&#39;k1bar&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">k1bar</span>
            <span class="n">pdict</span><span class="p">[</span><span class="s1">&#39;mubar&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">mubar</span>
            <span class="k">for</span> <span class="n">m</span><span class="p">,</span> <span class="n">reverse</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">reverses</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">reverse</span><span class="p">:</span>
                    <span class="n">pdict</span><span class="p">[</span><span class="s2">&quot;moving_loads_v_norm&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="o">*</span><span class="n">v_raw</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">pdict</span><span class="p">[</span><span class="s2">&quot;rho&quot;</span><span class="p">]</span><span class="o">/</span><span class="n">pdict</span><span class="p">[</span><span class="s2">&quot;E&quot;</span><span class="p">])]</span>
                    <span class="n">pdict</span><span class="p">[</span><span class="s2">&quot;file_stem&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">prefix</span> <span class="o">+</span> <span class="s2">&quot;tans2_alp</span><span class="si">{:5.3f}</span><span class="s2">_bet</span><span class="si">{:5.3f}</span><span class="s2">_n</span><span class="si">{:d}</span><span class="s2">_LtLc</span><span class="si">{:5.3f}</span><span class="s2">_rev&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">alp</span><span class="p">,</span><span class="n">beta</span><span class="p">,</span><span class="n">nterms</span><span class="p">,</span><span class="n">Lt_Lc</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">pdict</span><span class="p">[</span><span class="s2">&quot;moving_loads_v_norm&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="o">*</span><span class="n">v_raw</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">pdict</span><span class="p">[</span><span class="s2">&quot;rho&quot;</span><span class="p">]</span><span class="o">/</span><span class="n">pdict</span><span class="p">[</span><span class="s2">&quot;E&quot;</span><span class="p">])]</span>
                    <span class="n">pdict</span><span class="p">[</span><span class="s2">&quot;file_stem&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">prefix</span> <span class="o">+</span> <span class="s2">&quot;tans2_alp</span><span class="si">{:5.3f}</span><span class="s2">_bet</span><span class="si">{:5.3f}</span><span class="s2">_n</span><span class="si">{:d}</span><span class="s2">_LtLc</span><span class="si">{:5.3f}</span><span class="s2">_for&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">alp</span><span class="p">,</span><span class="n">beta</span><span class="p">,</span><span class="n">nterms</span><span class="p">,</span><span class="n">Lt_Lc</span><span class="p">)</span>


                <span class="nb">print</span><span class="p">(</span><span class="n">pdict</span><span class="p">[</span><span class="s2">&quot;file_stem&quot;</span><span class="p">])</span>
                <span class="n">a</span> <span class="o">=</span> <span class="n">SpecBeam</span><span class="p">(</span><span class="o">**</span><span class="n">pdict</span><span class="p">)</span>
                <span class="n">a</span><span class="o">.</span><span class="n">runme</span><span class="p">()</span>
                <span class="k">if</span> <span class="n">animateme</span><span class="p">:</span>
                    <span class="n">a</span><span class="o">.</span><span class="n">animateme</span><span class="p">()</span>
                <span class="n">a</span><span class="o">.</span><span class="n">saveme</span><span class="p">()</span>

                <span class="n">max_envelope</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">defl</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>




    <span class="c1">#            xplot = (pdict[&#39;xvals_norm&#39;]-trans_start)/trans_len</span>
                <span class="n">xplot</span> <span class="o">=</span> <span class="p">(</span><span class="n">pdict</span><span class="p">[</span><span class="s1">&#39;xvals_norm&#39;</span><span class="p">]</span><span class="o">-</span><span class="n">trans_middle</span><span class="p">)</span><span class="o">*</span><span class="n">pdict</span><span class="p">[</span><span class="s1">&#39;L&#39;</span><span class="p">]</span><span class="o">*</span><span class="n">lam</span>

        <span class="c1">#        print(pdict[&#39;xvals_norm&#39;])</span>
        <span class="c1">#        lam = (pdict[&#39;k1&#39;]/(4*pdict[&#39;E&#39;]*pdict[&#39;I&#39;]))**0.25</span>



                <span class="n">Q</span> <span class="o">=</span> <span class="n">pdict</span><span class="p">[</span><span class="s2">&quot;moving_loads_Fz_norm&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">pdict</span><span class="p">[</span><span class="s1">&#39;E&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">pdict</span><span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">]</span>

                <span class="n">wstatic</span> <span class="o">=</span> <span class="n">Q</span> <span class="o">*</span> <span class="n">lam</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">pdict</span><span class="p">[</span><span class="s1">&#39;k1&#39;</span><span class="p">])</span>
        <span class="c1">#        print(lam, Q, wstatic)</span>
        <span class="c1">#        print(max_envelope)</span>

                <span class="n">yplot</span> <span class="o">=</span> <span class="n">max_envelope</span> <span class="o">/</span> <span class="n">wstatic</span>


                <span class="n">max_ratio</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">defl</span><span class="p">)</span><span class="o">/</span> <span class="n">wstatic</span> <span class="o">/</span> <span class="n">DAF1</span>
                <span class="n">max_ratios</span><span class="p">[</span><span class="n">m</span><span class="p">][</span><span class="n">i</span><span class="p">,</span> <span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">max_ratio</span>

        <span class="c1">#        print(xplot.shape, yplot.shape)</span>
        <span class="c1">#        print(xplot)</span>
                <span class="k">if</span> <span class="n">reverse</span><span class="p">:</span>
                    <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;$L_t/L_c=</span><span class="si">{}</span><span class="s2">,\ </span><span class="se">\\</span><span class="s2">leftarrow$&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">Lt_Lc</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">k</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span>
                        <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;$spec\ </span><span class="se">\\</span><span class="s2">leftarrow$&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">Lt_Lc</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">label</span><span class="o">=</span><span class="kc">None</span>
                    <span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xplot</span><span class="p">,</span> <span class="n">yplot</span><span class="p">,</span> <span class="n">dashes</span><span class="o">=</span><span class="p">[</span><span class="mi">4</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span>
                         <span class="n">color</span><span class="o">=</span><span class="n">line</span><span class="o">.</span><span class="n">get_color</span><span class="p">(),</span>
                        <span class="n">label</span> <span class="o">=</span> <span class="n">label</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;$L_t/L_c=</span><span class="si">{}</span><span class="s2">,\ </span><span class="se">\\</span><span class="s2">rightarrow$&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">Lt_Lc</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">k</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span>
                        <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;$spec\ </span><span class="se">\\</span><span class="s2">rightarrow$&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">Lt_Lc</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">label</span><span class="o">=</span><span class="kc">None</span>
                    <span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xplot</span><span class="p">,</span> <span class="n">yplot</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span>
                         <span class="n">color</span><span class="o">=</span><span class="n">line</span><span class="o">.</span><span class="n">get_color</span><span class="p">(),</span>
                         <span class="n">label</span> <span class="o">=</span> <span class="n">label</span><span class="p">)</span>



                <span class="c1">#point vs time plot</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">xi_Lc</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">max_position</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">unravel_index</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">defl</span><span class="o">.</span><span class="n">argmax</span><span class="p">(),</span> <span class="n">a</span><span class="o">.</span><span class="n">defl</span><span class="o">.</span><span class="n">shape</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
                    <span class="n">xevalu</span><span class="o">=</span><span class="n">a</span><span class="o">.</span><span class="n">xvals_norm</span><span class="p">[</span><span class="n">max_position</span><span class="p">]</span>
<span class="c1">#                    xevalu = trans_middle + xi_Lc / lam/pdict[&quot;L&quot;]</span>
                    <span class="n">xi_Lc_</span> <span class="o">=</span> <span class="p">(</span><span class="n">xevalu</span><span class="o">-</span><span class="n">trans_middle</span><span class="p">)</span><span class="o">*</span><span class="n">lam</span><span class="o">*</span><span class="n">pdict</span><span class="p">[</span><span class="s2">&quot;L&quot;</span><span class="p">]</span>
                    <span class="n">ieval</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">searchsorted</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">xvals_norm</span><span class="p">,</span><span class="n">xevalu</span><span class="p">)</span>
                    <span class="n">xplot</span><span class="o">=</span><span class="n">a</span><span class="o">.</span><span class="n">tvals_norm</span>
                    <span class="n">yplot</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">defl</span><span class="p">[</span><span class="n">ieval</span><span class="o">-</span><span class="mi">1</span><span class="p">,:]</span> <span class="o">+</span> <span class="p">(</span><span class="n">xevalu</span><span class="o">-</span><span class="n">a</span><span class="o">.</span><span class="n">xvals_norm</span><span class="p">[</span><span class="n">ieval</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span><span class="o">/</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">xvals_norm</span><span class="p">[</span><span class="n">ieval</span><span class="p">]</span><span class="o">-</span><span class="n">a</span><span class="o">.</span><span class="n">xvals_norm</span><span class="p">[</span><span class="n">ieval</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> <span class="o">*</span> <span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">defl</span><span class="p">[</span><span class="n">ieval</span><span class="p">,:]</span><span class="o">-</span><span class="n">a</span><span class="o">.</span><span class="n">defl</span><span class="p">[</span><span class="n">ieval</span><span class="o">-</span><span class="mi">1</span><span class="p">,:])</span>
<span class="c1">#                    yplot = a.defl[ieval,:] + (xevalu-a.xvals_norm[ieval])/(a.xvals_norm[ieval+1]-a.xvals_norm[ieval]) * (a.defl[ieval+1,:]-a.defl[ieval,:])</span>
                    <span class="n">yplot</span> <span class="o">/=</span> <span class="n">wstatic</span>
                    <span class="n">ax4</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xplot</span><span class="p">,</span> <span class="n">yplot</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">line</span><span class="o">.</span><span class="n">get_color</span><span class="p">(),</span>
                            <span class="n">label</span><span class="o">=</span><span class="s2">&quot;$L_t/L_c=</span><span class="si">{}</span><span class="s2">$&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">Lt_Lc</span><span class="p">)</span> <span class="p">)</span>
                    <span class="k">for</span> <span class="n">imvpl</span><span class="p">,</span> <span class="n">mvpl</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">moving_loads_norm</span><span class="p">):</span>
                        <span class="n">t_pass</span> <span class="o">=</span> <span class="n">mvpl</span><span class="o">.</span><span class="n">time_axles_pass_beam_point</span><span class="p">(</span><span class="n">xevalu</span><span class="p">)</span>
                        <span class="n">ax4</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t_pass</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">interp</span><span class="p">(</span><span class="n">t_pass</span><span class="p">,</span><span class="n">xplot</span><span class="p">,</span><span class="n">yplot</span><span class="p">),</span>
                                     <span class="n">color</span><span class="o">=</span><span class="n">line</span><span class="o">.</span><span class="n">get_color</span><span class="p">(),</span>
                                     <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;o&quot;</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;:&#39;</span><span class="p">,</span>
                                     <span class="n">label</span><span class="o">=</span><span class="s2">&quot;$x/L_c=</span><span class="si">{:.1f}</span><span class="s2">$&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">xi_Lc_</span><span class="p">))</span>



                <span class="c1">#under loads</span>
                <span class="n">a</span><span class="o">.</span><span class="n">defl_vs_time_under_loads</span><span class="p">(</span><span class="n">xlim_norm</span><span class="o">=</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">xvals_norm</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">a</span><span class="o">.</span><span class="n">xvals_norm</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]))</span>
                <span class="n">dash_list</span><span class="o">=</span><span class="p">[(</span><span class="kc">None</span><span class="p">,</span><span class="kc">None</span><span class="p">),[</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">],[</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],[</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">]]</span>
                <span class="k">for</span> <span class="n">imvpl</span><span class="p">,</span> <span class="n">mvpl</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">moving_loads_norm</span><span class="p">):</span>
                    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">mvpl</span><span class="o">.</span><span class="n">x</span><span class="p">)):</span>
                        <span class="n">ax5</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">tvals</span><span class="p">,</span> <span class="n">a</span><span class="o">.</span><span class="n">moving_load_w</span><span class="p">[</span><span class="n">imvpl</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">/</span> <span class="n">wstatic</span><span class="p">,</span>
                             <span class="n">color</span><span class="o">=</span><span class="n">line</span><span class="o">.</span><span class="n">get_color</span><span class="p">(),</span>
                             <span class="n">label</span><span class="o">=</span><span class="s2">&quot;$L_t/L_c=</span><span class="si">{}</span><span class="s2">,\ load </span><span class="si">{}</span><span class="s2">$&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">Lt_Lc</span><span class="p">,</span> <span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span>
                             <span class="n">dashes</span><span class="o">=</span><span class="n">dash_list</span><span class="p">[</span><span class="n">j</span><span class="p">])</span>





    <span class="n">leg</span> <span class="o">=</span> <span class="n">ax2</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span>
<span class="c1">#                    title=&quot;$\\beta$&quot;,</span>
                    <span class="n">loc</span><span class="o">=</span><span class="s2">&quot;upper right&quot;</span><span class="p">,</span>
<span class="c1">#                    ncol=2,</span>
                    <span class="n">labelspacing</span><span class="o">=.</span><span class="mi">2</span><span class="p">,</span>
                    <span class="n">handlelength</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
                    <span class="n">fontsize</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span>
                    <span class="n">numpoints</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                        <span class="p">)</span>
    <span class="n">leg</span><span class="o">.</span><span class="n">draggable</span><span class="p">()</span>

    <span class="n">ax2</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">labelpad</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">labelpad</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">ax3</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">labelpad</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
    <span class="n">ax3</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">labelpad</span> <span class="o">=</span> <span class="mi">0</span>


    <span class="n">fig</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">top</span><span class="o">=</span><span class="mf">0.95</span><span class="p">,</span> <span class="n">bottom</span><span class="o">=</span><span class="mf">0.13</span><span class="p">,</span> <span class="n">left</span><span class="o">=</span><span class="mf">0.14</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="mf">0.95</span><span class="p">)</span>


    <span class="k">if</span> <span class="ow">not</span> <span class="n">xi_Lc</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">ax4</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;$norm _time$&#39;</span><span class="p">)</span>
        <span class="n">ax4</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;$w/w_</span><span class="si">{static1}</span><span class="s1">$&#39;</span><span class="p">)</span>
        <span class="n">leg</span> <span class="o">=</span> <span class="n">ax4</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span>
<span class="c1">#                    title=&quot;&quot;,</span>
                    <span class="n">labelspacing</span><span class="o">=.</span><span class="mi">2</span><span class="p">,</span>
                    <span class="n">handlelength</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
                    <span class="n">fontsize</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span>
                    <span class="n">numpoints</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">leg</span><span class="o">.</span><span class="n">draggable</span><span class="p">()</span>

    <span class="n">ax5</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;$time$&#39;</span><span class="p">)</span>
    <span class="n">ax5</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;$w/w_</span><span class="si">{static1}</span><span class="s1">$&#39;</span><span class="p">)</span>
    <span class="n">leg</span> <span class="o">=</span> <span class="n">ax5</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span>
<span class="c1">#                    title=&quot;&quot;,</span>
                <span class="n">labelspacing</span><span class="o">=.</span><span class="mi">2</span><span class="p">,</span>
                <span class="n">handlelength</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
                <span class="n">fontsize</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span>
                <span class="n">numpoints</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

    <span class="n">leg</span><span class="o">.</span><span class="n">draggable</span><span class="p">()</span>


    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">alp</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">alphas</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">m</span><span class="p">,</span> <span class="n">reverse</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">reverses</span><span class="p">):</span>
            <span class="n">xplot</span> <span class="o">=</span> <span class="n">Lt_Lcs</span>
            <span class="n">yplot</span> <span class="o">=</span> <span class="n">max_ratios</span><span class="p">[</span><span class="n">m</span><span class="p">][</span><span class="n">i</span><span class="p">,:]</span>
            <span class="k">if</span> <span class="n">reverse</span><span class="p">:</span>
                <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;$</span><span class="se">\\</span><span class="s2">alpha_1=</span><span class="si">{}</span><span class="s2">,\ </span><span class="se">\\</span><span class="s2">leftarrow$&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">alp</span><span class="p">)</span>
<span class="c1">#                if k==0:</span>
<span class="c1">#                    label = &quot;$spec\ \\leftarrow$&quot;.format(Lt_Lc)</span>
<span class="c1">#                else:</span>
<span class="c1">#                    label=None</span>
<span class="c1">#                ax2.plot(xplot, yplot, dashes=[4,2,1,2],</span>
<span class="c1">#                     color=line.get_color(),</span>
<span class="c1">#                    label = label)</span>
                <span class="k">if</span> <span class="n">article_formatting</span><span class="p">:</span>
                    <span class="n">ax6</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xplot</span><span class="p">,</span> <span class="n">yplot</span><span class="p">,</span>
                             <span class="n">label</span><span class="o">=</span><span class="n">label</span><span class="p">,</span>
                             <span class="n">markevery</span><span class="o">=</span><span class="p">(</span><span class="n">i</span><span class="o">/</span><span class="mi">6</span><span class="o">*</span><span class="mf">0.1</span><span class="p">,</span><span class="mf">0.1</span><span class="p">),</span>
                             <span class="o">**</span><span class="n">styles1</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">ax6</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xplot</span><span class="p">,</span> <span class="n">yplot</span><span class="p">,</span>
                             <span class="n">label</span><span class="o">=</span><span class="n">label</span><span class="p">,</span>
                             <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="n">line</span><span class="o">.</span><span class="n">get_color</span><span class="p">())</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;$</span><span class="se">\\</span><span class="s2">alpha_1=</span><span class="si">{}</span><span class="s2">,\ </span><span class="se">\\</span><span class="s2">rightarrow$&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">alp</span><span class="p">)</span>
<span class="c1">#                if k==0:</span>
<span class="c1">#                    label = &quot;$spec\ \\rightarrow$&quot;.format(Lt_Lc)</span>
<span class="c1">#                else:</span>
<span class="c1">#                    label=None</span>
<span class="c1">#</span>
<span class="c1">#                ax2.plot(xplot, yplot, ls=&#39;--&#39;,</span>
<span class="c1">#                     color=line.get_color(),</span>
<span class="c1">#                     label = label)</span>
                <span class="k">if</span> <span class="n">article_formatting</span><span class="p">:</span>
                    <span class="n">line</span><span class="p">,</span><span class="o">=</span><span class="n">ax6</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xplot</span><span class="p">,</span> <span class="n">yplot</span><span class="p">,</span>
                             <span class="n">label</span><span class="o">=</span><span class="n">label</span><span class="p">,</span>
                             <span class="n">markevery</span><span class="o">=</span><span class="p">(</span><span class="n">i</span><span class="o">/</span><span class="mi">6</span><span class="o">*</span><span class="mf">0.1</span><span class="p">,</span><span class="mf">0.1</span><span class="p">),</span>
                             <span class="o">**</span><span class="n">styles2</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">line</span><span class="p">,</span><span class="o">=</span><span class="n">ax6</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xplot</span><span class="p">,</span> <span class="n">yplot</span><span class="p">,</span>
                             <span class="n">label</span><span class="o">=</span><span class="n">label</span><span class="p">,</span>
                             <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">)</span>


<span class="c1">#            ax6.plot(xplot,yplot,label=&quot;$\\alpha_1={}$&quot;.format(alp))</span>
    <span class="n">ax6</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;$L_t/L_c$&#39;</span><span class="p">)</span>
    <span class="n">ax6</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;DAF*&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">flip</span><span class="p">(</span><span class="n">items</span><span class="p">,</span> <span class="n">ncol</span><span class="p">):</span>
        <span class="kn">import</span> <span class="nn">itertools</span>
        <span class="k">return</span> <span class="n">itertools</span><span class="o">.</span><span class="n">chain</span><span class="p">(</span><span class="o">*</span><span class="p">[</span><span class="n">items</span><span class="p">[</span><span class="n">i</span><span class="p">::</span><span class="n">ncol</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ncol</span><span class="p">)])</span>
    <span class="n">handles</span><span class="p">,</span> <span class="n">labels</span> <span class="o">=</span> <span class="n">ax6</span><span class="o">.</span><span class="n">get_legend_handles_labels</span><span class="p">()</span>

    <span class="n">leg</span> <span class="o">=</span> <span class="n">ax6</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">flip</span><span class="p">(</span><span class="n">handles</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">flip</span><span class="p">(</span><span class="n">labels</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span>
                     <span class="n">ncol</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
                     <span class="n">labelspacing</span><span class="o">=.</span><span class="mi">1</span><span class="p">,</span>
                     <span class="n">handlelength</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
                     <span class="n">fontsize</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span>
                     <span class="n">handletextpad</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span>
                     <span class="n">borderpad</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span>
                     <span class="n">columnspacing</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>
    <span class="n">leg</span><span class="o">.</span><span class="n">draggable</span><span class="p">()</span>
<span class="c1">#        for k, Lt_Lcs in enumerate(Lt_Lcs):</span>
    <span class="n">fig6</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">top</span><span class="o">=</span><span class="mf">0.98</span><span class="p">,</span> <span class="n">bottom</span><span class="o">=</span><span class="mf">0.15</span><span class="p">,</span> <span class="n">left</span><span class="o">=</span><span class="mf">0.18</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="mf">0.98</span><span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">saveas</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">save_figure</span><span class="p">(</span><span class="n">fig</span><span class="o">=</span><span class="n">fig6</span><span class="p">,</span> <span class="n">fname</span><span class="o">=</span><span class="n">saveas</span><span class="p">)</span>


    <span class="k">return</span> <span class="n">fig</span></div>

<div class="viewcode-block" id="tanhtran"><a class="viewcode-back" href="../../../api/geotecha.beam_on_foundation.specbeam.html#geotecha.beam_on_foundation.specbeam.tanhtran">[docs]</a><span class="k">def</span> <span class="nf">tanhtran</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Transition between two functions using tanh</span>

<span class="sd">    t(x) Smoothly transitions between 0 and 1;</span>

<span class="sd">    Used with:</span>
<span class="sd">        [transition f(x) to g(x)](x) = g(x)*t(x) + (1-t(x))*f(x)</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    x : float</span>
<span class="sd">        x values to evaluate at</span>
<span class="sd">    a : float</span>
<span class="sd">        Position of tranistion.  Often a=0.</span>
<span class="sd">    b : float,</span>
<span class="sd">        b close to zero gives a sharp change.</span>


<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    tfunc: float</span>
<span class="sd">        0.5 + 0.5 * tanh((x-a)/b)</span>

<span class="sd">    See Also</span>
<span class="sd">    --------</span>
<span class="sd">    tanhtrani : inverse of tanhtran</span>
<span class="sd">    tanhtranib : get smoothing factor from speccific x,y</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="mf">0.5</span><span class="o">+</span><span class="mf">0.5</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">tanh</span><span class="p">((</span><span class="n">x</span><span class="o">-</span><span class="mf">0.5</span><span class="p">)</span><span class="o">/</span><span class="n">b</span><span class="p">)</span></div>


<div class="viewcode-block" id="tanhtrani"><a class="viewcode-back" href="../../../api/geotecha.beam_on_foundation.specbeam.html#geotecha.beam_on_foundation.specbeam.tanhtrani">[docs]</a><span class="k">def</span> <span class="nf">tanhtrani</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Inverse of Transition between two functions using tanh</span>

<span class="sd">    x value that matches y</span>


<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    y : float</span>
<span class="sd">        y value to evaluate at</span>
<span class="sd">    a : float</span>
<span class="sd">        Position of tranistion.  Often a=0.</span>
<span class="sd">    b : float,</span>
<span class="sd">        b close to zero gives a sharp change.</span>


<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    tfunc: float</span>
<span class="sd">        b * arctanh((y - 0.5) / 0.5) + a</span>

<span class="sd">    See Also</span>
<span class="sd">    --------</span>
<span class="sd">    tanhtran : inverse of tanhtrani</span>
<span class="sd">    tanhtranib : get smoothing factor from specific point.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">b</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">arctanh</span><span class="p">((</span><span class="n">y</span> <span class="o">-</span> <span class="mf">0.5</span><span class="p">)</span> <span class="o">/</span> <span class="mf">0.5</span><span class="p">)</span> <span class="o">+</span> <span class="n">a</span></div>


<div class="viewcode-block" id="tanhtranib"><a class="viewcode-back" href="../../../api/geotecha.beam_on_foundation.specbeam.html#geotecha.beam_on_foundation.specbeam.tanhtranib">[docs]</a><span class="k">def</span> <span class="nf">tanhtranib</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">a</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Smoothing factor of tansition curve to get known (x,y)</span>

<span class="sd">    b value such that t(x) goes through (x,y)</span>


<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    x,y : float</span>
<span class="sd">        x values to evaluate at</span>
<span class="sd">    a : float</span>
<span class="sd">        Position of tranistion.  Often a=0.</span>



<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    tfunc: float</span>
<span class="sd">        (x-a) / arctanh((y - 0.5) / 0.5)</span>

<span class="sd">    See Also</span>
<span class="sd">    --------</span>
<span class="sd">    tanhtran : transition function</span>
<span class="sd">    tanhtrani : inverse of tanhtran</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="n">a</span><span class="p">)</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">arctanh</span><span class="p">((</span><span class="n">y</span> <span class="o">-</span> <span class="mf">0.5</span><span class="p">)</span> <span class="o">/</span> <span class="mf">0.5</span><span class="p">)</span></div>



<div class="viewcode-block" id="FIG_DAF_envelope_vary_beta"><a class="viewcode-back" href="../../../api/geotecha.beam_on_foundation.specbeam.html#geotecha.beam_on_foundation.specbeam.FIG_DAF_envelope_vary_beta">[docs]</a><span class="k">def</span> <span class="nf">FIG_DAF_envelope_vary_beta</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">betas</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">alphas</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                               <span class="n">saveas</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                               <span class="n">nx</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span><span class="n">nt</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span><span class="n">nterms</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">force_calc</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                               <span class="n">t_extend</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                               <span class="n">ylim</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                               <span class="n">numerical_DAF</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                               <span class="n">article_formatting</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;DAF envelope for whole beam with different alpha &amp; beta</span>

<span class="sd">    A plot will be produced of DAF vs normalised distance along beam, where</span>
<span class="sd">    the dynamic deflection in the DAF calculation is the maximum experienced</span>
<span class="sd">    each x/L point.</span>


<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    ax : matplotlib.Axes object, optional</span>
<span class="sd">        Axes object to plot on.  Default ax=None i.e. fig and axis will be</span>
<span class="sd">        created.</span>
<span class="sd">    betas : list of float, optional</span>
<span class="sd">        list of damping ratios, Default betas=None which will use</span>
<span class="sd">        [0, 0.05, 0.1].</span>
<span class="sd">    alphas : list of float, optional</span>
<span class="sd">        list of velocity ratios, Default alphas=None which will use</span>
<span class="sd">        [0.7].</span>
<span class="sd">    saveas : string, optional</span>
<span class="sd">        Filename stem (not including extension) to save figure to.</span>
<span class="sd">        Default saveas=None, i.e. figure won&#39;t be saved to disk.</span>
<span class="sd">    nx : int, optional</span>
<span class="sd">        Number of points between `xlim[0]` and `xlim[1]` at which to</span>
<span class="sd">        calculate deflection.  Default nx = 200.</span>
<span class="sd">    nt : int, optional</span>
<span class="sd">        Number of evaluation times from when load enters `xlim[0]` and</span>
<span class="sd">        leaves `xlim[1]`.  Default nt=200</span>
<span class="sd">    nterms : int, optional</span>
<span class="sd">        Number of series terms in approximation.  More terms  leads to higher</span>
<span class="sd">        accuracy but also longer computation times.  Start of with a</span>
<span class="sd">        small enough value to observe behaviour and then increase</span>
<span class="sd">        to confirm. Default nterms=100 .</span>
<span class="sd">    force_calc : [True, False], optional</span>
<span class="sd">        When True all calcuations will be done from scratch. When False</span>
<span class="sd">        Current working directory will be searched for a results file</span>
<span class="sd">        named according to &quot;saveas&quot; and</span>
<span class="sd">        if found it will be loaded.  Be careful as name of results file may</span>
<span class="sd">        not be unique to your analysis parameters.  Safest to use</span>
<span class="sd">        force_calc = True, but if you are simply regenerating graphs then</span>
<span class="sd">        consider force_calc=False.  Default force_calc=True.</span>
<span class="sd">    t_extend : float, optional</span>
<span class="sd">        factor to extend maximum evalutated time.  As per `nt&#39; evaluation times</span>
<span class="sd">        are normally between first point entering `xlim[0]&#39; and leaving</span>
<span class="sd">        `xlim[1]`.  However, with mulitple loads, loads can still be on the</span>
<span class="sd">        beam at that point. max eval time can be extended fby a factor.</span>
<span class="sd">        t_extend = 1 .</span>
<span class="sd">    ylim : float, optional</span>
<span class="sd">        Y axis limit. default ylim=None i.e. auto axis scale</span>
<span class="sd">    numerical_DAF : [False, True], optional</span>
<span class="sd">        If True then the static deflection for use in Dynamic amplification</span>
<span class="sd">        factor calcuations (DAF = w/wstatic) willbe determined from a</span>
<span class="sd">        very slow moving load travelling over the beam/foundation.</span>
<span class="sd">        If False then the analytical expression for wstatic will be used.</span>
<span class="sd">        Default numerical_DAF=False.</span>
<span class="sd">    article_formatting : [False, True], optional</span>
<span class="sd">        You should never need this.  It was a quick hack to do some</span>
<span class="sd">        custom formatting for a journal article.  Dont even try messing with</span>
<span class="sd">        it.  will ony work with 3 Lt_Lcs values values or less.  Default=False,</span>
<span class="sd">        i.e. no special formatting.</span>


<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="n">article_formatting</span><span class="p">:</span>
            <span class="n">mdc</span> <span class="o">=</span> <span class="n">MarkersDashesColors</span><span class="p">(</span><span class="n">markersize</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span><span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>


            <span class="n">styles</span><span class="o">=</span><span class="n">mdc</span><span class="p">(</span><span class="n">markers</span><span class="o">=</span><span class="p">[</span><span class="mi">5</span><span class="p">,</span><span class="mi">15</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span>
                   <span class="n">dashes</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                   <span class="n">marker_colors</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span>
                   <span class="n">line_colors</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>

            <span class="n">mevery</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.4</span><span class="p">,</span><span class="mf">0.15</span><span class="p">,</span><span class="mf">0.1</span><span class="p">]</span>

    <span class="c1">#used for figure 3 in publication</span>
    <span class="n">mytimer</span><span class="o">=</span><span class="n">SimpleTimer</span><span class="p">()</span>
    <span class="n">mytimer</span><span class="o">.</span><span class="n">start</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="s2">&quot;FIG_DAF_envelope_vary_beta&quot;</span><span class="p">)</span>


    <span class="k">if</span> <span class="n">ax</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">fig</span><span class="p">,</span><span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mf">3.54</span><span class="p">,</span><span class="mf">3.54</span><span class="p">))</span>

    <span class="n">matplotlib</span><span class="o">.</span><span class="n">rcParams</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s1">&#39;font.size&#39;</span><span class="p">:</span> <span class="mi">11</span><span class="p">})</span>



    <span class="n">pdict</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">(</span>
                <span class="n">E</span> <span class="o">=</span> <span class="mf">6.998</span><span class="o">*</span><span class="mf">1e9</span><span class="p">,</span> <span class="c1">#Pa</span>
                <span class="n">rho</span> <span class="o">=</span> <span class="mi">2373</span><span class="p">,</span> <span class="c1">#kg/m3</span>
                <span class="n">L</span> <span class="o">=</span> <span class="mi">160</span><span class="p">,</span> <span class="c1">#m</span>
                <span class="n">A</span> <span class="o">=</span> <span class="mf">0.3</span><span class="o">*</span><span class="mf">0.1</span><span class="p">,</span> <span class="c1"># m^2</span>
                <span class="n">I</span> <span class="o">=</span> <span class="mf">0.00022477900799999998</span><span class="p">,</span>
                <span class="n">k1</span> <span class="o">=</span> <span class="mf">800002.6125</span><span class="p">,</span>
                <span class="n">nterms</span><span class="o">=</span><span class="n">nterms</span><span class="p">,</span>
                <span class="n">BC</span><span class="o">=</span><span class="s2">&quot;SS&quot;</span><span class="p">,</span>
<span class="c1">#                moving_loads_x_norm=[[0-vv*load_spacing for vv in range(nloads)]],</span>
<span class="c1">#                moving_loads_Fz_norm=[[1.013e-4]*nloads],</span>
<span class="c1">#                xvals_norm=np.linspace(xeval[0], xeval[1], nx),</span>
                <span class="n">moving_loads_x_norm</span><span class="o">=</span><span class="p">[[</span><span class="mi">0</span><span class="p">]],</span>
                <span class="n">moving_loads_Fz_norm</span><span class="o">=</span><span class="p">[[</span><span class="mf">1.013e-4</span><span class="p">]],</span>
                <span class="n">xvals_norm</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">nx</span><span class="p">),</span>
                <span class="n">use_analytical</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                <span class="n">implementation</span><span class="o">=</span><span class="s2">&quot;fortran&quot;</span><span class="p">,</span>
                <span class="n">force_calc</span><span class="o">=</span><span class="n">force_calc</span><span class="p">,</span>
                <span class="p">)</span>




    <span class="k">if</span> <span class="n">alphas</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">alphas</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.7</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">betas</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">betas</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">]</span>



    <span class="k">if</span> <span class="n">numerical_DAF</span><span class="p">:</span>
        <span class="n">alphas</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mf">0.00001</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">alp</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">alphas</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">j</span><span class="p">,</span><span class="n">bet</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">betas</span><span class="p">):</span>

            <span class="n">mytimer</span><span class="o">.</span><span class="n">start</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;alpha=</span><span class="si">{}</span><span class="s2">, beta=</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">alp</span><span class="p">,</span> <span class="n">bet</span><span class="p">))</span>
<span class="c1">#            start_time1 = time.time()</span>
<span class="c1">#            print(&quot;doing alpha={}, beta={}&quot;.format(alp, bet))</span>
            <span class="n">v_crit</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="o">/</span><span class="n">pdict</span><span class="p">[</span><span class="s2">&quot;rho&quot;</span><span class="p">]</span><span class="o">/</span><span class="n">pdict</span><span class="p">[</span><span class="s2">&quot;A&quot;</span><span class="p">]</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">pdict</span><span class="p">[</span><span class="s2">&quot;k1&quot;</span><span class="p">]</span><span class="o">*</span><span class="n">pdict</span><span class="p">[</span><span class="s2">&quot;E&quot;</span><span class="p">]</span><span class="o">*</span><span class="n">pdict</span><span class="p">[</span><span class="s2">&quot;I&quot;</span><span class="p">]))</span>
            <span class="n">v_raw</span> <span class="o">=</span> <span class="n">v_crit</span><span class="o">*</span><span class="n">alp</span>

            <span class="n">c_crit</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">4</span><span class="o">*</span><span class="n">pdict</span><span class="p">[</span><span class="s2">&quot;rho&quot;</span><span class="p">]</span><span class="o">*</span><span class="n">pdict</span><span class="p">[</span><span class="s2">&quot;A&quot;</span><span class="p">]</span><span class="o">*</span><span class="n">pdict</span><span class="p">[</span><span class="s2">&quot;k1&quot;</span><span class="p">])</span>
            <span class="n">c_raw</span> <span class="o">=</span> <span class="n">c_crit</span> <span class="o">*</span> <span class="n">bet</span>

            <span class="n">tmax</span> <span class="o">=</span> <span class="n">pdict</span><span class="p">[</span><span class="s2">&quot;L&quot;</span><span class="p">]</span> <span class="o">/</span> <span class="n">v_raw</span>



            <span class="n">pdict</span><span class="p">[</span><span class="s2">&quot;file_stem&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;envelope_alp</span><span class="si">{:5.3f}</span><span class="s2">_bet</span><span class="si">{:5.3f}</span><span class="s2">_nx</span><span class="si">{:d}</span><span class="s2">_nt</span><span class="si">{:d}</span><span class="s2">_n</span><span class="si">{:d}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">alp</span><span class="p">,</span><span class="n">bet</span><span class="p">,</span><span class="n">nx</span><span class="p">,</span><span class="n">nt</span><span class="p">,</span><span class="n">nterms</span><span class="p">)</span>

            <span class="n">pdict</span><span class="p">[</span><span class="s2">&quot;mu&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">c_raw</span>
            <span class="n">pdict</span><span class="p">[</span><span class="s2">&quot;tvals&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">tmax</span><span class="o">*</span><span class="mi">0</span><span class="p">,</span><span class="n">tmax</span><span class="o">*</span><span class="n">t_extend</span><span class="p">,</span> <span class="n">nt</span><span class="p">)</span>

            <span class="n">pdict</span><span class="p">[</span><span class="s2">&quot;moving_loads_v_norm&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="o">*</span><span class="n">v_raw</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">pdict</span><span class="p">[</span><span class="s2">&quot;rho&quot;</span><span class="p">]</span><span class="o">/</span><span class="n">pdict</span><span class="p">[</span><span class="s2">&quot;E&quot;</span><span class="p">])]</span>


            <span class="n">a</span> <span class="o">=</span> <span class="n">SpecBeam</span><span class="p">(</span><span class="o">**</span><span class="n">pdict</span><span class="p">)</span>
            <span class="n">a</span><span class="o">.</span><span class="n">runme</span><span class="p">()</span>
<span class="c1">#            a.animateme()</span>
            <span class="n">a</span><span class="o">.</span><span class="n">saveme</span><span class="p">()</span>


            <span class="n">max_envelope</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">defl</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>


            <span class="n">lam</span> <span class="o">=</span> <span class="p">(</span><span class="n">pdict</span><span class="p">[</span><span class="s1">&#39;k1&#39;</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="mi">4</span><span class="o">*</span><span class="n">pdict</span><span class="p">[</span><span class="s1">&#39;E&#39;</span><span class="p">]</span><span class="o">*</span><span class="n">pdict</span><span class="p">[</span><span class="s1">&#39;I&#39;</span><span class="p">]))</span><span class="o">**</span><span class="mf">0.25</span>
            <span class="n">Q</span> <span class="o">=</span> <span class="n">pdict</span><span class="p">[</span><span class="s2">&quot;moving_loads_Fz_norm&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">pdict</span><span class="p">[</span><span class="s1">&#39;E&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">pdict</span><span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">]</span>

            <span class="k">if</span> <span class="n">numerical_DAF</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">i</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span>
                    <span class="n">wstatic</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">max_envelope</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">nx</span><span class="o">*</span><span class="mf">0.4</span><span class="p">):</span><span class="nb">int</span><span class="p">(</span><span class="n">nx</span><span class="o">*</span><span class="mf">0.6</span><span class="p">)])</span>
                    <span class="k">continue</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">wstatic</span> <span class="o">=</span> <span class="n">Q</span> <span class="o">*</span> <span class="n">lam</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">pdict</span><span class="p">[</span><span class="s1">&#39;k1&#39;</span><span class="p">])</span>


            <span class="n">xplot</span> <span class="o">=</span> <span class="n">pdict</span><span class="p">[</span><span class="s1">&#39;xvals_norm&#39;</span><span class="p">]</span>
            <span class="n">yplot</span> <span class="o">=</span> <span class="n">max_envelope</span> <span class="o">/</span> <span class="n">wstatic</span>

<span class="c1">#            label = &quot;$\\alpha={:3.2g},\\ \\beta={:3.2g}$&quot;.format(alp,bet)</span>
            <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;$</span><span class="si">{:3.2g}</span><span class="s2">$&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">bet</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">article_formatting</span><span class="p">:</span>
                <span class="n">line</span><span class="p">,</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xplot</span><span class="p">,</span> <span class="n">yplot</span><span class="p">,</span>
                                <span class="n">label</span><span class="o">=</span><span class="n">label</span><span class="p">,</span>
                                <span class="n">markevery</span><span class="o">=</span><span class="p">(</span><span class="n">j</span><span class="o">/</span><span class="mi">3</span><span class="o">*</span><span class="mf">0.9</span><span class="p">,</span><span class="n">mevery</span><span class="p">[</span><span class="n">j</span><span class="p">]),</span>
                                <span class="o">**</span><span class="n">styles</span><span class="p">[</span><span class="n">j</span><span class="p">])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">line</span><span class="p">,</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xplot</span><span class="p">,</span> <span class="n">yplot</span><span class="p">,</span>
                                <span class="n">label</span><span class="o">=</span><span class="n">label</span><span class="p">,</span>
                                <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,)</span>
<span class="c1">#                 color=line.get_color())</span>
            <span class="n">DAF</span> <span class="o">=</span> <span class="n">DAFinfinite</span><span class="p">(</span><span class="n">alp</span><span class="p">,</span> <span class="n">bet</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">j</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span>
                <span class="n">label</span><span class="o">=</span><span class="s2">&quot;analytical&quot;</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">label</span><span class="o">=</span><span class="kc">None</span>

            <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="mf">0.6</span><span class="p">,</span> <span class="n">DAF</span><span class="p">,</span>
                    <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">ms</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span>
                    <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;None&#39;</span><span class="p">,</span>
                    <span class="n">color</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">get_color</span><span class="p">(),</span>
                    <span class="n">label</span><span class="o">=</span><span class="n">label</span><span class="p">)</span>
            <span class="n">mytimer</span><span class="o">.</span><span class="n">finish</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

    <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;$x/L$&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;$DAF$&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">ylim</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">*</span><span class="n">ylim</span><span class="p">)</span>
    <span class="n">leg</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    <span class="n">leg</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span>
                    <span class="n">title</span><span class="o">=</span><span class="s2">&quot;$</span><span class="se">\\</span><span class="s2">beta$&quot;</span><span class="p">,</span>
                    <span class="n">loc</span><span class="o">=</span><span class="s2">&quot;upper center&quot;</span><span class="p">,</span>
<span class="c1">#                    ncol=2,</span>
                    <span class="n">labelspacing</span><span class="o">=.</span><span class="mi">2</span><span class="p">,</span>
                    <span class="n">handlelength</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
                    <span class="n">fontsize</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span>
                    <span class="n">numpoints</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                        <span class="p">)</span>
    <span class="n">leg</span><span class="o">.</span><span class="n">draggable</span><span class="p">()</span>

    <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">labelpad</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">labelpad</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="n">mytimer</span><span class="o">.</span><span class="n">finish</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="c1">#    end_time0 = time.time()</span>
<span class="c1">#    elapsed_time = (end_time0 - start_time0); print(&quot;Total run time={}&quot;.format(str(timedelta(seconds=elapsed_time))))</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">top</span><span class="o">=</span><span class="mf">0.95</span><span class="p">,</span> <span class="n">bottom</span><span class="o">=</span><span class="mf">0.13</span><span class="p">,</span> <span class="n">left</span><span class="o">=</span><span class="mf">0.14</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="mf">0.95</span><span class="p">)</span>


    <span class="k">if</span> <span class="ow">not</span> <span class="n">saveas</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">save_figure</span><span class="p">(</span><span class="n">fig</span><span class="o">=</span><span class="n">fig</span><span class="p">,</span> <span class="n">fname</span><span class="o">=</span><span class="n">saveas</span><span class="p">)</span>
<span class="c1">#        save_figure(fig=fig2, fname=saveas + &quot;_up&quot;)</span>
    <span class="k">return</span> <span class="n">ax</span></div>


<div class="viewcode-block" id="static_point_load_shape"><a class="viewcode-back" href="../../../api/geotecha.beam_on_foundation.specbeam.html#geotecha.beam_on_foundation.specbeam.static_point_load_shape">[docs]</a><span class="k">def</span> <span class="nf">static_point_load_shape</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">L</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Deflection shape parameter for point load at x=0 on infinite beam on</span>
<span class="sd">    elastic foundation  with characteristic length L.</span>

<span class="sd">    Deflection is relative to the maximum value</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    x : float</span>
<span class="sd">        x coordinate(s)</span>
<span class="sd">    L : float</span>
<span class="sd">        Beam characteristic Length.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    out : float</span>
<span class="sd">        Relative deflection at x.</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    FYI the defelctions are relative to w_max which is :</span>
<span class="sd">        L = Characteristic length = k1 / ((4 * E * I)**0.25)</span>
<span class="sd">        Q = Point load</span>
<span class="sd">        w_max = static = Q * lam / (2 * k1)</span>


<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">/</span><span class="n">L</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">/</span><span class="n">L</span><span class="p">)</span><span class="o">+</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">/</span><span class="n">L</span><span class="p">))</span></div>


<div class="viewcode-block" id="specbeam_vs_analytical_single_static_load"><a class="viewcode-back" href="../../../api/geotecha.beam_on_foundation.specbeam.html#geotecha.beam_on_foundation.specbeam.specbeam_vs_analytical_single_static_load">[docs]</a><span class="k">def</span> <span class="nf">specbeam_vs_analytical_single_static_load</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;Compare specbeam vs analytical solution for single static load</span>
<span class="sd">    at mid point of &#39;long&#39; beam.</span>

<span class="sd">    Will produce a plot and an animation.</span>

<span class="sd">    Note that you can&#39;t really have a static load in specbeam.  You can</span>
<span class="sd">    have a slowly applied load that then remains constant.  Thus depending</span>
<span class="sd">    on the beam properties e.g. damping, you can get a maximum displacement</span>
<span class="sd">    envelope that is higher than the static case in that the momentum of the</span>
<span class="sd">    beam carries the deflection past the &#39;analytical&quot; maximum and then</span>
<span class="sd">    oscillations are created untill they are damped out.</span>

<span class="sd">    &quot;&quot;&quot;</span>




    <span class="n">mytimer</span><span class="o">=</span><span class="n">SimpleTimer</span><span class="p">()</span>
    <span class="n">mytimer</span><span class="o">.</span><span class="n">start</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="s2">&quot;single_static_load&quot;</span><span class="p">)</span>
    <span class="n">vfact</span><span class="o">=</span><span class="mi">2</span>
    <span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">40</span><span class="p">)</span>
    <span class="n">t</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">=</span><span class="mi">999</span>
<span class="c1">#    x = np.linspace(0,160,2001)</span>
    <span class="c1">#see Dingetal2012 Table 2 for material properties</span>
    <span class="n">pdict</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">(</span>
            <span class="n">E</span> <span class="o">=</span> <span class="mf">6.998</span><span class="o">*</span><span class="mf">1e9</span><span class="p">,</span> <span class="c1">#Pa</span>
            <span class="n">rho</span> <span class="o">=</span> <span class="mi">2373</span><span class="p">,</span> <span class="c1">#kg/m3</span>
            <span class="n">L</span> <span class="o">=</span> <span class="mi">20</span><span class="p">,</span> <span class="c1">#m</span>
            <span class="n">A</span> <span class="o">=</span> <span class="mf">0.3</span><span class="o">*</span><span class="mf">0.1</span><span class="p">,</span> <span class="c1"># m^2</span>
            <span class="n">I</span> <span class="o">=</span> <span class="mf">0.00022477900799999998</span><span class="p">,</span>
            <span class="n">k1</span> <span class="o">=</span> <span class="mf">800002.6125</span><span class="p">,</span>
            <span class="c1">#v_norm=0.01165,</span>
<span class="c1">#            kf=5.41e-4,</span>
            <span class="c1">#Fz_norm=1.013e-4,</span>
            <span class="n">mu_norm</span><span class="o">=</span><span class="mf">39.263</span><span class="p">,</span><span class="c1">#/100,</span>
<span class="c1">#            k1_norm=97.552,</span>
<span class="c1">#            k3_norm=2.497e6,</span>
            <span class="n">nterms</span><span class="o">=</span><span class="mi">201</span><span class="p">,</span>
            <span class="n">BC</span><span class="o">=</span><span class="s2">&quot;SS&quot;</span><span class="p">,</span>
            <span class="n">nquad</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span>
<span class="c1">#            k1bar=PolyLine([0,0.5],[0.5,1],[1,1],[1,.25]),</span>
<span class="c1">#            k1bar=PolyLine([0,0.25,.75,1],[1.0,1,4,4]),</span>
<span class="c1">#            k1bar=PolyLine([0,0.4,.6,1],[1.0,1,.25,.25]),</span>
<span class="c1">#            k1bar=PolyLine([0,0.5],[0.5,1],[2,1],[2,1]),</span>

<span class="c1">#            moving_loads_x_norm=[[0,-0.05,-0.1]],</span>
<span class="c1">#            moving_loads_Fz_norm=[3*[1.013e-4]],</span>
<span class="c1">#            moving_loads_v_norm=[0.01165*vfact],</span>

<span class="c1">#            stationary_loads_x=None,</span>
<span class="c1">#            stationary_loads_vs_t=None,</span>
<span class="c1">#            stationary_loads_omega_phase=None,</span>
            <span class="n">stationary_loads_x_norm</span><span class="o">=</span><span class="p">[</span><span class="mf">0.5</span><span class="p">],</span>
<span class="c1">#            stationary_loads_vs_t_norm=[PolyLine([0,8],[1,1])],</span>
            <span class="n">stationary_loads_vs_t_norm</span><span class="o">=</span><span class="p">[</span><span class="n">PolyLine</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1000</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mf">1e-4</span><span class="p">,</span><span class="mf">1e-4</span><span class="p">])],</span>
<span class="c1">#            stationary_loads_omega_phase_norm=[(.5,0),(0,0)],#None,</span>
            <span class="n">tvals_norm</span><span class="o">=</span><span class="n">t</span><span class="p">,</span>
<span class="c1">#            tvals=np.array([4.0]),</span>
<span class="c1">#            xvals_norm=np.array([0.5]),</span>
<span class="c1">#            xvals=x,</span>

            <span class="n">use_analytical</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="c1">#            implementation=&quot;vectorized&quot;,</span>
            <span class="n">implementation</span><span class="o">=</span><span class="s2">&quot;fortran&quot;</span><span class="p">,</span>
            <span class="n">file_stem</span><span class="o">=</span><span class="s2">&quot;single_static_load&quot;</span><span class="p">,</span>
            <span class="n">force_calc</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="p">)</span>

    <span class="n">pdict</span><span class="p">[</span><span class="s1">&#39;xvals&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">pdict</span><span class="p">[</span><span class="s1">&#39;L&#39;</span><span class="p">],</span> <span class="mi">2001</span><span class="p">)</span>

    <span class="n">a</span> <span class="o">=</span> <span class="n">SpecBeam</span><span class="p">(</span><span class="o">**</span><span class="n">pdict</span><span class="p">)</span>
    <span class="n">a</span><span class="o">.</span><span class="n">runme</span><span class="p">()</span>
<span class="c1">#    a.saveme()</span>
    <span class="n">a</span><span class="o">.</span><span class="n">animateme</span><span class="p">(</span><span class="n">norm</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="c1">#    a.plot_w_vs_x_overtime(norm=True)</span>

    <span class="n">max_envelope</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">defl</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">min_envelope</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">defl</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>



    <span class="n">max_index</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">defl</span><span class="p">[</span><span class="nb">int</span><span class="p">((</span><span class="mi">2001</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">),:])</span>
    <span class="c1">#print(a.defl[int((2001-1)/2),:])</span>
    <span class="c1">#print(max_index)</span>
    <span class="n">maxy</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">defl</span><span class="p">[:,</span> <span class="n">max_index</span><span class="p">]</span>
    <span class="n">yyy</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">defl</span><span class="p">[:,</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

    <span class="n">lam</span> <span class="o">=</span> <span class="p">(</span><span class="n">pdict</span><span class="p">[</span><span class="s1">&#39;k1&#39;</span><span class="p">]</span> <span class="o">/</span><span class="p">(</span><span class="mi">4</span><span class="o">*</span><span class="n">pdict</span><span class="p">[</span><span class="s1">&#39;E&#39;</span><span class="p">]</span><span class="o">*</span><span class="n">pdict</span><span class="p">[</span><span class="s1">&#39;I&#39;</span><span class="p">]))</span><span class="o">**</span><span class="mf">0.25</span>
    <span class="n">Q</span> <span class="o">=</span> <span class="n">pdict</span><span class="p">[</span><span class="s2">&quot;stationary_loads_vs_t_norm&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">y</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">pdict</span><span class="p">[</span><span class="s1">&#39;E&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">pdict</span><span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">]</span>

    <span class="n">wstatic</span> <span class="o">=</span> <span class="n">Q</span> <span class="o">*</span> <span class="n">lam</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">pdict</span><span class="p">[</span><span class="s1">&#39;k1&#39;</span><span class="p">])</span>

    <span class="n">fig</span><span class="p">,</span><span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">xvals</span><span class="p">,</span> <span class="n">maxy</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;When max reached&#39;</span><span class="p">)</span>
<span class="c1">#    line,=ax.plot(a.xvals, max_envelope, label=&#39;envelope&#39;)</span>
<span class="c1">#    ax.plot(a.xvals, min_envelope, color=line.get_color())</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">xvals</span><span class="p">,</span> <span class="n">yyy</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;last&#39;</span><span class="p">,</span><span class="n">lw</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>

    <span class="n">xstatic</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">pdict</span><span class="p">[</span><span class="s2">&quot;L&quot;</span><span class="p">],</span> <span class="mi">5001</span><span class="p">)</span>
    <span class="n">ystatic</span> <span class="o">=</span> <span class="n">wstatic</span> <span class="o">*</span> <span class="n">static_point_load_shape</span><span class="p">((</span><span class="n">xstatic</span><span class="o">-</span><span class="n">pdict</span><span class="p">[</span><span class="s2">&quot;L&quot;</span><span class="p">]</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span><span class="mi">1</span><span class="o">/</span><span class="n">lam</span><span class="p">)</span>

    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xstatic</span><span class="p">,</span> <span class="n">ystatic</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;analytical&quot;</span><span class="p">,</span>
            <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;None&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">markevery</span><span class="o">=</span><span class="mf">0.02</span><span class="p">)</span>

    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Deflection&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Single static load at beam midpoint&#39;</span><span class="p">)</span>

    <span class="n">leg</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    <span class="n">leg</span><span class="o">.</span><span class="n">draggable</span><span class="p">()</span>

    <span class="n">mytimer</span><span class="o">.</span><span class="n">finish</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span></div>

<div class="viewcode-block" id="reverse_curve_transition"><a class="viewcode-back" href="../../../api/geotecha.beam_on_foundation.specbeam.html#geotecha.beam_on_foundation.specbeam.reverse_curve_transition">[docs]</a><span class="k">def</span> <span class="nf">reverse_curve_transition</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">x2</span><span class="p">,</span> <span class="n">y2</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Transition curve between (x1, y1) and (x2, y2)</span>

<span class="sd">    Connects two parallel horizontal lines by two circular arcs.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    x : array of float</span>
<span class="sd">        value(s) at which to caluclate transition curve</span>
<span class="sd">    x1, y1 : float</span>
<span class="sd">        start point of transition</span>
<span class="sd">    x2, y2 : float</span>
<span class="sd">        end point of transition</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    y : float</span>
<span class="sd">        value of transition curve at x.</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    Two circular curves transition in a rectangle h high by L wide.  Each</span>
<span class="sd">    curve has radius R and traces out a curve of delta radians.</span>
<span class="sd">    h=2*R*(1-cos(delta))</span>
<span class="sd">    &amp;</span>
<span class="sd">    L=2*R*(sin(delta))</span>

<span class="sd">    Solve these in wolfram alpha for delta :Solve[(1-Cos[x])/Sin[x]-h/L,x]</span>
<span class="sd">    to get : delta = 2*arctan(h/L)</span>
<span class="sd">    Then use equation of circle in particualr quadrant to get points on curve.</span>
<span class="sd">    adjust for x1,y1 and x2,y2 starting points.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">atleast_1d</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty_like</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">y1</span> <span class="o">==</span> <span class="n">y2</span><span class="p">:</span>
        <span class="c1">#no transition --&gt; horizontal line</span>
        <span class="n">y</span><span class="p">[:]</span><span class="o">=</span><span class="n">y1</span>
        <span class="k">return</span> <span class="n">y</span>

    <span class="n">xmid</span> <span class="o">=</span> <span class="p">(</span><span class="n">x2</span> <span class="o">+</span> <span class="n">x1</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span>
    <span class="n">xm</span> <span class="o">=</span> <span class="n">x</span> <span class="o">&lt;</span> <span class="n">xmid</span> <span class="c1">#LHS of transition</span>
    <span class="n">xp</span> <span class="o">=</span> <span class="n">x</span> <span class="o">&gt;=</span> <span class="n">xmid</span> <span class="c1">#RHS of transition</span>

    <span class="k">if</span> <span class="n">x2</span> <span class="o">&gt;</span> <span class="n">x1</span><span class="p">:</span>
        <span class="n">xa</span><span class="p">,</span> <span class="n">xb</span> <span class="o">=</span> <span class="n">x1</span><span class="p">,</span> <span class="n">x2</span>
        <span class="n">ya</span><span class="p">,</span> <span class="n">yb</span> <span class="o">=</span> <span class="n">y1</span><span class="p">,</span> <span class="n">y2</span>
    <span class="k">elif</span> <span class="n">x1</span><span class="o">&gt;</span><span class="n">x2</span><span class="p">:</span>
        <span class="n">xa</span><span class="p">,</span> <span class="n">xb</span><span class="o">=</span> <span class="n">x2</span><span class="p">,</span> <span class="n">x1</span>
        <span class="n">ya</span><span class="p">,</span> <span class="n">yb</span><span class="o">=</span> <span class="n">y2</span><span class="p">,</span> <span class="n">y1</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;x1 must be differnet to x2&quot;</span><span class="p">)</span>

    <span class="n">xmm</span> <span class="o">=</span> <span class="n">x</span> <span class="o">&lt;=</span> <span class="n">xa</span> <span class="c1">#to left of transition</span>
    <span class="n">xpp</span> <span class="o">=</span> <span class="n">x</span> <span class="o">&gt;=</span> <span class="n">xb</span> <span class="c1">#to right of transition</span>

    <span class="n">xm</span><span class="o">*=~</span><span class="n">xmm</span>
    <span class="n">xp</span><span class="o">*=~</span><span class="n">xpp</span>

    <span class="n">delta</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">arctan</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">yb</span> <span class="o">-</span> <span class="n">ya</span><span class="p">)</span> <span class="o">/</span> <span class="nb">abs</span><span class="p">(</span><span class="n">xb</span> <span class="o">-</span> <span class="n">xa</span><span class="p">))</span>
    <span class="n">R</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">xb</span> <span class="o">-</span> <span class="n">xa</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">delta</span><span class="p">))</span>

    <span class="k">if</span> <span class="n">yb</span><span class="o">&lt;</span><span class="n">ya</span><span class="p">:</span>
        <span class="n">y</span><span class="p">[</span><span class="n">xm</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">R</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">xm</span><span class="p">]</span><span class="o">-</span><span class="n">xa</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">ya</span> <span class="o">-</span> <span class="n">R</span>
        <span class="n">y</span><span class="p">[</span><span class="n">xp</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">R</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">xp</span><span class="p">]</span><span class="o">-</span><span class="n">xb</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">yb</span> <span class="o">+</span> <span class="n">R</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">y</span><span class="p">[</span><span class="n">xm</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">R</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">xm</span><span class="p">]</span><span class="o">-</span><span class="n">xa</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">ya</span> <span class="o">+</span> <span class="n">R</span>
        <span class="n">y</span><span class="p">[</span><span class="n">xp</span><span class="p">]</span> <span class="o">=</span> <span class="o">+</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">R</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">xp</span><span class="p">]</span><span class="o">-</span><span class="n">xb</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">yb</span> <span class="o">-</span> <span class="n">R</span>
    <span class="n">y</span><span class="p">[</span><span class="n">xmm</span><span class="p">]</span> <span class="o">=</span> <span class="n">ya</span>
    <span class="n">y</span><span class="p">[</span><span class="n">xpp</span><span class="p">]</span> <span class="o">=</span> <span class="n">yb</span>

    <span class="k">return</span> <span class="n">y</span></div>





<div class="viewcode-block" id="article_figure_01"><a class="viewcode-back" href="../../../api/geotecha.beam_on_foundation.specbeam.html#geotecha.beam_on_foundation.specbeam.article_figure_01">[docs]</a><span class="k">def</span> <span class="nf">article_figure_01</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;Figure 1 Mid point deflection comparison with Ding et al 2012, figure</span>
<span class="sd">    from Walker and Indraratna (in press).</span>

<span class="sd">    References</span>
<span class="sd">    ----------</span>
<span class="sd">    .. [1] Walker, R.T.R. and Indraratna, B, (in press) &quot;Moving loads on a</span>
<span class="sd">           viscoelastic foundation with special reference to railway</span>
<span class="sd">           transition zones&quot;. International Journal of Geomechanics.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1">################################</span>
    <span class="c1"># FIGURE GENERATING CODE</span>
    <span class="c1"># Figure 1 Mid point deflection comparison with Ding et al 2012</span>
    <span class="c1">#################################</span>
    <span class="n">mpl</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s1">&#39;classic&#39;</span><span class="p">)</span>
    <span class="c1">#Journal paper figure, verify against ding et al.</span>
    <span class="n">FIGURE_verify_against_DingEtAl2012_fig8</span><span class="p">(</span><span class="n">v_nterms</span><span class="o">=</span><span class="p">(</span><span class="mi">50</span><span class="p">,</span><span class="mi">75</span><span class="p">,</span><span class="mi">150</span><span class="p">,</span><span class="mi">200</span><span class="p">),</span><span class="n">saveas</span><span class="o">=</span><span class="s2">&quot;verify_Dingetal2012&quot;</span><span class="p">)</span><span class="c1">#75,150,200))</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span></div>


<div class="viewcode-block" id="article_figure_02"><a class="viewcode-back" href="../../../api/geotecha.beam_on_foundation.specbeam.html#geotecha.beam_on_foundation.specbeam.article_figure_02">[docs]</a><span class="k">def</span> <span class="nf">article_figure_02</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;Figure 2 Deflection amplification factor compared with analytical</span>
<span class="sd">    infinite beam solution, figure from Walker and Indraratna (in press).</span>

<span class="sd">    References</span>
<span class="sd">    ----------</span>
<span class="sd">    .. [1] Walker, R.T.R. and Indraratna, B, (in press) &quot;Moving loads on a</span>
<span class="sd">           viscoelastic foundation with special reference to railway</span>
<span class="sd">           transition zones&quot;. International Journal of Geomechanics.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1">#################################</span>
    <span class="c1"># FIGURE GENERATING CODE</span>
    <span class="c1"># Figure 2 Deflection amplification factor compared with analytical infinite beam solution</span>
    <span class="c1">#################################</span>
    <span class="n">mpl</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s1">&#39;classic&#39;</span><span class="p">)</span>
    <span class="n">FIGURE_DAF_constant_prop</span><span class="p">(</span><span class="n">saveas</span><span class="o">=</span><span class="s2">&quot;DAF_constant_astatic&quot;</span><span class="p">,</span>
                             <span class="n">nterms</span><span class="o">=</span><span class="mi">150</span><span class="p">,</span>
                             <span class="n">force_calc</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<span class="c1">#                                 betas=[0.05],</span>
<span class="c1">#                                 alphas=np.linspace(1e-5,3,4),</span>
<span class="c1">#                                 alphas=np.linspace(0.01,0.95,10),</span>
                             <span class="n">nx</span><span class="o">=</span><span class="mi">2000</span><span class="p">,</span> <span class="n">nt</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span>
                             <span class="n">prefix</span><span class="o">=</span><span class="s2">&quot;static_a&quot;</span><span class="p">,</span>
<span class="c1">#                                 end_damp=0.04,</span>
                             <span class="n">xwindow</span><span class="o">=</span><span class="p">(</span><span class="mf">0.3</span><span class="p">,</span><span class="mf">0.7</span><span class="p">),</span>
                             <span class="n">xeval</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
                             <span class="n">numerical_DAF</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                             <span class="n">article_formatting</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span></div>


<div class="viewcode-block" id="article_figure_03"><a class="viewcode-back" href="../../../api/geotecha.beam_on_foundation.specbeam.html#geotecha.beam_on_foundation.specbeam.article_figure_03">[docs]</a><span class="k">def</span> <span class="nf">article_figure_03</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;Figure 3 Low damping DAF for velocity ratio  alp=0p5,</span>
<span class="sd">    figure from Walker and Indraratna (in press).</span>

<span class="sd">    References</span>
<span class="sd">    ----------</span>
<span class="sd">    .. [1] Walker, R.T.R. and Indraratna, B, (in press) &quot;Moving loads on a</span>
<span class="sd">           viscoelastic foundation with special reference to railway</span>
<span class="sd">           transition zones&quot;. International Journal of Geomechanics.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1">#################################</span>
    <span class="c1"># FIGURE GENERATING CODE</span>
    <span class="c1"># Figure 3 Low damping DAF for velocity ratio  alp=0.5</span>
    <span class="c1">#################################</span>
    <span class="n">mpl</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s1">&#39;classic&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">=</span><span class="n">FIG_DAF_envelope_vary_beta</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                               <span class="n">betas</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">,</span><span class="mf">0.5</span><span class="p">],</span>
                               <span class="n">alphas</span><span class="o">=</span><span class="p">[</span><span class="mf">0.5</span><span class="p">],</span>
                           <span class="n">saveas</span><span class="o">=</span><span class="s2">&quot;low_beta_DAF_envelope&quot;</span><span class="p">,</span>
                           <span class="n">nx</span><span class="o">=</span><span class="mi">1001</span><span class="p">,</span><span class="n">nt</span><span class="o">=</span><span class="mi">1001</span><span class="p">,</span><span class="n">nterms</span><span class="o">=</span><span class="mi">150</span><span class="p">,</span>
                           <span class="n">force_calc</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                           <span class="n">t_extend</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                           <span class="n">ylim</span><span class="o">=</span><span class="p">(</span><span class="mf">0.8</span><span class="p">,</span><span class="mf">1.6</span><span class="p">),</span>
                           <span class="n">numerical_DAF</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                           <span class="n">article_formatting</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span></div>

<div class="viewcode-block" id="article_figure_04"><a class="viewcode-back" href="../../../api/geotecha.beam_on_foundation.specbeam.html#geotecha.beam_on_foundation.specbeam.article_figure_04">[docs]</a><span class="k">def</span> <span class="nf">article_figure_04</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;Figure 4 Relative DAF for various stiffness ratios,</span>
<span class="sd">    figure from Walker and Indraratna (in press).</span>

<span class="sd">    References</span>
<span class="sd">    ----------</span>
<span class="sd">    .. [1] Walker, R.T.R. and Indraratna, B, (in press) &quot;Moving loads on a</span>
<span class="sd">           viscoelastic foundation with special reference to railway</span>
<span class="sd">           transition zones&quot;. International Journal of Geomechanics.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1">#################################</span>
    <span class="c1"># FIGURE GENERATING CODE</span>
    <span class="c1"># Figure 4 Relative DAF for various stiffness ratios</span>
    <span class="c1">#################################</span>
    <span class="n">mpl</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s1">&#39;classic&#39;</span><span class="p">)</span>
    <span class="n">fig</span> <span class="o">=</span> <span class="n">transition_DAF1</span><span class="p">(</span><span class="n">kratios</span><span class="o">=</span><span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">50</span><span class="p">],</span>
                          <span class="n">alpmax</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
                          <span class="n">npts</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span>
                          <span class="n">saveas</span><span class="o">=</span><span class="s2">&quot;transitionDAF1&quot;</span><span class="p">,</span>
                          <span class="n">article_formatting</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span></div>


<div class="viewcode-block" id="article_figure_05a_05b_05c_07"><a class="viewcode-back" href="../../../api/geotecha.beam_on_foundation.specbeam.html#geotecha.beam_on_foundation.specbeam.article_figure_05a_05b_05c_07">[docs]</a><span class="k">def</span> <span class="nf">article_figure_05a_05b_05c_07</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;Figure 5 a),b),&amp;c) Max deflection envelope for  bet=0p1  k2_k1=10,</span>
<span class="sd">    and Figure 7 Deflection vs time at point which experiences maximum</span>
<span class="sd">    deflection  alp=0p8,  bet=0p1,  k2_k1=10, soft to stiff=forward,</span>
<span class="sd">    figure from Walker and Indraratna (in press).</span>

<span class="sd">    References</span>
<span class="sd">    ----------</span>
<span class="sd">    .. [1] Walker, R.T.R. and Indraratna, B, (in press) &quot;Moving loads on a</span>
<span class="sd">           viscoelastic foundation with special reference to railway</span>
<span class="sd">           transition zones&quot;. International Journal of Geomechanics.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1">#################################</span>
    <span class="c1"># FIGURE GENERATING CODE</span>
    <span class="c1"># Figure 5 a),b),&amp;c) Max deflection envelope for  bet=0.1,  k2_k1=10</span>
    <span class="c1"># will need to comment out code as appropriate for 5a, 5b, 5c.</span>
    <span class="c1"># Figure 7 Deflection vs time at point which experiences maximum deflection  alp=0.8,  bet=0.1,  k2_k1=10, soft to stiff=forward</span>
    <span class="c1">#################################</span>
    <span class="n">mpl</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s1">&#39;classic&#39;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">alpha_design</span><span class="p">,</span> <span class="n">alphas</span><span class="p">,</span> <span class="n">reverses</span><span class="p">,</span> <span class="n">saveas</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span>
                <span class="p">[</span><span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">],</span>
                <span class="p">[[</span><span class="mf">0.3</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.8</span><span class="p">]</span> <span class="p">,</span> <span class="p">[</span><span class="mf">0.8</span><span class="p">]],</span>
                <span class="p">[[</span><span class="kc">False</span><span class="p">],</span> <span class="p">[</span><span class="kc">False</span><span class="p">]</span> <span class="p">,</span> <span class="p">[</span><span class="kc">True</span><span class="p">]],</span>
                <span class="p">[</span><span class="s2">&quot;Lt_lc_alp0.3_bet0.1_forward&quot;</span><span class="p">,</span>
                 <span class="s2">&quot;Lt_lc_alp0.8_bet0.1_forward&quot;</span> <span class="p">,</span>
                 <span class="s2">&quot;Lt_lc_alp0.8_bet0.1_reverse&quot;</span><span class="p">]</span>
                 <span class="p">):</span>

        <span class="n">transition_zones1</span><span class="p">(</span><span class="n">xlim</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mi">8</span><span class="p">,</span><span class="mi">8</span><span class="p">),</span>
           <span class="n">ntrans</span> <span class="o">=</span> <span class="mi">50</span><span class="p">,</span> <span class="c1"># number of points to sample analytical trasnstion zone</span>
            <span class="n">kratio</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span>
            <span class="n">beta</span> <span class="o">=</span> <span class="mf">0.1</span><span class="p">,</span>
            <span class="n">nx</span> <span class="o">=</span> <span class="mi">400</span><span class="p">,</span>     <span class="c1">#number of x points</span>
            <span class="n">nt</span><span class="o">=</span><span class="mi">400</span><span class="p">,</span> <span class="c1">#number of time values</span>
            <span class="n">nterms</span><span class="o">=</span><span class="mi">150</span><span class="p">,</span>
            <span class="n">force_calc</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">ninterp</span> <span class="o">=</span> <span class="mi">50</span><span class="p">,</span> <span class="c1"># number of points to discretize the transition zone</span>
            <span class="n">nloads</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
            <span class="n">load_spacing</span> <span class="o">=</span> <span class="mf">0.03</span><span class="p">,</span>
            <span class="n">Lt_Lcs</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.01</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">5</span><span class="p">],</span> <span class="c1">#2,4,6],</span>
            <span class="n">t_extend</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">,</span> <span class="c1"># factor to extend maximum evalutated time.</span>
            <span class="n">DAF_distribution</span> <span class="o">=</span> <span class="s2">&quot;linear&quot;</span><span class="p">,</span>
            <span class="n">tanhend</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span>
            <span class="n">alpha_design</span> <span class="o">=</span> <span class="n">alpha_design</span><span class="p">,</span> <span class="c1">#alpha for back calculating k profile</span>
            <span class="n">alphas</span> <span class="o">=</span> <span class="n">alphas</span><span class="p">,</span>
            <span class="n">reverses</span><span class="o">=</span><span class="n">reverses</span><span class="p">,</span>
            <span class="n">saveas</span><span class="o">=</span><span class="n">saveas</span><span class="p">,</span>
            <span class="n">animateme</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>

            <span class="n">xi_Lc</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="c1">#ratio of xinterest over characteristic length)</span>
            <span class="n">article_formatting</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span></div>

<div class="viewcode-block" id="article_figure_06"><a class="viewcode-back" href="../../../api/geotecha.beam_on_foundation.specbeam.html#geotecha.beam_on_foundation.specbeam.article_figure_06">[docs]</a><span class="k">def</span> <span class="nf">article_figure_06</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;Additional deflection for transition effects,  bet=0p1,  alp=10, (dashed=stiff to soft, solid=soft to stiff),</span>
<span class="sd">    figure from Walker and Indraratna (in press).</span>

<span class="sd">    This takes forever to run.</span>

<span class="sd">    References</span>
<span class="sd">    ----------</span>
<span class="sd">    .. [1] Walker, R.T.R. and Indraratna, B, (in press) &quot;Moving loads on a</span>
<span class="sd">           viscoelastic foundation with special reference to railway</span>
<span class="sd">           transition zones&quot;. International Journal of Geomechanics.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1">#################################</span>
    <span class="c1"># FIGURE GENERATING CODE</span>
    <span class="c1"># Figure 6 Additional deflection for transition effects,  bet=0.1,  alp=10, (dashed=stiff to soft, solid=soft to stiff)</span>
    <span class="c1">#################################</span>
    <span class="c1">#this is for generating DAF* vs Lt_Lc</span>
    <span class="n">trans2</span><span class="p">(</span><span class="n">xlim</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">),</span>
       <span class="n">ntrans</span> <span class="o">=</span> <span class="mi">50</span><span class="p">,</span> <span class="c1"># number of points to sample analytical trasnstion zone</span>
        <span class="n">kratio</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span>
        <span class="n">beta</span> <span class="o">=</span> <span class="mf">0.1</span><span class="p">,</span>
        <span class="n">alphas</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">],</span>
        <span class="n">nx</span> <span class="o">=</span> <span class="mi">400</span><span class="p">,</span>     <span class="c1">#number of x points</span>
        <span class="n">nt</span><span class="o">=</span><span class="mi">400</span><span class="p">,</span> <span class="c1">#number of time values</span>
        <span class="n">nterms</span><span class="o">=</span><span class="mi">150</span><span class="p">,</span>
        <span class="n">force_calc</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">ninterp</span> <span class="o">=</span> <span class="mi">50</span><span class="p">,</span> <span class="c1"># number of points to discretize the transition zone</span>
        <span class="n">nloads</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
        <span class="n">load_spacing</span> <span class="o">=</span> <span class="mf">0.03</span><span class="p">,</span>
        <span class="c1">#alpha_design = 0.3, #alpha for back calculating k profile, #this will be ignored</span>
        <span class="n">Lt_Lcs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.01</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">50</span><span class="p">),</span> <span class="c1">#2,4,6],</span>
        <span class="n">t_extend</span> <span class="o">=</span> <span class="mf">1.2</span><span class="p">,</span> <span class="c1"># factor to extend maximum evalutated time.</span>
        <span class="n">DAF_distribution</span> <span class="o">=</span> <span class="s2">&quot;linear&quot;</span><span class="p">,</span>
        <span class="n">tanhend</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span>
        <span class="n">reverses</span><span class="o">=</span><span class="p">[</span><span class="kc">False</span><span class="p">,</span><span class="kc">True</span><span class="p">],</span>
        <span class="n">animateme</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">saveas</span><span class="o">=</span><span class="s2">&quot;DAf_star_vs_Lt_Lc&quot;</span><span class="p">,</span>
        <span class="n">xi_Lc</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="c1">#ratio of xinterest over characteristic length)</span>
        <span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span></div>

<div class="viewcode-block" id="article_figure_08"><a class="viewcode-back" href="../../../api/geotecha.beam_on_foundation.specbeam.html#geotecha.beam_on_foundation.specbeam.article_figure_08">[docs]</a><span class="k">def</span> <span class="nf">article_figure_08</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;Figure 8 Deflection vs time under four moving loads alp=0p8,  bet=0p1,  k2/k1=10, soft to stiff,</span>
<span class="sd">    figure from Walker and Indraratna (in press).</span>

<span class="sd">    References</span>
<span class="sd">    ----------</span>
<span class="sd">    .. [1] Walker, R.T.R. and Indraratna, B, (in press) &quot;Moving loads on a</span>
<span class="sd">           viscoelastic foundation with special reference to railway</span>
<span class="sd">           transition zones&quot;. International Journal of Geomechanics.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1">#################################</span>
    <span class="c1"># FIGURE GENERATING CODE</span>
    <span class="c1"># Figure 8 Deflection vs time under four moving loads alp=0.8,  bet=0.1,  k2/k1=10, soft to stiff</span>
    <span class="c1">#################################</span>
    <span class="n">mpl</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s1">&#39;classic&#39;</span><span class="p">)</span>
    <span class="c1">#This is for multi-load</span>
    <span class="k">for</span> <span class="n">Lt</span> <span class="ow">in</span> <span class="p">[</span><span class="mf">0.01</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">8</span><span class="p">]:</span>
        <span class="n">transition_zones1</span><span class="p">(</span><span class="n">xlim</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">),</span>
           <span class="n">ntrans</span> <span class="o">=</span> <span class="mi">50</span><span class="p">,</span> <span class="c1"># number of points to sample analytical trasnstion zone</span>
            <span class="n">kratio</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span>
            <span class="n">beta</span> <span class="o">=</span> <span class="mf">0.1</span><span class="p">,</span>
            <span class="n">alphas</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.8</span><span class="p">],</span>
            <span class="n">nx</span> <span class="o">=</span> <span class="mi">400</span><span class="p">,</span>     <span class="c1">#number of x points</span>
            <span class="n">nt</span><span class="o">=</span><span class="mi">400</span><span class="p">,</span> <span class="c1">#number of time values</span>
            <span class="n">nterms</span><span class="o">=</span><span class="mi">150</span><span class="p">,</span>
            <span class="n">force_calc</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">ninterp</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="c1"># number of points to discretize the transition zone</span>
            <span class="n">nloads</span> <span class="o">=</span> <span class="mi">4</span><span class="p">,</span>
            <span class="n">load_spacing</span> <span class="o">=</span> <span class="mf">0.03</span><span class="p">,</span>
            <span class="n">alpha_design</span> <span class="o">=</span> <span class="mf">0.8</span><span class="p">,</span> <span class="c1">#alpha for back calculating k profile</span>
            <span class="n">Lt_Lcs</span> <span class="o">=</span> <span class="p">[</span><span class="n">Lt</span><span class="p">],</span> <span class="c1">#2,4,6],</span>
            <span class="n">t_extend</span> <span class="o">=</span> <span class="mf">1.2</span><span class="p">,</span> <span class="c1"># factor to extend maximum evalutated time.</span>
            <span class="n">DAF_distribution</span> <span class="o">=</span> <span class="s2">&quot;linear&quot;</span><span class="p">,</span>
            <span class="n">tanhend</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span>
            <span class="n">reverses</span><span class="o">=</span><span class="p">[</span><span class="kc">False</span><span class="p">],</span>
            <span class="n">animateme</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">saveas</span><span class="o">=</span><span class="s2">&quot;four_loads_Lt_lc</span><span class="si">{:.2g}</span><span class="s2">_alp0.8_bet0.1_forward&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">Lt</span><span class="p">),</span>
            <span class="n">xi_Lc</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="c1">#ratio of xinterest over characteristic length)</span>
            <span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span></div>

<div class="viewcode-block" id="article_figure_09"><a class="viewcode-back" href="../../../api/geotecha.beam_on_foundation.specbeam.html#geotecha.beam_on_foundation.specbeam.article_figure_09">[docs]</a><span class="k">def</span> <span class="nf">article_figure_09</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;Figure 9 is  drawing in a word file,  this routine is just a marker</span>
<span class="sd">    to indicated that figure 9 has not been forgotten,</span>
<span class="sd">    figure from Walker and Indraratna (in press).</span>

<span class="sd">    References</span>
<span class="sd">    ----------</span>
<span class="sd">    .. [1] Walker, R.T.R. and Indraratna, B, (in press) &quot;Moving loads on a</span>
<span class="sd">           viscoelastic foundation with special reference to railway</span>
<span class="sd">           transition zones&quot;. International Journal of Geomechanics.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1">#################################</span>
    <span class="c1"># FIGURE GENERATING CODE</span>
    <span class="c1"># Figure 9 is a drawing in a word file</span>
    <span class="c1">#################################</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Figure 9 is  drawing in a word file.  This routine is just a marker to indicated that figure 9 has not been forgotten&quot;</span><span class="p">)</span></div>

<div class="viewcode-block" id="article_figure_10_11"><a class="viewcode-back" href="../../../api/geotecha.beam_on_foundation.specbeam.html#geotecha.beam_on_foundation.specbeam.article_figure_10_11">[docs]</a><span class="k">def</span> <span class="nf">article_figure_10_11</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;Figure 10 Measured vs modelled deflections at various locations in the</span>
<span class="sd">    transition zone, Figure 11 Peak displacement and stiffness distribution,</span>
<span class="sd">    figure from Walker and Indraratna (in press).</span>

<span class="sd">    References</span>
<span class="sd">    ----------</span>
<span class="sd">    .. [1] Walker, R.T.R. and Indraratna, B, (in press) &quot;Moving loads on a</span>
<span class="sd">           viscoelastic foundation with special reference to railway</span>
<span class="sd">           transition zones&quot;. International Journal of Geomechanics.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1">#################################</span>
    <span class="c1"># FIGURE GENERATING CODE</span>
    <span class="c1"># Figure 10 Measured vs modelled deflections at various locations in the transition zone</span>
    <span class="c1"># Figure 11 Peak displacement and stiffness distribution.</span>
    <span class="c1">#################################</span>
    <span class="n">mpl</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s1">&#39;classic&#39;</span><span class="p">)</span>
    <span class="c1">#generate comparison plots for Paixao case study</span>
    <span class="n">case_study_PaixaoEtAl2014</span><span class="p">(</span><span class="n">saveas</span><span class="o">=</span><span class="s2">&quot;Paixao&quot;</span><span class="p">,</span> <span class="n">nterms</span><span class="o">=</span><span class="mi">150</span><span class="p">,</span> <span class="n">force_calc</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                   <span class="n">nx</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span>
                   <span class="n">nt</span><span class="o">=</span><span class="mi">500</span><span class="p">)</span></div>


<div class="viewcode-block" id="article_figure_12"><a class="viewcode-back" href="../../../api/geotecha.beam_on_foundation.specbeam.html#geotecha.beam_on_foundation.specbeam.article_figure_12">[docs]</a><span class="k">def</span> <span class="nf">article_figure_12</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;Figure 12 python code for relative dynamic amplification factor</span>
<span class="sd">    calculation, figure from Walker and Indraratna (in press).</span>

<span class="sd">    References</span>
<span class="sd">    ----------</span>
<span class="sd">    .. [1] Walker, R.T.R. and Indraratna, B, (in press) &quot;Moving loads on a</span>
<span class="sd">           viscoelastic foundation with special reference to railway</span>
<span class="sd">           transition zones&quot;. International Journal of Geomechanics.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1">#################################</span>
    <span class="c1"># FIGURE GENERATING CODE</span>
    <span class="c1"># Figure 12 python code for relative dynamic amplification factor calculation</span>
    <span class="c1">#################################</span>
    <span class="n">mpl</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s1">&#39;classic&#39;</span><span class="p">)</span>
    <span class="kn">from</span> <span class="nn">geotecha.plotting.one_d</span> <span class="k">import</span> <span class="n">figure_from_source_code</span>
    <span class="n">fig</span> <span class="o">=</span> <span class="n">figure_from_source_code</span><span class="p">(</span><span class="n">DAFrelative</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mf">6.5</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
    <span class="n">save_figure</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="s2">&quot;DAFrelative&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;done&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span></div>



<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="kn">import</span> <span class="nn">nose</span>
    <span class="n">mpl</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s1">&#39;classic&#39;</span><span class="p">)</span>
<span class="c1">#    nose.runmodule(argv=[&#39;nose&#39;, &#39;--verbosity=3&#39;, &#39;--with-doctest&#39;, &#39;--doctest-options=+ELLIPSIS&#39;])</span>
<span class="c1">#    test_DingEtAl2012()</span>
<span class="c1">#    test_DingEtAl2012_deflection_shape()</span>
<span class="c1">#    test_SpecBeam_const_mat_midpoint_defl()</span>
<span class="c1">#    test_SpecBeam_const_mat_deflection_shape()</span>
<span class="c1">#    test_SpecBeam_const_mat_midpoint_defl_runme()</span>
<span class="c1">#    test_SpecBeam_const_mat_deflection_shape_runme()</span>
<span class="c1">#    test_SpecBeam_const_mat_midpoint_defl_runme_analytical_50()</span>
<span class="c1">#    test_SpecBeam_const_mat_midpoint_defl_runme_analytical_200()</span>
<span class="c1">#    SpecBeam_const_mat_midpoint_defl_runme_analytical_play()</span>
<span class="c1">#    test_SpecBeam_const_mat_deflection_shape_stationary_load()</span>
<span class="c1">#    SpecBeam_stationary_load_const_mat_midpoint_defl_runme_analytical_play()</span>
<span class="c1">#    dingetal_figure_8()</span>


<span class="c1">############################################</span>
<span class="c1"># Article figures</span>
<span class="c1">############################################</span>

<span class="c1">#    article_figure_01()</span>
<span class="c1">#    article_figure_02()</span>
<span class="c1">#    article_figure_03()</span>
<span class="c1">#    article_figure_04()</span>
<span class="c1">#    article_figure_05a_05b_05c_07()</span>
<span class="c1">#    article_figure_06() # this can take forever to run!!!!!!!! i.e. 5+hours</span>
<span class="c1">#    article_figure_07()</span>
<span class="c1">#    article_figure_08()</span>
<span class="c1">#    article_figure_09()</span>
<span class="c1">#    article_figure_10_11()</span>
<span class="c1">#    article_figure_12()</span>




<span class="c1">############################################</span>
<span class="c1"># Other code</span>
<span class="c1">############################################</span>
    <span class="k">if</span> <span class="mi">0</span><span class="p">:</span>
        <span class="c1">##An example of using the reverse transition curves</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>
        <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>

        <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">x2</span><span class="p">,</span> <span class="n">y2</span> <span class="ow">in</span> <span class="p">[(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="o">.</span><span class="mi">5</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mf">2.5</span><span class="p">),(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">),(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="mf">0.7</span><span class="p">),</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">)]:</span>

            <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x2</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;s&#39;</span><span class="p">)</span>

            <span class="n">y</span> <span class="o">=</span> <span class="n">reverse_curve_transition</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">x2</span><span class="p">,</span> <span class="n">y2</span><span class="p">)</span>
    <span class="c1">#        reverse_curve_transition(xtrans,0,DAF1, 1, DAF2)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;y&quot;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Transiton curve&quot;</span><span class="p">)</span>

        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

    <span class="k">if</span> <span class="mi">0</span><span class="p">:</span>
        <span class="c1">#Use SpecBeam to analyse/check a single static load at midpoint</span>
        <span class="n">specbeam_vs_analytical_single_static_load</span><span class="p">()</span>

    <span class="k">if</span> <span class="mi">0</span><span class="p">:</span>
        <span class="c1">#example of deflection envelope</span>
        <span class="k">for</span> <span class="n">alpha_design</span><span class="p">,</span> <span class="n">alphas</span><span class="p">,</span> <span class="n">reverses</span><span class="p">,</span> <span class="n">saveas</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span>
                    <span class="p">[</span><span class="mf">0.8</span><span class="p">],</span>
                    <span class="p">[[</span><span class="mf">0.8</span><span class="p">]],</span>
                    <span class="p">[[</span><span class="kc">False</span><span class="p">]],</span>
                    <span class="p">[</span><span class="s2">&quot;Lt_lc_alp0.3_bet0.1_forward&quot;</span><span class="p">]</span>
                     <span class="p">):</span>

            <span class="n">transition_zones1</span><span class="p">(</span><span class="n">xlim</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mi">8</span><span class="p">,</span><span class="mi">8</span><span class="p">),</span>
               <span class="n">ntrans</span> <span class="o">=</span> <span class="mi">50</span><span class="p">,</span> <span class="c1"># number of points to sample analytical trasnstion zone</span>
                <span class="n">kratio</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span>
                <span class="n">beta</span> <span class="o">=</span> <span class="mf">0.1</span><span class="p">,</span>
                <span class="n">nx</span> <span class="o">=</span> <span class="mi">400</span><span class="p">,</span>     <span class="c1">#number of x points</span>
                <span class="n">nt</span><span class="o">=</span><span class="mi">400</span><span class="p">,</span> <span class="c1">#number of time values</span>
                <span class="n">nterms</span><span class="o">=</span><span class="mi">150</span><span class="p">,</span>
                <span class="n">force_calc</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                <span class="n">ninterp</span> <span class="o">=</span> <span class="mi">50</span><span class="p">,</span> <span class="c1"># number of points to discretize the transition zone</span>
                <span class="n">nloads</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
                <span class="n">load_spacing</span> <span class="o">=</span> <span class="mf">0.03</span><span class="p">,</span>
                <span class="n">Lt_Lcs</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="c1">#2,4,6],</span>
                <span class="n">t_extend</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">,</span> <span class="c1"># factor to extend maximum evalutated time.</span>
                <span class="n">DAF_distribution</span> <span class="o">=</span> <span class="s2">&quot;linear&quot;</span><span class="p">,</span>
                <span class="n">tanhend</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span>
                <span class="n">alpha_design</span> <span class="o">=</span> <span class="n">alpha_design</span><span class="p">,</span> <span class="c1">#alpha for back calculating k profile</span>
                <span class="n">alphas</span> <span class="o">=</span> <span class="n">alphas</span><span class="p">,</span>
                <span class="n">reverses</span><span class="o">=</span><span class="n">reverses</span><span class="p">,</span>
                <span class="n">saveas</span><span class="o">=</span><span class="n">saveas</span><span class="p">,</span>
                <span class="n">animateme</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>

                <span class="n">xi_Lc</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="c1">#ratio of xinterest over characteristic length)</span>
                <span class="n">article_formatting</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

    <span class="k">if</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">esveld_fig6p17</span><span class="p">()</span>
        <span class="n">esveld_fig6p18</span><span class="p">()</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

    <span class="k">if</span> <span class="mi">0</span><span class="p">:</span>
        <span class="c1">#Messing around with deflection shape from multiple static loads</span>
        <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>

        <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
        <span class="c1">#single load, choose the location with xc:</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">point_load_static_defl_shape_function</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">xc</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;single load&#39;</span><span class="p">)</span>

        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;x/L_c&quot;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;relative w&quot;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">invert_yaxis</span><span class="p">()</span>

        <span class="c1">#load centers equally spaced, with equal magnitude of 1:</span>
        <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">3</span><span class="p">]:</span>
            <span class="n">xx</span><span class="p">,</span><span class="n">yy</span> <span class="o">=</span> <span class="n">multi_static</span><span class="p">(</span><span class="n">xc</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">n</span><span class="p">)</span><span class="o">*</span><span class="mi">3</span><span class="p">,</span> <span class="n">frel</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">n</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xx</span><span class="p">,</span><span class="n">yy</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2"> loads&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">n</span><span class="p">))</span>


        <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
        <span class="n">leg</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>


    <span class="k">if</span> <span class="mi">0</span><span class="p">:</span>
        <span class="c1">#messing around with moving point loads</span>
        <span class="n">a</span> <span class="o">=</span> <span class="n">MovingPointLoads</span><span class="p">([</span><span class="mf">0.</span><span class="p">,</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span><span class="o">-</span><span class="mi">5</span><span class="p">],[</span><span class="mf">20.</span><span class="p">,</span><span class="mi">15</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span> <span class="p">])</span>
        <span class="n">a</span><span class="o">.</span><span class="n">plotme</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">t</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">v0</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">t0</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">x0</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">xlim</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">),</span> <span class="n">ylim</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">100</span><span class="p">))</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span><span class="c1">#x0,t0,tf,v</span>

    <span class="k">if</span> <span class="mi">0</span><span class="p">:</span>
        <span class="c1">#messing around with moving point loads</span>
        <span class="n">a</span> <span class="o">=</span> <span class="n">MovingPointLoads</span><span class="p">([</span><span class="mf">0.</span><span class="p">,</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span><span class="o">-</span><span class="mi">5</span><span class="p">],[</span><span class="mf">20.</span><span class="p">,</span><span class="mi">15</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span> <span class="p">])</span>
<span class="c1">#        a.animateme(x0=-5,t0=0,tf=15,v0=6, xlim = (-10,20), ylim=(0,100))</span>
        <span class="n">a</span><span class="o">.</span><span class="n">animateme</span><span class="p">(</span><span class="n">x0</span><span class="o">=-</span><span class="mi">5</span><span class="p">,</span><span class="n">t0</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">tf</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span><span class="n">v0</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">xlim</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span><span class="mi">20</span><span class="p">),</span> <span class="n">ylim</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">100</span><span class="p">))</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span><span class="c1">#x0,t0,tf,v</span>

    <span class="k">if</span> <span class="mi">0</span><span class="p">:</span>
        <span class="c1">#messing around with moving point loads</span>
        <span class="n">a</span> <span class="o">=</span> <span class="n">MovingPointLoads</span><span class="p">([</span><span class="mf">0.</span><span class="p">,</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span><span class="o">-</span><span class="mi">5</span><span class="p">],[</span><span class="mf">20.</span><span class="p">,</span><span class="mi">15</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span> <span class="p">])</span>
        <span class="n">a</span><span class="o">.</span><span class="n">animateme</span><span class="p">(</span><span class="n">x0</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span><span class="n">t0</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">tf</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span><span class="n">v0</span><span class="o">=-</span><span class="mi">6</span><span class="p">,</span> <span class="n">xlim</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span><span class="mi">20</span><span class="p">),</span> <span class="n">ylim</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">100</span><span class="p">))</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span><span class="c1">#x0,t0,tf,v</span>

    <span class="k">if</span> <span class="mi">0</span><span class="p">:</span>
        <span class="c1">#messing around with moving point loads</span>
        <span class="n">a</span> <span class="o">=</span> <span class="n">MovingPointLoads</span><span class="p">([</span><span class="mf">0.</span><span class="p">,</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span><span class="o">-</span><span class="mi">5</span><span class="p">],[</span><span class="mf">20.</span><span class="p">,</span><span class="mi">15</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span> <span class="p">])</span>

        <span class="n">a</span><span class="o">.</span><span class="n">plot_specbeam_PolyLines</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">v</span><span class="o">=-</span><span class="mi">2</span><span class="p">,</span> <span class="n">L</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">t0</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span><span class="c1">#x0,t0,tf,v</span>
    <span class="k">if</span> <span class="mi">1</span><span class="p">:</span>
        <span class="c1">#messing around with moving point loads</span>
        <span class="n">a</span> <span class="o">=</span> <span class="n">MovingPointLoads</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="p">[</span><span class="mf">0.</span><span class="p">,</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span><span class="o">-</span><span class="mi">5</span><span class="p">],</span><span class="n">p</span><span class="o">=</span><span class="p">[</span><span class="mf">20.</span><span class="p">,</span><span class="mi">15</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span> <span class="p">],</span><span class="n">v</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span><span class="n">L</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span><span class="n">t0</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">12</span><span class="p">]:</span>
            <span class="n">x</span><span class="p">,</span><span class="n">p</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">point_loads_on_beam</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>

            <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">p</span><span class="p">,</span><span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span><span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;None&quot;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span> <span class="s2">&quot;</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">t</span><span class="p">))</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;L=</span><span class="si">{}</span><span class="s2">,v=</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">L</span><span class="p">,</span><span class="n">a</span><span class="o">.</span><span class="n">v</span><span class="p">))</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">100</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
    <span class="k">if</span> <span class="mi">0</span><span class="p">:</span>
        <span class="c1">#messing around with moving point loads</span>
        <span class="n">a</span> <span class="o">=</span> <span class="n">MovingPointLoads</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="p">[</span><span class="mf">0.</span><span class="p">,</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span><span class="o">-</span><span class="mi">5</span><span class="p">],</span><span class="n">p</span><span class="o">=</span><span class="p">[</span><span class="mf">20.</span><span class="p">,</span><span class="mi">15</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span> <span class="p">],</span><span class="n">v</span><span class="o">=-</span><span class="mi">3</span><span class="p">,</span><span class="n">L</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span><span class="n">t0</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">12</span><span class="p">]:</span>
            <span class="n">x</span><span class="p">,</span><span class="n">p</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">point_loads_on_beam</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>

            <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">p</span><span class="p">,</span><span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span><span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;None&quot;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span> <span class="s2">&quot;</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">t</span><span class="p">))</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;L=</span><span class="si">{}</span><span class="s2">,v=</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">L</span><span class="p">,</span><span class="n">a</span><span class="o">.</span><span class="n">v</span><span class="p">))</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">100</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1">############################################</span>
<span class="c1"># Misc code that Rohan has forgotten the use</span>
<span class="c1"># of but was no doubt useful at the time.</span>
<span class="c1">############################################</span>

    <span class="k">if</span> <span class="mi">0</span><span class="p">:</span>
        <span class="c1">#k3!=0 so use the numberical, not sure</span>
        <span class="n">start_time0</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
        <span class="n">ftime</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">fromtimestamp</span><span class="p">(</span><span class="n">start_time0</span><span class="p">)</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s1">&#39;%Y-%m-</span><span class="si">%d</span><span class="s1"> %H%M%S&#39;</span><span class="p">)</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">ftime</span> <span class="o">+</span> <span class="s2">&quot;.txt&quot;</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">ftime</span> <span class="o">+</span> <span class="n">os</span><span class="o">.</span><span class="n">linesep</span><span class="p">)</span>

            <span class="n">fig</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
            <span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="s2">&quot;111&quot;</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;time, s&quot;</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;w, m&quot;</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mf">3.5</span><span class="p">,</span> <span class="mf">4.5</span><span class="p">)</span>

            <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">50</span><span class="p">,</span><span class="mi">75</span><span class="p">,</span> <span class="p">]:</span>
                <span class="n">vstr</span><span class="o">=</span><span class="s2">&quot;nterms&quot;</span>
                <span class="n">vfmt</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2">&quot;</span>
                <span class="n">start_time1</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>

                <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;*&quot;</span> <span class="o">*</span> <span class="mi">70</span> <span class="o">+</span> <span class="n">os</span><span class="o">.</span><span class="n">linesep</span><span class="p">)</span>
                <span class="n">vequals</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{}</span><span class="s2">=</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">vstr</span><span class="p">,</span> <span class="n">vfmt</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">v</span><span class="p">))</span>
                <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">vequals</span> <span class="o">+</span> <span class="n">os</span><span class="o">.</span><span class="n">linesep</span><span class="p">);</span> <span class="nb">print</span><span class="p">(</span><span class="n">vequals</span><span class="p">)</span>

                <span class="n">pdict</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">(</span>
                    <span class="n">E</span> <span class="o">=</span> <span class="mf">6.998</span><span class="o">*</span><span class="mf">1e9</span><span class="p">,</span> <span class="c1">#Pa</span>
                    <span class="n">rho</span> <span class="o">=</span> <span class="mi">2373</span><span class="p">,</span> <span class="c1">#kg/m3</span>
                    <span class="n">L</span> <span class="o">=</span> <span class="mi">160</span><span class="p">,</span> <span class="c1">#m</span>
                    <span class="n">v_norm</span><span class="o">=</span><span class="mf">0.01165</span><span class="p">,</span>
                    <span class="n">kf</span><span class="o">=</span><span class="mf">5.41e-4</span><span class="p">,</span>
                    <span class="n">Fz_norm</span><span class="o">=</span><span class="mf">1.013e-4</span><span class="p">,</span>
                    <span class="n">mu_norm</span><span class="o">=</span><span class="mf">39.263</span><span class="p">,</span>
                    <span class="n">k1_norm</span><span class="o">=</span><span class="mf">97.552</span><span class="p">,</span>
                    <span class="n">k3_norm</span><span class="o">=</span><span class="mf">2.497e6</span><span class="p">,</span>
                    <span class="n">nterms</span><span class="o">=</span><span class="n">v</span><span class="p">,</span>
                    <span class="n">BC</span><span class="o">=</span><span class="s2">&quot;CC&quot;</span><span class="p">,</span>
                    <span class="n">nquad</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span>
                    <span class="p">)</span>

                <span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">4.5</span><span class="p">,</span> <span class="mi">400</span><span class="p">)</span>

                <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="n">pdict</span><span class="p">)</span> <span class="o">+</span> <span class="n">os</span><span class="o">.</span><span class="n">linesep</span><span class="p">)</span>

                <span class="k">for</span> <span class="n">BC</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;SS&quot;</span><span class="p">]:</span><span class="c1"># &quot;CC&quot;, &quot;FF&quot;]:</span>
                    <span class="n">pdict</span><span class="p">[</span><span class="s2">&quot;BC&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">BC</span>

                    <span class="n">a</span> <span class="o">=</span> <span class="n">SpecBeam</span><span class="p">(</span><span class="o">**</span><span class="n">pdict</span><span class="p">)</span>
                    <span class="n">a</span><span class="o">.</span><span class="n">calulate_qk</span><span class="p">(</span><span class="n">t</span><span class="o">=</span><span class="n">t</span><span class="p">)</span>

                    <span class="n">x</span> <span class="o">=</span> <span class="n">t</span>
                    <span class="n">y</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">wofx</span><span class="p">(</span><span class="n">x_norm</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">normalise_w</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

                    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;x=0.5, </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">vequals</span><span class="p">))</span>

                <span class="n">end_time1</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
                <span class="n">elapsed_time</span> <span class="o">=</span> <span class="p">(</span><span class="n">end_time1</span> <span class="o">-</span> <span class="n">start_time1</span><span class="p">);</span> <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Run time=</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">timedelta</span><span class="p">(</span><span class="n">seconds</span><span class="o">=</span><span class="n">elapsed_time</span><span class="p">))))</span>

                <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;Run time=</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">timedelta</span><span class="p">(</span><span class="n">seconds</span><span class="o">=</span><span class="n">elapsed_time</span><span class="p">)))</span> <span class="o">+</span> <span class="n">os</span><span class="o">.</span><span class="n">linesep</span><span class="p">)</span>

            <span class="n">leg</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
            <span class="n">leg</span><span class="o">.</span><span class="n">draggable</span><span class="p">()</span>

            <span class="n">end_time0</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
            <span class="n">elapsed_time</span> <span class="o">=</span> <span class="p">(</span><span class="n">end_time0</span> <span class="o">-</span> <span class="n">start_time0</span><span class="p">);</span> <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Total run time=</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">timedelta</span><span class="p">(</span><span class="n">seconds</span><span class="o">=</span><span class="n">elapsed_time</span><span class="p">))))</span>
            <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;Total run time=</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">timedelta</span><span class="p">(</span><span class="n">seconds</span><span class="o">=</span><span class="n">elapsed_time</span><span class="p">)))</span> <span class="o">+</span> <span class="n">os</span><span class="o">.</span><span class="n">linesep</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">ftime</span><span class="o">+</span><span class="s2">&quot;.pdf&quot;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>


    <span class="k">if</span> <span class="mi">0</span><span class="p">:</span>
        <span class="c1">#Journal paper figure, convergence with step change</span>
        <span class="n">FIGURE_convergence_step_change</span><span class="p">(</span><span class="n">v_nterms</span><span class="o">=</span><span class="p">(</span><span class="mi">50</span><span class="p">,</span><span class="mi">75</span><span class="p">,</span><span class="mi">150</span><span class="p">,</span><span class="mi">200</span><span class="p">),</span><span class="n">saveas</span><span class="o">=</span><span class="s2">&quot;convergence_step_change&quot;</span><span class="p">)</span><span class="c1">#75,150,200))</span>
    <span class="k">if</span> <span class="mi">0</span><span class="p">:</span>
        <span class="c1">#Journal paper figure, vary velocitiesconvergence with step change</span>
<span class="c1">#        FIGURE_convergence_step_change(v_nterms=(50,75,150),saveas=&quot;convergence_step_change&quot;)#75,150,200))</span>
        <span class="n">FIGURE_defl_envelope_vary_velocity</span><span class="p">(</span>
            <span class="n">velocities_norm</span><span class="o">=</span><span class="p">(</span><span class="mf">0.01165</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="mf">0.01165</span><span class="p">,</span> <span class="mf">0.01165</span><span class="o">*</span><span class="mi">2</span><span class="p">,</span> <span class="mf">0.01165</span><span class="o">*</span><span class="mi">4</span><span class="p">,</span> <span class="mf">0.01165</span><span class="o">*</span><span class="mi">10</span><span class="o">/</span><span class="mf">1.13</span><span class="p">),</span>
            <span class="n">saveas</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="n">nterms</span><span class="o">=</span><span class="mi">150</span><span class="p">,</span>
            <span class="n">nx</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span> <span class="n">nt</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span>
            <span class="n">force_calc</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>


    <span class="k">if</span> <span class="mi">0</span><span class="p">:</span>
        <span class="c1">#Journal paper figure, length of transition zone</span>
        <span class="n">FIGURE_DAF_transition_length</span><span class="p">(</span><span class="n">saveas</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">k_ratio</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span><span class="n">beta</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span><span class="n">nterms</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span><span class="n">force_calc</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">if</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">FIGURE_DAF_transition_length_esveld</span><span class="p">(</span><span class="n">saveas</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">k_ratio</span><span class="o">=</span><span class="mi">40</span><span class="p">,</span><span class="n">beta</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span><span class="n">nterms</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span><span class="n">force_calc</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">if</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">betas</span><span class="o">=</span><span class="p">[</span><span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">1.3</span><span class="p">]</span>
        <span class="n">kratios</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">20</span><span class="p">,</span><span class="mi">100</span><span class="p">,</span><span class="mi">1000</span><span class="p">,</span><span class="mi">10000</span><span class="p">]</span>

        <span class="n">betas</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mf">1.3</span><span class="p">]</span>
        <span class="n">kratios</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">20</span><span class="p">,</span><span class="mi">100</span><span class="p">,</span><span class="mi">1000</span><span class="p">,</span><span class="mi">10000</span><span class="p">]</span>

<span class="c1">#        betas=[0.05]</span>
<span class="c1">#        kratios=[40]</span>

        <span class="k">for</span> <span class="n">beta</span> <span class="ow">in</span> <span class="n">betas</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">kratio</span> <span class="ow">in</span> <span class="n">kratios</span><span class="p">:</span>
                <span class="n">saveas</span><span class="o">=</span><span class="s2">&quot;DAFwrtinf_t_len_bet</span><span class="si">{}</span><span class="s2">_krat</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">beta</span><span class="p">,</span><span class="n">kratio</span><span class="p">)</span>
<span class="c1">#                saveas=None</span>
                <span class="n">FIGURE_DAFwrtinf_transition_length</span><span class="p">(</span>
                    <span class="n">saveas</span><span class="o">=</span><span class="n">saveas</span><span class="p">,</span><span class="n">k_ratio</span><span class="o">=</span><span class="n">kratio</span><span class="p">,</span><span class="n">beta</span><span class="o">=</span><span class="n">beta</span><span class="p">,</span><span class="n">nterms</span><span class="o">=</span><span class="mi">150</span><span class="p">,</span><span class="n">force_calc</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

    <span class="k">if</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">betas</span><span class="o">=</span><span class="p">[</span><span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">1.3</span><span class="p">]</span>
        <span class="n">kratios</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">20</span><span class="p">,</span><span class="mi">100</span><span class="p">,</span><span class="mi">1000</span><span class="p">,</span><span class="mi">10000</span><span class="p">]</span>

        <span class="n">betas</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mf">1.3</span><span class="p">]</span>
<span class="c1">#        kratios=[1,2,5,10,20,100,1000,10000]</span>

<span class="c1">#        betas=[0.05]</span>
<span class="c1">#        kratios=[40]</span>

        <span class="k">for</span> <span class="n">beta</span> <span class="ow">in</span> <span class="n">betas</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">kratio</span> <span class="ow">in</span> <span class="n">kratios</span><span class="p">:</span>
                <span class="n">saveas</span><span class="o">=</span><span class="s2">&quot;revDAFwrtinf_t_len_bet</span><span class="si">{}</span><span class="s2">_krat</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">beta</span><span class="p">,</span><span class="n">kratio</span><span class="p">)</span>
<span class="c1">#                saveas=None</span>
                <span class="n">FIGURE_DAFwrtinf_transition_lengthrev</span><span class="p">(</span>
                    <span class="n">saveas</span><span class="o">=</span><span class="n">saveas</span><span class="p">,</span><span class="n">k_ratio</span><span class="o">=</span><span class="n">kratio</span><span class="p">,</span><span class="n">beta</span><span class="o">=</span><span class="n">beta</span><span class="p">,</span><span class="n">nterms</span><span class="o">=</span><span class="mi">150</span><span class="p">,</span><span class="n">force_calc</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

</pre></div>

          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2014, Rohan Walker.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 1.7.4</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.10</a>
      
    </div>

    

    
  </body>
</html>