
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>geotecha.inputoutput.inputoutput &#8212; geotecha 0.2.1 documentation</title>
    <link rel="stylesheet" href="../../../_static/default.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    <script type="text/javascript" src="../../../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../../_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
   
  <link rel="stylesheet" href="../../../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>

<div style="background-color: white; text-align: left; padding: 10px 10px 15px 15px">
<a href="../../../index.html"><img src="../../../_static/logo.png" border="0" alt="py4sci"/></a>
</div>



      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper"><div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../../../index.html">Documentation overview</a><ul>
  <li><a href="../../index.html">Module code</a><ul>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <h1>Source code for geotecha.inputoutput.inputoutput</h1><div class="highlight"><pre>
<span></span><span class="c1"># geotecha - A software suite for geotechncial engineering</span>
<span class="c1"># Copyright (C) 2018  Rohan T. Walker (rtrwalker@gmail.com)</span>
<span class="c1">#</span>
<span class="c1"># This program is free software: you can redistribute it and/or modify</span>
<span class="c1"># it under the terms of the GNU General Public License as published by</span>
<span class="c1"># the Free Software Foundation, either version 3 of the License, or</span>
<span class="c1"># (at your option) any later version.</span>
<span class="c1">#</span>
<span class="c1"># This program is distributed in the hope that it will be useful,</span>
<span class="c1"># but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<span class="c1"># MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span>
<span class="c1"># GNU General Public License for more details.</span>
<span class="c1">#</span>
<span class="c1"># You should have received a copy of the GNU General Public License</span>
<span class="c1"># along with this program.  If not, see http://www.gnu.org/licenses/gpl.html.</span>

<span class="sd">&quot;&quot;&quot;Input/output operations,attribute checking, proccess input files that</span>
<span class="sd">have python syntax.</span>

<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">from</span> <span class="nn">__future__</span> <span class="k">import</span> <span class="n">division</span><span class="p">,</span> <span class="n">print_function</span>
<span class="k">try</span><span class="p">:</span>
    <span class="c1">#py27</span>
    <span class="kn">import</span> <span class="nn">__builtin__</span>
<span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
    <span class="c1">#py34</span>
    <span class="kn">import</span> <span class="nn">builtins</span> <span class="k">as</span> <span class="nn">__builtin__</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">ast</span>
<span class="kn">import</span> <span class="nn">imp</span>
<span class="kn">import</span> <span class="nn">textwrap</span>
<span class="kn">import</span> <span class="nn">inspect</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">geotecha.piecewise.piecewise_linear_1d</span> <span class="k">import</span> <span class="n">PolyLine</span>
<span class="kn">from</span> <span class="nn">sympy.printing.fcode</span> <span class="k">import</span> <span class="n">FCodePrinter</span>
<span class="kn">import</span> <span class="nn">multiprocessing</span>
<span class="kn">import</span> <span class="nn">time</span>
<span class="k">try</span><span class="p">:</span>
    <span class="c1">#py27</span>
    <span class="kn">from</span> <span class="nn">StringIO</span> <span class="k">import</span> <span class="n">StringIO</span>
<span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
    <span class="c1">#py34</span>
    <span class="kn">from</span> <span class="nn">io</span> <span class="k">import</span> <span class="n">StringIO</span>
<span class="kn">import</span> <span class="nn">re</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">time</span>
<span class="kn">import</span> <span class="nn">time</span>
<span class="kn">from</span> <span class="nn">datetime</span>  <span class="k">import</span> <span class="n">timedelta</span>
<span class="kn">import</span> <span class="nn">fnmatch</span>
<span class="kn">import</span> <span class="nn">argparse</span>
<span class="kn">import</span> <span class="nn">logging</span>
<span class="kn">from</span> <span class="nn">contextlib</span> <span class="k">import</span> <span class="n">contextmanager</span>
<span class="kn">import</span> <span class="nn">pkg_resources</span>
<span class="kn">from</span> <span class="nn">geotecha.plotting.one_d</span> <span class="k">import</span> <span class="n">copy_dict</span>
<span class="kn">import</span> <span class="nn">pkgutil</span>
<span class="kn">import</span> <span class="nn">importlib</span>


<div class="viewcode-block" id="SyntaxChecker"><a class="viewcode-back" href="../../../api/geotecha.inputoutput.inputoutput.html#geotecha.inputoutput.inputoutput.SyntaxChecker">[docs]</a><span class="k">class</span> <span class="nc">SyntaxChecker</span><span class="p">(</span><span class="n">ast</span><span class="o">.</span><span class="n">NodeVisitor</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Check if a string contains only allowabel python syntax</span>


<span class="sd">    `SyntaxChecker` provides functionality to check syntax of string using the</span>
<span class="sd">    ast module.  Basically white-list allowable functions and attributes.  A</span>
<span class="sd">    SyntaxError will be raised if any code is found that is not allowed.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    allow : list of str</span>
<span class="sd">        List of SyntaxChecker &#39;allow&#39; methods to call. Default = [].</span>
<span class="sd">        e.g. allow=[&#39;ast&#39;, &#39;numpy&#39;] will call SyntaxChecker.allow_ast(),</span>
<span class="sd">        SyntaxChecker.allow_numpy()</span>

<span class="sd">    Attributes</span>
<span class="sd">    ----------</span>
<span class="sd">    allowed_functions : dict</span>
<span class="sd">        A dictionary of allowable functions. e.g. allowed_functions[&#39;cos&#39;] =</span>
<span class="sd">        math.cos would permit the use of &#39;cos&#39; from the math module.</span>
<span class="sd">        allowed_functions[&#39;math&#39;] = math would allow use of the math</span>
<span class="sd">        module (note to allow things like &#39;math.sin&#39; you would also have to</span>
<span class="sd">        add &#39;sin&#39; to the allowable_attributes).  Adding functions one by one</span>
<span class="sd">        can be cumbersome; see the &#39;allow_&lt;some_name&gt;&#39; methods for bulk adding</span>
<span class="sd">        of common functionality.</span>
<span class="sd">    allowed_node_types : dict</span>
<span class="sd">        Dictionary of allowable ast node names.</span>
<span class="sd">        e.g. allowed_node_types[&#39;Name&#39;] = ast.Name would allow ast.Name nodes.</span>
<span class="sd">        typically use SytaxChecker.allow_ast to allow a reasonable set of ast</span>
<span class="sd">        nodes</span>
<span class="sd">    allowed_attributes : set of string</span>
<span class="sd">        set of allowable attributes.  e.g. you have already allowed the math</span>
<span class="sd">        module with allowed_functions[&#39;math&#39;] = math.</span>
<span class="sd">        allowable_attributes.add(&#39;tan&#39;) will allow use of math.tan(34) etc.</span>
<span class="sd">        Note that the attribute &#39;tan&#39; could now be used as an attribute for</span>
<span class="sd">        any of the functions in allowed_functions even though this may not</span>
<span class="sd">        make any logical sense.  i.e. it will pass the SyntaxChecker but would</span>
<span class="sd">        fail if the code was executed. Adding attributes one by one</span>
<span class="sd">        can be cumbersome; see the &#39;allow_&lt;some_name&gt;&#39; methods for bulk adding</span>
<span class="sd">        of common functionality.</span>
<span class="sd">    safe_names : dict</span>
<span class="sd">        Dictionary of safe names.</span>
<span class="sd">        Default safe_names={&#39;True&#39;: True, &#39;False&#39;: False, &#39;None&#39;: None}.</span>
<span class="sd">    print_each_node : bool</span>
<span class="sd">        Print out each node when they are visited.</span>
<span class="sd">        Default print_each_node=False. Note that</span>
<span class="sd">        nodes may be printed twice, once for a generic visit and once for a</span>
<span class="sd">        specific visit such as visit_Name, visit_Attribute etc.</span>

<span class="sd">    Methods</span>
<span class="sd">    -------</span>
<span class="sd">    allow_ast</span>
<span class="sd">        Allow a subset of ast node types.</span>
<span class="sd">    allow_builtin</span>
<span class="sd">        Allow a subset of __builtins__ functions.</span>
<span class="sd">    allow_numpy</span>
<span class="sd">        Allow a subset of numpy functionality via np.funtion syntax.</span>
<span class="sd">    allow_PolyLine</span>
<span class="sd">        Allow PolyLine class from geotecha.piecewise.piecewise_linear_1d.</span>

<span class="sd">    See Also</span>
<span class="sd">    --------</span>
<span class="sd">    ast.NodeVisitor : Parent class.  Descriptions of python syntax grammar.</span>
<span class="sd">    object_members : Easily print a string of an objects routines for use in</span>
<span class="sd">        a &#39;allow_&lt;some_name&gt;&#39; method.</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    If subclassing new &#39;allow_&lt;some_name&gt;&#39; methods can be written to bulk add</span>
<span class="sd">    allowable functions and attributes.</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; syntax_checker = SyntaxChecker(allow=[&#39;ast&#39;, &#39;builtin&#39;, &#39;numpy&#39;])</span>
<span class="sd">    &gt;&gt;&gt; tree = ast.parse(&#39;a=np.cos(0.5)&#39;, mode=&#39;exec&#39;)</span>
<span class="sd">    &gt;&gt;&gt; syntax_checker.visit(tree)</span>

<span class="sd">    &gt;&gt;&gt; syntax_checker = SyntaxChecker(allow=[&#39;ast&#39;, &#39;builtin&#39;, &#39;numpy&#39;])</span>
<span class="sd">    &gt;&gt;&gt; tree = ast.parse(&#39;a=cos(0.5)&#39;, mode=&#39;exec&#39;)</span>
<span class="sd">    &gt;&gt;&gt; syntax_checker.visit(tree)</span>
<span class="sd">    Traceback (most recent call last):</span>
<span class="sd">        ...</span>
<span class="sd">    SyntaxError: cos is not an allowed function!</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1">#resources that helped in making this:</span>
    <span class="c1">#http://stackoverflow.com/questions/1515357/simple-example-of-how-to-use-ast-nodevisitor</span>
    <span class="c1">#http://stackoverflow.com/questions/10661079/restricting-pythons-syntax-to-execute-user-code-safely-is-this-a-safe-approach</span>
    <span class="c1">#http://stackoverflow.com/questions/12523516/using-ast-and-whitelists-to-make-pythons-eval-safe</span>
    <span class="c1">#http://docs.python.org/2/library/ast.html#abstract-grammar</span>
    <span class="c1">#http://eli.thegreenplace.net/2009/11/28/python-internals-working-with-python-asts/</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">allow</span><span class="o">=</span><span class="p">[]):</span>
        <span class="sd">&quot;&quot;&quot;Initialize a SyntaxChecker object&quot;&quot;&quot;</span>

        <span class="c1">#super(SyntaxChecker, self).__init__() # not sure if I need this</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">allowed_functions</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">allowed_node_types</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">allowed_attributes</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">safe_names</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;True&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span> <span class="s1">&#39;False&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span> <span class="s1">&#39;None&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">}</span><span class="c1">#dict()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">print_each_node</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">allow</span><span class="p">:</span>
            <span class="n">s</span> <span class="o">=</span> <span class="s1">&#39;allow_</span><span class="si">{0}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">s</span><span class="p">):</span>
                <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">s</span><span class="p">)()</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span><span class="s2">&quot;&#39;SyntaxChecker&#39; object has no attribute &quot;</span>
            <span class="s2">&quot;&#39;</span><span class="si">{0}</span><span class="s2">&#39;. i.e. &#39;</span><span class="si">{1}</span><span class="s2">&#39; is not a valid member &quot;</span>
            <span class="s2">&quot;of the allow list&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">s</span><span class="p">,</span><span class="n">v</span><span class="p">))</span>

<div class="viewcode-block" id="SyntaxChecker.visit_Call"><a class="viewcode-back" href="../../../api/geotecha.inputoutput.inputoutput.html#geotecha.inputoutput.inputoutput.SyntaxChecker.visit_Call">[docs]</a>    <span class="k">def</span> <span class="nf">visit_Call</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Custom visit a &#39;Call&#39; node&quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">print_each_node</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;CALL:&#39;</span><span class="p">,</span> <span class="n">ast</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">node</span><span class="p">))</span>

        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">node</span><span class="o">.</span><span class="n">func</span><span class="p">,</span><span class="s1">&#39;id&#39;</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">node</span><span class="o">.</span><span class="n">func</span><span class="o">.</span><span class="n">id</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">allowed_functions</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">SyntaxError</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2"> is not an allowed function!&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">node</span><span class="o">.</span><span class="n">func</span><span class="o">.</span><span class="n">id</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">ast</span><span class="o">.</span><span class="n">NodeVisitor</span><span class="o">.</span><span class="n">generic_visit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">ast</span><span class="o">.</span><span class="n">NodeVisitor</span><span class="o">.</span><span class="n">generic_visit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node</span><span class="p">)</span></div>


<div class="viewcode-block" id="SyntaxChecker.visit_Name"><a class="viewcode-back" href="../../../api/geotecha.inputoutput.inputoutput.html#geotecha.inputoutput.inputoutput.SyntaxChecker.visit_Name">[docs]</a>    <span class="k">def</span> <span class="nf">visit_Name</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Custom visit a &#39;Name&#39; node&quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">print_each_node</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;NAME: &#39;</span><span class="p">,</span> <span class="n">ast</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">node</span><span class="p">))</span>

        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">node</span><span class="o">.</span><span class="n">ctx</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="o">==</span><span class="s1">&#39;Store&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">allowed_attributes</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">node</span><span class="o">.</span><span class="n">id</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">type</span><span class="p">(</span><span class="n">node</span><span class="o">.</span><span class="n">ctx</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="o">==</span><span class="s1">&#39;Load&#39;</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">node</span><span class="o">.</span><span class="n">id</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">safe_names</span> <span class="ow">and</span> <span class="n">node</span><span class="o">.</span><span class="n">id</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">allowed_functions</span> <span class="ow">and</span> <span class="n">node</span><span class="o">.</span><span class="n">id</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">allowed_attributes</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">SyntaxError</span><span class="p">(</span><span class="s2">&quot;cannot use </span><span class="si">{}</span><span class="s2"> as name, function, or attribute!&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">node</span><span class="o">.</span><span class="n">id</span><span class="p">))</span>
                <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">ast</span><span class="o">.</span><span class="n">NodeVisitor</span><span class="o">.</span><span class="n">generic_visit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node</span><span class="p">)</span><span class="c1">#</span></div>

<div class="viewcode-block" id="SyntaxChecker.visit_Attribute"><a class="viewcode-back" href="../../../api/geotecha.inputoutput.inputoutput.html#geotecha.inputoutput.inputoutput.SyntaxChecker.visit_Attribute">[docs]</a>    <span class="k">def</span> <span class="nf">visit_Attribute</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Custom visit an &#39;Attribute&#39; node&quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">print_each_node</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;ATTRIBUTE:&#39;</span><span class="p">,</span> <span class="n">ast</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">node</span><span class="p">))</span>

        <span class="k">if</span> <span class="n">node</span><span class="o">.</span><span class="n">attr</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">allowed_functions</span> <span class="ow">and</span> <span class="n">node</span><span class="o">.</span><span class="n">attr</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">allowed_attributes</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">SyntaxError</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2"> is not an allowed attribute!&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">node</span><span class="o">.</span><span class="n">attr</span><span class="p">))</span>
            <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">ast</span><span class="o">.</span><span class="n">NodeVisitor</span><span class="o">.</span><span class="n">generic_visit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node</span><span class="p">)</span></div>

<div class="viewcode-block" id="SyntaxChecker.generic_visit"><a class="viewcode-back" href="../../../api/geotecha.inputoutput.inputoutput.html#geotecha.inputoutput.inputoutput.SyntaxChecker.generic_visit">[docs]</a>    <span class="k">def</span> <span class="nf">generic_visit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Custom visit a generic node&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">print_each_node</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;GENERIC: &#39;</span><span class="p">,</span> <span class="n">ast</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">node</span><span class="p">))</span>

        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">node</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">allowed_node_types</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">SyntaxError</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2"> is not allowed!&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">node</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="p">))</span>
            <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">ast</span><span class="o">.</span><span class="n">NodeVisitor</span><span class="o">.</span><span class="n">generic_visit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node</span><span class="p">)</span></div>

    <span class="k">def</span> <span class="nf">_split_string_allow</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">add_to</span><span class="o">=</span><span class="s1">&#39;attributes&#39;</span><span class="p">,</span> <span class="n">fn_module</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Split a string and add items to allowed lists</span>

<span class="sd">        Adds items to self.allowed_attributes or self.allowed_functions</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        s : str</span>
<span class="sd">            String containing items to allow.</span>
<span class="sd">        add_to : [&#39;attributes&#39;, &#39;functions&#39;]</span>
<span class="sd">            If add_to=&#39;attributes&#39; items will be added to</span>
<span class="sd">            self.allowed_attributes.  If add_to=&#39;functions&#39; the items will be</span>
<span class="sd">            added to self.allowed_functions.</span>
<span class="sd">        fn_module : module</span>
<span class="sd">            Module where functions are stored.  Only used when</span>
<span class="sd">            add_to=&#39;functions&#39;.</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">in_list</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;attributes&#39;</span><span class="p">,</span><span class="s1">&#39;functions&#39;</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">add_to</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">in_list</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;add_to cannot be </span><span class="si">{}</span><span class="s1">.  It must be one of &#39;</span>
                <span class="s1">&#39;[</span><span class="si">{}</span><span class="s1">]&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">&quot;&#39;</span><span class="si">{}</span><span class="s2">&#39;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">add_to</span><span class="p">),</span>
                <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="s2">&quot;&#39;</span><span class="si">{}</span><span class="s2">&#39;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">in_list</span><span class="p">])))</span>
        <span class="k">if</span> <span class="n">add_to</span><span class="o">==</span><span class="s1">&#39;functions&#39;</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="p">[</span><span class="n">a</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">s</span><span class="o">.</span><span class="n">split</span><span class="p">()</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">a</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;#&#39;</span><span class="p">)]:</span>
                <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">fn_module</span><span class="p">,</span> <span class="n">v</span><span class="p">):</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">allowed_functions</span><span class="p">[</span><span class="n">v</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">fn_module</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span>
            <span class="k">return</span>
        <span class="k">if</span> <span class="n">add_to</span><span class="o">==</span><span class="s1">&#39;attributes&#39;</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="p">[</span><span class="n">a</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">s</span><span class="o">.</span><span class="n">split</span><span class="p">()</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">a</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;#&#39;</span><span class="p">)]:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">allowed_attributes</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>

        <span class="k">return</span>

<div class="viewcode-block" id="SyntaxChecker.allow_ast"><a class="viewcode-back" href="../../../api/geotecha.inputoutput.inputoutput.html#geotecha.inputoutput.inputoutput.SyntaxChecker.allow_ast">[docs]</a>    <span class="k">def</span> <span class="nf">allow_ast</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Allow subset of ast node types&quot;&quot;&quot;</span>

        <span class="c1">#py27</span>
        <span class="c1">#object_members(ast, &#39;class&#39;)</span>
        <span class="n">s</span><span class="o">=</span><span class="n">textwrap</span><span class="o">.</span><span class="n">dedent</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span><span class="se">\</span>
<span class="s2">            #py27</span>
<span class="s2">            #AST Add And Assert Assign Attribute AugAssign AugLoad</span>
<span class="s2">            AugStore BinOp BitAnd BitOr BitXor BoolOp Break Call</span>
<span class="s2">            #ClassDef Compare Continue Del Delete Dict DictComp Div</span>
<span class="s2">            Ellipsis Eq ExceptHandler #Exec Expr Expression ExtSlice</span>
<span class="s2">            FloorDiv For FunctionDef GeneratorExp Global Gt GtE If</span>
<span class="s2">            IfExp #Import #ImportFrom In Index Interactive Invert Is</span>
<span class="s2">            IsNot LShift Lambda List ListComp Load Lt LtE Mod Module</span>
<span class="s2">            Mult Name #NodeTransformer #NodeVisitor Not NotEq NotIn Num</span>
<span class="s2">            Or Param Pass Pow Print RShift Raise Repr Return Set</span>
<span class="s2">            SetComp Slice Store Str Sub Subscript Suite TryExcept</span>
<span class="s2">            TryFinally Tuple UAdd USub UnaryOp While With Yield #alias</span>
<span class="s2">            arguments boolop #cmpop comprehension #excepthandler #expr</span>
<span class="s2">            #expr_context keyword #mod #operator slice #stmt #unaryop</span>

<span class="s2">            #py34_addtional</span>
<span class="s2">            Bytes NameConstant #Nonlocal Starred Try YieldFrom arg</span>
<span class="s2">            withitem</span>
<span class="s2">            &quot;&quot;&quot;</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="p">[</span><span class="n">a</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">s</span><span class="o">.</span><span class="n">split</span><span class="p">()</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">a</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;#&#39;</span><span class="p">)]:</span>
            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">ast</span><span class="p">,</span><span class="n">v</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">allowed_node_types</span><span class="p">[</span><span class="n">v</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">ast</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span>

        <span class="k">return</span></div>

<div class="viewcode-block" id="SyntaxChecker.allow_builtin"><a class="viewcode-back" href="../../../api/geotecha.inputoutput.inputoutput.html#geotecha.inputoutput.inputoutput.SyntaxChecker.allow_builtin">[docs]</a>    <span class="k">def</span> <span class="nf">allow_builtin</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Allow subset of __builtins__ functions&quot;&quot;&quot;</span>

        <span class="c1">#object_members(__builtin__ , &#39;routine&#39;)</span>
        <span class="n">s</span><span class="o">=</span><span class="n">textwrap</span><span class="o">.</span><span class="n">dedent</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span><span class="se">\</span>
<span class="s2">            #py27</span>
<span class="s2">            #__import__ abs all any apply bin #callable chr cmp</span>
<span class="s2">            #coerce compile #debugfile #delattr #dir divmod #eval</span>
<span class="s2">            #evalsc #execfile filter format #getattr #globals hasattr</span>
<span class="s2">            #hash hex id input #intern isinstance issubclass iter</span>
<span class="s2">            len locals map max min next oct #open #open_in_spyder</span>
<span class="s2">            ord pow print range raw_input reduce #reload repr</span>
<span class="s2">            round #runfile #setattr sorted sum unichr #vars zip</span>

<span class="s2">            #py34_addtional</span>
<span class="s2">            #__build_class__ ascii #exec repr</span>
<span class="s2">            &quot;&quot;&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_split_string_allow</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">add_to</span><span class="o">=</span><span class="s1">&#39;functions&#39;</span><span class="p">,</span> <span class="n">fn_module</span><span class="o">=</span><span class="n">__builtin__</span><span class="p">)</span>

        <span class="c1">#object_members(__builtin__ , &#39;class&#39;)</span>
        <span class="n">s</span><span class="o">=</span><span class="n">textwrap</span><span class="o">.</span><span class="n">dedent</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span><span class="se">\</span>
<span class="s2">            #py27</span>
<span class="s2">            basestring bool #buffer bytearray bytes #classmethod</span>
<span class="s2">            complex dict enumerate #file float frozenset int list</span>
<span class="s2">            long #memoryview #object #property reversed set slice</span>
<span class="s2">            #staticmethod str super tuple type unicode xrange</span>

<span class="s2">            #py34_addtional</span>
<span class="s2">            #__loader__ filter map range reversed zip</span>
<span class="s2">            &quot;&quot;&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_split_string_allow</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">add_to</span><span class="o">=</span><span class="s1">&#39;functions&#39;</span><span class="p">,</span><span class="n">fn_module</span><span class="o">=</span><span class="n">__builtin__</span><span class="p">)</span>

        <span class="c1">#object_members(complex , &#39;routine&#39;)</span>
        <span class="n">s</span><span class="o">=</span><span class="n">textwrap</span><span class="o">.</span><span class="n">dedent</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span><span class="se">\</span>
<span class="s2">            #py27</span>
<span class="s2">            conjugate</span>

<span class="s2">            #py34_addtional</span>
<span class="s2">            &quot;&quot;&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_split_string_allow</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">add_to</span><span class="o">=</span><span class="s1">&#39;attributes&#39;</span><span class="p">)</span>

        <span class="c1">#object_members(dict , &#39;routine&#39;)</span>
        <span class="n">s</span><span class="o">=</span><span class="n">textwrap</span><span class="o">.</span><span class="n">dedent</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span><span class="se">\</span>
<span class="s2">            #py27</span>
<span class="s2">            copy fromkeys get has_key items iteritems iterkeys</span>
<span class="s2">            itervalues keys pop popitem setdefault update values</span>
<span class="s2">            viewitems viewkeys viewvalues</span>

<span class="s2">            #py34_addtional</span>
<span class="s2">            clear</span>
<span class="s2">            &quot;&quot;&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_split_string_allow</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">add_to</span><span class="o">=</span><span class="s1">&#39;attributes&#39;</span><span class="p">)</span>

        <span class="c1">#object_members(list , &#39;routine&#39;)</span>
        <span class="n">s</span><span class="o">=</span><span class="n">textwrap</span><span class="o">.</span><span class="n">dedent</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">            #py27</span>
<span class="s2">            append count extend index</span>
<span class="s2">            insert pop remove reverse sort</span>

<span class="s2">            #py34_addtional</span>
<span class="s2">            clear copy</span>
<span class="s2">            &quot;&quot;&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_split_string_allow</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">add_to</span><span class="o">=</span><span class="s1">&#39;attributes&#39;</span><span class="p">)</span>

        <span class="c1">#object_members(str , &#39;routine&#39;)</span>
        <span class="n">s</span><span class="o">=</span><span class="n">textwrap</span><span class="o">.</span><span class="n">dedent</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">            #py27</span>
<span class="s2">            capitalize center count decode encode endswith</span>
<span class="s2">            expandtabs find format index isalnum isalpha isdigit</span>
<span class="s2">            islower isspace istitle isupper join ljust lower</span>
<span class="s2">            lstrip partition replace rfind rindex rjust</span>
<span class="s2">            rpartition rsplit rstrip split splitlines startswith</span>
<span class="s2">            strip swapcase title translate upper zfill</span>

<span class="s2">            #py34_addtional</span>
<span class="s2">            casefold format_map isdecimal isidentifier</span>
<span class="s2">            isnumeric isprintable isspace maketrans</span>
<span class="s2">            &quot;&quot;&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_split_string_allow</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">add_to</span><span class="o">=</span><span class="s1">&#39;attributes&#39;</span><span class="p">)</span>

        <span class="c1">#object_members(float , &#39;routine&#39;)</span>
        <span class="n">s</span><span class="o">=</span><span class="n">textwrap</span><span class="o">.</span><span class="n">dedent</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">            #py27</span>
<span class="s2">            as_integer_ratio conjugate fromhex hex</span>
<span class="s2">            is_integer</span>

<span class="s2">            #py34_addtional</span>
<span class="s2">            &quot;&quot;&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_split_string_allow</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">add_to</span><span class="o">=</span><span class="s1">&#39;attributes&#39;</span><span class="p">)</span>

        <span class="c1">#object_members(set , &#39;routine&#39;)</span>
        <span class="n">s</span><span class="o">=</span><span class="n">textwrap</span><span class="o">.</span><span class="n">dedent</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">            #py27</span>
<span class="s2">            add clear copy difference</span>
<span class="s2">            difference_update discard intersection</span>
<span class="s2">            intersection_update isdisjoint issubset issuperset</span>
<span class="s2">            pop remove symmetric_difference</span>
<span class="s2">            symmetric_difference_update union update</span>

<span class="s2">            #py34_addtional</span>
<span class="s2">            &quot;&quot;&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_split_string_allow</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">add_to</span><span class="o">=</span><span class="s1">&#39;attributes&#39;</span><span class="p">)</span>

        <span class="c1">#object_members(slice , &#39;routine&#39;)</span>
        <span class="n">s</span><span class="o">=</span><span class="n">textwrap</span><span class="o">.</span><span class="n">dedent</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">            #py27</span>
<span class="s2">            indices</span>

<span class="s2">            #py34_addtional</span>
<span class="s2">            &quot;&quot;&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_split_string_allow</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">add_to</span><span class="o">=</span><span class="s1">&#39;attributes&#39;</span><span class="p">)</span>


        <span class="k">return</span></div>

<div class="viewcode-block" id="SyntaxChecker.allow_numpy"><a class="viewcode-back" href="../../../api/geotecha.inputoutput.inputoutput.html#geotecha.inputoutput.inputoutput.SyntaxChecker.allow_numpy">[docs]</a>    <span class="k">def</span> <span class="nf">allow_numpy</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Allow a subset of numpy functionality via np.attribute syntax&quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">allowed_functions</span><span class="p">[</span><span class="s1">&#39;np&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">allowed_functions</span><span class="p">[</span><span class="s1">&#39;numpy&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span>

        <span class="c1">#object_members(np , &#39;routine&#39;)</span>
        <span class="n">s</span><span class="o">=</span><span class="n">textwrap</span><span class="o">.</span><span class="n">dedent</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">            #numpy_v_1_9_0</span>
<span class="s2">            add_docstring add_newdoc add_newdoc_ufunc alen all allclose</span>
<span class="s2">            alltrue alterdot amax amin angle any append apply_along_axis</span>
<span class="s2">            apply_over_axes arange argmax argmin argpartition argsort</span>
<span class="s2">            argwhere around array array2string array_equal array_equiv</span>
<span class="s2">            array_repr array_split array_str asanyarray asarray</span>
<span class="s2">            asarray_chkfinite ascontiguousarray asfarray asfortranarray</span>
<span class="s2">            asmatrix asscalar atleast_1d atleast_2d atleast_3d average</span>
<span class="s2">            bartlett base_repr bench binary_repr bincount blackman bmat</span>
<span class="s2">            broadcast_arrays busday_count busday_offset byte_bounds can_cast</span>
<span class="s2">            choose clip column_stack common_type compare_chararrays compress</span>
<span class="s2">            concatenate convolve copy copyto corrcoef correlate count_nonzero</span>
<span class="s2">            cov cross cumprod cumproduct cumsum datetime_as_string</span>
<span class="s2">            datetime_data delete deprecate deprecate_with_doc diag</span>
<span class="s2">            diag_indices diag_indices_from diagflat diagonal diff digitize</span>
<span class="s2">            disp dot dsplit dstack ediff1d einsum empty empty_like</span>
<span class="s2">            expand_dims extract eye fastCopyAndTranspose fill_diagonal</span>
<span class="s2">            find_common_type fix flatnonzero fliplr flipud frombuffer</span>
<span class="s2">            fromfile fromfunction fromiter frompyfunc fromregex fromstring</span>
<span class="s2">            full full_like fv genfromtxt get_array_wrap get_include</span>
<span class="s2">            get_printoptions getbuffer getbufsize geterr geterrcall geterrobj</span>
<span class="s2">            gradient hamming hanning histogram histogram2d histogramdd hsplit</span>
<span class="s2">            hstack i0 identity imag in1d indices info inner insert</span>
<span class="s2">            int_asbuffer interp intersect1d ipmt irr is_busday isclose</span>
<span class="s2">            iscomplex iscomplexobj isfortran isneginf isposinf isreal</span>
<span class="s2">            isrealobj isscalar issctype issubclass_ issubdtype issubsctype</span>
<span class="s2">            iterable ix_ kaiser kron lexsort linspace load loads loadtxt</span>
<span class="s2">            logspace lookfor mafromtxt mask_indices mat max maximum_sctype</span>
<span class="s2">            may_share_memory mean median meshgrid min min_scalar_type</span>
<span class="s2">            mintypecode mirr msort nan_to_num nanargmax nanargmin nanmax</span>
<span class="s2">            nanmean nanmedian nanmin nanpercentile nanstd nansum nanvar</span>
<span class="s2">            ndfromtxt ndim nested_iters newbuffer nonzero nper npv obj2sctype</span>
<span class="s2">            ones ones_like outer packbits pad partition percentile piecewise</span>
<span class="s2">            pkgload place pmt poly polyadd polyder polydiv polyfit polyint</span>
<span class="s2">            polymul polysub polyval ppmt prod product promote_types ptp put</span>
<span class="s2">            putmask pv rank rate ravel ravel_multi_index real real_if_close</span>
<span class="s2">            recfromcsv recfromtxt repeat require reshape resize restoredot</span>
<span class="s2">            result_type roll rollaxis roots rot90 round round_ row_stack</span>
<span class="s2">            safe_eval save savetxt savez savez_compressed sctype2char</span>
<span class="s2">            searchsorted select set_numeric_ops set_printoptions</span>
<span class="s2">            set_string_function setbufsize setdiff1d seterr seterrcall</span>
<span class="s2">            seterrobj setxor1d shape show_config sinc size sometrue sort</span>
<span class="s2">            sort_complex source split squeeze std sum swapaxes take tensordot</span>
<span class="s2">            test tile trace transpose trapz tri tril tril_indices</span>
<span class="s2">            tril_indices_from trim_zeros triu triu_indices triu_indices_from</span>
<span class="s2">            typename union1d unique unpackbits unravel_index unwrap vander</span>
<span class="s2">            var vdot vsplit vstack where who zeros zeros_like pi</span>
<span class="s2">            &quot;&quot;&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_split_string_allow</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">add_to</span><span class="o">=</span><span class="s1">&#39;attributes&#39;</span><span class="p">)</span>

        <span class="c1">#object_members(np.ndarray , &#39;routine&#39;)</span>
        <span class="n">s</span><span class="o">=</span><span class="n">textwrap</span><span class="o">.</span><span class="n">dedent</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">            #numpy_v_1_9_0</span>
<span class="s2">            all any argmax argmin argpartition argsort astype byteswap choose</span>
<span class="s2">            clip compress conj conjugate copy cumprod cumsum diagonal dot</span>
<span class="s2">            dump dumps fill flatten getfield item itemset max mean min</span>
<span class="s2">            newbyteorder nonzero partition prod ptp put ravel repeat reshape</span>
<span class="s2">            resize round searchsorted setfield setflags sort squeeze std sum</span>
<span class="s2">            swapaxes take tobytes tofile tolist tostring trace transpose var</span>
<span class="s2">            view</span>
<span class="s2">            &quot;&quot;&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_split_string_allow</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">add_to</span><span class="o">=</span><span class="s1">&#39;attributes&#39;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">allowed_attributes</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s1">&#39;math&#39;</span><span class="p">)</span>
        <span class="c1">#object_members(np.math,&#39;routine&#39;)</span>
        <span class="n">s</span><span class="o">=</span><span class="n">textwrap</span><span class="o">.</span><span class="n">dedent</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">            #numpy_v_1_9_0</span>
<span class="s2">            acos acosh asin asinh atan atan2 atanh ceil copysign cos cosh</span>
<span class="s2">            degrees erf erfc exp expm1 fabs factorial floor fmod frexp fsum</span>
<span class="s2">            gamma hypot isfinite isinf isnan ldexp lgamma log log10 log1p</span>
<span class="s2">            log2 modf pow radians sin sinh sqrt tan tanh trunc</span>
<span class="s2">            &quot;&quot;&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_split_string_allow</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">add_to</span><span class="o">=</span><span class="s1">&#39;attributes&#39;</span><span class="p">)</span>

        <span class="c1">#print(object_members(np, &#39;ufunc&#39;))</span>
        <span class="n">s</span><span class="o">=</span><span class="n">textwrap</span><span class="o">.</span><span class="n">dedent</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">            #numpy_v_1_9_0</span>
<span class="s2">            abs absolute add arccos arccosh arcsin arcsinh arctan arctan2</span>
<span class="s2">            arctanh bitwise_and bitwise_not bitwise_or bitwise_xor ceil conj</span>
<span class="s2">            conjugate copysign cos cosh deg2rad degrees divide equal exp exp2</span>
<span class="s2">            expm1 fabs floor floor_divide fmax fmin fmod frexp greater</span>
<span class="s2">            greater_equal hypot invert isfinite isinf isnan ldexp left_shift</span>
<span class="s2">            less less_equal log log10 log1p log2 logaddexp logaddexp2</span>
<span class="s2">            logical_and logical_not logical_or logical_xor maximum minimum</span>
<span class="s2">            mod modf multiply negative nextafter not_equal power rad2deg</span>
<span class="s2">            radians reciprocal remainder right_shift rint sign signbit sin</span>
<span class="s2">            sinh spacing sqrt square subtract tan tanh true_divide trunc</span>
<span class="s2">            &quot;&quot;&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_split_string_allow</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">add_to</span><span class="o">=</span><span class="s1">&#39;attributes&#39;</span><span class="p">)</span></div>
        <span class="c1">#to find more numpy functionality to add try:</span>
        <span class="c1">#object_members(np.polynomial,&#39;routine&#39;)</span>
        <span class="c1">#mem=object_members(np.polynomial,&#39;class&#39;)</span>
        <span class="c1">#object_members(np.polynomial.polynomial,&#39;routine&#39;)</span>


<div class="viewcode-block" id="SyntaxChecker.allow_PolyLine"><a class="viewcode-back" href="../../../api/geotecha.inputoutput.inputoutput.html#geotecha.inputoutput.inputoutput.SyntaxChecker.allow_PolyLine">[docs]</a>    <span class="k">def</span> <span class="nf">allow_PolyLine</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Allow PolyLine class from geotecha.piecewise.piecewise_linear_1d&quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">allowed_functions</span><span class="p">[</span><span class="s1">&#39;PolyLine&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">PolyLine</span>

        <span class="n">s</span><span class="o">=</span><span class="n">textwrap</span><span class="o">.</span><span class="n">dedent</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">            x y xy x1 x2 y1 y2 x1_x2_y1_y2</span>
<span class="s2">            &quot;&quot;&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_split_string_allow</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">add_to</span><span class="o">=</span><span class="s1">&#39;attributes&#39;</span><span class="p">)</span>
        <span class="k">return</span></div></div>


<div class="viewcode-block" id="object_members"><a class="viewcode-back" href="../../../api/geotecha.inputoutput.inputoutput.html#geotecha.inputoutput.inputoutput.object_members">[docs]</a><span class="k">def</span> <span class="nf">object_members</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">info</span><span class="o">=</span><span class="s1">&#39;function&#39;</span><span class="p">,</span> <span class="n">join</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Get a list of object members.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    obj : object</span>
<span class="sd">        Object to get members of.</span>
<span class="sd">    info : string, optional</span>
<span class="sd">        Type of members to gather.  Members will be gathered according to</span>
<span class="sd">        inspect.is&lt;member_type&gt;. e.g. info=&#39;function&#39; will check in object for</span>
<span class="sd">        inspect.isfunction. Other values include &#39;method&#39; &#39;function&#39;</span>
<span class="sd">        &#39;routine&#39;. Default info=&#39;function&#39;. NOTE that it is safer to use</span>
<span class="sd">        &#39;routine&#39; when getting functions.  There is a custom check for</span>
<span class="sd">        info=&#39;ufunc&#39; to give ufunc members of numpy.</span>
<span class="sd">    join : bool, optional</span>
<span class="sd">        If join==True then list will be joined together into one large</span>
<span class="sd">        space separated string.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    members : list of str, or str</span>
<span class="sd">        List of member names of specified types, or space separated names</span>
<span class="sd">        i single string.</span>


<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1">#useful resources</span>
    <span class="c1">#http://www.andreas-dewes.de/en/2012/static-code-analysis-with-python/</span>
    <span class="c1">#isroutine vs isfunction: http://stackoverflow.com/a/22428966</span>
    <span class="c1">#pkgutil : http://stackoverflow.com/a/1310912</span>

    <span class="c1">#add ufunc</span>
    <span class="k">def</span> <span class="nf">isufunc</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return true if the object is a numpy.ufunc&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">isinstance</span><span class="p">(</span><span class="nb">object</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ufunc</span><span class="p">)</span>
    <span class="n">inspect</span><span class="o">.</span><span class="n">isufunc</span> <span class="o">=</span> <span class="n">isufunc</span>

    <span class="k">if</span> <span class="n">info</span><span class="o">==</span><span class="s2">&quot;module&quot;</span><span class="p">:</span>
        <span class="c1"># for some reason getmembers with modules does not allways return a</span>
        <span class="c1"># complete list.</span>
        <span class="n">pkgpath</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="vm">__file__</span><span class="p">)</span>
        <span class="n">members</span> <span class="o">=</span> <span class="p">[</span><span class="n">name</span> <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">pkgutil</span><span class="o">.</span><span class="n">iter_modules</span><span class="p">([</span><span class="n">pkgpath</span><span class="p">])]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">members</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">j</span> <span class="ow">in</span>
                    <span class="n">inspect</span><span class="o">.</span><span class="n">getmembers</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span>
                                       <span class="nb">getattr</span><span class="p">(</span><span class="n">inspect</span><span class="p">,</span><span class="s1">&#39;is</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">info</span><span class="p">)))]</span>
    <span class="k">if</span> <span class="n">join</span><span class="p">:</span>
        <span class="n">members</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">textwrap</span><span class="o">.</span><span class="n">wrap</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">members</span><span class="p">),</span>
                                        <span class="n">break_long_words</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">65</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">members</span></div>


<div class="viewcode-block" id="make_module_from_text"><a class="viewcode-back" href="../../../api/geotecha.inputoutput.inputoutput.html#geotecha.inputoutput.inputoutput.make_module_from_text">[docs]</a><span class="k">def</span> <span class="nf">make_module_from_text</span><span class="p">(</span><span class="n">reader</span><span class="p">,</span> <span class="n">syntax_checker</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Make a module from file, StringIO, text etc.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    reader : file_like object</span>
<span class="sd">        Object to get text from.</span>
<span class="sd">    syntax_checker : SyntaxChecker object, optional</span>
<span class="sd">        Specifies what syntax is allowed when executing the text</span>
<span class="sd">        within `reader`.  Default = None, which means that text will be</span>
<span class="sd">        executed with the all powerful all dangerous exec function.  Only use</span>
<span class="sd">        this option if you trust the input.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    m : module</span>
<span class="sd">        text as module</span>

<span class="sd">    See Also</span>
<span class="sd">    --------</span>
<span class="sd">    SyntaxChecker : allow certain syntax</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    I suspect it is best if `reader` is a string. i.e reader can be pickled.</span>
<span class="sd">    fileobjects may be cause issues if used with multiprocessing.process</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1">#useful resources:</span>
    <span class="c1">#for making module out of strings/files see http://stackoverflow.com/a/7548190/2530083</span>
    <span class="c1">#http://old-blog.ooz.ie/2011/03/python-exec-module-in-namespace.html</span>
    <span class="c1">#http://stackoverflow.com/questions/7969949/whats-the-difference-between-globals-locals-and-vars</span>
    <span class="c1">#http://lucumr.pocoo.org/2011/2/1/exec-in-python/</span>
    <span class="c1">#   see down bottom  for config stuff</span>
    <span class="c1">#http://stackoverflow.com/a/2372145/2530083</span>
    <span class="c1">#   limit namespace</span>


    <span class="n">mymodule</span> <span class="o">=</span> <span class="n">imp</span><span class="o">.</span><span class="n">new_module</span><span class="p">(</span><span class="s1">&#39;mymodule&#39;</span><span class="p">)</span> <span class="c1">#may need to randomise the name; not sure</span>

    <span class="k">if</span> <span class="n">syntax_checker</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">exec</span><span class="p">(</span><span class="n">reader</span><span class="p">,</span> <span class="n">mymodule</span><span class="o">.</span><span class="vm">__dict__</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">mymodule</span>


    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">syntax_checker</span><span class="p">,</span> <span class="n">SyntaxChecker</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;syntax_checker should be a SyntaxChecker instance.&#39;</span><span class="p">)</span>

    <span class="n">tree</span> <span class="o">=</span> <span class="n">ast</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">reader</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;exec&#39;</span><span class="p">)</span>
    <span class="n">syntax_checker</span><span class="o">.</span><span class="n">visit</span><span class="p">(</span><span class="n">tree</span><span class="p">)</span>
    <span class="n">compiled</span> <span class="o">=</span> <span class="nb">compile</span><span class="p">(</span><span class="n">tree</span><span class="p">,</span> <span class="s1">&#39;&lt;string&gt;&#39;</span><span class="p">,</span> <span class="s2">&quot;exec&quot;</span><span class="p">)</span>
    <span class="n">mymodule</span><span class="o">.</span><span class="vm">__dict__</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">syntax_checker</span><span class="o">.</span><span class="n">allowed_functions</span><span class="p">)</span>
    <span class="n">exec</span><span class="p">(</span><span class="n">compiled</span><span class="p">,</span> <span class="n">mymodule</span><span class="o">.</span><span class="vm">__dict__</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">mymodule</span></div>

<div class="viewcode-block" id="print_all_nodes"><a class="viewcode-back" href="../../../api/geotecha.inputoutput.inputoutput.html#geotecha.inputoutput.inputoutput.print_all_nodes">[docs]</a><span class="k">class</span> <span class="nc">print_all_nodes</span><span class="p">(</span><span class="n">ast</span><span class="o">.</span><span class="n">NodeVisitor</span><span class="p">):</span><span class="c1">#http://stackoverflow.com/a/1515403/2530083</span>
    <span class="sd">&quot;&quot;&quot;Simple ast.NodeVisitor sub class that prints each node when visited</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; text=&quot;a=[3,2]*2&quot;</span>
<span class="sd">    &gt;&gt;&gt; x=print_all_nodes()</span>
<span class="sd">    &gt;&gt;&gt; tree=ast.parse(text)</span>
<span class="sd">    &gt;&gt;&gt; x.visit(tree)</span>
<span class="sd">         Module : Module(body=[Assign(targets=[Name(id=&#39;a&#39;, ctx=Store())], value=BinOp(left=List(elts=[Num(n=3), Num(n=2)], ctx=Load()), op=Mult(), right=Num(n=2)))])</span>
<span class="sd">         Assign : Assign(targets=[Name(id=&#39;a&#39;, ctx=Store())], value=BinOp(left=List(elts=[Num(n=3), Num(n=2)], ctx=Load()), op=Mult(), right=Num(n=2)))</span>
<span class="sd">         Name : Name(id=&#39;a&#39;, ctx=Store())</span>
<span class="sd">         Store : Store()</span>
<span class="sd">         BinOp : BinOp(left=List(elts=[Num(n=3), Num(n=2)], ctx=Load()), op=Mult(), right=Num(n=2))</span>
<span class="sd">         List : List(elts=[Num(n=3), Num(n=2)], ctx=Load())</span>
<span class="sd">         Num : Num(n=3)</span>
<span class="sd">         Num : Num(n=2)</span>
<span class="sd">         Load : Load()</span>
<span class="sd">         Mult : Mult()</span>
<span class="sd">         Num : Num(n=2)</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1">#useful resources</span>
    <span class="c1">#http://stackoverflow.com/a/1515403/2530083</span>
<div class="viewcode-block" id="print_all_nodes.generic_visit"><a class="viewcode-back" href="../../../api/geotecha.inputoutput.inputoutput.html#geotecha.inputoutput.inputoutput.print_all_nodes.generic_visit">[docs]</a>    <span class="k">def</span> <span class="nf">generic_visit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="o">*</span><span class="mi">4</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="n">node</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span><span class="s1">&#39;:&#39;</span><span class="p">,</span> <span class="n">ast</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">node</span><span class="p">))</span>
        <span class="n">ast</span><span class="o">.</span><span class="n">NodeVisitor</span><span class="o">.</span><span class="n">generic_visit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node</span><span class="p">)</span></div></div>


<div class="viewcode-block" id="fcode_one_large_expr"><a class="viewcode-back" href="../../../api/geotecha.inputoutput.inputoutput.html#geotecha.inputoutput.inputoutput.fcode_one_large_expr">[docs]</a><span class="k">def</span> <span class="nf">fcode_one_large_expr</span><span class="p">(</span><span class="n">expr</span><span class="p">,</span> <span class="n">prepend</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">settings</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Fortran friendly printing of sympy expression ignoring any loops/indexed</span>

<span class="sd">    The normal FcodePrinter.doprint method will try to figure out what fortran</span>
<span class="sd">    loops you need by looking for indexed expressions.  Sometimes you just want</span>
<span class="sd">    to change square brackets [] to parenteses () and wrap/indent the code for</span>
<span class="sd">    Fortran with appropriate line continuations. `fcode_one_large_expr`</span>
<span class="sd">    can do that for you. You will have to write your own fortran do loops.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    expr : sympy expression</span>
<span class="sd">        A single large sympy expression.</span>
<span class="sd">    prepend : string, optional</span>
<span class="sd">        A string to prepend to your fortran code.  Assuming you are</span>
<span class="sd">        going to cut and paste into a fortran routine `prepend` should be</span>
<span class="sd">        correct fortran format.  (note you do not need an initial indent</span>
<span class="sd">        for your prepend it will be put in for you). e.g.</span>
<span class="sd">        prepend = &#39;a(i, i) = a(i, i) + &#39;. Defualt prepend=None i.e. nothing</span>
<span class="sd">        prepended.</span>
<span class="sd">    settings : keyword arguments</span>
<span class="sd">        See `sympy.printing.fcode` docs, specifically FCodePrinter.__init__ .</span>
<span class="sd">        Note that &#39;assign_to will not work&#39;.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    out : str</span>
<span class="sd">        Fortran ready code that can be copy and pasted into a Fortran routine.</span>

<span class="sd">    See Also</span>
<span class="sd">    --------</span>
<span class="sd">    sympy.printing.fcode : contains all the functionality.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># FCodePrinter.indent_code uses &#39;&#39;.join to combine lines.  Should it be</span>
    <span class="c1"># &#39;\n&#39;.join ? This is my work around:</span>
    <span class="k">class</span> <span class="nc">FCodePrinter2</span><span class="p">(</span><span class="n">FCodePrinter</span><span class="p">):</span>
        <span class="nd">@property</span>
        <span class="k">def</span> <span class="nf">_lead</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_settings</span><span class="p">[</span><span class="s1">&#39;source_format&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;fixed&#39;</span><span class="p">:</span>
<span class="c1">#                return {&#39;code&#39;: &quot;      &quot;, &#39;cont&#39;: &quot;     @ &quot;, &#39;comment&#39;: &quot;C     &quot;} orig</span>
                <span class="k">return</span> <span class="p">{</span><span class="s1">&#39;code&#39;</span><span class="p">:</span> <span class="s2">&quot;      &quot;</span><span class="p">,</span> <span class="s1">&#39;cont&#39;</span><span class="p">:</span> <span class="s2">&quot;&amp;</span><span class="se">\n</span><span class="s2">      &quot;</span><span class="p">,</span> <span class="s1">&#39;comment&#39;</span><span class="p">:</span> <span class="s2">&quot;C     &quot;</span><span class="p">}</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">_settings</span><span class="p">[</span><span class="s1">&#39;source_format&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;free&#39;</span><span class="p">:</span>
                <span class="k">return</span> <span class="p">{</span><span class="s1">&#39;code&#39;</span><span class="p">:</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s1">&#39;cont&#39;</span><span class="p">:</span> <span class="s2">&quot;      &quot;</span><span class="p">,</span> <span class="s1">&#39;comment&#39;</span><span class="p">:</span> <span class="s2">&quot;! &quot;</span><span class="p">}</span>

    <span class="n">printer</span> <span class="o">=</span> <span class="n">FCodePrinter2</span><span class="p">(</span><span class="n">settings</span><span class="p">)</span>

    <span class="n">printer</span><span class="o">.</span><span class="n">_lead_cont</span> <span class="o">=</span> <span class="s1">&#39;&amp;</span><span class="se">\n</span><span class="s1">      &#39;</span> <span class="c1"># this should account for eariler version of sympy</span>
     
    <span class="n">expr</span> <span class="o">=</span> <span class="n">printer</span><span class="o">.</span><span class="n">parenthesize</span><span class="p">(</span><span class="n">expr</span><span class="p">,</span> <span class="mi">50</span><span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">prepend</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">expr</span> <span class="o">=</span> <span class="n">prepend</span> <span class="o">+</span> <span class="n">expr</span>

    <span class="k">return</span> <span class="n">printer</span><span class="o">.</span><span class="n">indent_code</span><span class="p">(</span><span class="n">expr</span><span class="p">)</span></div>


<div class="viewcode-block" id="copy_attributes_between_objects"><a class="viewcode-back" href="../../../api/geotecha.inputoutput.inputoutput.html#geotecha.inputoutput.inputoutput.copy_attributes_between_objects">[docs]</a><span class="k">def</span> <span class="nf">copy_attributes_between_objects</span><span class="p">(</span><span class="n">from_object</span><span class="p">,</span>
                                    <span class="n">to_object</span><span class="p">,</span>
                                    <span class="n">attributes</span><span class="o">=</span><span class="p">[],</span>
                                    <span class="n">defaults</span><span class="o">=</span><span class="nb">dict</span><span class="p">(),</span>
                                    <span class="n">not_found_value</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Copy attributes from one object to another</span>

<span class="sd">    Looks up `attributes` in `from_obj` and copies them to `to_object`.  If</span>
<span class="sd">    not present in `from_object` the corresponding attribute in `to_object`</span>
<span class="sd">    will be set to `defaults` or `not_found_value` if not in `defaults`.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    from_object : object or module</span>
<span class="sd">        Object to copy attributes from.</span>
<span class="sd">    to_object : object or module</span>
<span class="sd">        Object to copy attributes to.</span>
<span class="sd">    attributes : list of strings</span>
<span class="sd">        A list of attribute names to copy from `from_object` to `object_to`.</span>
<span class="sd">    defaults : dict of string-value pairs</span>
<span class="sd">        Dictionary specifying the default value of each attribute that is not</span>
<span class="sd">        found in `from_object`.</span>
<span class="sd">    not_found_value : optional</span>
<span class="sd">        Default value to set attribute to if not found in `from_object` or in</span>
<span class="sd">        `defaults`.  Default not_found_value=None.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    None</span>

<span class="sd">    &quot;&quot;&quot;</span>


    <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">attributes</span><span class="p">:</span>
            <span class="n">to_object</span><span class="o">.</span><span class="fm">__setattr__</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">from_object</span><span class="o">.</span><span class="vm">__dict__</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">defaults</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">not_found_value</span><span class="p">)))</span>

    <span class="k">return</span></div>

<div class="viewcode-block" id="copy_attributes_from_text_to_object"><a class="viewcode-back" href="../../../api/geotecha.inputoutput.inputoutput.html#geotecha.inputoutput.inputoutput.copy_attributes_from_text_to_object">[docs]</a><span class="k">def</span> <span class="nf">copy_attributes_from_text_to_object</span><span class="p">(</span><span class="n">reader</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Wrapper for `copy_attributes_between_objects` where `from_object`</span>
<span class="sd">    is fileobject, StringIO, text</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    reader : fileobject, StringIO, text</span>
<span class="sd">        text to turn into a module and pass as from_object</span>
<span class="sd">    *args :</span>
<span class="sd">        Positional arguments that will be passed to</span>
<span class="sd">        `copy_attributes_between_objects`.</span>
<span class="sd">    **kwargs :</span>
<span class="sd">        Keyword arguments that will be passed to</span>
<span class="sd">        `copy_attributes_between_objects`. You can use a SyntaxChecker</span>
<span class="sd">        object to interpret the `reader` by using the keyword argument</span>
<span class="sd">        &#39;syntax_checker&#39;=&lt;some SyntaxChecker object&gt;.</span>

<span class="sd">    See Also</span>
<span class="sd">    --------</span>
<span class="sd">    copy_attributes_between_objects : See for args and kwargs input.</span>
<span class="sd">    SyntaxChecker : Restrict the allowable syntax in the `reader`.</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    Put &#39;syntax_checker= &#39; in the kwargs to add a SyntaxChecker</span>


<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">syn_checker</span><span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;syntax_checker&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
    <span class="n">copy_attributes_between_objects</span><span class="p">(</span><span class="n">make_module_from_text</span><span class="p">(</span><span class="n">reader</span><span class="p">,</span>
            <span class="n">syn_checker</span><span class="p">),</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="k">return</span></div>


<div class="viewcode-block" id="check_attribute_is_list"><a class="viewcode-back" href="../../../api/geotecha.inputoutput.inputoutput.html#geotecha.inputoutput.inputoutput.check_attribute_is_list">[docs]</a><span class="k">def</span> <span class="nf">check_attribute_is_list</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">attributes</span><span class="o">=</span><span class="p">[],</span> <span class="n">force_list</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Check if attributes of an object are lists</span>

<span class="sd">    If attribute is not a list and `force_list`=True then attribute will be</span>
<span class="sd">    placed in list.  e.g. say obj.a = 6, 6 is not a list so obj.a will be</span>
<span class="sd">    changed to obj.a = [6].  An error is raised if attribute is not a list.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    obj : object</span>
<span class="sd">        Object with attributes to check.</span>
<span class="sd">    attributes : list of strings</span>
<span class="sd">        A list of attribute names to check.</span>
<span class="sd">    force_list : bool, optional</span>
<span class="sd">        If True not-list attributes will be put in a list. If False then</span>
<span class="sd">        non-list attributes will raise an error. Default force_list=False.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    None</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">g</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="fm">__getattribute__</span>
    <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">attributes</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">g</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">g</span><span class="p">(</span><span class="n">v</span><span class="p">),</span> <span class="nb">list</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">force_list</span><span class="p">:</span>
                    <span class="n">obj</span><span class="o">.</span><span class="fm">__setattr__</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="p">[</span><span class="n">g</span><span class="p">(</span><span class="n">v</span><span class="p">)])</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{0}</span><span class="s1"> should be a list. It is </span><span class="si">{1}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="n">g</span><span class="p">(</span><span class="n">v</span><span class="p">))))</span>
    <span class="k">return</span></div>


<div class="viewcode-block" id="check_attribute_PolyLines_have_same_x_limits"><a class="viewcode-back" href="../../../api/geotecha.inputoutput.inputoutput.html#geotecha.inputoutput.inputoutput.check_attribute_PolyLines_have_same_x_limits">[docs]</a><span class="k">def</span> <span class="nf">check_attribute_PolyLines_have_same_x_limits</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">attributes</span><span class="o">=</span><span class="p">[]):</span>
    <span class="sd">&quot;&quot;&quot;Check if attributes of object that are PolyLine have the same x values</span>

<span class="sd">    Each attribute can be a single instance of PolyLine or a list of PolyLines.</span>
<span class="sd">    An error is raised if x-values are different.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    obj : object</span>
<span class="sd">        Object with attributes to check.</span>
<span class="sd">    attributes : list of list of strings</span>
<span class="sd">        Each sublist is a list of attribute names to check.</span>

<span class="sd">    See Also</span>
<span class="sd">    --------</span>
<span class="sd">    geotecha.piecewise.piecewise_linear_1d.PolyLine : PolyLine class</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">g</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="fm">__getattribute__</span>

    <span class="k">for</span> <span class="n">sublist</span> <span class="ow">in</span> <span class="n">attributes</span><span class="p">:</span>
        <span class="c1">#find first x values</span>
        <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">sublist</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">g</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">g</span><span class="p">(</span><span class="n">v</span><span class="p">),</span> <span class="nb">list</span><span class="p">):</span>
                    <span class="n">xcheck</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">g</span><span class="p">(</span><span class="n">v</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">g</span><span class="p">(</span><span class="n">v</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]])</span>
                    <span class="n">xstr</span> <span class="o">=</span> <span class="n">v</span>
                    <span class="k">break</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">a</span> <span class="o">=</span> <span class="n">g</span><span class="p">(</span><span class="n">v</span><span class="p">)</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

                    <span class="n">xcheck</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">g</span><span class="p">(</span><span class="n">v</span><span class="p">)</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">g</span><span class="p">(</span><span class="n">v</span><span class="p">)</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]])</span>
                    <span class="n">xstr</span> <span class="o">=</span> <span class="n">v</span>
                    <span class="k">break</span>
        <span class="c1">#check against other x values</span>
        <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">sublist</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">g</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">g</span><span class="p">(</span><span class="n">v</span><span class="p">),</span> <span class="nb">list</span><span class="p">):</span>
                    <span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="n">u</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">g</span><span class="p">(</span><span class="n">v</span><span class="p">)):</span>
                        <span class="k">if</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">([</span><span class="n">u</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">u</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]],</span> <span class="n">xcheck</span><span class="p">):</span>
                            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;All upper and lower x limits must be the same.  Check &#39;</span> <span class="o">+</span> <span class="n">v</span> <span class="o">+</span> <span class="s1">&#39; and &#39;</span> <span class="o">+</span> <span class="n">xstr</span> <span class="o">+</span> <span class="s1">&#39;.&#39;</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">if</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">([</span><span class="n">g</span><span class="p">(</span><span class="n">v</span><span class="p">)</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">g</span><span class="p">(</span><span class="n">v</span><span class="p">)</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]],</span> <span class="n">xcheck</span><span class="p">):</span>
                        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;All upper and lower x limits must be the same.  Check &#39;</span> <span class="o">+</span> <span class="n">v</span> <span class="o">+</span> <span class="s1">&#39; and &#39;</span> <span class="o">+</span> <span class="n">xstr</span> <span class="o">+</span> <span class="s1">&#39;.&#39;</span><span class="p">)</span>
    <span class="k">return</span></div>


<div class="viewcode-block" id="check_attribute_pairs_have_equal_length"><a class="viewcode-back" href="../../../api/geotecha.inputoutput.inputoutput.html#geotecha.inputoutput.inputoutput.check_attribute_pairs_have_equal_length">[docs]</a><span class="k">def</span> <span class="nf">check_attribute_pairs_have_equal_length</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">attributes</span><span class="o">=</span><span class="p">[]):</span>
    <span class="sd">&quot;&quot;&quot;Check if attribute pairs have the same length</span>

<span class="sd">    Compares pairs only if both pairs are not None.  Raises error if pair items</span>
<span class="sd">    have unequal lenghth.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    obj : object</span>
<span class="sd">        Object with attributes to check.</span>
<span class="sd">    attributes : list of list of two string</span>
<span class="sd">        List of attribute names to check. Each sub-list should have two</span>
<span class="sd">        elements.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">g</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="fm">__getattribute__</span>

    <span class="c1"># for iterating in chuncks see http://stackoverflow.com/a/434328/2530083</span>
    <span class="c1">#for v1, v2 in [attributes[pos:pos + 2] for pos in xrange(0, len(attributes), 2)]:</span>

    <span class="k">for</span> <span class="n">pair</span> <span class="ow">in</span> <span class="n">attributes</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">pair</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">2</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Can only compare two items. you have </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">pair</span><span class="p">)))</span>
        <span class="n">v1</span><span class="p">,</span> <span class="n">v2</span> <span class="o">=</span> <span class="n">pair</span>
        <span class="k">if</span> <span class="nb">sum</span><span class="p">([</span><span class="n">v</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="p">[</span><span class="n">g</span><span class="p">(</span><span class="n">v1</span><span class="p">),</span> <span class="n">g</span><span class="p">(</span><span class="n">v2</span><span class="p">)]])</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">sum</span><span class="p">([</span><span class="nb">hasattr</span><span class="p">(</span><span class="n">v</span><span class="p">,</span><span class="s1">&#39;__len__&#39;</span><span class="p">)</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="p">[</span><span class="n">g</span><span class="p">(</span><span class="n">v1</span><span class="p">),</span> <span class="n">g</span><span class="p">(</span><span class="n">v2</span><span class="p">)]])</span><span class="o">!=</span><span class="mi">2</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;either </span><span class="si">{0}</span><span class="s2"> and </span><span class="si">{1}</span><span class="s2"> have no len attribute and so cannot be compared&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">v1</span><span class="p">,</span><span class="n">v2</span><span class="p">))</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">g</span><span class="p">(</span><span class="n">v1</span><span class="p">))</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">g</span><span class="p">(</span><span class="n">v2</span><span class="p">)):</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2"> has </span><span class="si">{:d}</span><span class="s2"> elements, </span><span class="si">{}</span><span class="s2"> has </span><span class="si">{:d}</span><span class="s2"> &quot;</span>
                    <span class="s2">&quot;elements.  They should have the same number of &quot;</span>
                    <span class="s2">&quot;elements.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">v1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">g</span><span class="p">(</span><span class="n">v1</span><span class="p">)),</span> <span class="n">v2</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">g</span><span class="p">(</span><span class="n">v2</span><span class="p">))))</span>

<span class="c1">#        elif sum([v is None for v in [g(v1), g(v2)]])==1:</span>
<span class="c1">#            raise ValueError(&quot;Cannot compare length of {0} and {1} when one of them is None&quot;.format(v1,v2))</span>
    <span class="k">return</span></div>


<div class="viewcode-block" id="check_attribute_combinations"><a class="viewcode-back" href="../../../api/geotecha.inputoutput.inputoutput.html#geotecha.inputoutput.inputoutput.check_attribute_combinations">[docs]</a><span class="k">def</span> <span class="nf">check_attribute_combinations</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">zero_or_all</span><span class="o">=</span><span class="p">[],</span> <span class="n">at_least_one</span><span class="o">=</span><span class="p">[],</span> <span class="n">one_implies_others</span><span class="o">=</span><span class="p">[]):</span>
    <span class="sd">&quot;&quot;&quot;Check for incomplete combinations of attributes</span>

<span class="sd">    Raises ValueError if any combination fails.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    zero_or_all : list of list of string</span>
<span class="sd">        Each element of `zero_or_all` is a list of attribute names that should</span>
<span class="sd">        either all be None or all be not None.</span>
<span class="sd">    at_least_one : list of list of string</span>
<span class="sd">        Each element of `at_least_one` is a list of attribute names of which at</span>
<span class="sd">        least one should not be None.</span>
<span class="sd">    one_implies_others : list of list of string</span>
<span class="sd">        Each element of `one_implies_others` is a list of attribute names.  If</span>
<span class="sd">        the first attribute in the list is not None then all other members of</span>
<span class="sd">        the list should also not be None.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    None</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">g</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="fm">__getattribute__</span>

    <span class="k">for</span> <span class="n">check</span> <span class="ow">in</span> <span class="n">zero_or_all</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">sum</span><span class="p">([</span><span class="n">g</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">check</span><span class="p">])</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">check</span><span class="p">)):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Either zero or all of the following variables must be defined: &#39;</span> <span class="o">+</span> <span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">check</span><span class="p">))</span>

    <span class="k">for</span> <span class="n">check</span> <span class="ow">in</span> <span class="n">at_least_one</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">any</span><span class="p">([</span><span class="ow">not</span> <span class="n">g</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">check</span><span class="p">]):</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">check</span><span class="p">)</span><span class="o">==</span><span class="mi">1</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Need the following variable: &#39;</span> <span class="o">+</span> <span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">check</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Need at least one of the following variables: &#39;</span> <span class="o">+</span> <span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">check</span><span class="p">))</span>

    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">check</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">one_implies_others</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">check</span><span class="p">)</span><span class="o">&lt;=</span><span class="mi">1</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;each member of &#39;one_implies_others&#39; must be a list with at least two elements.  Member </span><span class="si">{0}</span><span class="s2"> is </span><span class="si">{1}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">check</span><span class="p">)))</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">g</span><span class="p">(</span><span class="n">check</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">all</span><span class="p">([</span><span class="ow">not</span> <span class="n">g</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">check</span><span class="p">[</span><span class="mi">1</span><span class="p">:]]):</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;If </span><span class="si">{0}</span><span class="s1"> is defined then the following variables must also be defined: &#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">check</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">+</span> <span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">check</span><span class="p">[</span><span class="mi">1</span><span class="p">:]))</span>

    <span class="k">return</span></div>



<div class="viewcode-block" id="force_attribute_same_len_if_none"><a class="viewcode-back" href="../../../api/geotecha.inputoutput.inputoutput.html#geotecha.inputoutput.inputoutput.force_attribute_same_len_if_none">[docs]</a><span class="k">def</span> <span class="nf">force_attribute_same_len_if_none</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">same_len_attributes</span><span class="o">=</span><span class="p">[],</span> <span class="n">value</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Make list of None with len the same as an existing attribute</span>

<span class="sd">    If attributes after the first are None then make those attributes a list</span>
<span class="sd">    of len(first_attribute) filled with value.  This is useful when you want</span>
<span class="sd">    to zip each member of two attributes. If the second attribute is None,</span>
<span class="sd">    then any zipping is impossible.  However, if the second attribute</span>
<span class="sd">    is set to a list of None then zipping is possible.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    obj : object</span>
<span class="sd">        Object that has the attributes.</span>
<span class="sd">    same_len_attributes : list of list of string</span>
<span class="sd">        For each group of attribute names, if attributes after the first are</span>
<span class="sd">        None then those attributes will be made a list of len(first_attribute)</span>
<span class="sd">        filled with `value`.</span>
<span class="sd">    value : obj, optional</span>
<span class="sd">        Value to fill each list.  Default value=None.</span>


<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">for</span> <span class="n">group</span> <span class="ow">in</span> <span class="n">same_len_attributes</span><span class="p">:</span>
        <span class="n">a1</span> <span class="o">=</span><span class="nb">getattr</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">group</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">a1</span><span class="o">!=</span><span class="kc">None</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">group</span><span class="p">[</span><span class="mi">1</span><span class="p">:]:</span>
                <span class="k">if</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="nb">setattr</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="p">[</span><span class="n">value</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">a1</span><span class="p">))</span></div>



<div class="viewcode-block" id="initialize_objects_attributes"><a class="viewcode-back" href="../../../api/geotecha.inputoutput.inputoutput.html#geotecha.inputoutput.inputoutput.initialize_objects_attributes">[docs]</a><span class="k">def</span> <span class="nf">initialize_objects_attributes</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span>
                                  <span class="n">attributes</span><span class="o">=</span><span class="p">[],</span>
                                  <span class="n">defaults</span><span class="o">=</span><span class="nb">dict</span><span class="p">(),</span>
                                  <span class="n">not_found_value</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Initialize an objects attributes</span>

<span class="sd">    For each attribute, set it to the value found in `defaults` dictionary</span>
<span class="sd">    or, if the attribute is not found, set it to `not_found_value`.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    obj : object</span>
<span class="sd">        Object to set attributes in.</span>
<span class="sd">    attributes : list of strings</span>
<span class="sd">        A list of attribute names to set.</span>
<span class="sd">    defaults : dict of string-value pairs, optional</span>
<span class="sd">        Dictionary specifying the default value of each attribute.</span>
<span class="sd">        Default defautls=dict() i.e. no explicit default value.</span>
<span class="sd">    not_found_value : optional</span>
<span class="sd">        Default value to set attribute to if not found in `defaults` dict.</span>
<span class="sd">        Default not_found_value=None.</span>



<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    If using this function to initialize attributes in a class then just</span>
<span class="sd">    be aware that the attributes will not be available for auto-complete</span>
<span class="sd">    until an instance of the class is created.  This can be annoying when</span>
<span class="sd">    coding the class itself because typing &#39;self.&#39; will not have any</span>
<span class="sd">    autocomplete options.  To work around this use a temporary explicit</span>
<span class="sd">    assignment e.g. &#39;self.a = 6&#39; and then later comment it out when coding of</span>
<span class="sd">    the class is finsihed.</span>

<span class="sd">    See Also</span>
<span class="sd">    --------</span>
<span class="sd">    code_for_explicit_attribute_initialization : Use for temporary explicit</span>
<span class="sd">        attribute initialization to facilitate auto-complete, then comment</span>
<span class="sd">        out when done.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">attributes</span><span class="p">:</span>
        <span class="n">obj</span><span class="o">.</span><span class="fm">__setattr__</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">defaults</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">not_found_value</span><span class="p">))</span>
    <span class="k">return</span></div>

<div class="viewcode-block" id="code_for_explicit_attribute_initialization"><a class="viewcode-back" href="../../../api/geotecha.inputoutput.inputoutput.html#geotecha.inputoutput.inputoutput.code_for_explicit_attribute_initialization">[docs]</a><span class="k">def</span> <span class="nf">code_for_explicit_attribute_initialization</span><span class="p">(</span><span class="n">attributes</span><span class="o">=</span><span class="p">[],</span>
                                               <span class="n">defaults</span><span class="o">=</span><span class="p">{},</span>
                                               <span class="n">defaults_name</span><span class="o">=</span><span class="s1">&#39;_attribute_defaults&#39;</span><span class="p">,</span>
                                               <span class="n">object_name</span><span class="o">=</span><span class="s1">&#39;self&#39;</span><span class="p">,</span>
                                               <span class="n">not_found_value</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Generate code to initialize an objects attributes</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    object_name : string , optional</span>
<span class="sd">        Name of object to set attributes. default=&#39;self&#39;.</span>
<span class="sd">    attributes : list of strings</span>
<span class="sd">        A list of attribute names to set.</span>
<span class="sd">    defaults : dict of string-value pairs</span>
<span class="sd">        Dictionary specifying the default value of each attribute.</span>
<span class="sd">    defaults_name : string, optional</span>
<span class="sd">        If ``None`` then the actual values in `defaults` will be used</span>
<span class="sd">        to set attributes.  If not ``None`` then those attributes with</span>
<span class="sd">        defaults will be initialized by pointing to a dictionary called</span>
<span class="sd">        `defaults_name`.  Default defaults_name=&#39;_attribute_defaults&#39;,</span>
<span class="sd">    not_found_value : optional</span>
<span class="sd">        Default value to set attribute to if not found in `defaults`.</span>
<span class="sd">        default not_found_value=``None``</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    out : string</span>
<span class="sd">        Code that can be pasted into an object (usually in the __init__</span>
<span class="sd">        methos) to explicitly initialize attributes, so the attributes appear</span>
<span class="sd">        in autocomplete.</span>

<span class="sd">    See Also</span>
<span class="sd">    --------</span>
<span class="sd">    initialize_objects_attributes : Similar functionality with no copy paste.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">out</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
    <span class="k">if</span> <span class="n">defaults_name</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">attributes</span><span class="p">:</span>
            <span class="n">v2</span> <span class="o">=</span> <span class="n">defaults</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">not_found_value</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">v2</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
                <span class="n">v2</span> <span class="o">=</span> <span class="s2">&quot;&#39;</span><span class="si">{0}</span><span class="s2">&#39;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">v2</span><span class="p">)</span>

            <span class="n">out</span><span class="o">+=</span><span class="s1">&#39;</span><span class="si">{0}</span><span class="s1"> = </span><span class="si">{1}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">object_name</span><span class="p">,</span><span class="n">v</span><span class="p">]),</span> <span class="n">v2</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">attributes</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">v</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">defaults</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
                <span class="n">v2</span> <span class="o">=</span> <span class="n">not_found_value</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">v2</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
                    <span class="n">v2</span> <span class="o">=</span> <span class="s2">&quot;&#39;</span><span class="si">{0}</span><span class="s2">&#39;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">v2</span><span class="p">)</span>
                <span class="n">out</span><span class="o">+=</span><span class="s1">&#39;</span><span class="si">{0}</span><span class="s1"> = </span><span class="si">{1}</span><span class="s1">.get(</span><span class="si">{2}</span><span class="s1">, </span><span class="si">{3}</span><span class="s1">)</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">object_name</span><span class="p">,</span> <span class="n">v</span><span class="p">]),</span>
                    <span class="s1">&#39;.&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">object_name</span><span class="p">,</span> <span class="n">defaults_name</span><span class="p">]),</span>
                     <span class="s2">&quot;&#39;</span><span class="si">{}</span><span class="s2">&#39;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">v</span><span class="p">),</span>
                     <span class="n">v2</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">v2</span> <span class="o">=</span> <span class="n">not_found_value</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">v2</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
                    <span class="n">v2</span> <span class="o">=</span> <span class="s2">&quot;&#39;</span><span class="si">{0}</span><span class="s2">&#39;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">v2</span><span class="p">)</span>
                <span class="n">out</span><span class="o">+=</span><span class="s1">&#39;</span><span class="si">{0}</span><span class="s1"> = </span><span class="si">{1}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">object_name</span><span class="p">,</span><span class="n">v</span><span class="p">]),</span> <span class="n">v2</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">out</span></div>


<div class="viewcode-block" id="InputFileLoaderCheckerSaver"><a class="viewcode-back" href="../../../api/geotecha.inputoutput.inputoutput.html#geotecha.inputoutput.inputoutput.InputFileLoaderCheckerSaver">[docs]</a><span class="k">class</span> <span class="nc">InputFileLoaderCheckerSaver</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;A class for accepting an input file, running checks, saveing data/plots.</span>

<span class="sd">    Options to:</span>

<span class="sd">     - Accept an inputfile with python syntax</span>
<span class="sd">     - Copy attribute value from a text file (i.e. text such as &#39;b = 34&#39; in</span>
<span class="sd">       the input file will be result in self.b=34)</span>
<span class="sd">     - Run checks on the attributes.</span>
<span class="sd">     - Save data to file</span>
<span class="sd">     - Save figures to file.</span>
<span class="sd">     - Common attributes along with their defaults are available to all</span>
<span class="sd">       classes that sub-class InputFileLoaderCheckerSaver.</span>


<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    reader : file_like object</span>
<span class="sd">        Object to get text from. file, StringIO, text etc.</span>
<span class="sd">    pkg_for_version : string, optional</span>
<span class="sd">        The version attribute will be determined by the version number of</span>
<span class="sd">        the `pkg_for_version` package.  Default pkg_for_version=&#39;geotecha&#39;.</span>
<span class="sd">        If for some reason pkg_for_version has not been set, or the package</span>
<span class="sd">        cannot be found, then version will be &#39;unknown&#39;.</span>


<span class="sd">    Attributes</span>
<span class="sd">    ----------</span>
<span class="sd">    _attributes : list of string</span>
<span class="sd">        User defined list of attributes. Must be defined in the sub-class.</span>
<span class="sd">        A number of common attributes will be added to the user defined list.</span>
<span class="sd">        See the Notes section for the common attributes and their default</span>
<span class="sd">        values.</span>
<span class="sd">    _attribute_defaults : dict, optional</span>
<span class="sd">        User defined dict of attribute defaults. May be defined in the</span>
<span class="sd">        sub-class. Defaults for the common attributes will will be added</span>
<span class="sd">        to the user defined list.</span>
<span class="sd">        When no default value is given , None will be used.</span>
<span class="sd">        Default _attribute_defaults=dict() i.e. all user defaults are None.</span>
<span class="sd">        See the Notes section for the common attributes and their default</span>
<span class="sd">        values.</span>
<span class="sd">    _attributes_that_should_be_lists : list of string, optional</span>
<span class="sd">        list of attributes that should be of type ``list``. Those attributes</span>
<span class="sd">        that are not None and not lists will be put in a list.</span>
<span class="sd">        May be defined in the sub-class.</span>
<span class="sd">    _attributes_that_should_have_same_x_limits : list of list of str, optional</span>
<span class="sd">        Each sublist is a list of attribute names to check.</span>
<span class="sd">        May be defined in the sub-class.</span>
<span class="sd">    _attributes_that_should_have_same_len_pairs : list of list of two string</span>
<span class="sd">        List of attribute names to check. Each sub-list should have two</span>
<span class="sd">        elements.</span>
<span class="sd">        May be defined in the sub-class.</span>
<span class="sd">    _zero_or_all : list of list of string</span>
<span class="sd">        Each element of `zero_or_all` is a list of attribute names that should</span>
<span class="sd">        either all be None or all be not None.</span>
<span class="sd">        May be defined in the sub-class.</span>
<span class="sd">    _at_least_one : list of list of string</span>
<span class="sd">        Each element of `at_least_one` is a list of attribute names of which at</span>
<span class="sd">        least one should not be None.</span>
<span class="sd">        May be defined in the sub-class.</span>
<span class="sd">    _one_implies_others : list of list of string</span>
<span class="sd">        Each element of `one_implies_others` is a list of attribute names.  If</span>
<span class="sd">        the first attribute in the list is not None then all other members of</span>
<span class="sd">        the list should also not be None.</span>
<span class="sd">        May be defined in the sub-class.</span>
<span class="sd">    _input_text : string</span>
<span class="sd">        str of the input file.  Will be None if no reader is passed to the</span>
<span class="sd">        __init__ method</span>
<span class="sd">    _debug : True/False</span>
<span class="sd">        For use with debugging. Default _debug=False</span>
<span class="sd">    _figures : list of matplotlib figures</span>
<span class="sd">        Define in sub-class. Each figure should have a label which</span>
<span class="sd">        will be used to save figures.</span>
<span class="sd">    _grid_data_dicts : list of dict</span>
<span class="sd">        Define in sub-class. For saving grid_data to file</span>
<span class="sd">        using `save_grid_data_to_file`.</span>
<span class="sd">    _file_stem: string</span>
<span class="sd">        path including file name prefix with number for all output files.</span>
<span class="sd">        default=&#39;out_000&#39;.  If</span>
<span class="sd">        create_directory=True then files will be put in a folder named</span>
<span class="sd">        `file_stem`</span>


<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    For the _attributes and _attribute_defaults  attribute the common</span>
<span class="sd">    attributes and their defualts are:</span>

<span class="sd">    =========================== ========================================</span>
<span class="sd">    attribute name              description</span>
<span class="sd">    =========================== ========================================</span>
<span class="sd">    plot_properties             dict of dict.  Each subdict will be</span>
<span class="sd">                                used to pass propeties to plotting</span>
<span class="sd">                                routines.  Contents plot_properties</span>
<span class="sd">                                should be defined in each sub-class</span>
<span class="sd">                                Default = dict().</span>
<span class="sd">    save_data_to_file           True/False. If True data will be</span>
<span class="sd">                                saved to file.</span>
<span class="sd">                                Need to write routines to save data</span>
<span class="sd">                                Default = False.</span>
<span class="sd">    save_figures_to_file        True/False. If True then figures will</span>
<span class="sd">                                be saved to file.  Need to write</span>
<span class="sd">                                routine to plot figures.</span>
<span class="sd">                                Default = False.</span>
<span class="sd">    show_figures&#39;              True/False. If True the after</span>
<span class="sd">                                calculation figures will be shown</span>
<span class="sd">                                on screen. Need plt.show somewhere in</span>
<span class="sd">                                routines.</span>
<span class="sd">                                Default = False.</span>
<span class="sd">    prefix                      string. Filename prefix for all</span>
<span class="sd">                                output files. Default = &#39;out&#39;.</span>
<span class="sd">    directory                   string. Path to directory where files</span>
<span class="sd">                                should be stored.</span>
<span class="sd">                                Default directory=None which</span>
<span class="sd">                                will use the current working directory.</span>
<span class="sd">                                Note if you keep getting</span>
<span class="sd">                                directory does not exist errors then</span>
<span class="sd">                                try putting an r before the string</span>
<span class="sd">                                definition. i.e.</span>
<span class="sd">                                directory = r&#39;C:\\Users\\...&#39;.</span>
<span class="sd">    overwrite                   True/False. If True then existing</span>
<span class="sd">                                files will be overwritten.</span>
<span class="sd">                                Default = False.</span>
<span class="sd">    create_directory            True/Fase. If True a new sub-folder</span>
<span class="sd">                                with name based on  `prefix` and an</span>
<span class="sd">                                incremented number will contain the</span>
<span class="sd">                                output. Default = True.</span>
<span class="sd">    data_ext                    string. File extension for data files.</span>
<span class="sd">                                Default = &#39;.csv&#39;.</span>
<span class="sd">    input_ext                   string. File extension for original and</span>
<span class="sd">                                parsed input files. Default = &#39;.py&#39;.</span>
<span class="sd">    figure_ext                  string. File extension for figures.</span>
<span class="sd">                                Can be any valid matplotlib option for</span>
<span class="sd">                                savefig. Default = &quot;.eps&quot;. Others</span>
<span class="sd">                                include &#39;pdf&#39;, &#39;png&#39;.</span>
<span class="sd">    author                      string. Author of analysis.</span>
<span class="sd">                                Default = &#39;unknown&#39;</span>
<span class="sd">    title                       string. A title for the input file.</span>
<span class="sd">                                This will appear at the top of data</span>
<span class="sd">                                files. Default = None, i.e. no title.</span>
<span class="sd">    version                     Default = version number from</span>
<span class="sd">                                `pkg_for_version paramter`</span>
<span class="sd">    =========================== ========================================</span>



<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">reader</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">pkg_for_version</span><span class="o">=</span><span class="s1">&#39;geotecha&#39;</span><span class="p">):</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_debug</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_setup</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">pkg_for_version</span> <span class="o">=</span> <span class="n">pkg_for_version</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;_attributes&#39;</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_initialize_attributes</span><span class="p">()</span>


        <span class="bp">self</span><span class="o">.</span><span class="n">_input_text</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">reader</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">reader</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_input_text</span> <span class="o">=</span> <span class="n">reader</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_input_text</span> <span class="o">=</span> <span class="n">reader</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_transfer_attributes_from_inputfile</span><span class="p">()</span>



    <span class="k">def</span> <span class="nf">_transfer_attributes_from_inputfile</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Transfer attributes from input file using restricted syntax.</span>

<span class="sd">        For safety reasons the inputfile syntax is restricted.  If you wish</span>
<span class="sd">        to remove these restrictions then overwrite this method with</span>
<span class="sd">        syn_checker=None.  You will then have to do explicit imports.</span>
<span class="sd">        Existing input files used when syntax_checker was not None may not</span>
<span class="sd">        work because some modules (e.g. Numpy) were implicitly imported,</span>
<span class="sd">        &#39;import&#39; commands are often banned in default syntax_checker.</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;_attributes&#39;</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;No &#39;self._attributes&#39; defined in object.&quot;</span><span class="p">)</span>

        <span class="n">attribute_defaults</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;_attribute_defaults&#39;</span><span class="p">,</span> <span class="nb">dict</span><span class="p">())</span>

        <span class="n">syn_checker</span><span class="o">=</span><span class="n">SyntaxChecker</span><span class="p">([</span><span class="s1">&#39;ast&#39;</span><span class="p">,</span><span class="s1">&#39;builtin&#39;</span><span class="p">,</span><span class="s1">&#39;numpy&#39;</span><span class="p">,</span><span class="s1">&#39;PolyLine&#39;</span><span class="p">])</span>
<span class="c1">#        syntax_checker=None</span>


        <span class="n">copy_attributes_from_text_to_object</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_input_text</span><span class="p">,</span>
            <span class="bp">self</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_attributes</span><span class="p">,</span> <span class="n">attribute_defaults</span><span class="p">,</span>
            <span class="n">not_found_value</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">syntax_checker</span><span class="o">=</span><span class="n">syn_checker</span><span class="p">)</span>


    <span class="k">def</span> <span class="nf">_initialize_attributes</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Initialize attributes</span>

<span class="sd">        Relies on presence of self._attributes</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;_attributes&#39;</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;No &#39;self._attributes&#39; defined in object.&quot;</span><span class="p">)</span>

        <span class="n">common_attributes</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;plot_properties &#39;</span>
            <span class="s1">&#39;save_data_to_file prefix directory overwrite &#39;</span>
            <span class="s1">&#39;create_directory data_ext input_ext figure_ext &#39;</span>
            <span class="s1">&#39;save_figures_to_file show_figures &#39;</span>
            <span class="s1">&#39;author &#39;</span>
            <span class="s1">&#39;version &#39;</span>
            <span class="s1">&#39;title&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">version_str</span> <span class="o">=</span> <span class="n">pkg_resources</span><span class="o">.</span><span class="n">require</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pkg_for_version</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">version</span>
        <span class="k">except</span> <span class="p">(</span><span class="n">pkg_resources</span><span class="o">.</span><span class="n">DistributionNotFound</span><span class="p">,</span> <span class="ne">AttributeError</span><span class="p">):</span>
            <span class="n">version_str</span> <span class="o">=</span> <span class="s1">&#39;unknown&#39;</span>

        <span class="n">common_attribute_defaults</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;plot_properties&#39;</span><span class="p">:</span> <span class="nb">dict</span><span class="p">(),</span>
            <span class="s1">&#39;save_data_to_file&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
            <span class="s1">&#39;save_figures_to_file&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
            <span class="s1">&#39;show_figures&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
            <span class="s1">&#39;prefix&#39;</span><span class="p">:</span> <span class="s1">&#39;out&#39;</span><span class="p">,</span>
            <span class="s1">&#39;overwrite&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
            <span class="s1">&#39;create_directory&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
            <span class="s1">&#39;data_ext&#39;</span><span class="p">:</span> <span class="s1">&#39;.csv&#39;</span><span class="p">,</span>
            <span class="s1">&#39;input_ext&#39;</span><span class="p">:</span> <span class="s1">&#39;.py&#39;</span><span class="p">,</span>
            <span class="s1">&#39;figure_ext&#39;</span><span class="p">:</span> <span class="s1">&#39;.eps&#39;</span><span class="p">,</span>
            <span class="s1">&#39;author&#39;</span><span class="p">:</span> <span class="s1">&#39;unknown&#39;</span><span class="p">,</span>
            <span class="s1">&#39;version&#39;</span><span class="p">:</span> <span class="n">version_str</span><span class="p">}</span>

        <span class="n">attribute_defaults</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;_attribute_defaults&#39;</span><span class="p">,</span> <span class="nb">dict</span><span class="p">())</span>


        <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_attributes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">common_attributes</span> <span class="k">if</span>
                <span class="n">v</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_attributes</span><span class="p">]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_attribute_defaults</span> <span class="o">=</span> <span class="n">copy_dict</span><span class="p">(</span><span class="n">common_attribute_defaults</span><span class="p">,</span>
                                        <span class="n">attribute_defaults</span><span class="p">)</span>


        <span class="n">initialize_objects_attributes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                                      <span class="bp">self</span><span class="o">.</span><span class="n">_attributes</span><span class="p">,</span>
                                      <span class="bp">self</span><span class="o">.</span><span class="n">_attribute_defaults</span><span class="p">,</span>
                                      <span class="n">not_found_value</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_determine_output_stem</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Determine the stem for outputting files&quot;&quot;&quot;</span>
        <span class="n">prefix</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;prefix&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">prefix</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">prefix</span><span class="o">=</span><span class="s1">&#39;out&#39;</span>
        <span class="n">directory</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;directory&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">directory</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">directory</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">curdir</span>
        <span class="n">overwrite</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;overwrite&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">overwrite</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">overwrite</span> <span class="o">=</span> <span class="kc">False</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_file_stem</span> <span class="o">=</span> <span class="n">next_output_stem</span><span class="p">(</span>
            <span class="n">prefix</span><span class="o">=</span><span class="n">prefix</span><span class="p">,</span> <span class="n">path</span><span class="o">=</span><span class="n">directory</span><span class="p">,</span> <span class="n">start</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">inc</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">zfill</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span>
                     <span class="n">overwrite</span><span class="o">=</span><span class="n">overwrite</span><span class="p">)</span>

        <span class="n">create_directory</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;create_directory&#39;</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">create_directory</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_file_stem</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">directory</span><span class="p">,</span>
                                           <span class="bp">self</span><span class="o">.</span><span class="n">_file_stem</span><span class="p">,</span>
                                           <span class="bp">self</span><span class="o">.</span><span class="n">_file_stem</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_file_stem</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">directory</span><span class="p">,</span>
                                           <span class="bp">self</span><span class="o">.</span><span class="n">_file_stem</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_file_stem</span><span class="p">)):</span>
            <span class="n">os</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_file_stem</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">_save_figures</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        You need the following defined:</span>

<span class="sd">         - self._figures: a list of figures to save.  Each figure should</span>
<span class="sd">           have a label</span>


<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;save_figures_to_file&#39;</span><span class="p">,</span> <span class="kc">False</span><span class="p">):</span>
            <span class="k">return</span>

        <span class="k">if</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;_figures&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span>

        <span class="k">if</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;_file_stem&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_determine_output_stem</span><span class="p">()</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_figures</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
            <span class="n">figures</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_figures</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">figures</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_figures</span>

<span class="c1">#        directory = getattr(self, &#39;directory&#39;, None)</span>
<span class="c1">#        if directory is None:</span>
<span class="c1">#            directory = os.curdir</span>
<span class="c1">#</span>
<span class="c1">#        create_directory = getattr(self, &#39;create_directory&#39;, True)</span>


        <span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">fig</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_figures</span><span class="p">):</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">fig</span><span class="o">.</span><span class="n">get_label</span><span class="p">())</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">figname</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">get_label</span><span class="p">()</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">figname</span> <span class="o">=</span> <span class="s2">&quot;Figure_</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">.</span><span class="n">zfill</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
            <span class="n">filename</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_file_stem</span> <span class="o">+</span><span class="s1">&#39;_&#39;</span> <span class="o">+</span> <span class="n">figname</span> <span class="o">+</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;figure_ext&#39;</span><span class="p">,</span>
                                                               <span class="s1">&#39;.eps&#39;</span><span class="p">)</span>
            <span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="n">fig</span><span class="o">.</span><span class="n">dpi</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_save_data</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;save_data_to_file&#39;</span><span class="p">,</span> <span class="kc">False</span><span class="p">):</span>
            <span class="k">return</span>

        <span class="k">if</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;_file_stem&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_determine_output_stem</span><span class="p">()</span>

        <span class="c1">#original input</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;_input_text&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">filename</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_file_stem</span> <span class="o">+</span> <span class="s2">&quot;_input_original&quot;</span> <span class="o">+</span>
                <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;input_ext&#39;</span><span class="p">,</span> <span class="s1">&#39;.py&#39;</span><span class="p">))</span>

            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span><span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">myfile</span><span class="p">:</span>
                <span class="n">myfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_input_text</span><span class="p">)</span>

        <span class="c1">#parsed input</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;_attributes&#39;</span><span class="p">):</span>
            <span class="n">filename</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_file_stem</span> <span class="o">+</span> <span class="s2">&quot;_input_parsed&quot;</span> <span class="o">+</span>
                    <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;input_ext&#39;</span><span class="p">,</span> <span class="s1">&#39;.py&#39;</span><span class="p">))</span>
            <span class="n">text</span> <span class="o">=</span> <span class="n">string_of_object_attributes</span><span class="p">(</span><span class="n">obj</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span>
                            <span class="n">attributes</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_attributes</span><span class="p">,</span> <span class="n">none_at_bottom</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                        <span class="n">numpy_array_prefix</span> <span class="o">=</span> <span class="s2">&quot;np.&quot;</span><span class="p">)</span>
            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">myfile</span><span class="p">:</span>
                <span class="n">myfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>


        <span class="c1">#grid data</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;_grid_data_dicts&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span> <span class="c1">#no data</span>
            <span class="n">save_grid_data_to_file</span><span class="p">(</span><span class="n">data_dicts</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_grid_data_dicts</span><span class="p">,</span>
                   <span class="n">directory</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_file_stem</span><span class="p">),</span>
                   <span class="n">file_stem</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_file_stem</span><span class="p">),</span>
                   <span class="n">create_directory</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="c1"># already in file stem getattr(self, &#39;create_directory&#39;, True),</span>
                   <span class="n">ext</span><span class="o">=</span><span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;data_ext&#39;</span><span class="p">,</span> <span class="s1">&#39;.csv&#39;</span><span class="p">))</span>




    <span class="k">def</span> <span class="nf">_setup</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set up attributes for checking and initializing</span>

<span class="sd">        To be overridden in subclasses</span>

<span class="sd">        Basically define:</span>
<span class="sd">         - self._attribute_defaults</span>
<span class="sd">         - self._attributes</span>
<span class="sd">         - self._attributes_that_should_be_lists</span>
<span class="sd">         - self._attributes_to_force_same_len</span>
<span class="sd">         - self._attributes_that_should_have_same_x_limits</span>
<span class="sd">         - self._attributes_that_should_have_same_len_pairs</span>
<span class="sd">         - self._zero_or_all</span>
<span class="sd">         - self._at_least_one</span>
<span class="sd">         - self._one_implies_others</span>

<span class="sd">        To make coding easier (i.e. autocomplete) once you have a</span>
<span class="sd">        self.attributes defined,</span>
<span class="sd">        `use code_for_explicit_attribute_initialization`</span>
<span class="sd">        and paste the resulting code into your `_setup` routine</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">pass</span>
        <span class="k">return</span>

<div class="viewcode-block" id="InputFileLoaderCheckerSaver.check_input_attributes"><a class="viewcode-back" href="../../../api/geotecha.inputoutput.inputoutput.html#geotecha.inputoutput.inputoutput.InputFileLoaderCheckerSaver.check_input_attributes">[docs]</a>    <span class="k">def</span> <span class="nf">check_input_attributes</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Perform checks on attributes</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>

<span class="sd">        See Also</span>
<span class="sd">        --------</span>
<span class="sd">        check_attribute_combinations</span>
<span class="sd">        check_attribute_is_list</span>
<span class="sd">        force_attribute_same_len_if_none</span>
<span class="sd">        check_attribute_PolyLines_have_same_x_limits</span>
<span class="sd">        check_attribute_pairs_have_equal_length</span>

<span class="sd">        &quot;&quot;&quot;</span>


        <span class="n">zero_or_all</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;_zero_or_all&#39;</span><span class="p">,</span> <span class="p">[])</span>
        <span class="n">at_least_one</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;_at_least_one&#39;</span><span class="p">,</span> <span class="p">[])</span>
        <span class="n">one_implies_others</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;_one_implies_others&#39;</span><span class="p">,</span> <span class="p">[])</span>
        <span class="n">attributes_that_should_be_lists</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
            <span class="s1">&#39;_attributes_that_should_be_lists&#39;</span><span class="p">,[])</span>
        <span class="n">attributes_to_force_same_len</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
             <span class="s1">&#39;_attributes_to_force_same_len&#39;</span><span class="p">,</span> <span class="p">[])</span>
        <span class="n">attributes_that_should_have_same_x_limits</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
            <span class="s1">&#39;_attributes_that_should_have_same_x_limits&#39;</span><span class="p">,</span> <span class="p">[])</span>
        <span class="n">attributes_that_should_have_same_len_pairs</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
            <span class="s1">&#39;_attributes_that_should_have_same_len_pairs&#39;</span><span class="p">,</span> <span class="p">[])</span>




        <span class="n">check_attribute_combinations</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                                     <span class="n">zero_or_all</span><span class="p">,</span>
                                     <span class="n">at_least_one</span><span class="p">,</span>
                                     <span class="n">one_implies_others</span><span class="p">)</span>

        <span class="n">check_attribute_is_list</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                            <span class="n">attributes_that_should_be_lists</span><span class="p">,</span> <span class="n">force_list</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="n">force_attribute_same_len_if_none</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                                     <span class="n">attributes_to_force_same_len</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>

        <span class="n">check_attribute_PolyLines_have_same_x_limits</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                         <span class="n">attributes</span><span class="o">=</span><span class="n">attributes_that_should_have_same_x_limits</span><span class="p">)</span>
        <span class="n">check_attribute_pairs_have_equal_length</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                        <span class="n">attributes</span><span class="o">=</span><span class="n">attributes_that_should_have_same_len_pairs</span><span class="p">)</span>

        <span class="k">return</span></div></div>





<div class="viewcode-block" id="string_of_object_attributes"><a class="viewcode-back" href="../../../api/geotecha.inputoutput.inputoutput.html#geotecha.inputoutput.inputoutput.string_of_object_attributes">[docs]</a><span class="k">def</span> <span class="nf">string_of_object_attributes</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">attributes</span><span class="o">=</span><span class="p">[],</span> <span class="n">none_at_bottom</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                    <span class="n">numpy_array_prefix</span> <span class="o">=</span> <span class="s2">&quot;np.&quot;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Put repr of objects attributes into one string</span>

<span class="sd">    The repr of each attribute will be put in a line within the output string.</span>
<span class="sd">    If the attribute is not found then None will be given.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    obj : object</span>
<span class="sd">        Object containing attributes.</span>
<span class="sd">    attributes : list of string, optional</span>
<span class="sd">        List of attribute names.</span>
<span class="sd">    none_at_bottom : True/False</span>
<span class="sd">        If True then any attribute that is None will be placed at the end</span>
<span class="sd">        of the output string.</span>
<span class="sd">    numpy_array_prefix : string, optional</span>
<span class="sd">        repr of numpy arrays by default do not print with anything in front of</span>
<span class="sd">        &#39;array&#39;.  with `numpy_array_prefix` wou can add a &#39;np.&#39; etc.  default=</span>
<span class="sd">        &#39;np.&#39; Use `None` for no prefix.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    out : str</span>
<span class="sd">        String</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">f</span><span class="p">(</span><span class="n">v</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="k">return</span> <span class="s2">&quot;&#39;&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="s2">&quot;&quot;</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">numpy_array_prefix</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">a</span> <span class="o">=</span> <span class="n">PrefixNumpyArrayString</span><span class="p">(</span><span class="n">numpy_array_prefix</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">a</span> <span class="o">=</span> <span class="n">PrefixNumpyArrayString</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
    <span class="n">a</span><span class="o">.</span><span class="n">turn_on</span><span class="p">()</span>



    <span class="n">writer</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
    <span class="k">if</span> <span class="n">none_at_bottom</span><span class="p">:</span>
        <span class="n">writer</span><span class="o">+=</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="s1">&#39;</span><span class="si">{0}</span><span class="s1"> = </span><span class="si">{1}{2}{1}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">f</span><span class="p">(</span><span class="nb">getattr</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="kc">None</span><span class="p">)),</span>
            <span class="nb">getattr</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="kc">None</span><span class="p">))</span>
            <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">attributes</span> <span class="k">if</span> <span class="ow">not</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">])</span>
        <span class="n">writer</span><span class="o">+=</span><span class="s1">&#39;</span><span class="se">\n\n\n</span><span class="s1">&#39;</span>
        <span class="n">writer</span><span class="o">+=</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="s1">&#39;</span><span class="si">{0}</span><span class="s1"> = </span><span class="si">{1}{2}{1}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">f</span><span class="p">(</span><span class="nb">getattr</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="kc">None</span><span class="p">)),</span>
            <span class="nb">getattr</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="kc">None</span><span class="p">))</span>
            <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">attributes</span> <span class="k">if</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">])</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">writer</span><span class="o">+=</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="s1">&#39;</span><span class="si">{0}</span><span class="s1"> = </span><span class="si">{1}{2}{1}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">f</span><span class="p">(</span><span class="nb">getattr</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="kc">None</span><span class="p">)),</span>
            <span class="nb">getattr</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="kc">None</span><span class="p">))</span>
            <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">attributes</span><span class="p">])</span>

    <span class="n">writer</span><span class="o">+=</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
    <span class="n">a</span><span class="o">.</span><span class="n">turn_off</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">writer</span></div>



<div class="viewcode-block" id="PrefixNumpyArrayString"><a class="viewcode-back" href="../../../api/geotecha.inputoutput.inputoutput.html#geotecha.inputoutput.inputoutput.PrefixNumpyArrayString">[docs]</a><span class="k">class</span> <span class="nc">PrefixNumpyArrayString</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;When printing a numpy array string prefix &#39;array&#39;</span>

<span class="sd">    If you use `repr` to print a numpy array it will print as &#39;array([...])&#39;.</span>
<span class="sd">    If you have imported numpy with &#39;import numpy.array as array&#39; or some such</span>
<span class="sd">    import then you can paste the printed output straight back into Python.</span>
<span class="sd">    However, I use &#39;import numpy as np&#39; so I have to manually put in the &#39;np.&#39;</span>
<span class="sd">    before I can use the printed output in my code.  Using</span>
<span class="sd">    PrefixNumpyArrayString can put in the &#39;np.&#39; automatically when using the</span>
<span class="sd">    __str__ of the numpy array. i.e. __repr__ remains unchanged but __str__</span>
<span class="sd">    will have the prefix</span>

<span class="sd">    Attributes</span>
<span class="sd">    ----------</span>
<span class="sd">    prefix : string, optional</span>
<span class="sd">        string to prefix with. Default prefix=&#39;np.&#39;.</span>


<span class="sd">    Examples</span>
<span class="sd">    --------</span>

<span class="sd">    &gt;&gt;&gt; print(np.arange(3))</span>
<span class="sd">    [0 1 2]</span>
<span class="sd">    &gt;&gt;&gt; a=PrefixNumpyArrayString(&#39;numpy.&#39;)</span>
<span class="sd">    &gt;&gt;&gt; a.turn_on()</span>
<span class="sd">    &gt;&gt;&gt; print(np.arange(3))</span>
<span class="sd">    numpy.array([0, 1, 2])</span>
<span class="sd">    &gt;&gt;&gt; a.turn_off()</span>
<span class="sd">    &gt;&gt;&gt; print(np.arange(3))</span>
<span class="sd">    [0 1 2]</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">prefix</span> <span class="o">=</span> <span class="s1">&#39;np.&#39;</span><span class="p">):</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">prefix</span> <span class="o">=</span> <span class="n">prefix</span>

    <span class="k">def</span> <span class="nf">_pprint</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">arr</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Function to pass to np.set_string_function&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="s1">&#39;</span><span class="si">{}{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">prefix</span><span class="p">,</span> <span class="nb">repr</span><span class="p">(</span><span class="n">arr</span><span class="p">))</span>

<div class="viewcode-block" id="PrefixNumpyArrayString.turn_on"><a class="viewcode-back" href="../../../api/geotecha.inputoutput.inputoutput.html#geotecha.inputoutput.inputoutput.PrefixNumpyArrayString.turn_on">[docs]</a>    <span class="k">def</span> <span class="nf">turn_on</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Turn_on printing numpy array with prefix&quot;&quot;&quot;</span>
        <span class="n">np</span><span class="o">.</span><span class="n">set_string_function</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_pprint</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span></div>

<div class="viewcode-block" id="PrefixNumpyArrayString.turn_off"><a class="viewcode-back" href="../../../api/geotecha.inputoutput.inputoutput.html#geotecha.inputoutput.inputoutput.PrefixNumpyArrayString.turn_off">[docs]</a>    <span class="k">def</span> <span class="nf">turn_off</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Turn_on printing numpy array with prefix&quot;&quot;&quot;</span>
        <span class="n">np</span><span class="o">.</span><span class="n">set_string_function</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span></div></div>


<div class="viewcode-block" id="next_output_stem"><a class="viewcode-back" href="../../../api/geotecha.inputoutput.inputoutput.html#geotecha.inputoutput.inputoutput.next_output_stem">[docs]</a><span class="k">def</span> <span class="nf">next_output_stem</span><span class="p">(</span><span class="n">prefix</span><span class="p">,</span> <span class="n">path</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">start</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">inc</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">zfill</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
                     <span class="n">overwrite</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Find next unique prefix-number in sequence of numbered files/folders</span>

<span class="sd">    Looks in folder of `path` for files/folders with prefix-number combos</span>
<span class="sd">    of the form &#39;prefixdddxyz.ext&#39;.  If found</span>
<span class="sd">    then the ddd is incremented by `inc` and the new &#39;prefixddd&#39; is returned.</span>
<span class="sd">    E.g. if file &#39;prefix004_exact.out&#39; exists you will get &#39;prefix_005&#39; as</span>
<span class="sd">    the next output stem.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    prefix : string</span>
<span class="sd">        Start of file/folder name to search for.</span>
<span class="sd">    path : string, optional</span>
<span class="sd">        Folder to seach in.  Default path=None i.e. search in current working</span>
<span class="sd">        directory.</span>
<span class="sd">    start : int, optional</span>
<span class="sd">        If no existing files/folders match the numbering will start at `start`.</span>
<span class="sd">        Default start=1.</span>
<span class="sd">    inc : int, optional</span>
<span class="sd">        If matching files/folders are found then the number will increment</span>
<span class="sd">        by inc. Default inc=1.</span>
<span class="sd">    zfill : int, optional</span>
<span class="sd">        Fill number with zeros to the left. eg. if `zfill` is 3 and the number</span>
<span class="sd">        is 8, then the number will be output as &#39;008&#39;.</span>
<span class="sd">    overwrite : True/False</span>
<span class="sd">        When True the prefix-number combo will not be incremented and the</span>
<span class="sd">        highest exisiting prefix-number combo will be returned.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    stem : string</span>
<span class="sd">        Next output stem.</span>

<span class="sd">    &quot;&quot;&quot;</span>


    <span class="k">if</span> <span class="n">path</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">cwd</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">curdir</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">path</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;folder does not exist: &#39;</span> <span class="o">+</span> <span class="n">path</span><span class="p">)</span>
        <span class="n">cwd</span> <span class="o">=</span> <span class="n">path</span>


    <span class="n">pattern</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">prefix</span> <span class="o">+</span> <span class="s2">&quot;(?P&lt;x&gt;\d+).*&quot;</span><span class="p">)</span>

    <span class="n">nums</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">nm</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="n">cwd</span><span class="p">):</span>
        <span class="n">match</span> <span class="o">=</span> <span class="n">pattern</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="n">nm</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">match</span><span class="p">:</span>
            <span class="n">nums</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">match</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)))</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">nums</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span>

        <span class="n">num</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">nums</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">overwrite</span><span class="p">:</span>
            <span class="n">num</span> <span class="o">+=</span> <span class="n">inc</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">num</span> <span class="o">=</span> <span class="n">start</span>

    <span class="k">return</span> <span class="n">prefix</span><span class="o">+</span><span class="s2">&quot;&quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">num</span><span class="p">)</span><span class="o">.</span><span class="n">zfill</span><span class="p">(</span><span class="n">zfill</span><span class="p">)</span></div>


<div class="viewcode-block" id="make_array_into_dataframe"><a class="viewcode-back" href="../../../api/geotecha.inputoutput.inputoutput.html#geotecha.inputoutput.inputoutput.make_array_into_dataframe">[docs]</a><span class="k">def</span> <span class="nf">make_array_into_dataframe</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">column_labels</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">row_labels</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                                <span class="n">row_labels_label</span><span class="o">=</span><span class="s1">&#39;item&#39;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Make an array into a pandas dataframe</span>

<span class="sd">    The data frame will have no index. Use df.set_index().</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    data : 2d array</span>
<span class="sd">        Data to be put int</span>
<span class="sd">    column_labels :  list or 1d array, optional</span>
<span class="sd">        Column lables for data. Default column_labels=None which will give</span>
<span class="sd">        column numbers 0,1,2, etc.</span>
<span class="sd">    row_labels : list or 1d array, optional</span>
<span class="sd">        Default row_labels=None which will use row numbers, 0,1,2,etc.</span>
<span class="sd">    row_labels_label : string, optional</span>
<span class="sd">        Column label for the row_labels column.  Default</span>
<span class="sd">        row_labels_label=&#39;item&#39;.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    df : pandas dataframe</span>
<span class="sd">        dDtaframe of data with column and row labels added</span>


<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">data</span>

    <span class="k">if</span> <span class="n">column_labels</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">column_labels</span><span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">row_labels</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">s</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">row_labels</span><span class="p">)</span>
        <span class="n">df</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="n">row_labels_label</span><span class="p">,</span> <span class="n">value</span> <span class="o">=</span> <span class="n">row_labels</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">df</span></div>





<div class="viewcode-block" id="save_grid_data_to_file"><a class="viewcode-back" href="../../../api/geotecha.inputoutput.inputoutput.html#geotecha.inputoutput.inputoutput.save_grid_data_to_file">[docs]</a><span class="k">def</span> <span class="nf">save_grid_data_to_file</span><span class="p">(</span><span class="n">data_dicts</span><span class="p">,</span> <span class="n">directory</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">file_stem</span><span class="o">=</span><span class="s1">&#39;out_000&#39;</span><span class="p">,</span>
                           <span class="n">create_directory</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">ext</span><span class="o">=</span><span class="s1">&#39;.csv&#39;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Save grid data to files using a common filename stem</span>

<span class="sd">    Saves grid data in `directory`.  Each data filename will begin with</span>
<span class="sd">    `file_stem`.  Grid data is basically 2d data with rows and columns.</span>


<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    data_dicts : list of dict or single dict</span>
<span class="sd">        Each data_dict contains info for outputing a piece of data to a file.</span>
<span class="sd">        Although the data_dicts parameter is listed last, each data_dict</span>
<span class="sd">        should appear at the start of the argument list when calling the</span>
<span class="sd">        function.</span>

<span class="sd">        ==================  ============================================</span>
<span class="sd">        data_dict key       description</span>
<span class="sd">        ==================  ============================================</span>
<span class="sd">        name                String to be added to end of stem to create</span>
<span class="sd">                            file_name.</span>
<span class="sd">        data                array of data to save to file.  If data</span>
<span class="sd">                            is a pandas dataframe then row_labels and</span>
<span class="sd">                            column labels will be ignored (i.e. it will</span>
<span class="sd">                            be assumed that the dataframe already has</span>
<span class="sd">                            row labels and column labels).</span>
<span class="sd">        row_labels          List of row labels for data. default = None</span>
<span class="sd">                            which will give no row labels.</span>
<span class="sd">        row_labels_label    If there are row_labels then the column</span>
<span class="sd">                            label for the row_label column.</span>
<span class="sd">                            Default = None which will give &#39;item&#39;.</span>
<span class="sd">        column_labels       Column lables for data.</span>
<span class="sd">                            Default = None which will give nothing.</span>
<span class="sd">        header              String to appear before data.</span>
<span class="sd">                            Default = None.</span>
<span class="sd">        df_kwargs           dict of kwargs to pass to</span>
<span class="sd">                            pandas.DataFrame.to_csv(). Default ={}.</span>
<span class="sd">        ==================  ============================================</span>
<span class="sd">    directory : string, optional</span>
<span class="sd">        Path of directory to save data in.  Default directory=None which will</span>
<span class="sd">        save to the current working directory.</span>
<span class="sd">    file_stem : string, optional</span>
<span class="sd">        beginning of file name, Default file_stem=&#39;out_000&#39;. Filename will be</span>
<span class="sd">        made from `file_stem` + [`data_dict`[&#39;name&#39;]] + `ext`.</span>
<span class="sd">    ext : string, optional</span>
<span class="sd">        File extension.  Default ext=&quot;.csv&quot;.</span>
<span class="sd">    create_directory : True/False, optional</span>
<span class="sd">        If True, all data files will be placed in a directory named file_stem.</span>
<span class="sd">        So you might get files</span>
<span class="sd">        path_to_directory\\out_000\\out_000_cow.csv etc.</span>
<span class="sd">        If False, all data files will be placed in `directory`.  So you would</span>
<span class="sd">        get files path_to_directory\\out_000_cow.csv etc. Default</span>
<span class="sd">        create_directory=True.</span>


<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data_dicts</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
        <span class="n">data_dicts</span><span class="o">=</span><span class="p">[</span><span class="n">data_dicts</span><span class="p">]</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">data_dicts</span><span class="p">)</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span>


    <span class="k">if</span> <span class="ow">not</span> <span class="nb">all</span><span class="p">([</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="nb">dict</span><span class="p">)</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">data_dicts</span><span class="p">]):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;all elements of data_dicts must be a dict.&#39;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">directory</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">directory</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">curdir</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">directory</span><span class="p">):</span>
        <span class="n">os</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">directory</span><span class="p">)</span>


    <span class="k">if</span> <span class="n">create_directory</span><span class="p">:</span>
        <span class="n">dirname</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">directory</span><span class="p">,</span> <span class="n">file_stem</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">dirname</span><span class="p">):</span>
            <span class="n">os</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">dirname</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">dirname</span> <span class="o">=</span> <span class="n">directory</span>


    <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">data_dicts</span><span class="p">:</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">d</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;data&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="n">name</span> <span class="o">=</span> <span class="n">d</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;name&#39;</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
        <span class="n">row_labels</span> <span class="o">=</span> <span class="n">d</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;row_labels&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="n">row_labels_label</span> <span class="o">=</span> <span class="n">d</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;row_labels_label&#39;</span><span class="p">,</span> <span class="s1">&#39;item&#39;</span><span class="p">)</span>
        <span class="n">column_labels</span> <span class="o">=</span> <span class="n">d</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;column_labels&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="n">header</span> <span class="o">=</span> <span class="n">d</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;header&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="n">df_kwargs</span> <span class="o">=</span> <span class="n">d</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;df_kwargs&#39;</span><span class="p">,{})</span>

        <span class="k">if</span> <span class="n">data</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="n">df</span> <span class="o">=</span> <span class="n">make_array_into_dataframe</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span>
                <span class="n">column_labels</span><span class="o">=</span><span class="n">column_labels</span><span class="p">,</span> <span class="n">row_labels</span><span class="o">=</span><span class="n">row_labels</span><span class="p">,</span>
                <span class="n">row_labels_label</span><span class="o">=</span><span class="n">row_labels_label</span><span class="p">)</span>

        <span class="n">df_kwargs</span><span class="p">[</span><span class="s1">&#39;index_label&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;idex&quot;</span> <span class="c1"># ensure all columns have labels incl. index</span>
        <span class="n">filename</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">dirname</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">file_stem</span><span class="p">)</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">name</span><span class="p">)</span> <span class="o">+</span> <span class="n">ext</span> <span class="p">)</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span><span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">myfile</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">header</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">myfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">header</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="n">df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">myfile</span><span class="p">,</span> <span class="o">**</span><span class="n">df_kwargs</span><span class="p">)</span></div>



<div class="viewcode-block" id="hms_string"><a class="viewcode-back" href="../../../api/geotecha.inputoutput.inputoutput.html#geotecha.inputoutput.inputoutput.hms_string">[docs]</a><span class="k">def</span> <span class="nf">hms_string</span><span class="p">(</span><span class="n">sec_elapsed</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Convert seconds to human readable h:min:seconds</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    sec_elapsed : float</span>
<span class="sd">        Elapsed seconds</span>

<span class="sd">    References</span>
<span class="sd">    ----------</span>
<span class="sd">    Copied verbatim from http://arcpy.wordpress.com/2012/04/20/146/</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">h</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">sec_elapsed</span> <span class="o">/</span> <span class="p">(</span><span class="mi">60</span> <span class="o">*</span> <span class="mi">60</span><span class="p">))</span>
    <span class="n">m</span> <span class="o">=</span> <span class="nb">int</span><span class="p">((</span><span class="n">sec_elapsed</span> <span class="o">%</span> <span class="p">(</span><span class="mi">60</span> <span class="o">*</span> <span class="mi">60</span><span class="p">))</span> <span class="o">/</span> <span class="mi">60</span><span class="p">)</span>
    <span class="n">s</span> <span class="o">=</span> <span class="n">sec_elapsed</span> <span class="o">%</span> <span class="mf">60.</span>
    <span class="k">return</span> <span class="s2">&quot;</span><span class="si">{}</span><span class="s2">:</span><span class="si">{:&gt;02}</span><span class="s2">:</span><span class="si">{:&gt;05.2f}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">h</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="n">s</span><span class="p">)</span></div>


<div class="viewcode-block" id="GenericInputFileArgParser"><a class="viewcode-back" href="../../../api/geotecha.inputoutput.inputoutput.html#geotecha.inputoutput.inputoutput.GenericInputFileArgParser">[docs]</a><span class="k">class</span> <span class="nc">GenericInputFileArgParser</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Pass input files to a class/function, then call methods on the object</span>

<span class="sd">    see self.main for use in scripts.</span>

<span class="sd">    The working directory will be changed to the location of each input file</span>

<span class="sd">    Basically the path of each input file is passed to the method self.process.</span>


<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    obj : object/callable</span>
<span class="sd">        Object to call with input file as argument.</span>
<span class="sd">    methods : sequence of 3 element tuples, optional</span>
<span class="sd">        Each element of methods is a 3 element tuple (method_name, args,</span>
<span class="sd">        kwargs). After `obj` has been initialized the obj&#39;s method called</span>
<span class="sd">        &#39;method_name&#39; will be called with unpacked args and kwargs. i.e.</span>
<span class="sd">        obj(filename).method_name(*args, **kwargs). Default methods=[] i.e.</span>
<span class="sd">        no methods called.</span>
<span class="sd">    pass_open_file : True/False, optional</span>
<span class="sd">        If True then input files will be passed to obj as open file objects.</span>
<span class="sd">        If False then paths of the input files will be passed to obj.</span>
<span class="sd">        Default pass_open_file=True</span>
<span class="sd">    prog : string, optional</span>
<span class="sd">        Part of usage method for argparse, the name of the program.</span>
<span class="sd">        Default prog=None which uses sys.argv[0] i.e. the first command line</span>
<span class="sd">        paramter.</span>
<span class="sd">    description : string, optional</span>
<span class="sd">        Part of usage method for argparse.</span>
<span class="sd">        Default description=&quot;Process some input files&quot;.</span>
<span class="sd">    epilog : string, optional</span>
<span class="sd">        Part of usage method for argparse. Default epilog=&#39;If no options are</span>
<span class="sd">        specifyied then the user will be prompted to select files.&#39;</span>



<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    For basic usage, in a file to be used as a script put::</span>

<span class="sd">        if __name__==&#39;__main__&#39;:</span>
<span class="sd">            a = GenericInputFileArgParser(obj_to_call)</span>
<span class="sd">            a.main()</span>


<span class="sd">    See Also</span>
<span class="sd">    --------</span>
<span class="sd">    argparse : better description of some of the variables.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">,</span>
                 <span class="n">pass_open_file</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                 <span class="n">methods</span><span class="o">=</span><span class="p">[],</span>
                 <span class="n">prog</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                 <span class="n">description</span> <span class="o">=</span> <span class="s2">&quot;Process some input files&quot;</span><span class="p">,</span>
                 <span class="n">epilog</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;If no options are specifyied then the user &#39;</span>
                           <span class="s1">&#39;will be prompted to select files.&#39;</span><span class="p">)):</span>


        <span class="bp">self</span><span class="o">.</span><span class="n">obj</span> <span class="o">=</span> <span class="n">obj</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pass_open_file</span> <span class="o">=</span> <span class="n">pass_open_file</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">methods</span> <span class="o">=</span> <span class="n">methods</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_prog</span> <span class="o">=</span> <span class="n">prog</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_description</span> <span class="o">=</span> <span class="n">description</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_epilog</span> <span class="o">=</span> <span class="n">epilog</span>

<div class="viewcode-block" id="GenericInputFileArgParser.process"><a class="viewcode-back" href="../../../api/geotecha.inputoutput.inputoutput.html#geotecha.inputoutput.inputoutput.GenericInputFileArgParser.process">[docs]</a>    <span class="k">def</span> <span class="nf">process</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Process the input file path</span>

<span class="sd">        The default behaviour of self.process depends on `self.pass_open_file`.</span>
<span class="sd">        If True then `path` will be opened and then self.obj will be called</span>
<span class="sd">        with the opened file as the argument. If False then then `self.obj`</span>
<span class="sd">        will be called with the path itself as argument.</span>

<span class="sd">        If you need more complicated behaviour to process your input file</span>
<span class="sd">        (e.g. initalize self.obj with a path and then call one of it&#39;s methods)</span>
<span class="sd">        then over write this method.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        path : string</span>
<span class="sd">            Absolute path to input file.</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">pass_open_file</span><span class="p">:</span>
            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">path</span><span class="p">,</span><span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
                <span class="n">a</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">obj</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">a</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">obj</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">s</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="n">kwargs</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">methods</span><span class="p">:</span>
            <span class="nb">getattr</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">s</span><span class="p">)(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>


<div class="viewcode-block" id="GenericInputFileArgParser.main"><a class="viewcode-back" href="../../../api/geotecha.inputoutput.inputoutput.html#geotecha.inputoutput.inputoutput.GenericInputFileArgParser.main">[docs]</a>    <span class="k">def</span> <span class="nf">main</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">argv</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Accept command line arguments and pass files/paths to self.obj</span>

<span class="sd">        Allows users to specify files via the command line in various ways:</span>

<span class="sd">        1. If no options are specifyied a dialog box will open for the user</span>
<span class="sd">        to select files.</span>
<span class="sd">        2. A list of file paths can be specified with the --filename option</span>
<span class="sd">        3. The --directory and --pattern options can be used together to</span>
<span class="sd">        search a particular directory for files matching a certain pattern.</span>
<span class="sd">        If no actual directory is specified then the current working directory</span>
<span class="sd">        will be used.  The default pattern to look for is &quot;*.py&quot;.  The</span>
<span class="sd">        script file itself will not be processed if it matches the pattern</span>
<span class="sd">        itself.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        argv : list of str, optional</span>
<span class="sd">            List of command line arguments. Default argv=None which will grab</span>
<span class="sd">            arguments from sys.argv.  Used mainly for testing or bypassing</span>
<span class="sd">            script based command line arguments.</span>


<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">parser</span> <span class="o">=</span> <span class="n">argparse</span><span class="o">.</span><span class="n">ArgumentParser</span><span class="p">(</span><span class="n">prog</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_prog</span><span class="p">,</span>
                                         <span class="n">description</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_description</span><span class="p">,</span>
                                         <span class="n">epilog</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_epilog</span><span class="p">)</span>

        <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;-f&#39;</span><span class="p">,</span> <span class="s1">&#39;--filename&#39;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span><span class="c1">#argparse.FileType(&#39;r&#39;),</span>
                            <span class="n">nargs</span><span class="o">=</span><span class="s1">&#39;+&#39;</span><span class="p">,</span>
                            <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Path(s) to input file(s).&quot;</span><span class="p">)</span>

        <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;-d&#39;</span><span class="p">,</span> <span class="s1">&#39;--directory&#39;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span>
                            <span class="n">nargs</span><span class="o">=</span><span class="s1">&#39;*&#39;</span><span class="p">,</span>
                            <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Path(s) to directory containing input &quot;</span>
                            <span class="s2">&quot;files. Files in specified directory(s) that &quot;</span>
                            <span class="s2">&quot;match the pattern given with the --pattern &quot;</span>
                            <span class="s2">&quot;flag will be used.  If the --directory flag is &quot;</span>
                            <span class="s2">&quot;used without specifying a directory then the &quot;</span>
                            <span class="s2">&quot;current working directroy will be used.&quot;</span><span class="p">)</span>

        <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;-p&#39;</span><span class="p">,</span> <span class="s1">&#39;--pattern&#39;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span>
                            <span class="n">nargs</span><span class="o">=</span><span class="s1">&#39;?&#39;</span><span class="p">,</span> <span class="n">const</span><span class="o">=</span><span class="s2">&quot;*.py&quot;</span><span class="p">,</span>
                            <span class="n">help</span><span class="o">=</span><span class="s2">&quot;pattern to match files in the &quot;</span>
                            <span class="s2">&quot;directory specified using the --directory flag. &quot;</span>
                            <span class="s2">&quot;If the --pattern flag is used without &quot;</span>
                            <span class="s2">&quot;specifying a pattern then &#39;*.py&#39; will be used.&quot;</span><span class="p">)</span>




        <span class="k">if</span> <span class="n">argv</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">ns</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="n">parse_args</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">ns</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="n">parse_args</span><span class="p">(</span><span class="n">argv</span><span class="p">)</span>



        <span class="k">if</span> <span class="nb">len</span><span class="p">([</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="p">(</span><span class="n">ns</span><span class="o">.</span><span class="n">pattern</span><span class="p">,</span> <span class="n">ns</span><span class="o">.</span><span class="n">directory</span><span class="p">)</span> <span class="k">if</span> <span class="n">x</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">])</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">parser</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s1">&#39;--directory and --pattern must be given together. &#39;</span><span class="p">)</span>


        <span class="k">if</span> <span class="nb">len</span><span class="p">([</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="p">(</span><span class="n">ns</span><span class="o">.</span><span class="n">filename</span><span class="p">,</span> <span class="n">ns</span><span class="o">.</span><span class="n">directory</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">x</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">])</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
            <span class="n">parser</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s1">&#39;--filenames and --directory cannot be used &#39;</span>
                         <span class="s1">&#39;together.&#39;</span><span class="p">)</span>


        <span class="n">ns</span><span class="o">.</span><span class="n">directory</span> <span class="o">=</span> <span class="p">[</span><span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">()]</span> <span class="k">if</span> <span class="n">ns</span><span class="o">.</span><span class="n">directory</span><span class="o">==</span><span class="p">[]</span> <span class="k">else</span> <span class="n">ns</span><span class="o">.</span><span class="n">directory</span>

        <span class="k">if</span> <span class="p">(</span><span class="ow">not</span> <span class="n">ns</span><span class="o">.</span><span class="n">directory</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="ow">not</span> <span class="n">ns</span><span class="o">.</span><span class="n">pattern</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">):</span>
            <span class="c1">#find all files that match pattern</span>
            <span class="n">filenames</span><span class="o">=</span><span class="p">[]</span>
            <span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">d</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">ns</span><span class="o">.</span><span class="n">directory</span><span class="p">):</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">d</span><span class="p">):</span>
                    <span class="n">parser</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s1">&#39;directory #</span><span class="si">{0}</span><span class="s1"> in command line is not a &#39;</span>
                    <span class="s1">&#39;valid directory: </span><span class="si">{1}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">d</span><span class="p">))</span>

                <span class="p">[</span><span class="n">filenames</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">d</span><span class="p">),</span> <span class="n">v</span><span class="p">))</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span>
                    <span class="n">fnmatch</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="n">d</span><span class="p">),</span> <span class="n">ns</span><span class="o">.</span><span class="n">pattern</span><span class="p">)</span> <span class="k">if</span> <span class="n">v</span><span class="o">!=</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="vm">__file__</span><span class="p">)]</span>

            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">filenames</span><span class="p">)</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">IOError</span><span class="p">(</span><span class="s2">&quot;no files that match &#39;</span><span class="si">{0}</span><span class="s2">&#39; can be found in the &quot;</span>
                              <span class="s2">&quot;specified directories&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">ns</span><span class="o">.</span><span class="n">pattern</span><span class="p">))</span>

        <span class="k">elif</span> <span class="ow">not</span> <span class="n">ns</span><span class="o">.</span><span class="n">filename</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">filenames</span> <span class="o">=</span> <span class="p">[</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">ns</span><span class="o">.</span><span class="n">filename</span><span class="p">]</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="c1">#prompt for files</span>
            <span class="n">filenames</span> <span class="o">=</span> <span class="n">get_filepaths</span><span class="p">(</span><span class="n">wildcard</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">filenames</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span>

        <span class="n">level</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">()</span><span class="o">.</span><span class="n">level</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">()</span><span class="o">.</span><span class="n">setLevel</span><span class="p">(</span><span class="n">logging</span><span class="o">.</span><span class="n">INFO</span><span class="p">)</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;%Y-%m-</span><span class="si">%d</span><span class="s2"> %H:%M:%S&quot;</span><span class="p">)</span> <span class="o">+</span>
            <span class="s1">&#39; Start processing files&#39;</span><span class="p">)</span>
        <span class="n">start_time</span><span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">path</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">filenames</span><span class="p">):</span>

            <span class="k">try</span><span class="p">:</span>

<span class="c1">#                time.sleep(0.5)</span>
                <span class="k">if</span> <span class="n">i</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span>
                    <span class="n">time_remaining</span> <span class="o">=</span> <span class="p">((</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start_time</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">*</span>
                                        <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">filenames</span><span class="p">)</span><span class="o">-</span><span class="n">i</span><span class="p">))</span>

                    <span class="n">time_remaining</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;, estimated. time remaining &#39;</span> <span class="o">+</span>
                                    <span class="n">hms_string</span><span class="p">(</span><span class="n">time_remaining</span><span class="p">))</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">time_remaining</span><span class="o">=</span> <span class="s2">&quot;.&quot;</span>
                <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{0}</span><span class="s2">, processing </span><span class="si">{1}</span><span class="s2">, File </span><span class="si">{2}</span><span class="s2"> of </span><span class="si">{3}{4}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                                <span class="n">time</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;%Y-%m-</span><span class="si">%d</span><span class="s2"> %H:%M:%S&quot;</span><span class="p">),</span>
                                <span class="n">path</span><span class="p">,</span>
                                <span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span>
                                <span class="nb">len</span><span class="p">(</span><span class="n">filenames</span><span class="p">),</span>
                                <span class="n">time_remaining</span><span class="p">))</span>

                <span class="k">with</span> <span class="n">working_directory</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">path</span><span class="p">)):</span>

                    <span class="bp">self</span><span class="o">.</span><span class="n">process</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>

            <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
                <span class="n">logging</span><span class="o">.</span><span class="n">exception</span><span class="p">(</span><span class="s2">&quot;problem with file </span><span class="si">{0}</span><span class="s2">:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">path</span><span class="p">))</span>
            <span class="k">finally</span><span class="p">:</span>

                <span class="k">pass</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;%Y-%m-</span><span class="si">%d</span><span class="s2"> %H:%M:%S&quot;</span><span class="p">)</span> <span class="o">+</span>
            <span class="s1">&#39; End processing files&#39;</span><span class="p">)</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">()</span><span class="o">.</span><span class="n">setLevel</span><span class="p">(</span><span class="n">level</span><span class="p">)</span></div></div>







<div class="viewcode-block" id="working_directory"><a class="viewcode-back" href="../../../api/geotecha.inputoutput.inputoutput.html#geotecha.inputoutput.inputoutput.working_directory">[docs]</a><span class="nd">@contextmanager</span>
<span class="k">def</span> <span class="nf">working_directory</span><span class="p">(</span><span class="n">path</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Change working directory for duration of with statement</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    path : str</span>
<span class="sd">        Path to new current working directory</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    e.g. with working_directory(\data\stuff):</span>

<span class="sd">    References</span>
<span class="sd">    ----------</span>
<span class="sd">    Taken straight from http://stackoverflow.com/a/3012921/2530083</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">current_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">()</span>
    <span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">yield</span>
    <span class="k">finally</span><span class="p">:</span>
        <span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="n">current_dir</span><span class="p">)</span></div>



<div class="viewcode-block" id="get_filepaths"><a class="viewcode-back" href="../../../api/geotecha.inputoutput.inputoutput.html#geotecha.inputoutput.inputoutput.get_filepaths">[docs]</a><span class="k">def</span> <span class="nf">get_filepaths</span><span class="p">(</span><span class="n">wildcard</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; dialog box to select files</span>

<span class="sd">    Opens a dialog box from which the user can select files</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    wildcard : string, optional</span>
<span class="sd">        Only show file types of this kind. Default wildcard=&quot;&quot; which means</span>
<span class="sd">        no file type filtering.</span>
<span class="sd">        e.g. &quot;BMP files (*.bmp)|*.bmp|GIF files (*.gif)|*.gif&quot;</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    filepaths: list of paths</span>
<span class="sd">        List of user selected file paths.  Will return None if the cancel</span>
<span class="sd">        button was selected.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="kn">from</span> <span class="nn">PyQt5</span> <span class="k">import</span> <span class="n">QtGui</span>
        <span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
            <span class="kn">from</span> <span class="nn">PyQt4</span> <span class="k">import</span> <span class="n">QtGui</span>
        <span class="c1"># pyqt idea from https://www.daniweb.com/software-development/python/code/452624/get-multiple-file-names-pyqtpyside</span>
        <span class="n">app</span> <span class="o">=</span> <span class="n">QtGui</span><span class="o">.</span><span class="n">QApplication</span><span class="p">([])</span>
        <span class="n">caption</span> <span class="o">=</span> <span class="s1">&#39;Select file(s)&#39;</span>
        <span class="c1"># use current/working directory</span>
        <span class="n">directory</span> <span class="o">=</span> <span class="s1">&#39;./&#39;</span>
        <span class="n">filter_mask</span> <span class="o">=</span> <span class="n">wildcard</span>
        <span class="n">filepaths</span> <span class="o">=</span> <span class="n">QtGui</span><span class="o">.</span><span class="n">QFileDialog</span><span class="o">.</span><span class="n">getOpenFileNames</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span>
            <span class="n">caption</span><span class="p">,</span> <span class="n">directory</span><span class="p">,</span> <span class="n">filter_mask</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">filepaths</span><span class="p">)</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span>
            <span class="n">filepaths</span><span class="o">=</span><span class="kc">None</span>

    <span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
        <span class="kn">import</span> <span class="nn">wx</span>
        <span class="c1"># wx idea from http://stackoverflow.com/a/9319832/2530083</span>
        <span class="n">app</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">App</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
        <span class="n">style</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">FD_OPEN</span> <span class="o">|</span> <span class="n">wx</span><span class="o">.</span><span class="n">FD_FILE_MUST_EXIST</span> <span class="o">|</span> <span class="n">wx</span><span class="o">.</span><span class="n">FD_MULTIPLE</span>
        <span class="n">dialog</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">FileDialog</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="s1">&#39;Open&#39;</span><span class="p">,</span> <span class="n">wildcard</span><span class="o">=</span><span class="n">wildcard</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="n">style</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">dialog</span><span class="o">.</span><span class="n">ShowModal</span><span class="p">()</span> <span class="o">==</span> <span class="n">wx</span><span class="o">.</span><span class="n">ID_OK</span><span class="p">:</span>
            <span class="n">filepaths</span> <span class="o">=</span> <span class="n">dialog</span><span class="o">.</span><span class="n">GetPaths</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">filepaths</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="n">dialog</span><span class="o">.</span><span class="n">Destroy</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">filepaths</span></div>


<div class="viewcode-block" id="modules_in_package"><a class="viewcode-back" href="../../../api/geotecha.inputoutput.inputoutput.html#geotecha.inputoutput.inputoutput.modules_in_package">[docs]</a><span class="k">def</span> <span class="nf">modules_in_package</span><span class="p">(</span><span class="n">package_name</span><span class="p">,</span> <span class="n">exclude</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;test&#39;</span><span class="p">]):</span>
    <span class="sd">&quot;&quot;&quot;List of modules in a package</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    package_name : string</span>
<span class="sd">        Name of package to import and get modules from.</span>
<span class="sd">    exclude : list of string, optional</span>
<span class="sd">        Module names to exclude.  Default exclude=[&#39;test&#39;]</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    module_list : lsit of string</span>
<span class="sd">        List of modules in package_name ommiting any names in the</span>
<span class="sd">        exclude list.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">pkg</span> <span class="o">=</span> <span class="n">importlib</span><span class="o">.</span><span class="n">import_module</span><span class="p">(</span><span class="n">package_name</span><span class="p">)</span>

    <span class="n">pkgpath</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">pkg</span><span class="o">.</span><span class="vm">__file__</span><span class="p">)</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">name</span> <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">pkgutil</span><span class="o">.</span><span class="n">iter_modules</span><span class="p">([</span><span class="n">pkgpath</span><span class="p">])</span>
            <span class="k">if</span> <span class="n">name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">exclude</span><span class="p">]</span></div>

<div class="viewcode-block" id="SimpleTimer"><a class="viewcode-back" href="../../../api/geotecha.inputoutput.inputoutput.html#geotecha.inputoutput.inputoutput.SimpleTimer">[docs]</a><span class="k">class</span> <span class="nc">SimpleTimer</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Simple timer to display start, end, and elapsed wall clock time of</span>
<span class="sd">    code execution.</span>

<span class="sd">    Messages displayed when start and finish methods called.</span>

<span class="sd">    Attributes</span>
<span class="sd">    ----------</span>
<span class="sd">    start_times : dict</span>
<span class="sd">        Start times corresponding to each timing level.</span>
<span class="sd">    messages : dict</span>
<span class="sd">        Message/title corresponding to each timeing level.</span>
<span class="sd">    end_times : dict</span>
<span class="sd">        end times corresponding to each timing level.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">start_times</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">messages</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">end_times</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>

<div class="viewcode-block" id="SimpleTimer.start"><a class="viewcode-back" href="../../../api/geotecha.inputoutput.inputoutput.html#geotecha.inputoutput.inputoutput.SimpleTimer.start">[docs]</a>    <span class="k">def</span> <span class="nf">start</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">msg</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Print message saying timing level i has started.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ---------</span>
<span class="sd">        i : int</span>
<span class="sd">            index of timed process.  Numerical value of i will detemine</span>
<span class="sd">            indent of printed message. If i==0 then row of astericks will be</span>
<span class="sd">            printed before message.</span>
<span class="sd">        msg : string, optional</span>
<span class="sd">            title of timing process.  printed message will be &quot;Started &quot; + msg.</span>
<span class="sd">            Default msg=None which will make &quot;Started Level i&quot; appear.</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">start_times</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">msg</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">messages</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Level </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">messages</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">msg</span>
        <span class="k">if</span> <span class="n">i</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;*&quot;</span><span class="o">*</span><span class="mi">40</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;  &quot;</span><span class="o">*</span><span class="n">i</span> <span class="o">+</span> <span class="s2">&quot;Started &quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">messages</span><span class="p">[</span><span class="n">i</span><span class="p">])</span></div>

<div class="viewcode-block" id="SimpleTimer.finish"><a class="viewcode-back" href="../../../api/geotecha.inputoutput.inputoutput.html#geotecha.inputoutput.inputoutput.SimpleTimer.finish">[docs]</a>    <span class="k">def</span> <span class="nf">finish</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">i</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Print message saying timing level i has finished along with the</span>
<span class="sd">        elapsed time.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ---------</span>
<span class="sd">        i : int</span>
<span class="sd">            index of timed process.  Numerical value of i will detemine</span>
<span class="sd">            indent of printed message. If i==0 then row of astericks will be</span>
<span class="sd">            printed after finish message.</span>


<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">end_times</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
        <span class="n">elapsed_time</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">end_times</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">start_times</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>


        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;  &quot;</span><span class="o">*</span><span class="n">i</span> <span class="o">+</span> <span class="s2">&quot;Finished </span><span class="si">{}</span><span class="s2">, run time = </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">messages</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
                  <span class="nb">str</span><span class="p">(</span><span class="n">timedelta</span><span class="p">(</span><span class="n">seconds</span><span class="o">=</span><span class="n">elapsed_time</span><span class="p">))))</span>
        <span class="k">if</span> <span class="n">i</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;*&quot;</span><span class="o">*</span><span class="mi">40</span><span class="p">)</span></div></div>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="kn">import</span> <span class="nn">nose</span>
    <span class="n">nose</span><span class="o">.</span><span class="n">runmodule</span><span class="p">(</span><span class="n">argv</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;nose&#39;</span><span class="p">,</span> <span class="s1">&#39;--verbosity=3&#39;</span><span class="p">,</span> <span class="s1">&#39;--with-doctest&#39;</span><span class="p">])</span>
<span class="c1">#    nose.runmodule(argv=[&#39;nose&#39;, &#39;--verbosity=3&#39;])</span>
</pre></div>

          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2014, Rohan Walker.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 1.7.4</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.10</a>
      
    </div>

    

    
  </body>
</html>