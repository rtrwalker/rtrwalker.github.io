
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>geotecha.speccon.integrals &#8212; geotecha 0.2.1 documentation</title>
    <link rel="stylesheet" href="../../../_static/default.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    <script type="text/javascript" src="../../../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../../_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
   
  <link rel="stylesheet" href="../../../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>

<div style="background-color: white; text-align: left; padding: 10px 10px 15px 15px">
<a href="../../../index.html"><img src="../../../_static/logo.png" border="0" alt="py4sci"/></a>
</div>



      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper"><div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../../../index.html">Documentation overview</a><ul>
  <li><a href="../../index.html">Module code</a><ul>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <h1>Source code for geotecha.speccon.integrals</h1><div class="highlight"><pre>
<span></span><span class="c1"># geotecha - A software suite for geotechncial engineering</span>
<span class="c1"># Copyright (C) 2018  Rohan T. Walker (rtrwalker@gmail.com)</span>
<span class="c1">#</span>
<span class="c1"># This program is free software: you can redistribute it and/or modify</span>
<span class="c1"># it under the terms of the GNU General Public License as published by</span>
<span class="c1"># the Free Software Foundation, either version 3 of the License, or</span>
<span class="c1"># (at your option) any later version.</span>
<span class="c1">#</span>
<span class="c1"># This program is distributed in the hope that it will be useful,</span>
<span class="c1"># but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<span class="c1"># MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span>
<span class="c1"># GNU General Public License for more details.</span>
<span class="c1">#</span>
<span class="c1"># You should have received a copy of the GNU General Public License</span>
<span class="c1"># along with this program.  If not, see http://www.gnu.org/licenses/gpl.html.</span>
<span class="sd">&quot;&quot;&quot;Integrals and eigenvalues for consolidation using spectral methods.</span>

<span class="sd">Most of the functions have been generated using</span>
<span class="sd">geotecha.speccon.integrals_generate_code functions using sympy.</span>

<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">from</span> <span class="nn">__future__</span> <span class="k">import</span> <span class="n">division</span><span class="p">,</span> <span class="n">print_function</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">math</span>

<span class="kn">from</span> <span class="nn">geotecha.piecewise.piecewise_linear_1d</span> <span class="k">import</span> <span class="n">segment_containing_also_segments_less_than_xi</span>
<span class="kn">from</span> <span class="nn">geotecha.piecewise.piecewise_linear_1d</span> <span class="k">import</span> <span class="n">segments_between_xi_and_xj</span>
<span class="kn">import</span> <span class="nn">geotecha.piecewise.piecewise_linear_1d</span> <span class="k">as</span> <span class="nn">pwise</span>
<span class="kn">from</span> <span class="nn">geotecha.piecewise.piecewise_linear_1d</span> <span class="k">import</span> <span class="n">PolyLine</span>

<span class="n">MUST_TRY_FORTRAN</span><span class="o">=</span><span class="kc">False</span> <span class="c1">#use = True when debugging the fortran extensions.</span>

<div class="viewcode-block" id="m_from_sin_mx"><a class="viewcode-back" href="../../../api/geotecha.speccon.integrals.html#geotecha.speccon.integrals.m_from_sin_mx">[docs]</a><span class="k">def</span> <span class="nf">m_from_sin_mx</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">boundary</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Sine series eigenvalue of boundary value problem on [0, 1]</span>


<span class="sd">    `i` th eigenvalue, M,  of f(x) = sin(M*x) that satisfies:</span>
<span class="sd">        f(0) = 0, f(1) = 0; for `boundary` = 0 i.e. PTPB</span>
<span class="sd">        f(0) = 0; f&#39;(1) = 0; for `boundary` = 1 i.e. PTIB</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    i : ``int``</span>
<span class="sd">        Eigenvalue number in series to return.</span>
<span class="sd">    boundary : {0, 1}, optional</span>
<span class="sd">        Boundary condition.</span>
<span class="sd">        For &#39;Pervious Top Pervious Bottom (PTPB)&#39;, boundary = 0.</span>
<span class="sd">        For &#39;Pervious Top Impervious Bottom (PTIB)&#39;, boundary = 1.</span>
<span class="sd">        Default boundary=0.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    out : ``float``</span>
<span class="sd">        The `i` th eigenvalue</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="kn">from</span> <span class="nn">math</span> <span class="k">import</span> <span class="n">pi</span>

    <span class="k">if</span> <span class="n">boundary</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">{</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">}:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;boundary = </span><span class="si">{}</span><span class="s1">; must be 0 or 1.&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">boundary</span><span class="p">))</span>

    <span class="k">return</span> <span class="n">pi</span> <span class="o">*</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">boundary</span> <span class="o">/</span> <span class="mf">2.0</span><span class="p">)</span></div>

<div class="viewcode-block" id="pdim1sin_af_linear"><a class="viewcode-back" href="../../../api/geotecha.speccon.integrals.html#geotecha.speccon.integrals.pdim1sin_af_linear">[docs]</a><span class="k">def</span> <span class="nf">pdim1sin_af_linear</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Integration of sin(mi * z) * a(z) * sin(mj * z)</span>
<span class="sd">    between ztop and zbot where a(z) is piecewise linear.</span>

<span class="sd">    Wrapper for dim1sin_af_linear with PolyLine input.</span>

<span class="sd">    Calculation of integrals is performed at each element of a square symmetric</span>
<span class="sd">    matrix (size depends on size of `m`)</span>


<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    m : ``list`` of ``float``</span>
<span class="sd">       Eeigenvlaues of BVP. Generate with geoteca.speccon.m_from_sin_mx.</span>
<span class="sd">    a : PolyLine object</span>
<span class="sd">        PolyLine defining piecewise linear relationship.</span>
<span class="sd">    implementation : [&#39;vectorized&#39;, &#39;scalar&#39;, &#39;fortran&#39;], optional</span>
<span class="sd">        Functional implementation: &#39;scalar&#39; = python loops (slow),</span>
<span class="sd">        &#39;fortran&#39; = fortran code (fastest), &#39;vectorized&#39; = numpy(fast).</span>
<span class="sd">        Default implementation=&#39;vectorized&#39;.  If fortran extention module</span>
<span class="sd">        cannot be imported then &#39;vectorized&#39; version will be used.</span>
<span class="sd">        If anything other than &#39;fortran&#39; or &#39;scalar&#39; is used then</span>
<span class="sd">        default vectorized version will be used.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    A : numpy.ndarray</span>
<span class="sd">        A square symmetric matrix, size determined by size of `m`</span>

<span class="sd">    See Also</span>
<span class="sd">    --------</span>
<span class="sd">    m_from_sin_mx : Used to generate &#39;m&#39; input parameter.</span>
<span class="sd">    dim1sin_af_linear : Wrapped function.</span>
<span class="sd">        inputs.</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    The `dim1sin_af_linear` matrix, :math:`A` is given by:</span>

<span class="sd">    .. math:: \\mathbf{A}_{i,j}=\\int_{0}^1{{a\\left(z\\right)}\\phi_i\\phi_j\\,dz}</span>

<span class="sd">    where the basis function :math:`\\phi_i` is given by:</span>

<span class="sd">    .. math:: \\phi_i\\left(z\\right)=\\sin\\left({m_i}z\\right)</span>

<span class="sd">    and :math:`a\\left(z\\right)` is a piecewise linear function</span>
<span class="sd">    with respect to :math:`z`, that within a layer are defined by:</span>

<span class="sd">    .. math:: a\\left(z\\right) = a_t+\\frac{a_b-a_t}{z_b-z_t}\\left(z-z_t\\right)</span>

<span class="sd">    with :math:`t` and :math:`b` subscripts representing &#39;top&#39; and &#39;bottom&#39; of</span>
<span class="sd">    each layer respectively.</span>


<span class="sd">s</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">return</span> <span class="n">dim1sin_af_linear</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">a</span><span class="o">.</span><span class="n">y1</span><span class="p">,</span> <span class="n">a</span><span class="o">.</span><span class="n">y2</span><span class="p">,</span> <span class="n">a</span><span class="o">.</span><span class="n">x1</span><span class="p">,</span> <span class="n">a</span><span class="o">.</span><span class="n">x2</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>


<div class="viewcode-block" id="pdim1sin_abf_linear"><a class="viewcode-back" href="../../../api/geotecha.speccon.integrals.html#geotecha.speccon.integrals.pdim1sin_abf_linear">[docs]</a><span class="k">def</span> <span class="nf">pdim1sin_abf_linear</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Integration of sin(mi * z) * a(z) * a(z) * sin(mj * z)</span>
<span class="sd">    between ztop and zbot where a(z) is piecewise linear.</span>

<span class="sd">    Wrapper for dim1sin_abf_linear to allow PolyLine inputs.</span>


<span class="sd">    Calulation of integrals is performed at each element of a square symmetric</span>
<span class="sd">    matrix (size depends on size of `m`).</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    m : ``list`` of ``float``</span>
<span class="sd">        eigenvlaues of BVP. generate with geoteca.speccon.m_from_sin_mx</span>
<span class="sd">    a, b : PolyLine object</span>
<span class="sd">        PolyLine defining piecewise linear relationship.</span>
<span class="sd">    implementation : [&#39;vectorized&#39;, &#39;scalar&#39;, &#39;fortran&#39;], optional</span>
<span class="sd">        Functional implementation: &#39;scalar&#39; = python loops (slow),</span>
<span class="sd">        &#39;fortran&#39; = fortran code (fastest), &#39;vectorized&#39; = numpy(fast).</span>
<span class="sd">        Default implementation=&#39;vectorized&#39;.  If fortran extention module</span>
<span class="sd">        cannot be imported then &#39;vectorized&#39; version will be used.</span>
<span class="sd">        If anything other than &#39;fortran&#39; or &#39;scalar&#39; is used then</span>
<span class="sd">        default vectorized version will be used.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    A : numpy.ndarray</span>
<span class="sd">        A square symmetric matrix, size determined by size of `m`.</span>

<span class="sd">    See Also</span>
<span class="sd">    -------</span>
<span class="sd">    dim1sin_abf_linear : Wrapped function.</span>


<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    The `dim1sin_abf_linear` matrix, :math:`A` is given by:</span>

<span class="sd">    .. math:: \\mathbf{A}_{i,j}=\\int_{0}^1{{a\\left(z\\right)}{b\\left(z\\right)}\\phi_i\\phi_j\\,dz}</span>

<span class="sd">    where the basis function :math:`\\phi_i` is given by:</span>

<span class="sd">    .. math:: \\phi_i\\left(z\\right)=\\sin\\left({m_i}z\\right)</span>

<span class="sd">    and :math:`a\\left(z\\right)` and :math:`b\\left(z\\right)` are piecewise</span>
<span class="sd">    linear functions with respect to :math:`z`, that within a layer are defined by:</span>

<span class="sd">    .. math:: a\\left(z\\right) = a_t+\\frac{a_b-a_t}{z_b-z_t}\\left(z-z_t\\right)</span>

<span class="sd">    with :math:`t` and :math:`b` subscripts representing &#39;top&#39; and &#39;bottom&#39; of</span>
<span class="sd">    each layer respectively.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="n">pwise</span><span class="o">.</span><span class="n">polyline_make_x_common</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">dim1sin_abf_linear</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">a</span><span class="o">.</span><span class="n">y1</span><span class="p">,</span> <span class="n">a</span><span class="o">.</span><span class="n">y2</span><span class="p">,</span> <span class="n">b</span><span class="o">.</span><span class="n">y1</span><span class="p">,</span> <span class="n">b</span><span class="o">.</span><span class="n">y2</span><span class="p">,</span> <span class="n">a</span><span class="o">.</span><span class="n">x1</span><span class="p">,</span> <span class="n">a</span><span class="o">.</span><span class="n">x2</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>


<div class="viewcode-block" id="pdim1sin_D_aDf_linear"><a class="viewcode-back" href="../../../api/geotecha.speccon.integrals.html#geotecha.speccon.integrals.pdim1sin_D_aDf_linear">[docs]</a><span class="k">def</span> <span class="nf">pdim1sin_D_aDf_linear</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Integration of sin(mi * z) * D[a(z) * D[sin(mj * z),z],z]</span>
<span class="sd">    between ztop and zbot where a(z) is piecewise linear functions of z.</span>


<span class="sd">    Wrapper for dim1sin_D_aDf_linear to allow PolyLine inputs.</span>


<span class="sd">    Calulation of integrals is performed at each element of a square symmetric</span>
<span class="sd">    matrix (size depends on size of `m`)</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    m : ``list`` of ``float``</span>
<span class="sd">        eigenvlaues of BVP. generate with geoteca.speccon.m_from_sin_mx</span>
<span class="sd">    a : PolyLine object</span>
<span class="sd">        PolyLine defining piecewise linear relationship.</span>
<span class="sd">    implementation : [&#39;vectorized&#39;, &#39;scalar&#39;, &#39;fortran&#39;], optional</span>
<span class="sd">        Functional implementation: &#39;scalar&#39; = python loops (slow),</span>
<span class="sd">        &#39;fortran&#39; = fortran code (fastest), &#39;vectorized&#39; = numpy(fast).</span>
<span class="sd">        Default implementation=&#39;vectorized&#39;.  If fortran extention module</span>
<span class="sd">        cannot be imported then &#39;vectorized&#39; version will be used.</span>
<span class="sd">        If anything other than &#39;fortran&#39; or &#39;scalar&#39; is used then</span>
<span class="sd">        default vectorized version will be used.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    A : numpy.ndarray</span>
<span class="sd">        A square symmetric matrix, size determined by size of `m`.</span>

<span class="sd">    See Also</span>
<span class="sd">    --------</span>
<span class="sd">    dim1sin_D_aDf_linear : Wrapped function.</span>


<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    The `dim1sin_D_aDf_linear` matrix, :math:`A` is given by:</span>

<span class="sd">    .. math:: \\mathbf{A}_{i,j}=\\int_{0}^1{\\frac{d}{dz}\\left({a\\left(z\\right)}\\frac{d\\phi_j}{dz}\\right)\\phi_i\\,dz}</span>

<span class="sd">    where the basis function :math:`\\phi_i` is given by:</span>

<span class="sd">    .. math:: \\phi_i\\left(z\\right)=\\sin\\left({m_i}z\\right)</span>

<span class="sd">    and :math:`a\\left(z\\right)` is a piecewise</span>
<span class="sd">    linear functions with respect to :math:`z`, that within a layer is defined by:</span>

<span class="sd">    .. math:: a\\left(z\\right) = a_t+\\frac{a_b-a_t}{z_b-z_t}\\left(z-z_t\\right)</span>

<span class="sd">    with :math:`t` and :math:`b` subscripts representing &#39;top&#39; and &#39;bottom&#39; of</span>
<span class="sd">    each layer respectively.</span>

<span class="sd">    To make the above integration simpler we integate by parts to get:</span>

<span class="sd">    .. math:: \\mathbf{A}_{i,j}= \\left.\\phi_i{a\\left(z\\right)}\\frac{d\\phi_j}{dz}\\right|_{z=0}^{z=1} -\\int_{0}^1{{a\\left(z\\right)}\\frac{d\\phi_j}{dz}\\frac{d\\phi_i}{dz}\\,dz}</span>

<span class="sd">    In this case the sine basis functions means the left term in the above</span>
<span class="sd">    equation is zero, leaving us with</span>

<span class="sd">    .. math:: \\mathbf{A}_{i,j}= -\\int_{0}^1{{a\\left(z\\right)}\\frac{d\\phi_j}{dz}\\frac{d\\phi_i}{dz}\\,dz}</span>


<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">return</span> <span class="n">dim1sin_D_aDf_linear</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">a</span><span class="o">.</span><span class="n">y1</span><span class="p">,</span> <span class="n">a</span><span class="o">.</span><span class="n">y2</span><span class="p">,</span> <span class="n">a</span><span class="o">.</span><span class="n">x1</span><span class="p">,</span> <span class="n">a</span><span class="o">.</span><span class="n">x2</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>


<div class="viewcode-block" id="pdim1sin_ab_linear"><a class="viewcode-back" href="../../../api/geotecha.speccon.integrals.html#geotecha.speccon.integrals.pdim1sin_ab_linear">[docs]</a><span class="k">def</span> <span class="nf">pdim1sin_ab_linear</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Integration of sin(mi * z) * a(z) * b(z)</span>
<span class="sd">    between ztop and zbot where a(z) and b(z) are piecewise linear functions of z.</span>

<span class="sd">    Wrapper for dim1sin_ab_linear to allow PolyLine inputs.</span>


<span class="sd">    Calulation of integrals is performed at each element of a 1d array</span>
<span class="sd">    (size depends on size of `m`).</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    m : ``list`` of ``float``</span>
<span class="sd">        eigenvlaues of BVP. generate with geoteca.speccon.m_from_sin_mx</span>
<span class="sd">    a, b : PolyLine object</span>
<span class="sd">        PolyLine defining piecewise linear relationship.</span>
<span class="sd">    implementation : [&#39;vectorized&#39;, &#39;scalar&#39;, &#39;fortran&#39;], optional</span>
<span class="sd">        Functional implementation: &#39;scalar&#39; = python loops (slow),</span>
<span class="sd">        &#39;fortran&#39; = fortran code (fastest), &#39;vectorized&#39; = numpy(fast).</span>
<span class="sd">        Default implementation=&#39;vectorized&#39;.  If fortran extention module</span>
<span class="sd">        cannot be imported then &#39;vectorized&#39; version will be used.</span>
<span class="sd">        If anything other than &#39;fortran&#39; or &#39;scalar&#39; is used then</span>
<span class="sd">        default vectorized version will be used.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    A : numpy.ndarray</span>
<span class="sd">        A 1d array size determined by size of `m`. Treat as column</span>
<span class="sd">        vector.</span>

<span class="sd">    See Also</span>
<span class="sd">    --------</span>
<span class="sd">    dim1sin_ab_linear : Wrapped function.</span>


<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    The `dim1sin_ab_linear` which should be treated as a column vector,</span>
<span class="sd">    :math:`A` is given by:</span>

<span class="sd">    .. math:: \\mathbf{A}_{i}=\\int_{0}^1{{a\\left(z\\right)}{b\\left(z\\right)}\\phi_i\\,dz}</span>

<span class="sd">    where the basis function :math:`\\phi_i` is given by:</span>

<span class="sd">    .. math:: \\phi_i\\left(z\\right)=\\sin\\left({m_i}z\\right)</span>

<span class="sd">    and :math:`a\\left(z\\right)` and :math:`b\\left(z\\right)` are piecewise</span>
<span class="sd">    linear functions with respect to :math:`z`, that within a layer are defined by:</span>

<span class="sd">    .. math:: a\\left(z\\right) = a_t+\\frac{a_b-a_t}{z_b-z_t}\\left(z-z_t\\right)</span>

<span class="sd">    with :math:`t` and :math:`b` subscripts representing &#39;top&#39; and &#39;bottom&#39; of</span>
<span class="sd">    each layer respectively.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="n">pwise</span><span class="o">.</span><span class="n">polyline_make_x_common</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">dim1sin_ab_linear</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">a</span><span class="o">.</span><span class="n">y1</span><span class="p">,</span> <span class="n">a</span><span class="o">.</span><span class="n">y2</span><span class="p">,</span> <span class="n">b</span><span class="o">.</span><span class="n">y1</span><span class="p">,</span> <span class="n">b</span><span class="o">.</span><span class="n">y2</span><span class="p">,</span> <span class="n">a</span><span class="o">.</span><span class="n">x1</span><span class="p">,</span> <span class="n">a</span><span class="o">.</span><span class="n">x2</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>


<div class="viewcode-block" id="pdim1sin_abc_linear"><a class="viewcode-back" href="../../../api/geotecha.speccon.integrals.html#geotecha.speccon.integrals.pdim1sin_abc_linear">[docs]</a><span class="k">def</span> <span class="nf">pdim1sin_abc_linear</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Integrations of sin(mi * z) * a(z) * b(z) * c(z)</span>
<span class="sd">    between ztop and zbot where a(z), b(z), c(z) are piecewise linear functions of z.</span>

<span class="sd">    Wrapper for dim1sin_abc_linear to allow PolyLine inputs.</span>


<span class="sd">    Calulation of integrals is performed at each element of a 1d array</span>
<span class="sd">    (size depends on size of `m`).</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    m : ``list`` of ``float``</span>
<span class="sd">        eigenvlaues of BVP. generate with geoteca.speccon.m_from_sin_mx</span>
<span class="sd">    a, b, c : PolyLine object</span>
<span class="sd">        PolyLine defining piecewise linear relationship.</span>
<span class="sd">    implementation : [&#39;vectorized&#39;, &#39;scalar&#39;, &#39;fortran&#39;], optional</span>
<span class="sd">        Functional implementation: &#39;scalar&#39; = python loops (slow),</span>
<span class="sd">        &#39;fortran&#39; = fortran code (fastest), &#39;vectorized&#39; = numpy(fast).</span>
<span class="sd">        Default implementation=&#39;vectorized&#39;.  If fortran extention module</span>
<span class="sd">        cannot be imported then &#39;vectorized&#39; version will be used.</span>
<span class="sd">        If anything other than &#39;fortran&#39; or &#39;scalar&#39; is used then</span>
<span class="sd">        default vectorized version will be used.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    A : numpy.ndarray</span>
<span class="sd">        A 1d array size determined by size of `m`. Treat as column</span>
<span class="sd">        vector.</span>

<span class="sd">    See Also</span>
<span class="sd">    --------</span>
<span class="sd">    dim1sin_abc_linear : Wrapped function.</span>



<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    The `dim1sin_abc_linear` which should be treated as a column vector,</span>
<span class="sd">    :math:`A` is given by:</span>

<span class="sd">    .. math:: \\mathbf{A}_{i}=\\int_{0}^1{{a\\left(z\\right)}{b\\left(z\\right)}{c\\left(z\\right)}\\phi_i\\,dz}</span>

<span class="sd">    where the basis function :math:`\\phi_i` is given by:</span>

<span class="sd">    .. math:: \\phi_i\\left(z\\right)=\\sin\\left({m_i}z\\right)</span>

<span class="sd">    and :math:`a\\left(z\\right)`, :math:`b\\left(z\\right)`, and</span>
<span class="sd">    :math:`c\\left(z\\right)` are piecewise linear functions</span>
<span class="sd">    with respect to :math:`z`, that within a layer are defined by:</span>

<span class="sd">    .. math:: a\\left(z\\right) = a_t+\\frac{a_b-a_t}{z_b-z_t}\\left(z-z_t\\right)</span>

<span class="sd">    with :math:`t` and :math:`b` subscripts representing &#39;top&#39; and &#39;bottom&#39; of</span>
<span class="sd">    each layer respectively.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span> <span class="o">=</span> <span class="n">pwise</span><span class="o">.</span><span class="n">polyline_make_x_common</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="n">c</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">dim1sin_abc_linear</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">a</span><span class="o">.</span><span class="n">y1</span><span class="p">,</span> <span class="n">a</span><span class="o">.</span><span class="n">y2</span><span class="p">,</span> <span class="n">b</span><span class="o">.</span><span class="n">y1</span><span class="p">,</span> <span class="n">b</span><span class="o">.</span><span class="n">y2</span><span class="p">,</span><span class="n">c</span><span class="o">.</span><span class="n">y1</span><span class="p">,</span> <span class="n">c</span><span class="o">.</span><span class="n">y2</span><span class="p">,</span> <span class="n">a</span><span class="o">.</span><span class="n">x1</span><span class="p">,</span> <span class="n">a</span><span class="o">.</span><span class="n">x2</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>


<div class="viewcode-block" id="pdim1sin_D_aDb_linear"><a class="viewcode-back" href="../../../api/geotecha.speccon.integrals.html#geotecha.speccon.integrals.pdim1sin_D_aDb_linear">[docs]</a><span class="k">def</span> <span class="nf">pdim1sin_D_aDb_linear</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Integrations of `sin(mi * z) * D[a(z) * D[b(z), z], z]`</span>
<span class="sd">    between ztop and zbot where a(z) is a piecewise linear function of z,</span>
<span class="sd">    and b(z) is a linear function of z.</span>

<span class="sd">    Wrapper for dim1sin_D_aDb_linear to allow PolyLine inputs.</span>

<span class="sd">    Calulation of integrals is performed at each element of a 1d array</span>
<span class="sd">    (size depends on size of `m`).</span>

<span class="sd">    .. warning::</span>
<span class="sd">        The functions produced are set up to accept the b(z) input as</span>
<span class="sd">        piecewise linear, i.e. b.x1, b.x2, b.y1, b.y2 etc. It is up to the user to</span>
<span class="sd">        ensure that the b.x1 and b.x2 are such that they define a continuous</span>
<span class="sd">        linear function. eg. to define b(z)=z+1 then use</span>
<span class="sd">        b.x1=[0,0.4], b.x2=[0.4, 1], b.y1=[1,1.4], b.y2=[1.4,2].</span>


<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    m : ``list`` of ``float``</span>
<span class="sd">        eigenvlaues of BVP. generate with geoteca.speccon.m_from_sin_mx</span>
<span class="sd">    a, b : PolyLine object</span>
<span class="sd">        PolyLine defining piecewise linear relationship.</span>
<span class="sd">    implementation : [&#39;vectorized&#39;, &#39;scalar&#39;, &#39;fortran&#39;], optional</span>
<span class="sd">        Functional implementation: &#39;scalar&#39; = python loops (slow),</span>
<span class="sd">        &#39;fortran&#39; = fortran code (fastest), &#39;vectorized&#39; = numpy(fast).</span>
<span class="sd">        Default implementation=&#39;vectorized&#39;.  If fortran extention module</span>
<span class="sd">        cannot be imported then &#39;vectorized&#39; version will be used.</span>
<span class="sd">        If anything other than &#39;fortran&#39; or &#39;scalar&#39; is used then</span>
<span class="sd">        default vectorized version will be used.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    A : numpy.ndarray</span>
<span class="sd">        A 1d array size determined by size of `m`. Treat as column</span>
<span class="sd">        vector.</span>

<span class="sd">    See Also</span>
<span class="sd">    --------</span>
<span class="sd">    dim1sin_D_aDb_linear : Wrapped function.</span>


<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    The `dim1sin_D_aDb_linear` which should be treated as a column vector,</span>
<span class="sd">    :math:`A` is given by:</span>

<span class="sd">    .. math:: \\mathbf{A}_{i}=\\int_{0}^1{\\frac{d}{dz}\\left({a\\left(z\\right)}\\frac{d}{dz}{b\\left(z\\right)}\\right)\\phi_i\\,dz}</span>

<span class="sd">    where the basis function :math:`\\phi_i` is given by:</span>

<span class="sd">    .. math:: \\phi_i\\left(z\\right)=\\sin\\left({m_i}z\\right)</span>

<span class="sd">    and :math:`a\\left(z\\right)` is a piecewise</span>
<span class="sd">    linear functions with respect to :math:`z`, that within a layer is defined by:</span>

<span class="sd">    .. math:: a\\left(z\\right) = a_t+\\frac{a_b-a_t}{z_b-z_t}\\left(z-z_t\\right)</span>

<span class="sd">    with :math:`t` and :math:`b` subscripts representing &#39;top&#39; and &#39;bottom&#39; of</span>
<span class="sd">    each layer respectively.</span>

<span class="sd">    :math:`b\\left(z\\right)` is a linear function of :math:`z` defined by</span>

<span class="sd">    .. math:: b\\left(z\\right) = b_t+\\left({b_b-b_t}\\right)z</span>

<span class="sd">    with :math:`t` and :math:`b` subscripts now representing &#39;top&#39; and</span>
<span class="sd">    &#39;bottom&#39; of the profile respectively.</span>

<span class="sd">    Using the product rule for differentiation the above integral can be split</span>
<span class="sd">    into:</span>

<span class="sd">    .. math:: \\mathbf{A}_{i}=\\int_{0}^1{\\frac{da\\left(z\\right)}{dz}\\frac{db\\left(z\\right)}{dz}\\phi_i\\,dz} +</span>
<span class="sd">                              \\int_{0}^1{a\\left(z\\right)\\frac{d^2b\\left(z\\right)}{dz^2}\\phi_i\\,dz}</span>

<span class="sd">    The right hand term is zero because :math:`b\\left(z\\right)` is a</span>
<span class="sd">    continuous linear function so it&#39;s second derivative is zero.  The</span>
<span class="sd">    first derivative of :math:`b\\left(z\\right)` is a constant so the</span>
<span class="sd">    left term can be integrated by parts to give:</span>

<span class="sd">    .. math:: \\mathbf{A}_{i}=\\frac{db\\left(z\\right)}{dz}\\left(</span>
<span class="sd">                \\left.\\phi_i{a\\left(z\\right)}\\right|_{z=0}^{z=1} -</span>
<span class="sd">                -\\int_{0}^1{{a\\left(z\\right)}\\frac{d\\phi_i}{dz}\\,dz}</span>
<span class="sd">                \\right)</span>



<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="n">pwise</span><span class="o">.</span><span class="n">polyline_make_x_common</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">dim1sin_D_aDb_linear</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">a</span><span class="o">.</span><span class="n">y1</span><span class="p">,</span> <span class="n">a</span><span class="o">.</span><span class="n">y2</span><span class="p">,</span> <span class="n">b</span><span class="o">.</span><span class="n">y1</span><span class="p">,</span> <span class="n">b</span><span class="o">.</span><span class="n">y2</span><span class="p">,</span> <span class="n">a</span><span class="o">.</span><span class="n">x1</span><span class="p">,</span> <span class="n">a</span><span class="o">.</span><span class="n">x2</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>


<div class="viewcode-block" id="pEDload_linear"><a class="viewcode-back" href="../../../api/geotecha.speccon.integrals.html#geotecha.speccon.integrals.pEDload_linear">[docs]</a><span class="k">def</span> <span class="nf">pEDload_linear</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">eigs</span><span class="p">,</span> <span class="n">tvals</span><span class="p">,</span> <span class="n">dT</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Integration of D[load(tau), tau] * exp(dT * eig * (t-tau)) between</span>
<span class="sd">    [0, t], where load(tau) is piecewise linear.</span>

<span class="sd">    Wrapper for EDload_linear to allow PolyLine inputs.</span>

<span class="sd">    Performs integrations involving a piecewise linear load.  A 2d array of</span>
<span class="sd">    dimensions A[len(tvals), len(eigs)]</span>
<span class="sd">    is produced where the &#39;i&#39;th row of A contains the diagonal elements of the</span>
<span class="sd">    spectral &#39;E&#39; matrix calculated for the time value tvals[i]. i.e. rows of</span>
<span class="sd">    this matrix will be assembled into the diagonal matrix &#39;E&#39; elsewhere.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    a : PolyLine</span>
<span class="sd">        PolyLine object representing piecewise linear load vs time.</span>
<span class="sd">    eigs : 1d numpy.ndarray</span>
<span class="sd">        List of eigenvalues.</span>
<span class="sd">    tvals : 1d numpy.ndarray`</span>
<span class="sd">        List of time values to calculate integral at.</span>
<span class="sd">    dT : ``float``, optional</span>
<span class="sd">        Time factor multiple (Default dT=1.0).</span>
<span class="sd">    implementation : [&#39;vectorized&#39;, &#39;scalar&#39;, &#39;fortran&#39;], optional</span>
<span class="sd">        Functional implementation: &#39;scalar&#39; = python loops (slow),</span>
<span class="sd">        &#39;fortran&#39; = fortran code (fastest), &#39;vectorized&#39; = numpy(fast).</span>
<span class="sd">        Default implementation=&#39;vectorized&#39;.  If fortran extention module</span>
<span class="sd">        cannot be imported then &#39;vectorized&#39; version will be used.</span>
<span class="sd">        If anything other than &#39;fortran&#39; or &#39;scalar&#39; is used then</span>
<span class="sd">        default vectorized version will be used.</span>


<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    A : numpy.ndarray</span>
<span class="sd">        A 2d array of dimesnions A[len(tvals), len(eigs)].</span>
<span class="sd">        The &#39;i&#39;th row of A is the diagonal elements of the spectral &#39;E&#39; matrix</span>
<span class="sd">        calculated for the time tvals[i].</span>


<span class="sd">    See Also</span>
<span class="sd">    --------</span>
<span class="sd">    EDload_linear : Wrapped function.</span>


<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    Assuming the load are formulated as the product of separate time and depth</span>
<span class="sd">    dependant functions:</span>

<span class="sd">    .. math:: \\sigma\\left({Z,t}\\right)=\\sigma\\left({Z}\\right)\\sigma\\left({t}\\right)</span>

<span class="sd">    the solution to the consolidation equation using the spectral method has</span>
<span class="sd">    the form:</span>

<span class="sd">    .. math:: u\\left(Z,t\\right)=\\mathbf{\\Phi v E}\\left(\\mathbf{\\Gamma v}\\right)^{-1}\\mathbf{\\theta}</span>

<span class="sd">    The matrix :math:`E` is a time dependent diagonal matrix due to time</span>
<span class="sd">    dependant loadings.  The version of :math:`E` calculated here in</span>
<span class="sd">    `EDload_linear` is from loading terms in the governing equation that are NOT</span>
<span class="sd">    differentiated wrt :math:`t`.</span>
<span class="sd">    The diagonal elements of :math:`E` are given by:</span>

<span class="sd">    .. math:: \\mathbf{E}_{i,i}=\\int_{0}^t{\\frac{d{\\sigma\\left(\\tau\\right)}}{d\\tau}{\\exp\\left({(dT\\left(t-\\tau\\right)\\lambda_i}\\right)}\\,d\\tau}</span>

<span class="sd">    where</span>

<span class="sd">     :math:`\\lambda_i` is the `ith` eigenvalue of the problem,</span>
<span class="sd">     :math:`dT` is a time factor for numerical convienience,</span>
<span class="sd">     :math:`\\sigma\left(\\tau\\right)` is the time dependant portion of the loading function.</span>

<span class="sd">    When the time dependant loading term :math:`\\sigma\\left(\\tau\\right)` is</span>
<span class="sd">    piecewise in time. The contribution of each load segment is found by:</span>

<span class="sd">    .. math:: \\mathbf{E}_{i,i}=\\int_{t_s}^{t_f}{{\\sigma\\left(\\tau\\right)}\\exp\\left({dT\\left(t-\\tau\\right)*\\lambda_i}\\right)\\,d\\tau}</span>

<span class="sd">    where</span>

<span class="sd">    .. math:: t_s = \\min\\left(t,t_{increment\\:start}\\right)</span>

<span class="sd">    .. math:: t_f = \\min\\left(t,t_{increment\\:end}\\right)</span>

<span class="sd">    (note that this function,`EDload_linear`, rather than use :math:`t_s` and</span>
<span class="sd">    :math:`t_f`,</span>
<span class="sd">    explicitly finds increments that the current time falls in, falls after,</span>
<span class="sd">    and falls before and treates each case on it&#39;s own.)</span>

<span class="sd">    Each :math:`t` value of interest requires a separate diagonal matrix</span>
<span class="sd">    :math:`E`.  To use space more efficiently and to facilitate numpy</span>
<span class="sd">    broadcasting when using the results of the function, the diagonal elements</span>
<span class="sd">    of :math:`E` for each time value `t` value are stored in the rows of</span>
<span class="sd">    array :math:`A` returned by `EDload_linear`.  Thus:</span>

<span class="sd">    .. math:: \\mathbf{A}=\\left(\\begin{matrix}E_{0,0}(t_0)&amp;E_{1,1}(t_0)&amp; \cdots &amp; E_{neig-1,neig-1}(t_0)\\\ E_{0,0}(t_1)&amp;E_{1,1}(t_1)&amp; \\cdots &amp; E_{neig-1,neig-1}(t_1)\\\ \\vdots&amp;\\vdots&amp;\\ddots&amp;\\vdots \\\ E_{0,0}(t_m)&amp;E_{1,1}(t_m)&amp; \cdots &amp; E_{neig-1,neig-1}(t_m)\\end{matrix}\\right)</span>


<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">return</span> <span class="n">EDload_linear</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">a</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="n">eigs</span><span class="p">,</span> <span class="n">tvals</span><span class="p">,</span> <span class="n">dT</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>


<div class="viewcode-block" id="pEload_linear"><a class="viewcode-back" href="../../../api/geotecha.speccon.integrals.html#geotecha.speccon.integrals.pEload_linear">[docs]</a><span class="k">def</span> <span class="nf">pEload_linear</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">eigs</span><span class="p">,</span> <span class="n">tvals</span><span class="p">,</span> <span class="n">dT</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Integration of load(tau) * exp(dT * eig * (t-tau)) between [0, t], where</span>
<span class="sd">    load(tau) is piecewise linear.</span>

<span class="sd">    Wrapper for Eload_linear to allow PolyLine inputs.</span>

<span class="sd">    Performs integrations involving a piecewise linear load.  A 2d array of</span>
<span class="sd">    dimensions A[len(tvals), len(eigs)]</span>
<span class="sd">    is produced where the &#39;i&#39;th row of A contains the diagonal elements of the</span>
<span class="sd">    spectral &#39;E&#39; matrix calculated for the time value tvals[i]. i.e. rows of</span>
<span class="sd">    this matrix will be assembled into the diagonal matrix &#39;E&#39; elsewhere.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    a : PolyLine</span>
<span class="sd">        PolyLine object representing piecewise linear load vs time.</span>
<span class="sd">    eigs : 1d numpy.ndarray</span>
<span class="sd">        List of eigenvalues.</span>
<span class="sd">    tvals : 1d numpy.ndarray`</span>
<span class="sd">        List of time values to calculate integral at.</span>
<span class="sd">    dT : ``float``, optional</span>
<span class="sd">        Time factor multiple (Default dT=1.0).</span>
<span class="sd">    implementation : [&#39;vectorized&#39;, &#39;scalar&#39;, &#39;fortran&#39;], optional</span>
<span class="sd">        Functional implementation: &#39;scalar&#39; = python loops (slow),</span>
<span class="sd">        &#39;fortran&#39; = fortran code (fastest), &#39;vectorized&#39; = numpy(fast).</span>
<span class="sd">        Default implementation=&#39;vectorized&#39;.  If fortran extention module</span>
<span class="sd">        cannot be imported then &#39;vectorized&#39; version will be used.</span>
<span class="sd">        If anything other than &#39;fortran&#39; or &#39;scalar&#39; is used then</span>
<span class="sd">        default vectorized version will be used.</span>


<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    A : numpy.ndarray</span>
<span class="sd">        A 2d array of dimesnions A[len(tvals), len(eigs)].</span>
<span class="sd">        The &#39;i&#39;th row of A is the diagonal elements of the spectral &#39;E&#39; matrix</span>
<span class="sd">        calculated for the time tvals[i].</span>


<span class="sd">    See Also</span>
<span class="sd">    --------</span>
<span class="sd">    Eload_linear : Wrapped function, see for equations and other related</span>
<span class="sd">        functions.</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    Assuming the load are formulated as the product of separate time and depth</span>
<span class="sd">    dependant functions:</span>

<span class="sd">    .. math:: \\sigma\\left({Z,t}\\right)=\\sigma\\left({Z}\\right)\\sigma\\left({t}\\right)</span>

<span class="sd">    the solution to the consolidation equation using the spectral method has</span>
<span class="sd">    the form:</span>

<span class="sd">    .. math:: u\\left(Z,t\\right)=\\mathbf{\\Phi v E}\\left(\\mathbf{\\Gamma v}\\right)^{-1}\\mathbf{\\theta}</span>

<span class="sd">    The matrix :math:`E` is a time dependent diagonal matrix due to time</span>
<span class="sd">    dependant loadings.  The version of :math:`E` calculated here in</span>
<span class="sd">    `Eload_linear` is from loading terms in the governing equation that are NOT</span>
<span class="sd">    differentiated wrt :math:`t`.</span>
<span class="sd">    The diagonal elements of :math:`E` are given by:</span>

<span class="sd">    .. math:: \\mathbf{E}_{i,i}=\\int_{0}^t{{\\sigma\\left(\\tau\\right)}{\exp\\left({(dT\\left(t-\\tau\\right)\\lambda_i}\\right)}\\,d\\tau}</span>

<span class="sd">    where</span>

<span class="sd">     :math:`\\lambda_i` is the `ith` eigenvalue of the problem,</span>
<span class="sd">     :math:`dT` is a time factor for numerical convienience,</span>
<span class="sd">     :math:`\\sigma\left(\\tau\\right)` is the time dependant portion of the loading function.</span>

<span class="sd">    When the time dependant loading term :math:`\\sigma\\left(\\tau\\right)` is</span>
<span class="sd">    piecewise in time. The contribution of each load segment is found by:</span>

<span class="sd">    .. math:: \\mathbf{E}_{i,i}=\\int_{t_s}^{t_f}{{\\sigma\\left(\\tau\\right)}\\exp\\left({dT\\left(t-\\tau\\right)*\\lambda_i}\\right)\\,d\\tau}</span>

<span class="sd">    where</span>

<span class="sd">    .. math:: t_s = \\min\\left(t,t_{increment\\:start}\\right)</span>

<span class="sd">    .. math:: t_f = \\min\\left(t,t_{increment\\:end}\\right)</span>

<span class="sd">    (note that this function,`Eload_linear`, rather than use :math:`t_s` and</span>
<span class="sd">    :math:`t_f`,</span>
<span class="sd">    explicitly finds increments that the current time falls in, falls after,</span>
<span class="sd">    and falls before and treates each case on it&#39;s own.)</span>

<span class="sd">    Each :math:`t` value of interest requires a separate diagonal matrix</span>
<span class="sd">    :math:`E`.  To use space more efficiently and to facilitate numpy</span>
<span class="sd">    broadcasting when using the results of the function, the diagonal elements</span>
<span class="sd">    of :math:`E` for each time value `t` value are stored in the rows of</span>
<span class="sd">    array :math:`A` returned by `Eload_linear`.  Thus:</span>

<span class="sd">    .. math:: \\mathbf{A}=\\left(\\begin{matrix}E_{0,0}(t_0)&amp;E_{1,1}(t_0)&amp; \cdots &amp; E_{neig-1,neig-1}(t_0)\\\ E_{0,0}(t_1)&amp;E_{1,1}(t_1)&amp; \\cdots &amp; E_{neig-1,neig-1}(t_1)\\\ \\vdots&amp;\\vdots&amp;\\ddots&amp;\\vdots \\\ E_{0,0}(t_m)&amp;E_{1,1}(t_m)&amp; \cdots &amp; E_{neig-1,neig-1}(t_m)\\end{matrix}\\right)</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">return</span> <span class="n">Eload_linear</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">a</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="n">eigs</span><span class="p">,</span> <span class="n">tvals</span><span class="p">,</span> <span class="n">dT</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>


<div class="viewcode-block" id="pEDload_coslinear"><a class="viewcode-back" href="../../../api/geotecha.speccon.integrals.html#geotecha.speccon.integrals.pEDload_coslinear">[docs]</a><span class="k">def</span> <span class="nf">pEDload_coslinear</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">omega</span><span class="p">,</span> <span class="n">phase</span><span class="p">,</span> <span class="n">eigs</span><span class="p">,</span> <span class="n">tvals</span><span class="p">,</span> <span class="n">dT</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Integration of D[cos(omega*tau+phase)*load(tau), tau] * exp(dT * eig * (t-tau)) between [0, t], where</span>
<span class="sd">    load(tau) is piecewise linear.</span>

<span class="sd">    Wrapper for EDload_coslinear to allow PolyLine inputs.</span>

<span class="sd">    Performs integrations involving a piecewise linear load.  A 2d array of</span>
<span class="sd">    dimensions A[len(tvals), len(eigs)]</span>
<span class="sd">    is produced where the &#39;i&#39;th row of A contains the diagonal elements of the</span>
<span class="sd">    spectral &#39;E&#39; matrix calculated for the time value tvals[i]. i.e. rows of</span>
<span class="sd">    this matrix will be assembled into the diagonal matrix &#39;E&#39; elsewhere.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    a : PolyLine</span>
<span class="sd">        PolyLine object representing piecewise linear load vs time.</span>
<span class="sd">        List of load magnitudes.</span>
<span class="sd">    omega, phase : float</span>
<span class="sd">        Parameters that describe a cyclic load cos(omega * t + phase).</span>
<span class="sd">    eigs : 1d numpy.ndarray</span>
<span class="sd">        List of eigenvalues.</span>
<span class="sd">    tvals : 1d numpy.ndarray`</span>
<span class="sd">        List of time values to calculate integral at.</span>
<span class="sd">    dT : ``float``, optional</span>
<span class="sd">        Time factor multiple (Default dT=1.0).</span>
<span class="sd">    implementation : [&#39;vectorized&#39;, &#39;scalar&#39;, &#39;fortran&#39;], optional</span>
<span class="sd">        Functional implementation: &#39;scalar&#39; = python loops (slow),</span>
<span class="sd">        &#39;fortran&#39; = fortran code (fastest), &#39;vectorized&#39; = numpy(fast).</span>
<span class="sd">        Default implementation=&#39;vectorized&#39;.  If fortran extention module</span>
<span class="sd">        cannot be imported then &#39;vectorized&#39; version will be used.</span>
<span class="sd">        If anything other than &#39;fortran&#39; or &#39;scalar&#39; is used then</span>
<span class="sd">        default vectorized version will be used.</span>


<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    A : numpy.ndarray</span>
<span class="sd">        A 2d array of dimesnions A[len(tvals), len(eigs)].</span>
<span class="sd">        The &#39;i&#39;th row of A is the diagonal elements of the spectral &#39;E&#39; matrix</span>
<span class="sd">        calculated for the time tvals[i].</span>


<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    Assuming the load are formulated as the product of separate time and depth</span>
<span class="sd">    dependant functions:</span>

<span class="sd">    .. math:: \\sigma\\left({Z,t}\\right)=\\sigma\\left({Z}\\right)\\sigma\\left({t}\\right)</span>

<span class="sd">    the solution to the consolidation equation using the spectral method has</span>
<span class="sd">    the form:</span>

<span class="sd">    .. math:: u\\left(Z,t\\right)=\\mathbf{\\Phi v E}\\left(\\mathbf{\\Gamma v}\\right)^{-1}\\mathbf{\\theta}</span>

<span class="sd">    The matrix :math:`E` is a time dependent diagonal matrix due to time</span>
<span class="sd">    dependant loadings.  The version of :math:`E` calculated here in</span>
<span class="sd">    `EDload_coslinear` is from loading terms in the governing equation that are NOT</span>
<span class="sd">    differentiated wrt :math:`t`.</span>
<span class="sd">    The diagonal elements of :math:`E` are given by:</span>

<span class="sd">    .. math:: \\mathbf{E}_{i,i}=\\int_{0}^t{\\frac{d{{\\cos\\left(\\omega\\tau+\\textrm{phase}\\right)}\\sigma\\left(\\tau\\right)}}{d\\tau}{\\exp\\left({(dT\\left(t-\\tau\\right)\\lambda_i}\\right)}\\,d\\tau}</span>

<span class="sd">    where</span>

<span class="sd">     :math:`\\lambda_i` is the `ith` eigenvalue of the problem,</span>
<span class="sd">     :math:`dT` is a time factor for numerical convienience,</span>
<span class="sd">     :math:`\\sigma\left(\\tau\\right)` is the time dependant portion of the loading function.</span>

<span class="sd">    When the time dependant loading term :math:`\\sigma\\left(\\tau\\right)` is</span>
<span class="sd">    piecewise in time. The contribution of each load segment is found by:</span>

<span class="sd">    .. math:: \\mathbf{E}_{i,i}=\\int_{t_s}^{t_f}{\\frac{d{{\\cos\\left(\\omega\\tau+\\textrm{phase}\\right)}\\sigma\\left(\\tau\\right)}}{d\\tau}\\exp\\left({dT\\left(t-\\tau\\right)*\\lambda_i}\\right)\\,d\\tau}</span>

<span class="sd">    where</span>

<span class="sd">    .. math:: t_s = \\min\\left(t,t_{increment\\:start}\\right)</span>

<span class="sd">    .. math:: t_f = \\min\\left(t,t_{increment\\:end}\\right)</span>

<span class="sd">    (note that this function,`EDload_coslinear`, rather than use :math:`t_s` and</span>
<span class="sd">    :math:`t_f`,</span>
<span class="sd">    explicitly finds increments that the current time falls in, falls after,</span>
<span class="sd">    and falls before and treates each case on it&#39;s own.)</span>

<span class="sd">    Each :math:`t` value of interest requires a separate diagonal matrix</span>
<span class="sd">    :math:`E`.  To use space more efficiently and to facilitate numpy</span>
<span class="sd">    broadcasting when using the results of the function, the diagonal elements</span>
<span class="sd">    of :math:`E` for each time value `t` value are stored in the rows of</span>
<span class="sd">    array :math:`A` returned by `EDload_coslinear`.  Thus:</span>

<span class="sd">    .. math:: \\mathbf{A}=\\left(\\begin{matrix}E_{0,0}(t_0)&amp;E_{1,1}(t_0)&amp; \cdots &amp; E_{neig-1,neig-1}(t_0)\\\ E_{0,0}(t_1)&amp;E_{1,1}(t_1)&amp; \\cdots &amp; E_{neig-1,neig-1}(t_1)\\\ \\vdots&amp;\\vdots&amp;\\ddots&amp;\\vdots \\\ E_{0,0}(t_m)&amp;E_{1,1}(t_m)&amp; \cdots &amp; E_{neig-1,neig-1}(t_m)\\end{matrix}\\right)</span>

<span class="sd">    See Also</span>
<span class="sd">    --------</span>
<span class="sd">    pEDload_coslinear : Same function with PolyLine inputs.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">return</span> <span class="n">EDload_coslinear</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">a</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="n">omega</span><span class="p">,</span> <span class="n">phase</span><span class="p">,</span> <span class="n">eigs</span><span class="p">,</span> <span class="n">tvals</span><span class="p">,</span> <span class="n">dT</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>


<div class="viewcode-block" id="pEload_coslinear"><a class="viewcode-back" href="../../../api/geotecha.speccon.integrals.html#geotecha.speccon.integrals.pEload_coslinear">[docs]</a><span class="k">def</span> <span class="nf">pEload_coslinear</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">omega</span><span class="p">,</span> <span class="n">phase</span><span class="p">,</span> <span class="n">eigs</span><span class="p">,</span> <span class="n">tvals</span><span class="p">,</span> <span class="n">dT</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Integration of cos(omega*tau+phase)*load(tau) * exp(dT * eig * (t-tau)) between [0, t], where</span>
<span class="sd">    load(tau) is piecewise linear.</span>


<span class="sd">    Wrapper for Eload_coslinear to allow PolyLine inputs.</span>


<span class="sd">    Performs integrations involving a piecewise linear load.  A 2d array of</span>
<span class="sd">    dimensions A[len(tvals), len(eigs)]</span>
<span class="sd">    is produced where the &#39;i&#39;th row of A contains the diagonal elements of the</span>
<span class="sd">    spectral &#39;E&#39; matrix calculated for the time value tvals[i]. i.e. rows of</span>
<span class="sd">    this matrix will be assembled into the diagonal matrix &#39;E&#39; elsewhere.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    a : PolyLine</span>
<span class="sd">        PolyLine object representing piecewise linear load vs time.</span>
<span class="sd">    omega, phase : float</span>
<span class="sd">        Parameters that describe a cyclic load cos(omega * t + phase).</span>
<span class="sd">    eigs : 1d numpy.ndarray</span>
<span class="sd">        List of eigenvalues.</span>
<span class="sd">    tvals : 1d numpy.ndarray`</span>
<span class="sd">        List of time values to calculate integral at.</span>
<span class="sd">    dT : ``float``, optional</span>
<span class="sd">        Time factor multiple (Default dT=1.0).</span>
<span class="sd">    implementation : [&#39;vectorized&#39;, &#39;scalar&#39;, &#39;fortran&#39;], optional</span>
<span class="sd">        Functional implementation: &#39;scalar&#39; = python loops (slow),</span>
<span class="sd">        &#39;fortran&#39; = fortran code (fastest), &#39;vectorized&#39; = numpy(fast).</span>
<span class="sd">        Default implementation=&#39;vectorized&#39;.  If fortran extention module</span>
<span class="sd">        cannot be imported then &#39;vectorized&#39; version will be used.</span>
<span class="sd">        If anything other than &#39;fortran&#39; or &#39;scalar&#39; is used then</span>
<span class="sd">        default vectorized version will be used.</span>


<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    A : numpy.ndarray</span>
<span class="sd">        A 2d array of dimesnions A[len(tvals), len(eigs)].</span>
<span class="sd">        The &#39;i&#39;th row of A is the diagonal elements of the spectral &#39;E&#39; matrix</span>
<span class="sd">        calculated for the time tvals[i].</span>


<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    Assuming the load are formulated as the product of separate time and depth</span>
<span class="sd">    dependant functions:</span>

<span class="sd">    .. math:: \\sigma\\left({Z,t}\\right)=\\sigma\\left({Z}\\right)\\sigma\\left({t}\\right)</span>

<span class="sd">    the solution to the consolidation equation using the spectral method has</span>
<span class="sd">    the form:</span>

<span class="sd">    .. math:: u\\left(Z,t\\right)=\\mathbf{\\Phi v E}\\left(\\mathbf{\\Gamma v}\\right)^{-1}\\mathbf{\\theta}</span>

<span class="sd">    The matrix :math:`E` is a time dependent diagonal matrix due to time</span>
<span class="sd">    dependant loadings.  The version of :math:`E` calculated here in</span>
<span class="sd">    `Eload_coslinear` is from loading terms in the governing equation that are NOT</span>
<span class="sd">    differentiated wrt :math:`t`.</span>
<span class="sd">    The diagonal elements of :math:`E` are given by:</span>

<span class="sd">    .. math:: \\mathbf{E}_{i,i}=\\int_{0}^t{{\\cos\\left(\\omega\\tau+\\textrm{phase}\\right)}{\\sigma\\left(\\tau\\right)}{\exp\\left({(dT\\left(t-\\tau\\right)\\lambda_i}\\right)}\\,d\\tau}</span>

<span class="sd">    where</span>

<span class="sd">     :math:`\\lambda_i` is the `ith` eigenvalue of the problem,</span>
<span class="sd">     :math:`dT` is a time factor for numerical convienience,</span>
<span class="sd">     :math:`\\sigma\left(\\tau\\right)` is the time dependant portion of the loading function.</span>

<span class="sd">    When the time dependant loading term :math:`\\sigma\\left(\\tau\\right)` is</span>
<span class="sd">    piecewise in time. The contribution of each load segment is found by:</span>

<span class="sd">    .. math:: \\mathbf{E}_{i,i}=\\int_{t_s}^{t_f}{{\\cos\\left(\\omega\\tau+\\textrm{phase}\\right)}{\\sigma\\left(\\tau\\right)}\\exp\\left({dT\\left(t-\\tau\\right)*\\lambda_i}\\right)\\,d\\tau}</span>

<span class="sd">    where</span>

<span class="sd">    .. math:: t_s = \\min\\left(t,t_{increment\\:start}\\right)</span>

<span class="sd">    .. math:: t_f = \\min\\left(t,t_{increment\\:end}\\right)</span>

<span class="sd">    (note that this function,`Eload_coslinear`, rather than use :math:`t_s` and</span>
<span class="sd">    :math:`t_f`,</span>
<span class="sd">    explicitly finds increments that the current time falls in, falls after,</span>
<span class="sd">    and falls before and treates each case on it&#39;s own.)</span>

<span class="sd">    Each :math:`t` value of interest requires a separate diagonal matrix</span>
<span class="sd">    :math:`E`.  To use space more efficiently and to facilitate numpy</span>
<span class="sd">    broadcasting when using the results of the function, the diagonal elements</span>
<span class="sd">    of :math:`E` for each time value `t` value are stored in the rows of</span>
<span class="sd">    array :math:`A` returned by `Eload_coslinear`.  Thus:</span>

<span class="sd">    .. math:: \\mathbf{A}=\\left(\\begin{matrix}E_{0,0}(t_0)&amp;E_{1,1}(t_0)&amp; \cdots &amp; E_{neig-1,neig-1}(t_0)\\\ E_{0,0}(t_1)&amp;E_{1,1}(t_1)&amp; \\cdots &amp; E_{neig-1,neig-1}(t_1)\\\ \\vdots&amp;\\vdots&amp;\\ddots&amp;\\vdots \\\ E_{0,0}(t_m)&amp;E_{1,1}(t_m)&amp; \cdots &amp; E_{neig-1,neig-1}(t_m)\\end{matrix}\\right)</span>

<span class="sd">    See Also</span>
<span class="sd">    --------</span>
<span class="sd">    Eload_coslinear : Wrapped function.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">return</span> <span class="n">Eload_coslinear</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">a</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="n">omega</span><span class="p">,</span> <span class="n">phase</span><span class="p">,</span> <span class="n">eigs</span><span class="p">,</span> <span class="n">tvals</span><span class="p">,</span> <span class="n">dT</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>


<div class="viewcode-block" id="pEload_sinlinear"><a class="viewcode-back" href="../../../api/geotecha.speccon.integrals.html#geotecha.speccon.integrals.pEload_sinlinear">[docs]</a><span class="k">def</span> <span class="nf">pEload_sinlinear</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">omega</span><span class="p">,</span> <span class="n">phase</span><span class="p">,</span> <span class="n">eigs</span><span class="p">,</span> <span class="n">tvals</span><span class="p">,</span> <span class="n">dT</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Integration of sin(omega*tau+phase)*load(tau) * exp(dT * eig * (t-tau)) between [0, t], where</span>
<span class="sd">    load(tau) is piecewise linear.</span>


<span class="sd">    Wrapper for Eload_sinlinear to allow PolyLine inputs.</span>


<span class="sd">    Performs integrations involving a piecewise linear load.  A 2d array of</span>
<span class="sd">    dimensions A[len(tvals), len(eigs)]</span>
<span class="sd">    is produced where the &#39;i&#39;th row of A contains the diagonal elements of the</span>
<span class="sd">    spectral &#39;E&#39; matrix calculated for the time value tvals[i]. i.e. rows of</span>
<span class="sd">    this matrix will be assembled into the diagonal matrix &#39;E&#39; elsewhere.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    a : PolyLine</span>
<span class="sd">        PolyLine object representing piecewise linear load vs time.</span>
<span class="sd">    omega, phase : float</span>
<span class="sd">        Parameters that describe a cyclic load sin(omega * t + phase).</span>
<span class="sd">    eigs : 1d numpy.ndarray</span>
<span class="sd">        List of eigenvalues.</span>
<span class="sd">    tvals : 1d numpy.ndarray`</span>
<span class="sd">        List of time values to calculate integral at.</span>
<span class="sd">    dT : ``float``, optional</span>
<span class="sd">        Time factor multiple (Default dT=1.0).</span>
<span class="sd">    implementation : [&#39;vectorized&#39;, &#39;scalar&#39;, &#39;fortran&#39;], optional</span>
<span class="sd">        Functional implementation: &#39;scalar&#39; = python loops (slow),</span>
<span class="sd">        &#39;fortran&#39; = fortran code (fastest), &#39;vectorized&#39; = numpy(fast).</span>
<span class="sd">        Default implementation=&#39;vectorized&#39;.  If fortran extention module</span>
<span class="sd">        cannot be imported then &#39;vectorized&#39; version will be used.</span>
<span class="sd">        If anything other than &#39;fortran&#39; or &#39;scalar&#39; is used then</span>
<span class="sd">        default vectorized version will be used.</span>


<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    A : numpy.ndarray</span>
<span class="sd">        A 2d array of dimesnions A[len(tvals), len(eigs)].</span>
<span class="sd">        The &#39;i&#39;th row of A is the diagonal elements of the spectral &#39;E&#39; matrix</span>
<span class="sd">        calculated for the time tvals[i].</span>


<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    Assuming the load are formulated as the product of separate time and depth</span>
<span class="sd">    dependant functions:</span>

<span class="sd">    .. math:: \\sigma\\left({Z,t}\\right)=\\sigma\\left({Z}\\right)\\sigma\\left({t}\\right)</span>

<span class="sd">    the solution to the consolidation equation using the spectral method has</span>
<span class="sd">    the form:</span>

<span class="sd">    .. math:: u\\left(Z,t\\right)=\\mathbf{\\Phi v E}\\left(\\mathbf{\\Gamma v}\\right)^{-1}\\mathbf{\\theta}</span>

<span class="sd">    The matrix :math:`E` is a time dependent diagonal matrix due to time</span>
<span class="sd">    dependant loadings.  The version of :math:`E` calculated here in</span>
<span class="sd">    `Eload_sinlinear` is from loading terms in the governing equation that are NOT</span>
<span class="sd">    differentiated wrt :math:`t`.</span>
<span class="sd">    The diagonal elements of :math:`E` are given by:</span>

<span class="sd">    .. math:: \\mathbf{E}_{i,i}=\\int_{0}^t{{\\sin\\left(\\omega\\tau+\\textrm{phase}\\right)}{\\sigma\\left(\\tau\\right)}{\exp\\left({(dT\\left(t-\\tau\\right)\\lambda_i}\\right)}\\,d\\tau}</span>

<span class="sd">    where</span>

<span class="sd">     :math:`\\lambda_i` is the `ith` eigenvalue of the problem,</span>
<span class="sd">     :math:`dT` is a time factor for numerical convienience,</span>
<span class="sd">     :math:`\\sigma\left(\\tau\\right)` is the time dependant portion of the loading function.</span>

<span class="sd">    When the time dependant loading term :math:`\\sigma\\left(\\tau\\right)` is</span>
<span class="sd">    piecewise in time. The contribution of each load segment is found by:</span>

<span class="sd">    .. math:: \\mathbf{E}_{i,i}=\\int_{t_s}^{t_f}{{\\sin\\left(\\omega\\tau+\\textrm{phase}\\right)}{\\sigma\\left(\\tau\\right)}\\exp\\left({dT\\left(t-\\tau\\right)*\\lambda_i}\\right)\\,d\\tau}</span>

<span class="sd">    where</span>

<span class="sd">    .. math:: t_s = \\min\\left(t,t_{increment\\:start}\\right)</span>

<span class="sd">    .. math:: t_f = \\min\\left(t,t_{increment\\:end}\\right)</span>

<span class="sd">    (note that this function,`Eload_sinlinear`, rather than use :math:`t_s` and</span>
<span class="sd">    :math:`t_f`,</span>
<span class="sd">    explicitly finds increments that the current time falls in, falls after,</span>
<span class="sd">    and falls before and treates each case on it&#39;s own.)</span>

<span class="sd">    Each :math:`t` value of interest requires a separate diagonal matrix</span>
<span class="sd">    :math:`E`.  To use space more efficiently and to facilitate numpy</span>
<span class="sd">    broadcasting when using the results of the function, the diagonal elements</span>
<span class="sd">    of :math:`E` for each time value `t` value are stored in the rows of</span>
<span class="sd">    array :math:`A` returned by `Eload_sinlinear`.  Thus:</span>

<span class="sd">    .. math:: \\mathbf{A}=\\left(\\begin{matrix}E_{0,0}(t_0)&amp;E_{1,1}(t_0)&amp; \cdots &amp; E_{neig-1,neig-1}(t_0)\\\ E_{0,0}(t_1)&amp;E_{1,1}(t_1)&amp; \\cdots &amp; E_{neig-1,neig-1}(t_1)\\\ \\vdots&amp;\\vdots&amp;\\ddots&amp;\\vdots \\\ E_{0,0}(t_m)&amp;E_{1,1}(t_m)&amp; \cdots &amp; E_{neig-1,neig-1}(t_m)\\end{matrix}\\right)</span>

<span class="sd">    See Also</span>
<span class="sd">    --------</span>
<span class="sd">    Eload_sinlinear : Wrapped function.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">return</span> <span class="n">Eload_sinlinear</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">a</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="n">omega</span><span class="p">,</span> <span class="n">phase</span><span class="p">,</span> <span class="n">eigs</span><span class="p">,</span> <span class="n">tvals</span><span class="p">,</span> <span class="n">dT</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>


<div class="viewcode-block" id="dim1sin"><a class="viewcode-back" href="../../../api/geotecha.speccon.integrals.html#geotecha.speccon.integrals.dim1sin">[docs]</a><span class="k">def</span> <span class="nf">dim1sin</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">z</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;sin(m*z) for each combination of m and z</span>

<span class="sd">    Calculates array A[len(z), len(m)]</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    m : ``list`` of ``float``</span>
<span class="sd">        Eigenvlaues of BVP. generate with geoteca.speccon.m_from_sin_mx</span>
<span class="sd">    z : ``list`` of ``float``</span>
<span class="sd">        Normalised depth or z-coordinate should be between 0 and 1.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    A : numpy.ndarray</span>
<span class="sd">        A 1d array size A[len(z), len(m)].</span>

<span class="sd">    See Also</span>
<span class="sd">    --------</span>
<span class="sd">    m_from_sin_mx : used to generate &#39;m&#39; input parameter</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    .. math:: \\mathbf{A}_{i,j}=\\sin\\left({m_j, z_i}\\right)</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">m</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
    <span class="n">z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">z</span><span class="p">[:,</span> <span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">,</span> <span class="p">:])</span></div>


<div class="viewcode-block" id="dim1sin_avg_between"><a class="viewcode-back" href="../../../api/geotecha.speccon.integrals.html#geotecha.speccon.integrals.dim1sin_avg_between">[docs]</a><span class="k">def</span> <span class="nf">dim1sin_avg_between</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">z</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Average of sin(m * z) between z1 and z2</span>

<span class="sd">    Integrate(sin(m*z), (z, z1, z2))/(z2-z1) for each combination of m</span>
<span class="sd">    and [z1,z2].</span>

<span class="sd">    Calculates array A[len(z), len(m)].</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    m : ``list`` of ``float``</span>
<span class="sd">        Eigenvlaues of BVP. generate with geoteca.speccon.m_from_sin_mx</span>
<span class="sd">    z : ``list`` of ``list`` of float``</span>
<span class="sd">        Normalised depth or z-coordinate pair should be two values</span>
<span class="sd">        between 0 and 1..</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    A : numpy.ndarray</span>
<span class="sd">        A 1d array size A[len(z), len(m)]</span>

<span class="sd">    See Also</span>
<span class="sd">    --------</span>
<span class="sd">    m_from_sin_mx : used to generate &#39;m&#39; input parameter</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    .. math:: \\mathbf{A}_{i,j}=\\frac{1}{z_{2i}-z_{1i}}\\int_{z_{1i}}^{z_{2i}}{\\sin\\left({m_j, z}\\right)\\,dz}</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="kn">from</span> <span class="nn">numpy</span> <span class="k">import</span> <span class="n">sin</span><span class="p">,</span> <span class="n">cos</span>
    <span class="n">m</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
    <span class="n">z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>

    <span class="n">a</span> <span class="o">=</span> <span class="n">z</span><span class="p">[:,</span><span class="mi">0</span><span class="p">][:,</span><span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">]</span>
    <span class="n">b</span> <span class="o">=</span> <span class="n">z</span><span class="p">[:,</span><span class="mi">1</span><span class="p">][:,</span><span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">]</span>
    <span class="n">mm</span> <span class="o">=</span> <span class="n">m</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">,:]</span>

    <span class="k">return</span> <span class="p">(</span><span class="n">cos</span><span class="p">(</span><span class="n">a</span><span class="o">*</span><span class="n">mm</span><span class="p">)</span><span class="o">-</span><span class="n">cos</span><span class="p">(</span><span class="n">b</span><span class="o">*</span><span class="n">mm</span><span class="p">))</span><span class="o">/</span><span class="n">mm</span><span class="o">/</span><span class="p">(</span><span class="n">b</span><span class="o">-</span><span class="n">a</span><span class="p">)</span></div>


<div class="viewcode-block" id="pdim1sin_a_linear_between"><a class="viewcode-back" href="../../../api/geotecha.speccon.integrals.html#geotecha.speccon.integrals.pdim1sin_a_linear_between">[docs]</a><span class="k">def</span> <span class="nf">pdim1sin_a_linear_between</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Integrations of `sin(mi * z) * a(z)`</span>
<span class="sd">    between [z1, z2] where a(z) is a piecewise linear functions of z.</span>

<span class="sd">    Wrapper for dim1sin_a_linear_between to allow PolyLine inputs.</span>

<span class="sd">    Calculates array A[len(z), len(m)].</span>


<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    m : ``list`` of ``float``</span>
<span class="sd">        Eigenvlaues of BVP. generate with geoteca.speccon.m_from_sin_mx</span>
<span class="sd">    a : PolyLine object</span>
<span class="sd">        PolyLine defining piecewise linear relationship.</span>
<span class="sd">    z : ``list`` of ``list`` of float``</span>
<span class="sd">        Normalised depth or z-coordinate pair should be two values</span>
<span class="sd">        between 0 and 1.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    A : numpy.ndarray</span>
<span class="sd">        A 2d array size of size [len(z), len(m)].</span>

<span class="sd">    See Also</span>
<span class="sd">    --------</span>
<span class="sd">    dim1sin_a_linear_between : Wrapped function.</span>


<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    The `dim1sin_a_linear_between`, :math:`A`, is given by:</span>

<span class="sd">    .. math:: \\mathbf{A}_{i,j}=</span>
<span class="sd">                \\int_{z_1}^{z_2}{{a\\left(z\\right)}\\phi_j\\,dz}</span>

<span class="sd">    where the basis function :math:`\\phi_j` is given by:</span>

<span class="sd">    .. math:: \\phi_j\\left(z\\right)=\\sin\\left({m_j}z\\right)</span>

<span class="sd">    and :math:`a\\left(z\\right)` is a piecewise</span>
<span class="sd">    linear functions with respect to :math:`z`, that within a layer are defined by:</span>

<span class="sd">    .. math:: a\\left(z\\right) = a_t+\\frac{a_b-a_t}{z_b-z_t}\\left(z-z_t\\right)</span>

<span class="sd">    with :math:`t` and :math:`b` subscripts representing &#39;top&#39; and &#39;bottom&#39; of</span>
<span class="sd">    each layer respectively.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">return</span> <span class="n">dim1sin_a_linear_between</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">a</span><span class="o">.</span><span class="n">y1</span><span class="p">,</span> <span class="n">a</span><span class="o">.</span><span class="n">y2</span><span class="p">,</span> <span class="n">a</span><span class="o">.</span><span class="n">x1</span><span class="p">,</span> <span class="n">a</span><span class="o">.</span><span class="n">x2</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>


<div class="viewcode-block" id="dim1sin_a_linear_between"><a class="viewcode-back" href="../../../api/geotecha.speccon.integrals.html#geotecha.speccon.integrals.dim1sin_a_linear_between">[docs]</a><span class="k">def</span> <span class="nf">dim1sin_a_linear_between</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">at</span><span class="p">,</span> <span class="n">ab</span><span class="p">,</span> <span class="n">zt</span><span class="p">,</span> <span class="n">zb</span><span class="p">,</span> <span class="n">z</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Integrations of `sin(mi * z) * a(z)`</span>
<span class="sd">    between [z1, z2] where a(z) is a piecewise linear functions of z.</span>

<span class="sd">    Calculates array A[len(z), len(m)].</span>


<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    m : ``list`` of ``float``</span>
<span class="sd">        Eigenvlaues of BVP. generate with geoteca.speccon.m_from_sin_mx</span>
<span class="sd">    at : ``list`` of ``float``</span>
<span class="sd">        Property at top of each layer.</span>
<span class="sd">    ab : ``list`` of ``float``</span>
<span class="sd">        Property at bottom of each layer.</span>
<span class="sd">    zt : ``list`` of ``float``</span>
<span class="sd">        Normalised depth or z-coordinate at top of each layer. `zt[0]` = 0</span>
<span class="sd">    zb : ``list`` of ``float``</span>
<span class="sd">        Normalised depth or z-coordinate at bottom of each layer. `zt[-1]` = 1</span>
<span class="sd">    z : ``list`` of ``list`` of float``</span>
<span class="sd">        Normalised depth or z-coordinate pair should be two values</span>
<span class="sd">        between 0 and 1.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    A : numpy.ndarray</span>
<span class="sd">        A 2d array size of size [len(z), len(m)].</span>

<span class="sd">    See Also</span>
<span class="sd">    --------</span>
<span class="sd">    m_from_sin_mx : Used to generate &#39;m&#39; input parameter.</span>
<span class="sd">    geotecha.speccon.integrals_generate_code.dim1sin_a_linear_between : Generation</span>
<span class="sd">        of code for this function.</span>
<span class="sd">    pdim1sin_a_linear_between : Same function with PolyLine</span>
<span class="sd">        inputs.</span>
<span class="sd">    geotecha.piecewise.piecewise_linear_1d.segments_between_xi_and_xj : Used in the</span>
<span class="sd">        function.</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    The `dim1sin_a_linear_between`, :math:`A`, is given by:</span>

<span class="sd">    .. math:: \\mathbf{A}_{i,j}=</span>
<span class="sd">                \\int_{z_1}^{z_2}{{a\\left(z\\right)}\\phi_j\\,dz}</span>

<span class="sd">    where the basis function :math:`\\phi_j` is given by:</span>

<span class="sd">    .. math:: \\phi_j\\left(z\\right)=\\sin\\left({m_j}z\\right)</span>

<span class="sd">    and :math:`a\\left(z\\right)` is a piecewise</span>
<span class="sd">    linear functions with respect to :math:`z`, that within a layer are defined by:</span>

<span class="sd">    .. math:: a\\left(z\\right) = a_t+\\frac{a_b-a_t}{z_b-z_t}\\left(z-z_t\\right)</span>

<span class="sd">    with :math:`t` and :math:`b` subscripts representing &#39;top&#39; and &#39;bottom&#39; of</span>
<span class="sd">    each layer respectively.</span>


<span class="sd">    &quot;&quot;&quot;</span>


    <span class="c1">#import numpy as np #import this globally</span>
    <span class="c1">#import math #import this globally</span>

    <span class="n">sin</span><span class="o">=</span><span class="n">math</span><span class="o">.</span><span class="n">sin</span>
    <span class="n">cos</span><span class="o">=</span><span class="n">math</span><span class="o">.</span><span class="n">cos</span>
    <span class="n">m</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
    <span class="n">at</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">at</span><span class="p">)</span>
    <span class="n">ab</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">ab</span><span class="p">)</span>
    <span class="n">zt</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">zt</span><span class="p">)</span>
    <span class="n">zb</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">zb</span><span class="p">)</span>

    <span class="n">z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">atleast_2d</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>

    <span class="n">z1</span> <span class="o">=</span> <span class="n">z</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">z2</span> <span class="o">=</span> <span class="n">z</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]</span>

    <span class="n">z_for_interp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">zt</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">z_for_interp</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">zt</span><span class="p">[:]</span>
    <span class="n">z_for_interp</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">=</span><span class="n">zb</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>


    <span class="p">(</span><span class="n">segment_both</span><span class="p">,</span>
     <span class="n">segment_z1_only</span><span class="p">,</span>
     <span class="n">segment_z2_only</span><span class="p">,</span>
     <span class="n">segments_between</span><span class="p">)</span> <span class="o">=</span> <span class="n">segments_between_xi_and_xj</span><span class="p">(</span><span class="n">z_for_interp</span><span class="p">,</span> <span class="n">z1</span><span class="p">,</span> <span class="n">z2</span><span class="p">)</span>

    <span class="n">nz</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>
    <span class="n">neig</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>

    <span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">nz</span><span class="p">,</span><span class="n">neig</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nz</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">layer</span> <span class="ow">in</span> <span class="n">segment_both</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span>
            <span class="n">a_slope</span> <span class="o">=</span> <span class="p">(</span><span class="n">ab</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span> <span class="o">-</span> <span class="n">at</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span> <span class="o">/</span> <span class="p">(</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span> <span class="o">-</span> <span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">neig</span><span class="p">):</span>
                <span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">+=</span> <span class="p">(</span><span class="o">-</span><span class="n">a_slope</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="n">z1</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">+</span> <span class="n">a_slope</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="n">z2</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">+</span>
                    <span class="n">a_slope</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">z1</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="n">z1</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">-</span>
                    <span class="n">a_slope</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">z2</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="n">z2</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">-</span>
                    <span class="n">a_slope</span><span class="o">*</span><span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="n">z1</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">+</span>
                    <span class="n">a_slope</span><span class="o">*</span><span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="n">z2</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">+</span>
                    <span class="n">at</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="n">z1</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">-</span> <span class="n">at</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="n">z2</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
        <span class="k">for</span> <span class="n">layer</span> <span class="ow">in</span> <span class="n">segment_z1_only</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span>
            <span class="n">a_slope</span> <span class="o">=</span> <span class="p">(</span><span class="n">ab</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span> <span class="o">-</span> <span class="n">at</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span> <span class="o">/</span> <span class="p">(</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span> <span class="o">-</span> <span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">neig</span><span class="p">):</span>
                <span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">+=</span> <span class="p">(</span><span class="o">-</span><span class="n">a_slope</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="n">z1</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">+</span> <span class="n">a_slope</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">])</span> <span class="o">+</span>
                    <span class="n">a_slope</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">z1</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="n">z1</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">-</span>
                    <span class="n">a_slope</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">])</span> <span class="o">-</span>
                    <span class="n">a_slope</span><span class="o">*</span><span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="n">z1</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">+</span>
                    <span class="n">a_slope</span><span class="o">*</span><span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">])</span> <span class="o">+</span>
                    <span class="n">at</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="n">z1</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">-</span> <span class="n">at</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]))</span>
        <span class="k">for</span> <span class="n">layer</span> <span class="ow">in</span> <span class="n">segments_between</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span>
            <span class="n">a_slope</span> <span class="o">=</span> <span class="p">(</span><span class="n">ab</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span> <span class="o">-</span> <span class="n">at</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span> <span class="o">/</span> <span class="p">(</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span> <span class="o">-</span> <span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">neig</span><span class="p">):</span>
                <span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">+=</span> <span class="p">(</span><span class="n">a_slope</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">])</span> <span class="o">-</span> <span class="n">a_slope</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">])</span> <span class="o">-</span>
                    <span class="n">a_slope</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">])</span> <span class="o">+</span>
                    <span class="n">a_slope</span><span class="o">*</span><span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">])</span> <span class="o">-</span>
                    <span class="n">at</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">])</span> <span class="o">+</span>
                    <span class="n">at</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]))</span>
        <span class="k">for</span> <span class="n">layer</span> <span class="ow">in</span> <span class="n">segment_z2_only</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span>
            <span class="n">a_slope</span> <span class="o">=</span> <span class="p">(</span><span class="n">ab</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span> <span class="o">-</span> <span class="n">at</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span> <span class="o">/</span> <span class="p">(</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span> <span class="o">-</span> <span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">neig</span><span class="p">):</span>
                <span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">+=</span> <span class="p">(</span><span class="n">a_slope</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="n">z2</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">-</span> <span class="n">a_slope</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">])</span> <span class="o">-</span>
                    <span class="n">a_slope</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">z2</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="n">z2</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">+</span>
                    <span class="n">a_slope</span><span class="o">*</span><span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="n">z2</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">-</span>
                    <span class="n">at</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="n">z2</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">+</span> <span class="n">at</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]))</span>
    <span class="k">return</span> <span class="n">A</span></div>


<div class="viewcode-block" id="dim1sin_af_linear"><a class="viewcode-back" href="../../../api/geotecha.speccon.integrals.html#geotecha.speccon.integrals.dim1sin_af_linear">[docs]</a><span class="k">def</span> <span class="nf">dim1sin_af_linear</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">at</span><span class="p">,</span> <span class="n">ab</span><span class="p">,</span> <span class="n">zt</span><span class="p">,</span> <span class="n">zb</span><span class="p">,</span> <span class="n">implementation</span><span class="o">=</span><span class="s1">&#39;vectorized&#39;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Integration of sin(mi * z) * a(z) * sin(mj * z)</span>
<span class="sd">    between ztop and zbot where a(z) is piecewise linear.</span>


<span class="sd">    Calculation of integrals is performed at each element of a square symmetric</span>
<span class="sd">    matrix (size depends on size of `m`)</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    m : ``list`` of ``float``</span>
<span class="sd">        eigenvlaues of BVP. generate with geoteca.speccon.m_from_sin_mx</span>
<span class="sd">    at : ``list`` of ``float``</span>
<span class="sd">        Property at top of each layer.</span>
<span class="sd">    ab : ``list`` of ``float``</span>
<span class="sd">        Property at bottom of each layer.</span>
<span class="sd">    zt : ``list`` of ``float``</span>
<span class="sd">        Normalised depth or z-coordinate at top of each layer. `zt[0]` = 0</span>
<span class="sd">    zb : ``list`` of ``float``</span>
<span class="sd">        Normalised depth or z-coordinate at bottom of each layer. `zt[-1]` = 1</span>
<span class="sd">    implementation : [&#39;vectorized&#39;, &#39;scalar&#39;, &#39;fortran&#39;], optional</span>
<span class="sd">        Functional implementation: &#39;scalar&#39; = python loops (slow),</span>
<span class="sd">        &#39;fortran&#39; = fortran code (fastest), &#39;vectorized&#39; = numpy(fast).</span>
<span class="sd">        Default implementation=&#39;vectorized&#39;.  If fortran extention module</span>
<span class="sd">        cannot be imported then &#39;vectorized&#39; version will be used.</span>
<span class="sd">        If anything other than &#39;fortran&#39; or &#39;scalar&#39; is used then</span>
<span class="sd">        default vectorized version will be used.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    A : numpy.ndarray</span>
<span class="sd">        A square symmetric matrix, size determined by size of `m`.</span>

<span class="sd">    See Also</span>
<span class="sd">    --------</span>
<span class="sd">    m_from_sin_mx : Used to generate &#39;m&#39; input parameter.</span>
<span class="sd">    geotecha.integrals_generate_code.dim1sin_af_linear : Generation</span>
<span class="sd">        of code for this function.</span>
<span class="sd">    pdim1sin_af_linear : Same function with PolyLine</span>
<span class="sd">        inputs.</span>
<span class="sd">    geotecha.speccon.ext_integrals.dim1sin_af_linear : Equivalent fortran</span>
<span class="sd">        function.</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    The `dim1sin_af_linear` matrix, :math:`A` is given by:</span>

<span class="sd">    .. math:: \\mathbf{A}_{i,j}=\\int_{0}^1{{a\\left(z\\right)}\\phi_i\\phi_j\\,dz}</span>

<span class="sd">    where the basis function :math:`\\phi_i` is given by:</span>

<span class="sd">    .. math:: \\phi_i\\left(z\\right)=\\sin\\left({m_i}z\\right)</span>

<span class="sd">    and :math:`a\\left(z\\right)` is a piecewise linear function</span>
<span class="sd">    with respect to :math:`z`, that within a layer are defined by:</span>

<span class="sd">    .. math:: a\\left(z\\right) = a_t+\\frac{a_b-a_t}{z_b-z_t}\\left(z-z_t\\right)</span>

<span class="sd">    with :math:`t` and :math:`b` subscripts representing &#39;top&#39; and &#39;bottom&#39; of</span>
<span class="sd">    each layer respectively.</span>




<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1">#import numpy as np #import this at module level</span>
    <span class="c1">#import math #import this at module level</span>

    <span class="n">m</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
    <span class="n">at</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">at</span><span class="p">)</span>
    <span class="n">ab</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">ab</span><span class="p">)</span>
    <span class="n">zt</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">zt</span><span class="p">)</span>
    <span class="n">zb</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">zb</span><span class="p">)</span>

    <span class="n">neig</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">implementation</span> <span class="o">==</span> <span class="s1">&#39;scalar&#39;</span><span class="p">:</span>
        <span class="n">sin</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">sin</span>
        <span class="n">cos</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">cos</span>
        <span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="n">neig</span><span class="p">,</span> <span class="n">neig</span><span class="p">],</span> <span class="nb">float</span><span class="p">)</span>
        <span class="n">nlayers</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">zt</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">layer</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nlayers</span><span class="p">):</span>
            <span class="n">a_slope</span> <span class="o">=</span> <span class="p">(</span><span class="n">ab</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span> <span class="o">-</span> <span class="n">at</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span> <span class="o">/</span> <span class="p">(</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span> <span class="o">-</span> <span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">neig</span><span class="p">):</span>
                <span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span> <span class="o">+=</span> <span class="p">(</span><span class="n">a_slope</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="mi">4</span> <span class="o">-</span> <span class="n">a_slope</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="mi">4</span> <span class="o">+</span>
                    <span class="n">a_slope</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">*</span><span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">/</span><span class="mi">2</span> <span class="o">-</span>
                    <span class="n">a_slope</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">/</span><span class="mi">2</span> <span class="o">-</span>
                    <span class="n">a_slope</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">/</span><span class="mi">2</span> <span class="o">-</span>
                    <span class="n">a_slope</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">/</span><span class="mi">2</span> <span class="o">+</span>
                    <span class="n">a_slope</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="mi">4</span> <span class="o">+</span>
                    <span class="n">a_slope</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="mi">4</span> <span class="o">+</span>
                    <span class="n">a_slope</span><span class="o">*</span><span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="mi">4</span> <span class="o">+</span>
                    <span class="n">a_slope</span><span class="o">*</span><span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="mi">4</span> <span class="o">-</span>
                    <span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">*</span><span class="n">at</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">/</span><span class="mi">2</span> <span class="o">+</span>
                    <span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">*</span><span class="n">at</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">/</span><span class="mi">2</span> <span class="o">+</span>
                    <span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">at</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">/</span><span class="mi">2</span> <span class="o">+</span>
                    <span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">at</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">/</span><span class="mi">2</span> <span class="o">-</span>
                    <span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">at</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">/</span><span class="mi">2</span> <span class="o">-</span>
                    <span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">at</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">neig</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
                <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">neig</span><span class="p">):</span>
                    <span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">+=</span> <span class="p">(</span><span class="n">a_slope</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span>
                        <span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span> <span class="o">-</span>
                        <span class="n">a_slope</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span>
                        <span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span> <span class="o">+</span>
                        <span class="n">a_slope</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span>
                        <span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">*</span><span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span> <span class="o">-</span>
                        <span class="n">a_slope</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span>
                        <span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span> <span class="o">+</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">a_slope</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span>
                        <span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">a_slope</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span>
                        <span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span> <span class="o">-</span>
                        <span class="n">a_slope</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span>
                        <span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">*</span><span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span> <span class="o">+</span>
                        <span class="n">a_slope</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span>
                        <span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span> <span class="o">+</span>
                        <span class="n">a_slope</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span>
                        <span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span> <span class="o">-</span>
                        <span class="n">a_slope</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span>
                        <span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span> <span class="o">-</span>
                        <span class="n">a_slope</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span>
                        <span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">*</span><span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span> <span class="o">+</span>
                        <span class="n">a_slope</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span>
                        <span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span> <span class="o">+</span>
                        <span class="n">a_slope</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span>
                        <span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">*</span><span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span> <span class="o">-</span>
                        <span class="n">a_slope</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span>
                        <span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span> <span class="o">-</span>
                        <span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span>
                        <span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">*</span><span class="n">at</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span> <span class="o">+</span>
                        <span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span>
                        <span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">*</span><span class="n">at</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span> <span class="o">+</span>
                        <span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span>
                        <span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">*</span><span class="n">at</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span> <span class="o">-</span>
                        <span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span>
                        <span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">*</span><span class="n">at</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span> <span class="o">+</span>
                        <span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span>
                        <span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">*</span><span class="n">at</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span> <span class="o">-</span>
                        <span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span>
                        <span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">*</span><span class="n">at</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span> <span class="o">-</span>
                        <span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span>
                        <span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">*</span><span class="n">at</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span> <span class="o">+</span>
                        <span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span>
                        <span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">*</span><span class="n">at</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span>

        <span class="c1">#A is symmetric</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">neig</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">neig</span><span class="p">):</span>
                <span class="n">A</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span>

    <span class="k">elif</span> <span class="n">implementation</span> <span class="o">==</span> <span class="s1">&#39;fortran&#39;</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">MUST_TRY_FORTRAN</span><span class="p">:</span>
            <span class="kn">import</span> <span class="nn">geotecha.speccon.ext_integrals</span> <span class="k">as</span> <span class="nn">ext_integ</span>
            <span class="n">A</span> <span class="o">=</span> <span class="n">ext_integ</span><span class="o">.</span><span class="n">dim1sin_af_linear</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">at</span><span class="p">,</span> <span class="n">ab</span><span class="p">,</span> <span class="n">zt</span><span class="p">,</span> <span class="n">zb</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="kn">import</span> <span class="nn">geotecha.speccon.ext_integrals</span> <span class="k">as</span> <span class="nn">ext_integ</span>
            <span class="n">A</span> <span class="o">=</span> <span class="n">ext_integ</span><span class="o">.</span><span class="n">dim1sin_af_linear</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">at</span><span class="p">,</span> <span class="n">ab</span><span class="p">,</span> <span class="n">zt</span><span class="p">,</span> <span class="n">zb</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
            <span class="n">A</span> <span class="o">=</span> <span class="n">dim1sin_af_linear</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">at</span><span class="p">,</span> <span class="n">ab</span><span class="p">,</span> <span class="n">zt</span><span class="p">,</span> <span class="n">zb</span><span class="p">,</span> <span class="n">implementation</span><span class="o">=</span><span class="s1">&#39;vectorized&#39;</span><span class="p">)</span>

    <span class="k">else</span><span class="p">:</span><span class="c1">#default is &#39;vectorized&#39; using numpy</span>
        <span class="n">sin</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span>
        <span class="n">cos</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span>
        <span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="n">neig</span><span class="p">,</span> <span class="n">neig</span><span class="p">],</span> <span class="nb">float</span><span class="p">)</span>

        <span class="n">diag</span> <span class="o">=</span>  <span class="n">np</span><span class="o">.</span><span class="n">diag_indices</span><span class="p">(</span><span class="n">neig</span><span class="p">)</span>
        <span class="n">triu</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">triu_indices</span><span class="p">(</span><span class="n">neig</span><span class="p">,</span> <span class="n">k</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">tril</span> <span class="o">=</span> <span class="p">(</span><span class="n">triu</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">triu</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

        <span class="n">a_slope</span> <span class="o">=</span> <span class="p">(</span><span class="n">ab</span> <span class="o">-</span> <span class="n">at</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">zb</span> <span class="o">-</span> <span class="n">zt</span><span class="p">)</span>

        <span class="n">mi</span> <span class="o">=</span> <span class="n">m</span><span class="p">[:,</span> <span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">]</span>
        <span class="n">A</span><span class="p">[</span><span class="n">diag</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="o">-</span><span class="n">a_slope</span><span class="o">*</span><span class="n">zb</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">zt</span><span class="o">/</span><span class="mi">2</span> <span class="o">-</span> <span class="n">a_slope</span><span class="o">*</span><span class="n">zb</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">zt</span><span class="o">/</span><span class="mi">2</span> <span class="o">+</span> <span class="n">a_slope</span><span class="o">*</span><span class="n">zb</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="mi">4</span> <span class="o">+</span>
            <span class="n">a_slope</span><span class="o">*</span><span class="n">zb</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="mi">4</span> <span class="o">+</span> <span class="n">a_slope</span><span class="o">*</span><span class="n">zt</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zt</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="mi">4</span> <span class="o">+</span>
            <span class="n">a_slope</span><span class="o">*</span><span class="n">zt</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zt</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="mi">4</span> <span class="o">+</span> <span class="n">a_slope</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">zt</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">mi</span><span class="p">)</span> <span class="o">-</span>
            <span class="n">a_slope</span><span class="o">*</span><span class="n">zb</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">mi</span><span class="p">)</span> <span class="o">+</span> <span class="n">a_slope</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="p">(</span><span class="mi">4</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span>
            <span class="n">a_slope</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zt</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="p">(</span><span class="mi">4</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">zb</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">at</span><span class="o">/</span><span class="mi">2</span> <span class="o">+</span> <span class="n">zb</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">at</span><span class="o">/</span><span class="mi">2</span> <span class="o">-</span>
            <span class="n">zt</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zt</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">at</span><span class="o">/</span><span class="mi">2</span> <span class="o">-</span> <span class="n">zt</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zt</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">at</span><span class="o">/</span><span class="mi">2</span> <span class="o">-</span> <span class="n">cos</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">at</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">mi</span><span class="p">)</span> <span class="o">+</span>
            <span class="n">cos</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zt</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zt</span><span class="p">)</span><span class="o">*</span><span class="n">at</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">mi</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

        <span class="n">mi</span> <span class="o">=</span> <span class="n">m</span><span class="p">[</span><span class="n">triu</span><span class="p">[</span><span class="mi">0</span><span class="p">]][:,</span> <span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">]</span>
        <span class="n">mj</span> <span class="o">=</span> <span class="n">m</span><span class="p">[</span><span class="n">triu</span><span class="p">[</span><span class="mi">1</span><span class="p">]][:,</span> <span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">]</span>
        <span class="n">A</span><span class="p">[</span><span class="n">triu</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">a_slope</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mj</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">zt</span><span class="o">/</span><span class="p">(</span><span class="n">mi</span><span class="o">**</span><span class="mi">4</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">mj</span><span class="o">**</span><span class="mi">4</span><span class="p">)</span> <span class="o">-</span>
            <span class="n">a_slope</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">zb</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mj</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">mi</span><span class="o">**</span><span class="mi">4</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">mj</span><span class="o">**</span><span class="mi">4</span><span class="p">)</span> <span class="o">-</span>
            <span class="n">a_slope</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">mj</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mj</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">zt</span><span class="o">/</span><span class="p">(</span><span class="n">mi</span><span class="o">**</span><span class="mi">4</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">mj</span><span class="o">**</span><span class="mi">4</span><span class="p">)</span> <span class="o">+</span>
            <span class="n">a_slope</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">mj</span><span class="o">*</span><span class="n">zb</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mj</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">mi</span><span class="o">**</span><span class="mi">4</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">mj</span><span class="o">**</span><span class="mi">4</span><span class="p">)</span> <span class="o">+</span>
            <span class="n">a_slope</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mj</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">mi</span><span class="o">**</span><span class="mi">4</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">mj</span><span class="o">**</span><span class="mi">4</span><span class="p">)</span> <span class="o">-</span>
            <span class="n">a_slope</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zt</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mj</span><span class="o">*</span><span class="n">zt</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">mi</span><span class="o">**</span><span class="mi">4</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">mj</span><span class="o">**</span><span class="mi">4</span><span class="p">)</span> <span class="o">-</span>
            <span class="n">a_slope</span><span class="o">*</span><span class="n">mi</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mj</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">zt</span><span class="o">/</span><span class="p">(</span><span class="n">mi</span><span class="o">**</span><span class="mi">4</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">mj</span><span class="o">**</span><span class="mi">4</span><span class="p">)</span> <span class="o">+</span>
            <span class="n">a_slope</span><span class="o">*</span><span class="n">mi</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">zb</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mj</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">mi</span><span class="o">**</span><span class="mi">4</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">mj</span><span class="o">**</span><span class="mi">4</span><span class="p">)</span> <span class="o">+</span>
            <span class="mi">2</span><span class="o">*</span><span class="n">a_slope</span><span class="o">*</span><span class="n">mi</span><span class="o">*</span><span class="n">mj</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mj</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">mi</span><span class="o">**</span><span class="mi">4</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">mj</span><span class="o">**</span><span class="mi">4</span><span class="p">)</span> <span class="o">-</span>
            <span class="mi">2</span><span class="o">*</span><span class="n">a_slope</span><span class="o">*</span><span class="n">mi</span><span class="o">*</span><span class="n">mj</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zt</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mj</span><span class="o">*</span><span class="n">zt</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">mi</span><span class="o">**</span><span class="mi">4</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">mj</span><span class="o">**</span><span class="mi">4</span><span class="p">)</span> <span class="o">+</span>
            <span class="n">a_slope</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mj</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">zt</span><span class="o">/</span><span class="p">(</span><span class="n">mi</span><span class="o">**</span><span class="mi">4</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">mj</span><span class="o">**</span><span class="mi">4</span><span class="p">)</span> <span class="o">-</span>
            <span class="n">a_slope</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">zb</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mj</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">mi</span><span class="o">**</span><span class="mi">4</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">mj</span><span class="o">**</span><span class="mi">4</span><span class="p">)</span> <span class="o">+</span>
            <span class="n">a_slope</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mj</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">mi</span><span class="o">**</span><span class="mi">4</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">mj</span><span class="o">**</span><span class="mi">4</span><span class="p">)</span> <span class="o">-</span>
            <span class="n">a_slope</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zt</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mj</span><span class="o">*</span><span class="n">zt</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">mi</span><span class="o">**</span><span class="mi">4</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">mj</span><span class="o">**</span><span class="mi">4</span><span class="p">)</span> <span class="o">-</span>
            <span class="n">mi</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mj</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">at</span><span class="o">/</span><span class="p">(</span><span class="n">mi</span><span class="o">**</span><span class="mi">4</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">mj</span><span class="o">**</span><span class="mi">4</span><span class="p">)</span> <span class="o">+</span>
            <span class="n">mi</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zt</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mj</span><span class="o">*</span><span class="n">zt</span><span class="p">)</span><span class="o">*</span><span class="n">at</span><span class="o">/</span><span class="p">(</span><span class="n">mi</span><span class="o">**</span><span class="mi">4</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">mj</span><span class="o">**</span><span class="mi">4</span><span class="p">)</span> <span class="o">+</span>
            <span class="n">mi</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">mj</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mj</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">at</span><span class="o">/</span><span class="p">(</span><span class="n">mi</span><span class="o">**</span><span class="mi">4</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">mj</span><span class="o">**</span><span class="mi">4</span><span class="p">)</span> <span class="o">-</span>
            <span class="n">mi</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">mj</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mj</span><span class="o">*</span><span class="n">zt</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zt</span><span class="p">)</span><span class="o">*</span><span class="n">at</span><span class="o">/</span><span class="p">(</span><span class="n">mi</span><span class="o">**</span><span class="mi">4</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">mj</span><span class="o">**</span><span class="mi">4</span><span class="p">)</span> <span class="o">+</span>
            <span class="n">mi</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mj</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">at</span><span class="o">/</span><span class="p">(</span><span class="n">mi</span><span class="o">**</span><span class="mi">4</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">mj</span><span class="o">**</span><span class="mi">4</span><span class="p">)</span> <span class="o">-</span>
            <span class="n">mi</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zt</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mj</span><span class="o">*</span><span class="n">zt</span><span class="p">)</span><span class="o">*</span><span class="n">at</span><span class="o">/</span><span class="p">(</span><span class="n">mi</span><span class="o">**</span><span class="mi">4</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">mj</span><span class="o">**</span><span class="mi">4</span><span class="p">)</span> <span class="o">-</span>
            <span class="n">mj</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mj</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">at</span><span class="o">/</span><span class="p">(</span><span class="n">mi</span><span class="o">**</span><span class="mi">4</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">mj</span><span class="o">**</span><span class="mi">4</span><span class="p">)</span> <span class="o">+</span>
            <span class="n">mj</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mj</span><span class="o">*</span><span class="n">zt</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zt</span><span class="p">)</span><span class="o">*</span><span class="n">at</span><span class="o">/</span><span class="p">(</span><span class="n">mi</span><span class="o">**</span><span class="mi">4</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">mj</span><span class="o">**</span><span class="mi">4</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="c1">#A is symmetric</span>
        <span class="n">A</span><span class="p">[</span><span class="n">tril</span><span class="p">]</span> <span class="o">=</span> <span class="n">A</span><span class="p">[</span><span class="n">triu</span><span class="p">]</span>

    <span class="k">return</span> <span class="n">A</span></div>


<div class="viewcode-block" id="dim1sin_abf_linear"><a class="viewcode-back" href="../../../api/geotecha.speccon.integrals.html#geotecha.speccon.integrals.dim1sin_abf_linear">[docs]</a><span class="k">def</span> <span class="nf">dim1sin_abf_linear</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">at</span><span class="p">,</span> <span class="n">ab</span><span class="p">,</span> <span class="n">bt</span><span class="p">,</span> <span class="n">bb</span><span class="p">,</span>  <span class="n">zt</span><span class="p">,</span> <span class="n">zb</span><span class="p">,</span> <span class="n">implementation</span><span class="o">=</span><span class="s1">&#39;vectorized&#39;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Integration of sin(mi * z) * a(z) * a(z) * sin(mj * z)</span>
<span class="sd">    between ztop and zbot where a(z) is piecewise linear.</span>

<span class="sd">    Calulation of integrals is performed at each element of a square symmetric</span>
<span class="sd">    matrix (size depends on size of `m`).</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    m : ``list`` of ``float``</span>
<span class="sd">        eigenvlaues of BVP. generate with geoteca.speccon.m_from_sin_mx</span>
<span class="sd">    at : ``list`` of ``float``</span>
<span class="sd">        Property at top of each layer.</span>
<span class="sd">    ab : ``list`` of ``float``</span>
<span class="sd">        Property at bottom of each layer.</span>
<span class="sd">    bt : ``list`` of ``float``</span>
<span class="sd">        2nd property at top of each layer.</span>
<span class="sd">    bb : ``list`` of ``float``</span>
<span class="sd">        2nd property at bottom of each layer.</span>
<span class="sd">    zt : ``list`` of ``float``</span>
<span class="sd">        Normalised depth or z-coordinate at top of each layer. `zt[0]` = 0</span>
<span class="sd">    zb : ``list`` of ``float``</span>
<span class="sd">        Normalised depth or z-coordinate at bottom of each layer. `zt[-1]` = 1</span>
<span class="sd">    implementation : [&#39;vectorized&#39;, &#39;scalar&#39;, &#39;fortran&#39;], optional</span>
<span class="sd">        Functional implementation: &#39;scalar&#39; = python loops (slow),</span>
<span class="sd">        &#39;fortran&#39; = fortran code (fastest), &#39;vectorized&#39; = numpy(fast).</span>
<span class="sd">        Default implementation=&#39;vectorized&#39;.  If fortran extention module</span>
<span class="sd">        cannot be imported then &#39;vectorized&#39; version will be used.</span>
<span class="sd">        If anything other than &#39;fortran&#39; or &#39;scalar&#39; is used then</span>
<span class="sd">        default vectorized version will be used.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    A : numpy.ndarray</span>
<span class="sd">        A square symmetric matrix, size determined by size of `m`.</span>

<span class="sd">    See Also</span>
<span class="sd">    --------</span>
<span class="sd">    m_from_sin_mx : Used to generate &#39;m&#39; input parameter.</span>
<span class="sd">    geotecha.integrals_generate_code.dim1sin_abf_linear : Generation</span>
<span class="sd">        of code for this function.</span>
<span class="sd">    pdim1sin_abf_linear : Same function with PolyLine</span>
<span class="sd">        inputs.</span>
<span class="sd">    geotecha.speccon.ext_integrals.dim1sin_abf_linear : Equivalent fortran</span>
<span class="sd">        function.</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    The `dim1sin_abf_linear` matrix, :math:`A` is given by:</span>

<span class="sd">    .. math:: \\mathbf{A}_{i,j}=\\int_{0}^1{{a\\left(z\\right)}{b\\left(z\\right)}\\phi_i\\phi_j\\,dz}</span>

<span class="sd">    where the basis function :math:`\\phi_i` is given by:</span>

<span class="sd">    .. math:: \\phi_i\\left(z\\right)=\\sin\\left({m_i}z\\right)</span>

<span class="sd">    and :math:`a\\left(z\\right)` and :math:`b\\left(z\\right)` are piecewise</span>
<span class="sd">    linear functions with respect to :math:`z`, that within a layer are defined by:</span>

<span class="sd">    .. math:: a\\left(z\\right) = a_t+\\frac{a_b-a_t}{z_b-z_t}\\left(z-z_t\\right)</span>

<span class="sd">    with :math:`t` and :math:`b` subscripts representing &#39;top&#39; and &#39;bottom&#39; of</span>
<span class="sd">    each layer respectively.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1">#import numpy as np #import this at module level</span>
    <span class="c1">#import math #import this at module level</span>

    <span class="n">m</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
    <span class="n">at</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">at</span><span class="p">)</span>
    <span class="n">ab</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">ab</span><span class="p">)</span>
    <span class="n">bt</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">bt</span><span class="p">)</span>
    <span class="n">bb</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">bb</span><span class="p">)</span>
    <span class="n">zt</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">zt</span><span class="p">)</span>
    <span class="n">zb</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">zb</span><span class="p">)</span>

    <span class="n">neig</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">implementation</span> <span class="o">==</span> <span class="s1">&#39;scalar&#39;</span><span class="p">:</span>
        <span class="n">sin</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">sin</span>
        <span class="n">cos</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">cos</span>
        <span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="n">neig</span><span class="p">,</span> <span class="n">neig</span><span class="p">],</span> <span class="nb">float</span><span class="p">)</span>
        <span class="n">nlayers</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">zt</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">layer</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nlayers</span><span class="p">):</span>
            <span class="n">a_slope</span> <span class="o">=</span> <span class="p">(</span><span class="n">ab</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span> <span class="o">-</span> <span class="n">at</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span> <span class="o">/</span> <span class="p">(</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span> <span class="o">-</span> <span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span>
            <span class="n">b_slope</span> <span class="o">=</span> <span class="p">(</span><span class="n">bb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span> <span class="o">-</span> <span class="n">bt</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span> <span class="o">/</span> <span class="p">(</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span> <span class="o">-</span> <span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">neig</span><span class="p">):</span>
                <span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span> <span class="o">+=</span> <span class="p">(</span><span class="n">a_slope</span><span class="o">*</span><span class="n">b_slope</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">/</span><span class="mi">4</span> <span class="o">-</span>
                    <span class="n">a_slope</span><span class="o">*</span><span class="n">b_slope</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">/</span><span class="mi">4</span> <span class="o">-</span>
                    <span class="n">a_slope</span><span class="o">*</span><span class="n">b_slope</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">/</span><span class="mi">2</span> <span class="o">+</span>
                    <span class="n">a_slope</span><span class="o">*</span><span class="n">b_slope</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="mi">4</span> <span class="o">-</span>
                    <span class="n">a_slope</span><span class="o">*</span><span class="n">b_slope</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="mi">4</span> <span class="o">+</span>
                    <span class="n">a_slope</span><span class="o">*</span><span class="n">b_slope</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="mi">4</span> <span class="o">+</span>
                    <span class="n">a_slope</span><span class="o">*</span><span class="n">b_slope</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="mi">4</span> <span class="o">-</span>
                    <span class="n">a_slope</span><span class="o">*</span><span class="n">b_slope</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">*</span><span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="mi">2</span>
                    <span class="o">+</span>
                    <span class="n">a_slope</span><span class="o">*</span><span class="n">b_slope</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">*</span><span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span>
                    <span class="o">-</span>
                    <span class="n">a_slope</span><span class="o">*</span><span class="n">b_slope</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">/</span><span class="mi">2</span>
                    <span class="o">+</span> <span class="n">a_slope</span><span class="o">*</span><span class="n">b_slope</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="mi">2</span> <span class="o">+</span>
                    <span class="n">a_slope</span><span class="o">*</span><span class="n">b_slope</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="mi">2</span> <span class="o">-</span>
                    <span class="n">a_slope</span><span class="o">*</span><span class="n">b_slope</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">/</span><span class="mi">2</span> <span class="o">-</span>
                    <span class="n">a_slope</span><span class="o">*</span><span class="n">b_slope</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">/</span><span class="mi">2</span> <span class="o">+</span>
                    <span class="n">a_slope</span><span class="o">*</span><span class="n">b_slope</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="mi">6</span> <span class="o">+</span>
                    <span class="n">a_slope</span><span class="o">*</span><span class="n">b_slope</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="mi">6</span> <span class="o">-</span>
                    <span class="n">a_slope</span><span class="o">*</span><span class="n">b_slope</span><span class="o">*</span><span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="mi">6</span> <span class="o">-</span>
                    <span class="n">a_slope</span><span class="o">*</span><span class="n">b_slope</span><span class="o">*</span><span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="mi">6</span> <span class="o">+</span>
                    <span class="n">a_slope</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">bt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">/</span><span class="mi">4</span> <span class="o">-</span>
                    <span class="n">a_slope</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">bt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">/</span><span class="mi">4</span> <span class="o">+</span>
                    <span class="n">a_slope</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">*</span><span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">bt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">/</span><span class="mi">2</span>
                    <span class="o">-</span>
                    <span class="n">a_slope</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">*</span><span class="n">bt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">/</span><span class="mi">2</span>
                    <span class="o">-</span> <span class="n">a_slope</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">bt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">/</span><span class="mi">2</span> <span class="o">-</span>
                    <span class="n">a_slope</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">bt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">/</span><span class="mi">2</span> <span class="o">+</span>
                    <span class="n">a_slope</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">bt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">/</span><span class="mi">4</span> <span class="o">+</span>
                    <span class="n">a_slope</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">bt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">/</span><span class="mi">4</span> <span class="o">+</span>
                    <span class="n">a_slope</span><span class="o">*</span><span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">bt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">/</span><span class="mi">4</span> <span class="o">+</span>
                    <span class="n">a_slope</span><span class="o">*</span><span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">bt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">/</span><span class="mi">4</span> <span class="o">+</span>
                    <span class="n">b_slope</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">at</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">/</span><span class="mi">4</span> <span class="o">-</span>
                    <span class="n">b_slope</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">at</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">/</span><span class="mi">4</span> <span class="o">+</span>
                    <span class="n">b_slope</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">*</span><span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">at</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">/</span><span class="mi">2</span>
                    <span class="o">-</span>
                    <span class="n">b_slope</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">*</span><span class="n">at</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">/</span><span class="mi">2</span>
                    <span class="o">-</span> <span class="n">b_slope</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">at</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">/</span><span class="mi">2</span> <span class="o">-</span>
                    <span class="n">b_slope</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">at</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">/</span><span class="mi">2</span> <span class="o">+</span>
                    <span class="n">b_slope</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">at</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">/</span><span class="mi">4</span> <span class="o">+</span>
                    <span class="n">b_slope</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">at</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">/</span><span class="mi">4</span> <span class="o">+</span>
                    <span class="n">b_slope</span><span class="o">*</span><span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">at</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">/</span><span class="mi">4</span> <span class="o">+</span>
                    <span class="n">b_slope</span><span class="o">*</span><span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">at</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">/</span><span class="mi">4</span> <span class="o">-</span>
                    <span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">*</span><span class="n">bt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">at</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">/</span><span class="mi">2</span> <span class="o">+</span>
                    <span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">*</span><span class="n">bt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">at</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">/</span><span class="mi">2</span> <span class="o">+</span>
                    <span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">bt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">at</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">/</span><span class="mi">2</span> <span class="o">+</span>
                    <span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">bt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">at</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">/</span><span class="mi">2</span> <span class="o">-</span>
                    <span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">bt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">at</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">/</span><span class="mi">2</span> <span class="o">-</span>
                    <span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">bt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">at</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">neig</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
                <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">neig</span><span class="p">):</span>
                    <span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">+=</span> <span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">a_slope</span><span class="o">*</span><span class="n">b_slope</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span>
                        <span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">a_slope</span><span class="o">*</span><span class="n">b_slope</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span>
                        <span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">a_slope</span><span class="o">*</span><span class="n">b_slope</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span>
                        <span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">*</span><span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span> <span class="o">+</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">a_slope</span><span class="o">*</span><span class="n">b_slope</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span>
                        <span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span> <span class="o">-</span>
                        <span class="n">a_slope</span><span class="o">*</span><span class="n">b_slope</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">5</span><span class="o">*</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span>
                        <span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">*</span><span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">a_slope</span><span class="o">*</span><span class="n">b_slope</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">5</span><span class="o">*</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span>
                        <span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">*</span><span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span> <span class="o">-</span>
                        <span class="n">a_slope</span><span class="o">*</span><span class="n">b_slope</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">5</span><span class="o">*</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span>
                        <span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span> <span class="o">-</span>
                        <span class="mi">6</span><span class="o">*</span><span class="n">a_slope</span><span class="o">*</span><span class="n">b_slope</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span> <span class="o">+</span>
                        <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span> <span class="o">+</span>
                        <span class="mi">6</span><span class="o">*</span><span class="n">a_slope</span><span class="o">*</span><span class="n">b_slope</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span> <span class="o">+</span>
                        <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span> <span class="o">-</span>
                        <span class="mi">4</span><span class="o">*</span><span class="n">a_slope</span><span class="o">*</span><span class="n">b_slope</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span> <span class="o">+</span>
                        <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span>
                        <span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">*</span><span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span> <span class="o">+</span>
                        <span class="mi">4</span><span class="o">*</span><span class="n">a_slope</span><span class="o">*</span><span class="n">b_slope</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span> <span class="o">+</span>
                        <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span>
                        <span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span> <span class="o">+</span>
                        <span class="n">a_slope</span><span class="o">*</span><span class="n">b_slope</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span> <span class="o">+</span>
                        <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span>
                        <span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">*</span><span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">a_slope</span><span class="o">*</span><span class="n">b_slope</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span> <span class="o">+</span>
                        <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span>
                        <span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">*</span><span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span> <span class="o">+</span>
                        <span class="n">a_slope</span><span class="o">*</span><span class="n">b_slope</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span> <span class="o">+</span>
                        <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span>
                        <span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span> <span class="o">+</span>
                        <span class="mi">6</span><span class="o">*</span><span class="n">a_slope</span><span class="o">*</span><span class="n">b_slope</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span> <span class="o">+</span>
                        <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span> <span class="o">-</span>
                        <span class="mi">6</span><span class="o">*</span><span class="n">a_slope</span><span class="o">*</span><span class="n">b_slope</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span> <span class="o">+</span>
                        <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span> <span class="o">+</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">a_slope</span><span class="o">*</span><span class="n">b_slope</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span> <span class="o">+</span>
                        <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span>
                        <span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">*</span><span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span>
                        <span class="mi">4</span><span class="o">*</span><span class="n">a_slope</span><span class="o">*</span><span class="n">b_slope</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span> <span class="o">+</span>
                        <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span>
                        <span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">*</span><span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span> <span class="o">+</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">a_slope</span><span class="o">*</span><span class="n">b_slope</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span> <span class="o">+</span>
                        <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span>
                        <span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">a_slope</span><span class="o">*</span><span class="n">b_slope</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span>
                        <span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span> <span class="o">+</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">a_slope</span><span class="o">*</span><span class="n">b_slope</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span>
                        <span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span> <span class="o">+</span>
                        <span class="mi">4</span><span class="o">*</span><span class="n">a_slope</span><span class="o">*</span><span class="n">b_slope</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span> <span class="o">+</span>
                        <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span>
                        <span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">*</span><span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">4</span><span class="o">*</span><span class="n">a_slope</span><span class="o">*</span><span class="n">b_slope</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span> <span class="o">+</span>
                        <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span>
                        <span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">a_slope</span><span class="o">*</span><span class="n">b_slope</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span> <span class="o">+</span>
                        <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span>
                        <span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">*</span><span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span>
                        <span class="mi">4</span><span class="o">*</span><span class="n">a_slope</span><span class="o">*</span><span class="n">b_slope</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span> <span class="o">+</span>
                        <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span>
                        <span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">*</span><span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">a_slope</span><span class="o">*</span><span class="n">b_slope</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span> <span class="o">+</span>
                        <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span>
                        <span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span> <span class="o">+</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">a_slope</span><span class="o">*</span><span class="n">b_slope</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span>
                        <span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">*</span><span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">a_slope</span><span class="o">*</span><span class="n">b_slope</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span>
                        <span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span> <span class="o">-</span>
                        <span class="n">a_slope</span><span class="o">*</span><span class="n">b_slope</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span> <span class="o">+</span>
                        <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span>
                        <span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">*</span><span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">a_slope</span><span class="o">*</span><span class="n">b_slope</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span> <span class="o">+</span>
                        <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span>
                        <span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">*</span><span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span> <span class="o">-</span>
                        <span class="n">a_slope</span><span class="o">*</span><span class="n">b_slope</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span> <span class="o">+</span>
                        <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span>
                        <span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span> <span class="o">+</span>
                        <span class="n">a_slope</span><span class="o">*</span><span class="n">b_slope</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">5</span><span class="o">*</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span>
                        <span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">*</span><span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">a_slope</span><span class="o">*</span><span class="n">b_slope</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">5</span><span class="o">*</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span>
                        <span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">*</span><span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span> <span class="o">+</span>
                        <span class="n">a_slope</span><span class="o">*</span><span class="n">b_slope</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">5</span><span class="o">*</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span>
                        <span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span> <span class="o">+</span>
                        <span class="n">a_slope</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span>
                        <span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">*</span><span class="n">bt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span> <span class="o">-</span>
                        <span class="n">a_slope</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span>
                        <span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">*</span><span class="n">bt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span> <span class="o">+</span>
                        <span class="n">a_slope</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">5</span><span class="o">*</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span>
                        <span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">*</span><span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">bt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span> <span class="o">-</span>
                        <span class="n">a_slope</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">5</span><span class="o">*</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span>
                        <span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">*</span><span class="n">bt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span> <span class="o">+</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">a_slope</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span>
                        <span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">*</span><span class="n">bt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">a_slope</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span>
                        <span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">*</span><span class="n">bt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span> <span class="o">-</span>
                        <span class="n">a_slope</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span>
                        <span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">*</span><span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">bt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span> <span class="o">+</span>
                        <span class="n">a_slope</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span>
                        <span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">*</span><span class="n">bt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">a_slope</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span>
                        <span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">*</span><span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">bt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span> <span class="o">+</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">a_slope</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span>
                        <span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">*</span><span class="n">bt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">a_slope</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span>
                        <span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">*</span><span class="n">bt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span> <span class="o">+</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">a_slope</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span>
                        <span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">*</span><span class="n">bt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span> <span class="o">+</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">a_slope</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span>
                        <span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">*</span><span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">bt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">a_slope</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span>
                        <span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">*</span><span class="n">bt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span> <span class="o">-</span>
                        <span class="n">a_slope</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span>
                        <span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">*</span><span class="n">bt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span> <span class="o">+</span>
                        <span class="n">a_slope</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span>
                        <span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">*</span><span class="n">bt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span> <span class="o">+</span>
                        <span class="n">a_slope</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span>
                        <span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">*</span><span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">bt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span> <span class="o">-</span>
                        <span class="n">a_slope</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span>
                        <span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">*</span><span class="n">bt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span> <span class="o">-</span>
                        <span class="n">a_slope</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">5</span><span class="o">*</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span>
                        <span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">*</span><span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">bt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span> <span class="o">+</span>
                        <span class="n">a_slope</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">5</span><span class="o">*</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span>
                        <span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">*</span><span class="n">bt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span> <span class="o">+</span>
                        <span class="n">b_slope</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span>
                        <span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">*</span><span class="n">at</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span> <span class="o">-</span>
                        <span class="n">b_slope</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span>
                        <span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">*</span><span class="n">at</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span> <span class="o">+</span>
                        <span class="n">b_slope</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">5</span><span class="o">*</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span>
                        <span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">*</span><span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">at</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span> <span class="o">-</span>
                        <span class="n">b_slope</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">5</span><span class="o">*</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span>
                        <span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">*</span><span class="n">at</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span> <span class="o">+</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">b_slope</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span>
                        <span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">*</span><span class="n">at</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">b_slope</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span>
                        <span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">*</span><span class="n">at</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span> <span class="o">-</span>
                        <span class="n">b_slope</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span>
                        <span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">*</span><span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">at</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span> <span class="o">+</span>
                        <span class="n">b_slope</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span>
                        <span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">*</span><span class="n">at</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">b_slope</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span>
                        <span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">*</span><span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">at</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span> <span class="o">+</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">b_slope</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span>
                        <span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">*</span><span class="n">at</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">b_slope</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span>
                        <span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">*</span><span class="n">at</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span> <span class="o">+</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">b_slope</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span>
                        <span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">*</span><span class="n">at</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span> <span class="o">+</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">b_slope</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span>
                        <span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">*</span><span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">at</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">b_slope</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span>
                        <span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">*</span><span class="n">at</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span> <span class="o">-</span>
                        <span class="n">b_slope</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span>
                        <span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">*</span><span class="n">at</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span> <span class="o">+</span>
                        <span class="n">b_slope</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span>
                        <span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">*</span><span class="n">at</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span> <span class="o">+</span>
                        <span class="n">b_slope</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span>
                        <span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">*</span><span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">at</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span> <span class="o">-</span>
                        <span class="n">b_slope</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span>
                        <span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">*</span><span class="n">at</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span> <span class="o">-</span>
                        <span class="n">b_slope</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">5</span><span class="o">*</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span>
                        <span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">*</span><span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">at</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span> <span class="o">+</span>
                        <span class="n">b_slope</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">5</span><span class="o">*</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span>
                        <span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">*</span><span class="n">at</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span> <span class="o">-</span>
                        <span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">5</span><span class="o">*</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span>
                        <span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">*</span><span class="n">bt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">at</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span> <span class="o">+</span>
                        <span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">5</span><span class="o">*</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span>
                        <span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">*</span><span class="n">bt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">at</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span> <span class="o">+</span>
                        <span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span>
                        <span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">*</span><span class="n">bt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">at</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span> <span class="o">-</span>
                        <span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span>
                        <span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">*</span><span class="n">bt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">at</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span> <span class="o">+</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span>
                        <span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">*</span><span class="n">bt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">at</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span>
                        <span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">*</span><span class="n">bt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">at</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span>
                        <span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">*</span><span class="n">bt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">at</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span> <span class="o">+</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span>
                        <span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">*</span><span class="n">bt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">at</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span> <span class="o">-</span>
                        <span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span>
                        <span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">*</span><span class="n">bt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">at</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span> <span class="o">+</span>
                        <span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span>
                        <span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">*</span><span class="n">bt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">at</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span> <span class="o">+</span>
                        <span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">5</span><span class="o">*</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span>
                        <span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">*</span><span class="n">bt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">at</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span> <span class="o">-</span>
                        <span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">5</span><span class="o">*</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span>
                        <span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">*</span><span class="n">bt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">at</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span>

        <span class="c1">#A is symmetric</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">neig</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">neig</span><span class="p">):</span>
                <span class="n">A</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span>

    <span class="k">elif</span> <span class="n">implementation</span> <span class="o">==</span> <span class="s1">&#39;fortran&#39;</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">MUST_TRY_FORTRAN</span><span class="p">:</span>
            <span class="kn">import</span> <span class="nn">geotecha.speccon.ext_integrals</span> <span class="k">as</span> <span class="nn">ext_integ</span>
            <span class="n">A</span> <span class="o">=</span> <span class="n">ext_integ</span><span class="o">.</span><span class="n">dim1sin_abf_linear</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">at</span><span class="p">,</span> <span class="n">ab</span><span class="p">,</span> <span class="n">bt</span><span class="p">,</span> <span class="n">bb</span><span class="p">,</span> <span class="n">zt</span><span class="p">,</span> <span class="n">zb</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="kn">import</span> <span class="nn">geotecha.speccon.ext_integrals</span> <span class="k">as</span> <span class="nn">ext_integ</span>
                <span class="n">A</span> <span class="o">=</span> <span class="n">ext_integ</span><span class="o">.</span><span class="n">dim1sin_abf_linear</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">at</span><span class="p">,</span> <span class="n">ab</span><span class="p">,</span> <span class="n">bt</span><span class="p">,</span> <span class="n">bb</span><span class="p">,</span> <span class="n">zt</span><span class="p">,</span> <span class="n">zb</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
                <span class="n">A</span> <span class="o">=</span> <span class="n">dim1sin_abf_linear</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">at</span><span class="p">,</span> <span class="n">ab</span><span class="p">,</span> <span class="n">bt</span><span class="p">,</span> <span class="n">bb</span><span class="p">,</span> <span class="n">zt</span><span class="p">,</span> <span class="n">zb</span><span class="p">,</span> <span class="n">implementation</span><span class="o">=</span><span class="s1">&#39;vectorized&#39;</span><span class="p">)</span>

    <span class="k">else</span><span class="p">:</span><span class="c1">#default is &#39;vectorized&#39; using numpy</span>
        <span class="n">sin</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span>
        <span class="n">cos</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span>
        <span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="n">neig</span><span class="p">,</span> <span class="n">neig</span><span class="p">],</span> <span class="nb">float</span><span class="p">)</span>

        <span class="n">diag</span> <span class="o">=</span>  <span class="n">np</span><span class="o">.</span><span class="n">diag_indices</span><span class="p">(</span><span class="n">neig</span><span class="p">)</span>
        <span class="n">triu</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">triu_indices</span><span class="p">(</span><span class="n">neig</span><span class="p">,</span> <span class="n">k</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">tril</span> <span class="o">=</span> <span class="p">(</span><span class="n">triu</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">triu</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

        <span class="n">a_slope</span> <span class="o">=</span> <span class="p">(</span><span class="n">ab</span> <span class="o">-</span> <span class="n">at</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">zb</span> <span class="o">-</span> <span class="n">zt</span><span class="p">)</span>
        <span class="n">b_slope</span> <span class="o">=</span> <span class="p">(</span><span class="n">bb</span> <span class="o">-</span> <span class="n">bt</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">zb</span> <span class="o">-</span> <span class="n">zt</span><span class="p">)</span>

        <span class="n">mi</span> <span class="o">=</span> <span class="n">m</span><span class="p">[:,</span> <span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">]</span>
        <span class="n">A</span><span class="p">[</span><span class="n">diag</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">a_slope</span><span class="o">*</span><span class="n">b_slope</span><span class="o">*</span><span class="n">zb</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">zt</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="mi">2</span> <span class="o">+</span> <span class="n">a_slope</span><span class="o">*</span><span class="n">b_slope</span><span class="o">*</span><span class="n">zb</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">zt</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="mi">2</span> <span class="o">-</span>
            <span class="n">a_slope</span><span class="o">*</span><span class="n">b_slope</span><span class="o">*</span><span class="n">zb</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">zt</span><span class="o">/</span><span class="mi">2</span> <span class="o">-</span> <span class="n">a_slope</span><span class="o">*</span><span class="n">b_slope</span><span class="o">*</span><span class="n">zb</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">zt</span><span class="o">/</span><span class="mi">2</span> <span class="o">+</span>
            <span class="n">a_slope</span><span class="o">*</span><span class="n">b_slope</span><span class="o">*</span><span class="n">zb</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="mi">6</span> <span class="o">+</span> <span class="n">a_slope</span><span class="o">*</span><span class="n">b_slope</span><span class="o">*</span><span class="n">zb</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="mi">6</span> <span class="o">-</span>
            <span class="n">a_slope</span><span class="o">*</span><span class="n">b_slope</span><span class="o">*</span><span class="n">zt</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zt</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="mi">6</span> <span class="o">-</span> <span class="n">a_slope</span><span class="o">*</span><span class="n">b_slope</span><span class="o">*</span><span class="n">zt</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zt</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="mi">6</span> <span class="o">-</span>
            <span class="n">a_slope</span><span class="o">*</span><span class="n">b_slope</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">zt</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">mi</span><span class="p">)</span> <span class="o">+</span>
            <span class="n">a_slope</span><span class="o">*</span><span class="n">b_slope</span><span class="o">*</span><span class="n">zb</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">zt</span><span class="o">/</span><span class="n">mi</span> <span class="o">-</span>
            <span class="n">a_slope</span><span class="o">*</span><span class="n">b_slope</span><span class="o">*</span><span class="n">zb</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">mi</span><span class="p">)</span> <span class="o">-</span>
            <span class="n">a_slope</span><span class="o">*</span><span class="n">b_slope</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">zt</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">a_slope</span><span class="o">*</span><span class="n">b_slope</span><span class="o">*</span><span class="n">zb</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="p">(</span><span class="mi">4</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
            <span class="o">-</span> <span class="n">a_slope</span><span class="o">*</span><span class="n">b_slope</span><span class="o">*</span><span class="n">zb</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="p">(</span><span class="mi">4</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span>
            <span class="n">a_slope</span><span class="o">*</span><span class="n">b_slope</span><span class="o">*</span><span class="n">zt</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zt</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="p">(</span><span class="mi">4</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">a_slope</span><span class="o">*</span><span class="n">b_slope</span><span class="o">*</span><span class="n">zt</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zt</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="p">(</span><span class="mi">4</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
            <span class="o">+</span> <span class="n">a_slope</span><span class="o">*</span><span class="n">b_slope</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mi">4</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">-</span>
            <span class="n">a_slope</span><span class="o">*</span><span class="n">b_slope</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zt</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zt</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mi">4</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">-</span> <span class="n">a_slope</span><span class="o">*</span><span class="n">zb</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">zt</span><span class="o">*</span><span class="n">bt</span><span class="o">/</span><span class="mi">2</span> <span class="o">-</span>
            <span class="n">a_slope</span><span class="o">*</span><span class="n">zb</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">zt</span><span class="o">*</span><span class="n">bt</span><span class="o">/</span><span class="mi">2</span> <span class="o">+</span> <span class="n">a_slope</span><span class="o">*</span><span class="n">zb</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">bt</span><span class="o">/</span><span class="mi">4</span> <span class="o">+</span>
            <span class="n">a_slope</span><span class="o">*</span><span class="n">zb</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">bt</span><span class="o">/</span><span class="mi">4</span> <span class="o">+</span> <span class="n">a_slope</span><span class="o">*</span><span class="n">zt</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zt</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">bt</span><span class="o">/</span><span class="mi">4</span> <span class="o">+</span>
            <span class="n">a_slope</span><span class="o">*</span><span class="n">zt</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zt</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">bt</span><span class="o">/</span><span class="mi">4</span> <span class="o">+</span> <span class="n">a_slope</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">zt</span><span class="o">*</span><span class="n">bt</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">mi</span><span class="p">)</span> <span class="o">-</span>
            <span class="n">a_slope</span><span class="o">*</span><span class="n">zb</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">bt</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">mi</span><span class="p">)</span> <span class="o">+</span> <span class="n">a_slope</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">bt</span><span class="o">/</span><span class="p">(</span><span class="mi">4</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span>
            <span class="n">a_slope</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zt</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">bt</span><span class="o">/</span><span class="p">(</span><span class="mi">4</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="n">b_slope</span><span class="o">*</span><span class="n">zb</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">zt</span><span class="o">*</span><span class="n">at</span><span class="o">/</span><span class="mi">2</span> <span class="o">-</span>
            <span class="n">b_slope</span><span class="o">*</span><span class="n">zb</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">zt</span><span class="o">*</span><span class="n">at</span><span class="o">/</span><span class="mi">2</span> <span class="o">+</span> <span class="n">b_slope</span><span class="o">*</span><span class="n">zb</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">at</span><span class="o">/</span><span class="mi">4</span> <span class="o">+</span>
            <span class="n">b_slope</span><span class="o">*</span><span class="n">zb</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">at</span><span class="o">/</span><span class="mi">4</span> <span class="o">+</span> <span class="n">b_slope</span><span class="o">*</span><span class="n">zt</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zt</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">at</span><span class="o">/</span><span class="mi">4</span> <span class="o">+</span>
            <span class="n">b_slope</span><span class="o">*</span><span class="n">zt</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zt</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">at</span><span class="o">/</span><span class="mi">4</span> <span class="o">+</span> <span class="n">b_slope</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">zt</span><span class="o">*</span><span class="n">at</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">mi</span><span class="p">)</span> <span class="o">-</span>
            <span class="n">b_slope</span><span class="o">*</span><span class="n">zb</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">at</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">mi</span><span class="p">)</span> <span class="o">+</span> <span class="n">b_slope</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">at</span><span class="o">/</span><span class="p">(</span><span class="mi">4</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span>
            <span class="n">b_slope</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zt</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">at</span><span class="o">/</span><span class="p">(</span><span class="mi">4</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">zb</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">bt</span><span class="o">*</span><span class="n">at</span><span class="o">/</span><span class="mi">2</span> <span class="o">+</span> <span class="n">zb</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">bt</span><span class="o">*</span><span class="n">at</span><span class="o">/</span><span class="mi">2</span>
            <span class="o">-</span> <span class="n">zt</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zt</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">bt</span><span class="o">*</span><span class="n">at</span><span class="o">/</span><span class="mi">2</span> <span class="o">-</span> <span class="n">zt</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zt</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">bt</span><span class="o">*</span><span class="n">at</span><span class="o">/</span><span class="mi">2</span> <span class="o">-</span>
            <span class="n">cos</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">bt</span><span class="o">*</span><span class="n">at</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">mi</span><span class="p">)</span> <span class="o">+</span> <span class="n">cos</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zt</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zt</span><span class="p">)</span><span class="o">*</span><span class="n">bt</span><span class="o">*</span><span class="n">at</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">mi</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

        <span class="n">mi</span> <span class="o">=</span> <span class="n">m</span><span class="p">[</span><span class="n">triu</span><span class="p">[</span><span class="mi">0</span><span class="p">]][:,</span> <span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">]</span>
        <span class="n">mj</span> <span class="o">=</span> <span class="n">m</span><span class="p">[</span><span class="n">triu</span><span class="p">[</span><span class="mi">1</span><span class="p">]][:,</span> <span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">]</span>
        <span class="n">A</span><span class="p">[</span><span class="n">triu</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="o">-</span><span class="n">a_slope</span><span class="o">*</span><span class="n">b_slope</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">5</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mj</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">zt</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="p">(</span><span class="n">mi</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">4</span> <span class="o">-</span> <span class="n">mj</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span> <span class="o">+</span>
            <span class="mi">2</span><span class="o">*</span><span class="n">a_slope</span><span class="o">*</span><span class="n">b_slope</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">5</span><span class="o">*</span><span class="n">zb</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mj</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">zt</span><span class="o">/</span><span class="p">(</span><span class="n">mi</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span>
            <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">4</span> <span class="o">-</span> <span class="n">mj</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span> <span class="o">-</span> <span class="n">a_slope</span><span class="o">*</span><span class="n">b_slope</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">5</span><span class="o">*</span><span class="n">zb</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mj</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">mi</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span>
            <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">4</span> <span class="o">-</span> <span class="n">mj</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span> <span class="o">+</span>
            <span class="n">a_slope</span><span class="o">*</span><span class="n">b_slope</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">mj</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mj</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">zt</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="p">(</span><span class="n">mi</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span>
            <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">4</span> <span class="o">-</span> <span class="n">mj</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">a_slope</span><span class="o">*</span><span class="n">b_slope</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">mj</span><span class="o">*</span><span class="n">zb</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mj</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">zt</span><span class="o">/</span><span class="p">(</span><span class="n">mi</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span>
            <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">4</span> <span class="o">-</span> <span class="n">mj</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span> <span class="o">+</span>
            <span class="n">a_slope</span><span class="o">*</span><span class="n">b_slope</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">mj</span><span class="o">*</span><span class="n">zb</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mj</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">mi</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span>
            <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">4</span> <span class="o">-</span> <span class="n">mj</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">a_slope</span><span class="o">*</span><span class="n">b_slope</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mj</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">zt</span><span class="o">/</span><span class="p">(</span><span class="n">mi</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span>
            <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">4</span> <span class="o">-</span> <span class="n">mj</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span> <span class="o">+</span>
            <span class="mi">2</span><span class="o">*</span><span class="n">a_slope</span><span class="o">*</span><span class="n">b_slope</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">zb</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mj</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">mi</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">4</span>
            <span class="o">-</span> <span class="n">mj</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">a_slope</span><span class="o">*</span><span class="n">b_slope</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mj</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">zt</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="p">(</span><span class="n">mi</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span>
            <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">4</span> <span class="o">-</span> <span class="n">mj</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span> <span class="o">-</span>
            <span class="mi">4</span><span class="o">*</span><span class="n">a_slope</span><span class="o">*</span><span class="n">b_slope</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">zb</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mj</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">zt</span><span class="o">/</span><span class="p">(</span><span class="n">mi</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span>
            <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">4</span> <span class="o">-</span> <span class="n">mj</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span> <span class="o">+</span>
            <span class="mi">2</span><span class="o">*</span><span class="n">a_slope</span><span class="o">*</span><span class="n">b_slope</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">zb</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mj</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">mi</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span>
            <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">4</span> <span class="o">-</span> <span class="n">mj</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span> <span class="o">-</span> <span class="mi">4</span><span class="o">*</span><span class="n">a_slope</span><span class="o">*</span><span class="n">b_slope</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">mj</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mj</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">zt</span><span class="o">/</span><span class="p">(</span><span class="n">mi</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span>
            <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">4</span> <span class="o">-</span> <span class="n">mj</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span> <span class="o">+</span>
            <span class="mi">4</span><span class="o">*</span><span class="n">a_slope</span><span class="o">*</span><span class="n">b_slope</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">mj</span><span class="o">*</span><span class="n">zb</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mj</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">mi</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span>
            <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">4</span> <span class="o">-</span> <span class="n">mj</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">a_slope</span><span class="o">*</span><span class="n">b_slope</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mj</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">mi</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span>
            <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">4</span> <span class="o">-</span> <span class="n">mj</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span> <span class="o">-</span>
            <span class="mi">2</span><span class="o">*</span><span class="n">a_slope</span><span class="o">*</span><span class="n">b_slope</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zt</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mj</span><span class="o">*</span><span class="n">zt</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">mi</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">4</span> <span class="o">-</span>
            <span class="n">mj</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">a_slope</span><span class="o">*</span><span class="n">b_slope</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mj</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">zt</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="p">(</span><span class="n">mi</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span>
            <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">4</span> <span class="o">-</span> <span class="n">mj</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span> <span class="o">+</span>
            <span class="mi">4</span><span class="o">*</span><span class="n">a_slope</span><span class="o">*</span><span class="n">b_slope</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">zb</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mj</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">zt</span><span class="o">/</span><span class="p">(</span><span class="n">mi</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span>
            <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">4</span> <span class="o">-</span> <span class="n">mj</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span> <span class="o">-</span>
            <span class="mi">2</span><span class="o">*</span><span class="n">a_slope</span><span class="o">*</span><span class="n">b_slope</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">zb</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mj</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">mi</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span>
            <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">4</span> <span class="o">-</span> <span class="n">mj</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span> <span class="o">-</span> <span class="mi">6</span><span class="o">*</span><span class="n">a_slope</span><span class="o">*</span><span class="n">b_slope</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">mj</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mj</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">mi</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span>
            <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">4</span> <span class="o">-</span> <span class="n">mj</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span> <span class="o">+</span>
            <span class="mi">6</span><span class="o">*</span><span class="n">a_slope</span><span class="o">*</span><span class="n">b_slope</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">mj</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mj</span><span class="o">*</span><span class="n">zt</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zt</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">mi</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">4</span>
            <span class="o">-</span> <span class="n">mj</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span> <span class="o">-</span> <span class="n">a_slope</span><span class="o">*</span><span class="n">b_slope</span><span class="o">*</span><span class="n">mi</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mj</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">zt</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="p">(</span><span class="n">mi</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span>
            <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">4</span> <span class="o">-</span> <span class="n">mj</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">a_slope</span><span class="o">*</span><span class="n">b_slope</span><span class="o">*</span><span class="n">mi</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">zb</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mj</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">zt</span><span class="o">/</span><span class="p">(</span><span class="n">mi</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span>
            <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">4</span> <span class="o">-</span> <span class="n">mj</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span> <span class="o">-</span>
            <span class="n">a_slope</span><span class="o">*</span><span class="n">b_slope</span><span class="o">*</span><span class="n">mi</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">zb</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mj</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">mi</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span>
            <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">4</span> <span class="o">-</span> <span class="n">mj</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span> <span class="o">+</span> <span class="mi">4</span><span class="o">*</span><span class="n">a_slope</span><span class="o">*</span><span class="n">b_slope</span><span class="o">*</span><span class="n">mi</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mj</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">zt</span><span class="o">/</span><span class="p">(</span><span class="n">mi</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span>
            <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">4</span> <span class="o">-</span> <span class="n">mj</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span> <span class="o">-</span>
            <span class="mi">4</span><span class="o">*</span><span class="n">a_slope</span><span class="o">*</span><span class="n">b_slope</span><span class="o">*</span><span class="n">mi</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">zb</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mj</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">mi</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span>
            <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">4</span> <span class="o">-</span> <span class="n">mj</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span> <span class="o">+</span> <span class="mi">6</span><span class="o">*</span><span class="n">a_slope</span><span class="o">*</span><span class="n">b_slope</span><span class="o">*</span><span class="n">mi</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mj</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">mi</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span>
            <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">4</span> <span class="o">-</span> <span class="n">mj</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span> <span class="o">-</span>
            <span class="mi">6</span><span class="o">*</span><span class="n">a_slope</span><span class="o">*</span><span class="n">b_slope</span><span class="o">*</span><span class="n">mi</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zt</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mj</span><span class="o">*</span><span class="n">zt</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">mi</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">4</span>
            <span class="o">-</span> <span class="n">mj</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span> <span class="o">+</span> <span class="n">a_slope</span><span class="o">*</span><span class="n">b_slope</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">5</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mj</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">zt</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="p">(</span><span class="n">mi</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span>
            <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">4</span> <span class="o">-</span> <span class="n">mj</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">a_slope</span><span class="o">*</span><span class="n">b_slope</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">5</span><span class="o">*</span><span class="n">zb</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mj</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">zt</span><span class="o">/</span><span class="p">(</span><span class="n">mi</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span>
            <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">4</span> <span class="o">-</span> <span class="n">mj</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span> <span class="o">+</span>
            <span class="n">a_slope</span><span class="o">*</span><span class="n">b_slope</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">5</span><span class="o">*</span><span class="n">zb</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mj</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">mi</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">4</span>
            <span class="o">-</span> <span class="n">mj</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">a_slope</span><span class="o">*</span><span class="n">b_slope</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mj</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">zt</span><span class="o">/</span><span class="p">(</span><span class="n">mi</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span>
            <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">4</span> <span class="o">-</span> <span class="n">mj</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">a_slope</span><span class="o">*</span><span class="n">b_slope</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">zb</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mj</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">mi</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span>
            <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">4</span> <span class="o">-</span> <span class="n">mj</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span> <span class="o">-</span>
            <span class="mi">2</span><span class="o">*</span><span class="n">a_slope</span><span class="o">*</span><span class="n">b_slope</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mj</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">mi</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">4</span> <span class="o">-</span>
            <span class="n">mj</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">a_slope</span><span class="o">*</span><span class="n">b_slope</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mj</span><span class="o">*</span><span class="n">zt</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zt</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">mi</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span>
            <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">4</span> <span class="o">-</span> <span class="n">mj</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span> <span class="o">+</span> <span class="n">a_slope</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">5</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mj</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">zt</span><span class="o">*</span><span class="n">bt</span><span class="o">/</span><span class="p">(</span><span class="n">mi</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span>
            <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">4</span> <span class="o">-</span> <span class="n">mj</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span> <span class="o">-</span>
            <span class="n">a_slope</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">5</span><span class="o">*</span><span class="n">zb</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mj</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">bt</span><span class="o">/</span><span class="p">(</span><span class="n">mi</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">4</span> <span class="o">-</span>
            <span class="n">mj</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span> <span class="o">-</span> <span class="n">a_slope</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">mj</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mj</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">zt</span><span class="o">*</span><span class="n">bt</span><span class="o">/</span><span class="p">(</span><span class="n">mi</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span>
            <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">4</span> <span class="o">-</span> <span class="n">mj</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span> <span class="o">+</span> <span class="n">a_slope</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">mj</span><span class="o">*</span><span class="n">zb</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mj</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">bt</span><span class="o">/</span><span class="p">(</span><span class="n">mi</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span>
            <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">4</span> <span class="o">-</span> <span class="n">mj</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span> <span class="o">+</span> <span class="n">a_slope</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mj</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">bt</span><span class="o">/</span><span class="p">(</span><span class="n">mi</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span>
            <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">4</span> <span class="o">-</span> <span class="n">mj</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span> <span class="o">-</span> <span class="n">a_slope</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zt</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mj</span><span class="o">*</span><span class="n">zt</span><span class="p">)</span><span class="o">*</span><span class="n">bt</span><span class="o">/</span><span class="p">(</span><span class="n">mi</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span>
            <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">4</span> <span class="o">-</span> <span class="n">mj</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span> <span class="o">-</span>
            <span class="mi">2</span><span class="o">*</span><span class="n">a_slope</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mj</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">zt</span><span class="o">*</span><span class="n">bt</span><span class="o">/</span><span class="p">(</span><span class="n">mi</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">4</span>
            <span class="o">-</span> <span class="n">mj</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">a_slope</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">zb</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mj</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">bt</span><span class="o">/</span><span class="p">(</span><span class="n">mi</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span>
            <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">4</span> <span class="o">-</span> <span class="n">mj</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">a_slope</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">mj</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mj</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">bt</span><span class="o">/</span><span class="p">(</span><span class="n">mi</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span>
            <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">4</span> <span class="o">-</span> <span class="n">mj</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span> <span class="o">-</span>
            <span class="mi">2</span><span class="o">*</span><span class="n">a_slope</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">mj</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zt</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mj</span><span class="o">*</span><span class="n">zt</span><span class="p">)</span><span class="o">*</span><span class="n">bt</span><span class="o">/</span><span class="p">(</span><span class="n">mi</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">4</span> <span class="o">-</span>
            <span class="n">mj</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">a_slope</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mj</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">zt</span><span class="o">*</span><span class="n">bt</span><span class="o">/</span><span class="p">(</span><span class="n">mi</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span>
            <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">4</span> <span class="o">-</span> <span class="n">mj</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">a_slope</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">zb</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mj</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">bt</span><span class="o">/</span><span class="p">(</span><span class="n">mi</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span>
            <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">4</span> <span class="o">-</span> <span class="n">mj</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span> <span class="o">+</span>
            <span class="n">a_slope</span><span class="o">*</span><span class="n">mi</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mj</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">zt</span><span class="o">*</span><span class="n">bt</span><span class="o">/</span><span class="p">(</span><span class="n">mi</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">4</span> <span class="o">-</span>
            <span class="n">mj</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span> <span class="o">-</span> <span class="n">a_slope</span><span class="o">*</span><span class="n">mi</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">zb</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mj</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">bt</span><span class="o">/</span><span class="p">(</span><span class="n">mi</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span>
            <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">4</span> <span class="o">-</span> <span class="n">mj</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">a_slope</span><span class="o">*</span><span class="n">mi</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mj</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">bt</span><span class="o">/</span><span class="p">(</span><span class="n">mi</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span>
            <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">4</span> <span class="o">-</span> <span class="n">mj</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span> <span class="o">+</span>
            <span class="mi">2</span><span class="o">*</span><span class="n">a_slope</span><span class="o">*</span><span class="n">mi</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zt</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mj</span><span class="o">*</span><span class="n">zt</span><span class="p">)</span><span class="o">*</span><span class="n">bt</span><span class="o">/</span><span class="p">(</span><span class="n">mi</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">4</span> <span class="o">-</span>
            <span class="n">mj</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span> <span class="o">-</span> <span class="n">a_slope</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">5</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mj</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">zt</span><span class="o">*</span><span class="n">bt</span><span class="o">/</span><span class="p">(</span><span class="n">mi</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span>
            <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">4</span> <span class="o">-</span> <span class="n">mj</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span> <span class="o">+</span> <span class="n">a_slope</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">5</span><span class="o">*</span><span class="n">zb</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mj</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">bt</span><span class="o">/</span><span class="p">(</span><span class="n">mi</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span>
            <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">4</span> <span class="o">-</span> <span class="n">mj</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span> <span class="o">-</span> <span class="n">a_slope</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mj</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">bt</span><span class="o">/</span><span class="p">(</span><span class="n">mi</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span>
            <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">4</span> <span class="o">-</span> <span class="n">mj</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span> <span class="o">+</span> <span class="n">a_slope</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zt</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mj</span><span class="o">*</span><span class="n">zt</span><span class="p">)</span><span class="o">*</span><span class="n">bt</span><span class="o">/</span><span class="p">(</span><span class="n">mi</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span>
            <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">4</span> <span class="o">-</span> <span class="n">mj</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span> <span class="o">+</span>
            <span class="n">b_slope</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">5</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mj</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">zt</span><span class="o">*</span><span class="n">at</span><span class="o">/</span><span class="p">(</span><span class="n">mi</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">4</span> <span class="o">-</span>
            <span class="n">mj</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span> <span class="o">-</span> <span class="n">b_slope</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">5</span><span class="o">*</span><span class="n">zb</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mj</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">at</span><span class="o">/</span><span class="p">(</span><span class="n">mi</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span>
            <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">4</span> <span class="o">-</span> <span class="n">mj</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span> <span class="o">-</span> <span class="n">b_slope</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">mj</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mj</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">zt</span><span class="o">*</span><span class="n">at</span><span class="o">/</span><span class="p">(</span><span class="n">mi</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span>
            <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">4</span> <span class="o">-</span> <span class="n">mj</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span> <span class="o">+</span>
            <span class="n">b_slope</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">mj</span><span class="o">*</span><span class="n">zb</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mj</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">at</span><span class="o">/</span><span class="p">(</span><span class="n">mi</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">4</span> <span class="o">-</span>
            <span class="n">mj</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span> <span class="o">+</span> <span class="n">b_slope</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mj</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">at</span><span class="o">/</span><span class="p">(</span><span class="n">mi</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">4</span> <span class="o">-</span>
            <span class="n">mj</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span> <span class="o">-</span> <span class="n">b_slope</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zt</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mj</span><span class="o">*</span><span class="n">zt</span><span class="p">)</span><span class="o">*</span><span class="n">at</span><span class="o">/</span><span class="p">(</span><span class="n">mi</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">4</span> <span class="o">-</span>
            <span class="n">mj</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">b_slope</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mj</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">zt</span><span class="o">*</span><span class="n">at</span><span class="o">/</span><span class="p">(</span><span class="n">mi</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span>
            <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">4</span> <span class="o">-</span> <span class="n">mj</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">b_slope</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">zb</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mj</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">at</span><span class="o">/</span><span class="p">(</span><span class="n">mi</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span>
            <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">4</span> <span class="o">-</span> <span class="n">mj</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span> <span class="o">+</span>
            <span class="mi">2</span><span class="o">*</span><span class="n">b_slope</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">mj</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mj</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">at</span><span class="o">/</span><span class="p">(</span><span class="n">mi</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">4</span> <span class="o">-</span>
            <span class="n">mj</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">b_slope</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">mj</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zt</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mj</span><span class="o">*</span><span class="n">zt</span><span class="p">)</span><span class="o">*</span><span class="n">at</span><span class="o">/</span><span class="p">(</span><span class="n">mi</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span>
            <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">4</span> <span class="o">-</span> <span class="n">mj</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">b_slope</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mj</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">zt</span><span class="o">*</span><span class="n">at</span><span class="o">/</span><span class="p">(</span><span class="n">mi</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span>
            <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">4</span> <span class="o">-</span> <span class="n">mj</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span> <span class="o">-</span>
            <span class="mi">2</span><span class="o">*</span><span class="n">b_slope</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">zb</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mj</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">at</span><span class="o">/</span><span class="p">(</span><span class="n">mi</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">4</span>
            <span class="o">-</span> <span class="n">mj</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span> <span class="o">+</span> <span class="n">b_slope</span><span class="o">*</span><span class="n">mi</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mj</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">zt</span><span class="o">*</span><span class="n">at</span><span class="o">/</span><span class="p">(</span><span class="n">mi</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span>
            <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">4</span> <span class="o">-</span> <span class="n">mj</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span> <span class="o">-</span> <span class="n">b_slope</span><span class="o">*</span><span class="n">mi</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">zb</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mj</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">at</span><span class="o">/</span><span class="p">(</span><span class="n">mi</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span>
            <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">4</span> <span class="o">-</span> <span class="n">mj</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span> <span class="o">-</span>
            <span class="mi">2</span><span class="o">*</span><span class="n">b_slope</span><span class="o">*</span><span class="n">mi</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mj</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">at</span><span class="o">/</span><span class="p">(</span><span class="n">mi</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">4</span> <span class="o">-</span>
            <span class="n">mj</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">b_slope</span><span class="o">*</span><span class="n">mi</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zt</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mj</span><span class="o">*</span><span class="n">zt</span><span class="p">)</span><span class="o">*</span><span class="n">at</span><span class="o">/</span><span class="p">(</span><span class="n">mi</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span>
            <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">4</span> <span class="o">-</span> <span class="n">mj</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span> <span class="o">-</span> <span class="n">b_slope</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">5</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mj</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">zt</span><span class="o">*</span><span class="n">at</span><span class="o">/</span><span class="p">(</span><span class="n">mi</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span>
            <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">4</span> <span class="o">-</span> <span class="n">mj</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span> <span class="o">+</span>
            <span class="n">b_slope</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">5</span><span class="o">*</span><span class="n">zb</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mj</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">at</span><span class="o">/</span><span class="p">(</span><span class="n">mi</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">4</span> <span class="o">-</span>
            <span class="n">mj</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span> <span class="o">-</span> <span class="n">b_slope</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mj</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">at</span><span class="o">/</span><span class="p">(</span><span class="n">mi</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">4</span> <span class="o">-</span>
            <span class="n">mj</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span> <span class="o">+</span> <span class="n">b_slope</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zt</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mj</span><span class="o">*</span><span class="n">zt</span><span class="p">)</span><span class="o">*</span><span class="n">at</span><span class="o">/</span><span class="p">(</span><span class="n">mi</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">4</span> <span class="o">-</span>
            <span class="n">mj</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span> <span class="o">-</span> <span class="n">mi</span><span class="o">**</span><span class="mi">5</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mj</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">bt</span><span class="o">*</span><span class="n">at</span><span class="o">/</span><span class="p">(</span><span class="n">mi</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">4</span> <span class="o">-</span>
            <span class="n">mj</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span> <span class="o">+</span> <span class="n">mi</span><span class="o">**</span><span class="mi">5</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zt</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mj</span><span class="o">*</span><span class="n">zt</span><span class="p">)</span><span class="o">*</span><span class="n">bt</span><span class="o">*</span><span class="n">at</span><span class="o">/</span><span class="p">(</span><span class="n">mi</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">4</span> <span class="o">-</span>
            <span class="n">mj</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span> <span class="o">+</span> <span class="n">mi</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">mj</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mj</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">bt</span><span class="o">*</span><span class="n">at</span><span class="o">/</span><span class="p">(</span><span class="n">mi</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">4</span> <span class="o">-</span>
            <span class="n">mj</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span> <span class="o">-</span> <span class="n">mi</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">mj</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mj</span><span class="o">*</span><span class="n">zt</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zt</span><span class="p">)</span><span class="o">*</span><span class="n">bt</span><span class="o">*</span><span class="n">at</span><span class="o">/</span><span class="p">(</span><span class="n">mi</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">4</span> <span class="o">-</span>
            <span class="n">mj</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mj</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">bt</span><span class="o">*</span><span class="n">at</span><span class="o">/</span><span class="p">(</span><span class="n">mi</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span>
            <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">4</span> <span class="o">-</span> <span class="n">mj</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zt</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mj</span><span class="o">*</span><span class="n">zt</span><span class="p">)</span><span class="o">*</span><span class="n">bt</span><span class="o">*</span><span class="n">at</span><span class="o">/</span><span class="p">(</span><span class="n">mi</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span>
            <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">4</span> <span class="o">-</span> <span class="n">mj</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span> <span class="o">-</span>
            <span class="mi">2</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mj</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">bt</span><span class="o">*</span><span class="n">at</span><span class="o">/</span><span class="p">(</span><span class="n">mi</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">4</span> <span class="o">-</span>
            <span class="n">mj</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mj</span><span class="o">*</span><span class="n">zt</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zt</span><span class="p">)</span><span class="o">*</span><span class="n">bt</span><span class="o">*</span><span class="n">at</span><span class="o">/</span><span class="p">(</span><span class="n">mi</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span>
            <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">4</span> <span class="o">-</span> <span class="n">mj</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span> <span class="o">-</span> <span class="n">mi</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mj</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">bt</span><span class="o">*</span><span class="n">at</span><span class="o">/</span><span class="p">(</span><span class="n">mi</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span>
            <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">4</span> <span class="o">-</span> <span class="n">mj</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span> <span class="o">+</span> <span class="n">mi</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zt</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mj</span><span class="o">*</span><span class="n">zt</span><span class="p">)</span><span class="o">*</span><span class="n">bt</span><span class="o">*</span><span class="n">at</span><span class="o">/</span><span class="p">(</span><span class="n">mi</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span>
            <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">4</span> <span class="o">-</span> <span class="n">mj</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span> <span class="o">+</span> <span class="n">mj</span><span class="o">**</span><span class="mi">5</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mj</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">bt</span><span class="o">*</span><span class="n">at</span><span class="o">/</span><span class="p">(</span><span class="n">mi</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span>
            <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">4</span> <span class="o">-</span> <span class="n">mj</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span> <span class="o">-</span> <span class="n">mj</span><span class="o">**</span><span class="mi">5</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mj</span><span class="o">*</span><span class="n">zt</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zt</span><span class="p">)</span><span class="o">*</span><span class="n">bt</span><span class="o">*</span><span class="n">at</span><span class="o">/</span><span class="p">(</span><span class="n">mi</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span>
            <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">4</span> <span class="o">-</span> <span class="n">mj</span><span class="o">**</span><span class="mi">6</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="c1">#A is symmetric</span>
        <span class="n">A</span><span class="p">[</span><span class="n">tril</span><span class="p">]</span> <span class="o">=</span> <span class="n">A</span><span class="p">[</span><span class="n">triu</span><span class="p">]</span>

    <span class="k">return</span> <span class="n">A</span></div>


<div class="viewcode-block" id="dim1sin_D_aDf_linear"><a class="viewcode-back" href="../../../api/geotecha.speccon.integrals.html#geotecha.speccon.integrals.dim1sin_D_aDf_linear">[docs]</a><span class="k">def</span> <span class="nf">dim1sin_D_aDf_linear</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">at</span><span class="p">,</span> <span class="n">ab</span><span class="p">,</span> <span class="n">zt</span><span class="p">,</span> <span class="n">zb</span><span class="p">,</span> <span class="n">implementation</span><span class="o">=</span><span class="s1">&#39;vectorized&#39;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Integration of sin(mi * z) * D[a(z) * D[sin(mj * z),z],z]</span>
<span class="sd">    between ztop and zbot where a(z) is piecewise linear functions of z.</span>


<span class="sd">    Calulation of integrals is performed at each element of a square symmetric</span>
<span class="sd">    matrix (size depends on size of `m`)</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    m : ``list`` of ``float``</span>
<span class="sd">        eigenvlaues of BVP. generate with geoteca.speccon.m_from_sin_mx</span>
<span class="sd">    at : ``list`` of ``float``</span>
<span class="sd">        Property at top of each layer.</span>
<span class="sd">    ab : ``list`` of ``float``</span>
<span class="sd">        Property at bottom of each layer.</span>
<span class="sd">    zt : ``list`` of ``float``</span>
<span class="sd">        Normalised depth or z-coordinate at top of each layer. `zt[0]` = 0</span>
<span class="sd">    zb : ``list`` of ``float``</span>
<span class="sd">        Normalised depth or z-coordinate at bottom of each layer. `zt[-1]` = 1</span>
<span class="sd">    implementation : [&#39;vectorized&#39;, &#39;scalar&#39;, &#39;fortran&#39;], optional</span>
<span class="sd">        Functional implementation: &#39;scalar&#39; = python loops (slow),</span>
<span class="sd">        &#39;fortran&#39; = fortran code (fastest), &#39;vectorized&#39; = numpy(fast).</span>
<span class="sd">        Default implementation=&#39;vectorized&#39;.  If fortran extention module</span>
<span class="sd">        cannot be imported then &#39;vectorized&#39; version will be used.</span>
<span class="sd">        If anything other than &#39;fortran&#39; or &#39;scalar&#39; is used then</span>
<span class="sd">        default vectorized version will be used.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    A : numpy.ndarray</span>
<span class="sd">        A square symmetric matrix, size determined by size of `m`.</span>

<span class="sd">    See Also</span>
<span class="sd">    --------</span>
<span class="sd">    m_from_sin_mx : Used to generate &#39;m&#39; input parameter.</span>
<span class="sd">    geotecha.speccon.integrals_generate_code.dim1sin_D_aDf_linear_implementations : Generation</span>
<span class="sd">        of code for this function.</span>
<span class="sd">    pdim1sin_D_aDf_linear : Same function with PolyLine</span>
<span class="sd">        inputs.</span>
<span class="sd">    geotecha.speccon.ext_integrals.dim1sin_D_aDf_linear : Equivalent fortran</span>
<span class="sd">        function.</span>


<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    The `dim1sin_D_aDf_linear` matrix, :math:`A` is given by:</span>

<span class="sd">    .. math:: \\mathbf{A}_{i,j}=\\int_{0}^1{\\frac{d}{dz}\\left({a\\left(z\\right)}\\frac{d\\phi_j}{dz}\\right)\\phi_i\\,dz}</span>

<span class="sd">    where the basis function :math:`\\phi_i` is given by:</span>

<span class="sd">    .. math:: \\phi_i\\left(z\\right)=\\sin\\left({m_i}z\\right)</span>

<span class="sd">    and :math:`a\\left(z\\right)` is a piecewise</span>
<span class="sd">    linear functions with respect to :math:`z`, that within a layer is defined by:</span>

<span class="sd">    .. math:: a\\left(z\\right) = a_t+\\frac{a_b-a_t}{z_b-z_t}\\left(z-z_t\\right)</span>

<span class="sd">    with :math:`t` and :math:`b` subscripts representing &#39;top&#39; and &#39;bottom&#39; of</span>
<span class="sd">    each layer respectively.</span>

<span class="sd">    To make the above integration simpler we integate by parts to get:</span>

<span class="sd">    .. math:: \\mathbf{A}_{i,j}= \\left.\\phi_i{a\\left(z\\right)}\\frac{d\\phi_j}{dz}\\right|_{z=0}^{z=1} -\\int_{0}^1{{a\\left(z\\right)}\\frac{d\\phi_j}{dz}\\frac{d\\phi_i}{dz}\\,dz}</span>

<span class="sd">    In this case the sine basis functions means the left term in the above</span>
<span class="sd">    equation is zero, leaving us with</span>

<span class="sd">    .. math:: \\mathbf{A}_{i,j}= -\\int_{0}^1{{a\\left(z\\right)}\\frac{d\\phi_j}{dz}\\frac{d\\phi_i}{dz}\\,dz}</span>


<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1">#import numpy as np #import this at module level</span>
    <span class="c1">#import math #import this at module level</span>

    <span class="n">m</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
    <span class="n">at</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">at</span><span class="p">)</span>
    <span class="n">ab</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">ab</span><span class="p">)</span>
    <span class="n">zt</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">zt</span><span class="p">)</span>
    <span class="n">zb</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">zb</span><span class="p">)</span>

    <span class="n">neig</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">implementation</span> <span class="o">==</span> <span class="s1">&#39;scalar&#39;</span><span class="p">:</span>
        <span class="n">sin</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">sin</span>
        <span class="n">cos</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">cos</span>
        <span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="n">neig</span><span class="p">,</span> <span class="n">neig</span><span class="p">],</span> <span class="nb">float</span><span class="p">)</span>
        <span class="n">nlayers</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">zt</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">layer</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nlayers</span><span class="p">):</span>
            <span class="n">a_slope</span> <span class="o">=</span> <span class="p">(</span><span class="n">ab</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span> <span class="o">-</span> <span class="n">at</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span> <span class="o">/</span> <span class="p">(</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span> <span class="o">-</span> <span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">neig</span><span class="p">):</span>
                <span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span> <span class="o">+=</span> <span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">a_slope</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="mi">4</span> <span class="o">-</span>
                    <span class="n">a_slope</span><span class="o">*</span><span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="mi">4</span> <span class="o">-</span>
                    <span class="n">a_slope</span><span class="o">*</span><span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="mi">4</span> <span class="o">+</span>
                    <span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">*</span><span class="n">at</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">/</span><span class="mi">2</span> <span class="o">+</span>
                    <span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">at</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">/</span><span class="mi">2</span> <span class="o">+</span>
                    <span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">at</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span>
                    <span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">a_slope</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="mi">4</span> <span class="o">-</span>
                    <span class="n">a_slope</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">*</span><span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">/</span><span class="mi">2</span> <span class="o">+</span>
                    <span class="n">a_slope</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">/</span><span class="mi">2</span> <span class="o">-</span>
                    <span class="n">a_slope</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">/</span><span class="mi">2</span> <span class="o">-</span>
                    <span class="n">a_slope</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">/</span><span class="mi">2</span> <span class="o">+</span>
                    <span class="n">a_slope</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="mi">4</span> <span class="o">+</span>
                    <span class="n">a_slope</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="mi">4</span> <span class="o">+</span>
                    <span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">*</span><span class="n">at</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">/</span><span class="mi">2</span> <span class="o">+</span>
                    <span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">at</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">/</span><span class="mi">2</span> <span class="o">+</span>
                    <span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">at</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">/</span><span class="mi">2</span><span class="p">))</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">neig</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
                <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">neig</span><span class="p">):</span>
                    <span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">+=</span> <span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">a_slope</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span>
                        <span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span> <span class="o">+</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">a_slope</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span>
                        <span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span> <span class="o">+</span>
                        <span class="n">a_slope</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span>
                        <span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span> <span class="o">+</span> <span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span>
                        <span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">*</span><span class="n">at</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span> <span class="o">-</span>
                        <span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span>
                        <span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">*</span><span class="n">at</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span> <span class="o">-</span>
                        <span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span>
                        <span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">*</span><span class="n">at</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span> <span class="o">+</span>
                        <span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span>
                        <span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">*</span><span class="n">at</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span> <span class="o">-</span>
                        <span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">a_slope</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span>
                        <span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span> <span class="o">-</span>
                        <span class="n">a_slope</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span>
                        <span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">*</span><span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span> <span class="o">+</span>
                        <span class="n">a_slope</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span>
                        <span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span> <span class="o">+</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">a_slope</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span>
                        <span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span> <span class="o">+</span>
                        <span class="n">a_slope</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span>
                        <span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">*</span><span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span> <span class="o">-</span>
                        <span class="n">a_slope</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span>
                        <span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span> <span class="o">+</span>
                        <span class="n">a_slope</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span>
                        <span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span> <span class="o">+</span>
                        <span class="n">a_slope</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span>
                        <span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">*</span><span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span> <span class="o">-</span>
                        <span class="n">a_slope</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span>
                        <span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span> <span class="o">-</span>
                        <span class="n">a_slope</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span>
                        <span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">*</span><span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span> <span class="o">+</span>
                        <span class="n">a_slope</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span>
                        <span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span> <span class="o">+</span>
                        <span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span>
                        <span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">*</span><span class="n">at</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span> <span class="o">-</span>
                        <span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span>
                        <span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">*</span><span class="n">at</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span> <span class="o">-</span>
                        <span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span>
                        <span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">*</span><span class="n">at</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span> <span class="o">+</span>
                        <span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span>
                        <span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">*</span><span class="n">at</span><span class="p">[</span><span class="n">layer</span><span class="p">]))</span>

        <span class="c1">#A is symmetric</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">neig</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">neig</span><span class="p">):</span>
                <span class="n">A</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span>

    <span class="k">elif</span> <span class="n">implementation</span> <span class="o">==</span> <span class="s1">&#39;fortran&#39;</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">MUST_TRY_FORTRAN</span><span class="p">:</span>
            <span class="kn">import</span> <span class="nn">geotecha.speccon.ext_integrals</span> <span class="k">as</span> <span class="nn">ext_integ</span>
            <span class="n">A</span> <span class="o">=</span> <span class="n">ext_integ</span><span class="o">.</span><span class="n">dim1sin_d_adf_linear</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">at</span><span class="p">,</span> <span class="n">ab</span><span class="p">,</span> <span class="n">zt</span><span class="p">,</span> <span class="n">zb</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="kn">import</span> <span class="nn">geotecha.speccon.ext_integrals</span> <span class="k">as</span> <span class="nn">ext_integ</span>
                <span class="n">A</span> <span class="o">=</span> <span class="n">ext_integ</span><span class="o">.</span><span class="n">dim1sin_d_adf_linear</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">at</span><span class="p">,</span> <span class="n">ab</span><span class="p">,</span> <span class="n">zt</span><span class="p">,</span> <span class="n">zb</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
                <span class="n">A</span> <span class="o">=</span> <span class="n">dim1sin_D_aDf_linear</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">at</span><span class="p">,</span> <span class="n">ab</span><span class="p">,</span> <span class="n">zt</span><span class="p">,</span> <span class="n">zb</span><span class="p">,</span> <span class="n">implementation</span><span class="o">=</span><span class="s1">&#39;vectorized&#39;</span><span class="p">)</span>

    <span class="k">else</span><span class="p">:</span><span class="c1">#default is &#39;vectorized&#39; using numpy</span>
        <span class="n">sin</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span>
        <span class="n">cos</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span>
        <span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="n">neig</span><span class="p">,</span> <span class="n">neig</span><span class="p">],</span> <span class="nb">float</span><span class="p">)</span>

        <span class="n">diag</span> <span class="o">=</span>  <span class="n">np</span><span class="o">.</span><span class="n">diag_indices</span><span class="p">(</span><span class="n">neig</span><span class="p">)</span>
        <span class="n">triu</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">triu_indices</span><span class="p">(</span><span class="n">neig</span><span class="p">,</span> <span class="n">k</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">tril</span> <span class="o">=</span> <span class="p">(</span><span class="n">triu</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">triu</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

        <span class="n">a_slope</span> <span class="o">=</span> <span class="p">(</span><span class="n">ab</span> <span class="o">-</span> <span class="n">at</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">zb</span> <span class="o">-</span> <span class="n">zt</span><span class="p">)</span>

        <span class="n">mi</span> <span class="o">=</span> <span class="n">m</span><span class="p">[:,</span> <span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">]</span>
        <span class="n">A</span><span class="p">[</span><span class="n">diag</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">mi</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">a_slope</span><span class="o">*</span><span class="n">zt</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zt</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="mi">4</span> <span class="o">-</span> <span class="n">a_slope</span><span class="o">*</span><span class="n">zt</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zt</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="mi">4</span> <span class="o">-</span>
            <span class="n">a_slope</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zt</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="p">(</span><span class="mi">4</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">zt</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zt</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">at</span><span class="o">/</span><span class="mi">2</span> <span class="o">+</span> <span class="n">zt</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zt</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">at</span><span class="o">/</span><span class="mi">2</span> <span class="o">+</span>
            <span class="n">cos</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zt</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zt</span><span class="p">)</span><span class="o">*</span><span class="n">at</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">mi</span><span class="p">))</span> <span class="o">-</span> <span class="n">mi</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">a_slope</span><span class="o">*</span><span class="n">zb</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">zt</span><span class="o">/</span><span class="mi">2</span> <span class="o">-</span>
            <span class="n">a_slope</span><span class="o">*</span><span class="n">zb</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">zt</span><span class="o">/</span><span class="mi">2</span> <span class="o">+</span> <span class="n">a_slope</span><span class="o">*</span><span class="n">zb</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="mi">4</span> <span class="o">+</span>
            <span class="n">a_slope</span><span class="o">*</span><span class="n">zb</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="mi">4</span> <span class="o">-</span> <span class="n">a_slope</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">zt</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">mi</span><span class="p">)</span> <span class="o">+</span>
            <span class="n">a_slope</span><span class="o">*</span><span class="n">zb</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">mi</span><span class="p">)</span> <span class="o">-</span> <span class="n">a_slope</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="p">(</span><span class="mi">4</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span>
            <span class="n">zb</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">at</span><span class="o">/</span><span class="mi">2</span> <span class="o">+</span> <span class="n">zb</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">at</span><span class="o">/</span><span class="mi">2</span> <span class="o">+</span> <span class="n">cos</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">at</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">mi</span><span class="p">)),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

        <span class="n">mi</span> <span class="o">=</span> <span class="n">m</span><span class="p">[</span><span class="n">triu</span><span class="p">[</span><span class="mi">0</span><span class="p">]][:,</span> <span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">]</span>
        <span class="n">mj</span> <span class="o">=</span> <span class="n">m</span><span class="p">[</span><span class="n">triu</span><span class="p">[</span><span class="mi">1</span><span class="p">]][:,</span> <span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">]</span>
        <span class="n">A</span><span class="p">[</span><span class="n">triu</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">mj</span><span class="o">*</span><span class="p">(</span><span class="n">a_slope</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zt</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mj</span><span class="o">*</span><span class="n">zt</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">mi</span><span class="o">**</span><span class="mi">4</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">mj</span><span class="o">**</span><span class="mi">4</span><span class="p">)</span> <span class="o">+</span>
            <span class="mi">2</span><span class="o">*</span><span class="n">a_slope</span><span class="o">*</span><span class="n">mi</span><span class="o">*</span><span class="n">mj</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zt</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mj</span><span class="o">*</span><span class="n">zt</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">mi</span><span class="o">**</span><span class="mi">4</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">mj</span><span class="o">**</span><span class="mi">4</span><span class="p">)</span> <span class="o">+</span>
            <span class="n">a_slope</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zt</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mj</span><span class="o">*</span><span class="n">zt</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">mi</span><span class="o">**</span><span class="mi">4</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">mj</span><span class="o">**</span><span class="mi">4</span><span class="p">)</span> <span class="o">+</span>
            <span class="n">mi</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mj</span><span class="o">*</span><span class="n">zt</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zt</span><span class="p">)</span><span class="o">*</span><span class="n">at</span><span class="o">/</span><span class="p">(</span><span class="n">mi</span><span class="o">**</span><span class="mi">4</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">mj</span><span class="o">**</span><span class="mi">4</span><span class="p">)</span> <span class="o">-</span>
            <span class="n">mi</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">mj</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zt</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mj</span><span class="o">*</span><span class="n">zt</span><span class="p">)</span><span class="o">*</span><span class="n">at</span><span class="o">/</span><span class="p">(</span><span class="n">mi</span><span class="o">**</span><span class="mi">4</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">mj</span><span class="o">**</span><span class="mi">4</span><span class="p">)</span> <span class="o">-</span>
            <span class="n">mi</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mj</span><span class="o">*</span><span class="n">zt</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zt</span><span class="p">)</span><span class="o">*</span><span class="n">at</span><span class="o">/</span><span class="p">(</span><span class="n">mi</span><span class="o">**</span><span class="mi">4</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">mj</span><span class="o">**</span><span class="mi">4</span><span class="p">)</span> <span class="o">+</span>
            <span class="n">mj</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zt</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mj</span><span class="o">*</span><span class="n">zt</span><span class="p">)</span><span class="o">*</span><span class="n">at</span><span class="o">/</span><span class="p">(</span><span class="n">mi</span><span class="o">**</span><span class="mi">4</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">mj</span><span class="o">**</span><span class="mi">4</span><span class="p">))</span> <span class="o">-</span>
            <span class="n">mi</span><span class="o">*</span><span class="n">mj</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">a_slope</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mj</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">zt</span><span class="o">/</span><span class="p">(</span><span class="n">mi</span><span class="o">**</span><span class="mi">4</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">mj</span><span class="o">**</span><span class="mi">4</span><span class="p">)</span> <span class="o">+</span>
            <span class="n">a_slope</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">zb</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mj</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">mi</span><span class="o">**</span><span class="mi">4</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">mj</span><span class="o">**</span><span class="mi">4</span><span class="p">)</span> <span class="o">+</span>
            <span class="n">a_slope</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">mj</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mj</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">zt</span><span class="o">/</span><span class="p">(</span><span class="n">mi</span><span class="o">**</span><span class="mi">4</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">mj</span><span class="o">**</span><span class="mi">4</span><span class="p">)</span> <span class="o">-</span>
            <span class="n">a_slope</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">mj</span><span class="o">*</span><span class="n">zb</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mj</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">mi</span><span class="o">**</span><span class="mi">4</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">mj</span><span class="o">**</span><span class="mi">4</span><span class="p">)</span> <span class="o">+</span>
            <span class="n">a_slope</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mj</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">mi</span><span class="o">**</span><span class="mi">4</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">mj</span><span class="o">**</span><span class="mi">4</span><span class="p">)</span> <span class="o">+</span>
            <span class="n">a_slope</span><span class="o">*</span><span class="n">mi</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mj</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">zt</span><span class="o">/</span><span class="p">(</span><span class="n">mi</span><span class="o">**</span><span class="mi">4</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">mj</span><span class="o">**</span><span class="mi">4</span><span class="p">)</span> <span class="o">-</span>
            <span class="n">a_slope</span><span class="o">*</span><span class="n">mi</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">zb</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mj</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">mi</span><span class="o">**</span><span class="mi">4</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">mj</span><span class="o">**</span><span class="mi">4</span><span class="p">)</span> <span class="o">+</span>
            <span class="mi">2</span><span class="o">*</span><span class="n">a_slope</span><span class="o">*</span><span class="n">mi</span><span class="o">*</span><span class="n">mj</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mj</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">mi</span><span class="o">**</span><span class="mi">4</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">mj</span><span class="o">**</span><span class="mi">4</span><span class="p">)</span> <span class="o">-</span>
            <span class="n">a_slope</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mj</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">zt</span><span class="o">/</span><span class="p">(</span><span class="n">mi</span><span class="o">**</span><span class="mi">4</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">mj</span><span class="o">**</span><span class="mi">4</span><span class="p">)</span> <span class="o">+</span>
            <span class="n">a_slope</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">zb</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mj</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">mi</span><span class="o">**</span><span class="mi">4</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">mj</span><span class="o">**</span><span class="mi">4</span><span class="p">)</span> <span class="o">+</span>
            <span class="n">a_slope</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mj</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">mi</span><span class="o">**</span><span class="mi">4</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">mj</span><span class="o">**</span><span class="mi">4</span><span class="p">)</span> <span class="o">+</span>
            <span class="n">mi</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mj</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">at</span><span class="o">/</span><span class="p">(</span><span class="n">mi</span><span class="o">**</span><span class="mi">4</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">mj</span><span class="o">**</span><span class="mi">4</span><span class="p">)</span> <span class="o">-</span>
            <span class="n">mi</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">mj</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mj</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">at</span><span class="o">/</span><span class="p">(</span><span class="n">mi</span><span class="o">**</span><span class="mi">4</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">mj</span><span class="o">**</span><span class="mi">4</span><span class="p">)</span> <span class="o">-</span>
            <span class="n">mi</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mj</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">at</span><span class="o">/</span><span class="p">(</span><span class="n">mi</span><span class="o">**</span><span class="mi">4</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">mj</span><span class="o">**</span><span class="mi">4</span><span class="p">)</span> <span class="o">+</span>
            <span class="n">mj</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mj</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">at</span><span class="o">/</span><span class="p">(</span><span class="n">mi</span><span class="o">**</span><span class="mi">4</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">mj</span><span class="o">**</span><span class="mi">4</span><span class="p">)),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="c1">#A is symmetric</span>
        <span class="n">A</span><span class="p">[</span><span class="n">tril</span><span class="p">]</span> <span class="o">=</span> <span class="n">A</span><span class="p">[</span><span class="n">triu</span><span class="p">]</span>

    <span class="k">return</span> <span class="n">A</span></div>


<div class="viewcode-block" id="dim1sin_ab_linear"><a class="viewcode-back" href="../../../api/geotecha.speccon.integrals.html#geotecha.speccon.integrals.dim1sin_ab_linear">[docs]</a><span class="k">def</span> <span class="nf">dim1sin_ab_linear</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">at</span><span class="p">,</span> <span class="n">ab</span><span class="p">,</span> <span class="n">bt</span><span class="p">,</span> <span class="n">bb</span><span class="p">,</span> <span class="n">zt</span><span class="p">,</span> <span class="n">zb</span><span class="p">,</span> <span class="n">implementation</span><span class="o">=</span><span class="s1">&#39;vectorized&#39;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Integration of sin(mi * z) * a(z) * b(z)</span>
<span class="sd">    between ztop and zbot where a(z) and b(z) are piecewise linear functions of z.</span>


<span class="sd">    Calulation of integrals is performed at each element of a 1d array</span>
<span class="sd">    (size depends on size of `m`).</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    m : ``list`` of ``float``</span>
<span class="sd">        eigenvlaues of BVP. generate with geoteca.speccon.m_from_sin_mx</span>
<span class="sd">    at : ``list`` of ``float``</span>
<span class="sd">        Property at top of each layer.</span>
<span class="sd">    ab : ``list`` of ``float``</span>
<span class="sd">        Property at bottom of each layer.</span>
<span class="sd">    bt : ``list`` of ``float``</span>
<span class="sd">        2nd property at top of each layer.</span>
<span class="sd">    bb : ``list`` of ``float``</span>
<span class="sd">        2nd property at bottom of each layer.</span>
<span class="sd">    zt : ``list`` of ``float``</span>
<span class="sd">        Normalised depth or z-coordinate at top of each layer. `zt[0]` = 0</span>
<span class="sd">    zb : ``list`` of ``float``</span>
<span class="sd">        Normalised depth or z-coordinate at bottom of each layer. `zt[-1]` = 1</span>
<span class="sd">    implementation : [&#39;vectorized&#39;, &#39;scalar&#39;, &#39;fortran&#39;], optional</span>
<span class="sd">        Functional implementation: &#39;scalar&#39; = python loops (slow),</span>
<span class="sd">        &#39;fortran&#39; = fortran code (fastest), &#39;vectorized&#39; = numpy(fast).</span>
<span class="sd">        Default implementation=&#39;vectorized&#39;.  If fortran extention module</span>
<span class="sd">        cannot be imported then &#39;vectorized&#39; version will be used.</span>
<span class="sd">        If anything other than &#39;fortran&#39; or &#39;scalar&#39; is used then</span>
<span class="sd">        default vectorized version will be used.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    A : numpy.ndarray</span>
<span class="sd">        A 1d array size determined by size of `m`. Treat as column</span>
<span class="sd">        vector</span>

<span class="sd">    See Also</span>
<span class="sd">    --------</span>
<span class="sd">    m_from_sin_mx : Used to generate &#39;m&#39; input parameter.</span>
<span class="sd">    geotecha.speccon.integrals_generate_code.dim1sin_ab_linear_implementations : Generation</span>
<span class="sd">        of code for this function.</span>
<span class="sd">    pdim1sin_ab_linear : Same function with PolyLine</span>
<span class="sd">        inputs.</span>
<span class="sd">    geotecha.speccon.ext_integrals.dim1sin_ab_linear : Equivalent fortran</span>
<span class="sd">        function.</span>


<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    The `dim1sin_ab_linear` which should be treated as a column vector,</span>
<span class="sd">    :math:`A` is given by:</span>

<span class="sd">    .. math:: \\mathbf{A}_{i}=\\int_{0}^1{{a\\left(z\\right)}{b\\left(z\\right)}\\phi_i\\,dz}</span>

<span class="sd">    where the basis function :math:`\\phi_i` is given by:</span>

<span class="sd">    .. math:: \\phi_i\\left(z\\right)=\\sin\\left({m_i}z\\right)</span>

<span class="sd">    and :math:`a\\left(z\\right)` and :math:`b\\left(z\\right)` are piecewise</span>
<span class="sd">    linear functions with respect to :math:`z`, that within a layer are defined by:</span>

<span class="sd">    .. math:: a\\left(z\\right) = a_t+\\frac{a_b-a_t}{z_b-z_t}\\left(z-z_t\\right)</span>

<span class="sd">    with :math:`t` and :math:`b` subscripts representing &#39;top&#39; and &#39;bottom&#39; of</span>
<span class="sd">    each layer respectively.</span>


<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1">#import numpy as np #import this at module level</span>
    <span class="c1">#import math #import this at module level</span>

    <span class="n">m</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
    <span class="n">at</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">at</span><span class="p">)</span>
    <span class="n">ab</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">ab</span><span class="p">)</span>
    <span class="n">bt</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">bt</span><span class="p">)</span>
    <span class="n">bb</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">bb</span><span class="p">)</span>
    <span class="n">zt</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">zt</span><span class="p">)</span>
    <span class="n">zb</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">zb</span><span class="p">)</span>

    <span class="n">neig</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">implementation</span> <span class="o">==</span> <span class="s1">&#39;scalar&#39;</span><span class="p">:</span>
        <span class="n">sin</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">sin</span>
        <span class="n">cos</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">cos</span>
        <span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">neig</span><span class="p">,</span> <span class="nb">float</span><span class="p">)</span>

        <span class="n">nlayers</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">zt</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">layer</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nlayers</span><span class="p">):</span>
            <span class="n">a_slope</span> <span class="o">=</span> <span class="p">(</span><span class="n">ab</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span> <span class="o">-</span> <span class="n">at</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span> <span class="o">/</span> <span class="p">(</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span> <span class="o">-</span> <span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span>
            <span class="n">b_slope</span> <span class="o">=</span> <span class="p">(</span><span class="n">bb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span> <span class="o">-</span> <span class="n">bt</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span> <span class="o">/</span> <span class="p">(</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span> <span class="o">-</span> <span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">neig</span><span class="p">):</span>
                <span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+=</span> <span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">a_slope</span><span class="o">*</span><span class="n">b_slope</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">a_slope</span><span class="o">*</span><span class="n">b_slope</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span>
                    <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">a_slope</span><span class="o">*</span><span class="n">b_slope</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">*</span><span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span> <span class="o">+</span>
                    <span class="mi">2</span><span class="o">*</span><span class="n">a_slope</span><span class="o">*</span><span class="n">b_slope</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span> <span class="o">-</span>
                    <span class="n">a_slope</span><span class="o">*</span><span class="n">b_slope</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">*</span><span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span>
                    <span class="mi">2</span><span class="o">*</span><span class="n">a_slope</span><span class="o">*</span><span class="n">b_slope</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">*</span><span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span> <span class="o">-</span>
                    <span class="n">a_slope</span><span class="o">*</span><span class="n">b_slope</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span> <span class="o">+</span>
                    <span class="n">a_slope</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">*</span><span class="n">bt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span> <span class="o">-</span>
                    <span class="n">a_slope</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">*</span><span class="n">bt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span> <span class="o">+</span>
                    <span class="n">a_slope</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">*</span><span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">bt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span> <span class="o">-</span>
                    <span class="n">a_slope</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">*</span><span class="n">bt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span> <span class="o">+</span>
                    <span class="n">b_slope</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">*</span><span class="n">at</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span> <span class="o">-</span>
                    <span class="n">b_slope</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">*</span><span class="n">at</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span> <span class="o">+</span>
                    <span class="n">b_slope</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">*</span><span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">at</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span> <span class="o">-</span>
                    <span class="n">b_slope</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">*</span><span class="n">at</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span> <span class="o">-</span>
                    <span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">*</span><span class="n">bt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">at</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span> <span class="o">+</span>
                    <span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">*</span><span class="n">bt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">at</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span>

    <span class="k">elif</span> <span class="n">implementation</span> <span class="o">==</span> <span class="s1">&#39;fortran&#39;</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">MUST_TRY_FORTRAN</span><span class="p">:</span>
            <span class="kn">import</span> <span class="nn">geotecha.speccon.ext_integrals</span> <span class="k">as</span> <span class="nn">ext_integ</span>
            <span class="n">A</span> <span class="o">=</span> <span class="n">ext_integ</span><span class="o">.</span><span class="n">dim1sin_ab_linear</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">at</span><span class="p">,</span> <span class="n">ab</span><span class="p">,</span> <span class="n">bt</span><span class="p">,</span> <span class="n">bb</span><span class="p">,</span> <span class="n">zt</span><span class="p">,</span> <span class="n">zb</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="kn">import</span> <span class="nn">geotecha.speccon.ext_integrals</span> <span class="k">as</span> <span class="nn">ext_integ</span>
                <span class="n">A</span> <span class="o">=</span> <span class="n">ext_integ</span><span class="o">.</span><span class="n">dim1sin_ab_linear</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">at</span><span class="p">,</span> <span class="n">ab</span><span class="p">,</span> <span class="n">bt</span><span class="p">,</span> <span class="n">bb</span><span class="p">,</span> <span class="n">zt</span><span class="p">,</span> <span class="n">zb</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
                <span class="n">A</span> <span class="o">=</span> <span class="n">dim1sin_ab_linear</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">at</span><span class="p">,</span> <span class="n">ab</span><span class="p">,</span> <span class="n">bt</span><span class="p">,</span> <span class="n">bb</span><span class="p">,</span> <span class="n">zt</span><span class="p">,</span> <span class="n">zb</span><span class="p">,</span> <span class="n">implementation</span><span class="o">=</span><span class="s1">&#39;vectorized&#39;</span><span class="p">)</span>

    <span class="k">else</span><span class="p">:</span><span class="c1">#default is &#39;vectorized&#39; using numpy</span>
        <span class="n">sin</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span>
        <span class="n">cos</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span>
        <span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">neig</span><span class="p">,</span> <span class="nb">float</span><span class="p">)</span>

        <span class="n">a_slope</span> <span class="o">=</span> <span class="p">(</span><span class="n">ab</span> <span class="o">-</span> <span class="n">at</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">zb</span> <span class="o">-</span> <span class="n">zt</span><span class="p">)</span>
        <span class="n">b_slope</span> <span class="o">=</span> <span class="p">(</span><span class="n">bb</span> <span class="o">-</span> <span class="n">bt</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">zb</span> <span class="o">-</span> <span class="n">zt</span><span class="p">)</span>
        <span class="n">mi</span> <span class="o">=</span> <span class="n">m</span><span class="p">[:,</span> <span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">]</span>
        <span class="n">A</span><span class="p">[:]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="o">-</span><span class="n">a_slope</span><span class="o">*</span><span class="n">b_slope</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">zt</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="n">mi</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">a_slope</span><span class="o">*</span><span class="n">b_slope</span><span class="o">*</span><span class="n">zb</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">zt</span><span class="o">/</span><span class="n">mi</span> <span class="o">-</span>
            <span class="n">a_slope</span><span class="o">*</span><span class="n">b_slope</span><span class="o">*</span><span class="n">zb</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">/</span><span class="n">mi</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">a_slope</span><span class="o">*</span><span class="n">b_slope</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">zt</span><span class="o">/</span><span class="n">mi</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span>
            <span class="mi">2</span><span class="o">*</span><span class="n">a_slope</span><span class="o">*</span><span class="n">b_slope</span><span class="o">*</span><span class="n">zb</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">/</span><span class="n">mi</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">a_slope</span><span class="o">*</span><span class="n">b_slope</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">/</span><span class="n">mi</span><span class="o">**</span><span class="mi">3</span> <span class="o">-</span>
            <span class="mi">2</span><span class="o">*</span><span class="n">a_slope</span><span class="o">*</span><span class="n">b_slope</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zt</span><span class="p">)</span><span class="o">/</span><span class="n">mi</span><span class="o">**</span><span class="mi">3</span> <span class="o">+</span> <span class="n">a_slope</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">zt</span><span class="o">*</span><span class="n">bt</span><span class="o">/</span><span class="n">mi</span> <span class="o">-</span>
            <span class="n">a_slope</span><span class="o">*</span><span class="n">zb</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">bt</span><span class="o">/</span><span class="n">mi</span> <span class="o">+</span> <span class="n">a_slope</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">bt</span><span class="o">/</span><span class="n">mi</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">a_slope</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zt</span><span class="p">)</span><span class="o">*</span><span class="n">bt</span><span class="o">/</span><span class="n">mi</span><span class="o">**</span><span class="mi">2</span>
            <span class="o">+</span> <span class="n">b_slope</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">zt</span><span class="o">*</span><span class="n">at</span><span class="o">/</span><span class="n">mi</span> <span class="o">-</span> <span class="n">b_slope</span><span class="o">*</span><span class="n">zb</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">at</span><span class="o">/</span><span class="n">mi</span> <span class="o">+</span>
            <span class="n">b_slope</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">at</span><span class="o">/</span><span class="n">mi</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">b_slope</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zt</span><span class="p">)</span><span class="o">*</span><span class="n">at</span><span class="o">/</span><span class="n">mi</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">cos</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">bt</span><span class="o">*</span><span class="n">at</span><span class="o">/</span><span class="n">mi</span> <span class="o">+</span>
            <span class="n">cos</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zt</span><span class="p">)</span><span class="o">*</span><span class="n">bt</span><span class="o">*</span><span class="n">at</span><span class="o">/</span><span class="n">mi</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>


    <span class="k">return</span> <span class="n">A</span></div>


<div class="viewcode-block" id="dim1sin_abc_linear"><a class="viewcode-back" href="../../../api/geotecha.speccon.integrals.html#geotecha.speccon.integrals.dim1sin_abc_linear">[docs]</a><span class="k">def</span> <span class="nf">dim1sin_abc_linear</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">at</span><span class="p">,</span> <span class="n">ab</span><span class="p">,</span> <span class="n">bt</span><span class="p">,</span> <span class="n">bb</span><span class="p">,</span> <span class="n">ct</span><span class="p">,</span> <span class="n">cb</span><span class="p">,</span> <span class="n">zt</span><span class="p">,</span> <span class="n">zb</span><span class="p">,</span> <span class="n">implementation</span><span class="o">=</span><span class="s1">&#39;vectorized&#39;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Integrations of sin(mi * z) * a(z) * b(z) * c(z)</span>
<span class="sd">    between ztop and zbot where a(z), b(z), c(z) are piecewise linear functions of z.</span>

<span class="sd">    Calulation of integrals is performed at each element of a 1d array</span>
<span class="sd">    (size depends on size of `m`).</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    m : ``list`` of ``float``</span>
<span class="sd">        eigenvlaues of BVP. generate with geoteca.speccon.m_from_sin_mx</span>
<span class="sd">    at : ``list`` of ``float``</span>
<span class="sd">        Property at top of each layer.</span>
<span class="sd">    ab : ``list`` of ``float``</span>
<span class="sd">        Property at bottom of each layer.</span>
<span class="sd">    bt : ``list`` of ``float``</span>
<span class="sd">        2nd property at top of each layer.</span>
<span class="sd">    bb : ``list`` of ``float``</span>
<span class="sd">        2nd property at bottom of each layer.</span>
<span class="sd">    ct : ``list`` of ``float``</span>
<span class="sd">        3rd property at top of each layer.</span>
<span class="sd">    cb : ``list`` of ``float``</span>
<span class="sd">        3rd property at bottom of each layer.</span>
<span class="sd">    zt : ``list`` of ``float``</span>
<span class="sd">        Normalised depth or z-coordinate at top of each layer. `zt[0]` = 0</span>
<span class="sd">    zb : ``list`` of ``float``</span>
<span class="sd">        Normalised depth or z-coordinate at bottom of each layer. `zt[-1]` = 1</span>
<span class="sd">    implementation : [&#39;vectorized&#39;, &#39;scalar&#39;, &#39;fortran&#39;], optional</span>
<span class="sd">        Functional implementation: &#39;scalar&#39; = python loops (slow),</span>
<span class="sd">        &#39;fortran&#39; = fortran code (fastest), &#39;vectorized&#39; = numpy(fast).</span>
<span class="sd">        Default implementation=&#39;vectorized&#39;.  If fortran extention module</span>
<span class="sd">        cannot be imported then &#39;vectorized&#39; version will be used.</span>
<span class="sd">        If anything other than &#39;fortran&#39; or &#39;scalar&#39; is used then</span>
<span class="sd">        default vectorized version will be used.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    A : numpy.ndarray</span>
<span class="sd">        A 1d array size determined by size of `m`. Treat as column</span>
<span class="sd">        vector.</span>

<span class="sd">    See Also</span>
<span class="sd">    --------</span>
<span class="sd">    m_from_sin_mx : Used to generate &#39;m&#39; input parameter.</span>
<span class="sd">    geotecha.speccon.integrals_generate_code.dim1sin_abc_linear_implementations : Generation</span>
<span class="sd">        of code for this function.</span>
<span class="sd">    pdim1sin_abc_linear : Same function with PolyLine</span>
<span class="sd">        inputs.</span>
<span class="sd">    geotecha.speccon.ext_integrals.dim1sin_abc_linear : Equivalent fortran</span>
<span class="sd">        function.</span>


<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    The `dim1sin_abc_linear` which should be treated as a column vector,</span>
<span class="sd">    :math:`A` is given by:</span>

<span class="sd">    .. math:: \\mathbf{A}_{i}=\\int_{0}^1{{a\\left(z\\right)}{b\\left(z\\right)}{c\\left(z\\right)}\\phi_i\\,dz}</span>

<span class="sd">    where the basis function :math:`\\phi_i` is given by:</span>

<span class="sd">    .. math:: \\phi_i\\left(z\\right)=\\sin\\left({m_i}z\\right)</span>

<span class="sd">    and :math:`a\\left(z\\right)`, :math:`b\\left(z\\right)`, and</span>
<span class="sd">    :math:`c\\left(z\\right)` are piecewise linear functions</span>
<span class="sd">    with respect to :math:`z`, that within a layer are defined by:</span>

<span class="sd">    .. math:: a\\left(z\\right) = a_t+\\frac{a_b-a_t}{z_b-z_t}\\left(z-z_t\\right)</span>

<span class="sd">    with :math:`t` and :math:`b` subscripts representing &#39;top&#39; and &#39;bottom&#39; of</span>
<span class="sd">    each layer respectively.</span>


<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1">#import numpy as np #import this at module level</span>
    <span class="c1">#import math #import this at module level</span>

    <span class="n">m</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
    <span class="n">at</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">at</span><span class="p">)</span>
    <span class="n">ab</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">ab</span><span class="p">)</span>
    <span class="n">bt</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">bt</span><span class="p">)</span>
    <span class="n">bb</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">bb</span><span class="p">)</span>
    <span class="n">ct</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">ct</span><span class="p">)</span>
    <span class="n">cb</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">cb</span><span class="p">)</span>
    <span class="n">zt</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">zt</span><span class="p">)</span>
    <span class="n">zb</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">zb</span><span class="p">)</span>

    <span class="n">neig</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">implementation</span> <span class="o">==</span> <span class="s1">&#39;scalar&#39;</span><span class="p">:</span>
        <span class="n">sin</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">sin</span>
        <span class="n">cos</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">cos</span>
        <span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">neig</span><span class="p">,</span> <span class="nb">float</span><span class="p">)</span>
        <span class="n">nlayers</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">zt</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">layer</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nlayers</span><span class="p">):</span>
            <span class="n">a_slope</span> <span class="o">=</span> <span class="p">(</span><span class="n">ab</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span> <span class="o">-</span> <span class="n">at</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span> <span class="o">/</span> <span class="p">(</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span> <span class="o">-</span> <span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span>
            <span class="n">b_slope</span> <span class="o">=</span> <span class="p">(</span><span class="n">bb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span> <span class="o">-</span> <span class="n">bt</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span> <span class="o">/</span> <span class="p">(</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span> <span class="o">-</span> <span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span>
            <span class="n">c_slope</span> <span class="o">=</span> <span class="p">(</span><span class="n">cb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span> <span class="o">-</span> <span class="n">ct</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span> <span class="o">/</span> <span class="p">(</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span> <span class="o">-</span> <span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">neig</span><span class="p">):</span>
                <span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+=</span> <span class="p">(</span><span class="o">-</span><span class="mi">6</span><span class="o">*</span><span class="n">a_slope</span><span class="o">*</span><span class="n">b_slope</span><span class="o">*</span><span class="n">c_slope</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">4</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span> <span class="o">+</span>
                    <span class="mi">6</span><span class="o">*</span><span class="n">a_slope</span><span class="o">*</span><span class="n">b_slope</span><span class="o">*</span><span class="n">c_slope</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">4</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span> <span class="o">-</span>
                    <span class="mi">6</span><span class="o">*</span><span class="n">a_slope</span><span class="o">*</span><span class="n">b_slope</span><span class="o">*</span><span class="n">c_slope</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">*</span><span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span> <span class="o">+</span>
                    <span class="mi">6</span><span class="o">*</span><span class="n">a_slope</span><span class="o">*</span><span class="n">b_slope</span><span class="o">*</span><span class="n">c_slope</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">)</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span> <span class="o">+</span>
                    <span class="mi">3</span><span class="o">*</span><span class="n">a_slope</span><span class="o">*</span><span class="n">b_slope</span><span class="o">*</span><span class="n">c_slope</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">*</span><span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span>
                    <span class="mi">6</span><span class="o">*</span><span class="n">a_slope</span><span class="o">*</span><span class="n">b_slope</span><span class="o">*</span><span class="n">c_slope</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">*</span><span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span> <span class="o">+</span>
                    <span class="mi">3</span><span class="o">*</span><span class="n">a_slope</span><span class="o">*</span><span class="n">b_slope</span><span class="o">*</span><span class="n">c_slope</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span> <span class="o">+</span>
                    <span class="n">a_slope</span><span class="o">*</span><span class="n">b_slope</span><span class="o">*</span><span class="n">c_slope</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">*</span><span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">**</span><span class="mi">3</span> <span class="o">-</span>
                    <span class="mi">3</span><span class="o">*</span><span class="n">a_slope</span><span class="o">*</span><span class="n">b_slope</span><span class="o">*</span><span class="n">c_slope</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">*</span><span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span>
                    <span class="o">+</span>
                    <span class="mi">3</span><span class="o">*</span><span class="n">a_slope</span><span class="o">*</span><span class="n">b_slope</span><span class="o">*</span><span class="n">c_slope</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">*</span><span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span>
                    <span class="o">-</span> <span class="n">a_slope</span><span class="o">*</span><span class="n">b_slope</span><span class="o">*</span><span class="n">c_slope</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span> <span class="o">+</span>
                    <span class="mi">2</span><span class="o">*</span><span class="n">a_slope</span><span class="o">*</span><span class="n">b_slope</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">*</span><span class="n">ct</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span> <span class="o">-</span>
                    <span class="mi">2</span><span class="o">*</span><span class="n">a_slope</span><span class="o">*</span><span class="n">b_slope</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">*</span><span class="n">ct</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span> <span class="o">-</span>
                    <span class="mi">2</span><span class="o">*</span><span class="n">a_slope</span><span class="o">*</span><span class="n">b_slope</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">*</span><span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">ct</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span> <span class="o">+</span>
                    <span class="mi">2</span><span class="o">*</span><span class="n">a_slope</span><span class="o">*</span><span class="n">b_slope</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">*</span><span class="n">ct</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span> <span class="o">-</span>
                    <span class="n">a_slope</span><span class="o">*</span><span class="n">b_slope</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">*</span><span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">ct</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span> <span class="o">+</span>
                    <span class="mi">2</span><span class="o">*</span><span class="n">a_slope</span><span class="o">*</span><span class="n">b_slope</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">*</span><span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">ct</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span> <span class="o">-</span>
                    <span class="n">a_slope</span><span class="o">*</span><span class="n">b_slope</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">*</span><span class="n">ct</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span> <span class="o">+</span>
                    <span class="mi">2</span><span class="o">*</span><span class="n">a_slope</span><span class="o">*</span><span class="n">c_slope</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">*</span><span class="n">bt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span> <span class="o">-</span>
                    <span class="mi">2</span><span class="o">*</span><span class="n">a_slope</span><span class="o">*</span><span class="n">c_slope</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">*</span><span class="n">bt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span> <span class="o">-</span>
                    <span class="mi">2</span><span class="o">*</span><span class="n">a_slope</span><span class="o">*</span><span class="n">c_slope</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">*</span><span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">bt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span> <span class="o">+</span>
                    <span class="mi">2</span><span class="o">*</span><span class="n">a_slope</span><span class="o">*</span><span class="n">c_slope</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">*</span><span class="n">bt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span> <span class="o">-</span>
                    <span class="n">a_slope</span><span class="o">*</span><span class="n">c_slope</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">*</span><span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">bt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span> <span class="o">+</span>
                    <span class="mi">2</span><span class="o">*</span><span class="n">a_slope</span><span class="o">*</span><span class="n">c_slope</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">*</span><span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">bt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span> <span class="o">-</span>
                    <span class="n">a_slope</span><span class="o">*</span><span class="n">c_slope</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">*</span><span class="n">bt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span> <span class="o">+</span>
                    <span class="n">a_slope</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">*</span><span class="n">ct</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">bt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span> <span class="o">-</span>
                    <span class="n">a_slope</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">*</span><span class="n">ct</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">bt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span> <span class="o">+</span>
                    <span class="n">a_slope</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">*</span><span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">ct</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">bt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span> <span class="o">-</span>
                    <span class="n">a_slope</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">*</span><span class="n">ct</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">bt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span> <span class="o">+</span>
                    <span class="mi">2</span><span class="o">*</span><span class="n">b_slope</span><span class="o">*</span><span class="n">c_slope</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">*</span><span class="n">at</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span> <span class="o">-</span>
                    <span class="mi">2</span><span class="o">*</span><span class="n">b_slope</span><span class="o">*</span><span class="n">c_slope</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">*</span><span class="n">at</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span> <span class="o">-</span>
                    <span class="mi">2</span><span class="o">*</span><span class="n">b_slope</span><span class="o">*</span><span class="n">c_slope</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">*</span><span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">at</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span> <span class="o">+</span>
                    <span class="mi">2</span><span class="o">*</span><span class="n">b_slope</span><span class="o">*</span><span class="n">c_slope</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">*</span><span class="n">at</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span> <span class="o">-</span>
                    <span class="n">b_slope</span><span class="o">*</span><span class="n">c_slope</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">*</span><span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">at</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span> <span class="o">+</span>
                    <span class="mi">2</span><span class="o">*</span><span class="n">b_slope</span><span class="o">*</span><span class="n">c_slope</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">*</span><span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">at</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span> <span class="o">-</span>
                    <span class="n">b_slope</span><span class="o">*</span><span class="n">c_slope</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">*</span><span class="n">at</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span> <span class="o">+</span>
                    <span class="n">b_slope</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">*</span><span class="n">ct</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">at</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span> <span class="o">-</span>
                    <span class="n">b_slope</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">*</span><span class="n">ct</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">at</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span> <span class="o">+</span>
                    <span class="n">b_slope</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">*</span><span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">ct</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">at</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span> <span class="o">-</span>
                    <span class="n">b_slope</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">*</span><span class="n">ct</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">at</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span> <span class="o">+</span>
                    <span class="n">c_slope</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">*</span><span class="n">bt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">at</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span> <span class="o">-</span>
                    <span class="n">c_slope</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">*</span><span class="n">bt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">at</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span> <span class="o">+</span>
                    <span class="n">c_slope</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">*</span><span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">bt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">at</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span> <span class="o">-</span>
                    <span class="n">c_slope</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">*</span><span class="n">bt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">at</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span> <span class="o">-</span>
                    <span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">*</span><span class="n">ct</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">bt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">at</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span> <span class="o">+</span>
                    <span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span><span class="o">*</span><span class="n">ct</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">bt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">at</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span>

    <span class="k">elif</span> <span class="n">implementation</span> <span class="o">==</span> <span class="s1">&#39;fortran&#39;</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">MUST_TRY_FORTRAN</span><span class="p">:</span>
            <span class="kn">import</span> <span class="nn">geotecha.speccon.ext_integrals</span> <span class="k">as</span> <span class="nn">ext_integ</span>
            <span class="n">A</span> <span class="o">=</span> <span class="n">ext_integ</span><span class="o">.</span><span class="n">dim1sin_abc_linear</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">at</span><span class="p">,</span> <span class="n">ab</span><span class="p">,</span> <span class="n">bt</span><span class="p">,</span> <span class="n">bb</span><span class="p">,</span>  <span class="n">ct</span><span class="p">,</span> <span class="n">cb</span><span class="p">,</span> <span class="n">zt</span><span class="p">,</span> <span class="n">zb</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="kn">import</span> <span class="nn">geotecha.speccon.ext_integrals</span> <span class="k">as</span> <span class="nn">ext_integ</span>
                <span class="n">A</span> <span class="o">=</span> <span class="n">ext_integ</span><span class="o">.</span><span class="n">dim1sin_abc_linear</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">at</span><span class="p">,</span> <span class="n">ab</span><span class="p">,</span> <span class="n">bt</span><span class="p">,</span> <span class="n">bb</span><span class="p">,</span>  <span class="n">ct</span><span class="p">,</span> <span class="n">cb</span><span class="p">,</span> <span class="n">zt</span><span class="p">,</span> <span class="n">zb</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
                <span class="n">A</span> <span class="o">=</span> <span class="n">dim1sin_abc_linear</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">at</span><span class="p">,</span> <span class="n">ab</span><span class="p">,</span> <span class="n">bt</span><span class="p">,</span> <span class="n">bb</span><span class="p">,</span>  <span class="n">ct</span><span class="p">,</span> <span class="n">cb</span><span class="p">,</span> <span class="n">zt</span><span class="p">,</span> <span class="n">zb</span><span class="p">,</span> <span class="n">implementation</span><span class="o">=</span><span class="s1">&#39;vectorized&#39;</span><span class="p">)</span>

    <span class="k">else</span><span class="p">:</span><span class="c1">#default is &#39;vectorized&#39; using numpy</span>
        <span class="n">sin</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span>
        <span class="n">cos</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span>
        <span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">neig</span><span class="p">,</span> <span class="nb">float</span><span class="p">)</span>


        <span class="n">a_slope</span> <span class="o">=</span> <span class="p">(</span><span class="n">ab</span> <span class="o">-</span> <span class="n">at</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">zb</span> <span class="o">-</span> <span class="n">zt</span><span class="p">)</span>
        <span class="n">b_slope</span> <span class="o">=</span> <span class="p">(</span><span class="n">bb</span> <span class="o">-</span> <span class="n">bt</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">zb</span> <span class="o">-</span> <span class="n">zt</span><span class="p">)</span>
        <span class="n">c_slope</span> <span class="o">=</span> <span class="p">(</span><span class="n">cb</span> <span class="o">-</span> <span class="n">ct</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">zb</span> <span class="o">-</span> <span class="n">zt</span><span class="p">)</span>

        <span class="n">mi</span> <span class="o">=</span> <span class="n">m</span><span class="p">[:,</span> <span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">]</span>
        <span class="n">A</span><span class="p">[:]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">a_slope</span><span class="o">*</span><span class="n">b_slope</span><span class="o">*</span><span class="n">c_slope</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">zt</span><span class="o">**</span><span class="mi">3</span><span class="o">/</span><span class="n">mi</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">a_slope</span><span class="o">*</span><span class="n">b_slope</span><span class="o">*</span><span class="n">c_slope</span><span class="o">*</span><span class="n">zb</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">zt</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="n">mi</span> <span class="o">+</span>
            <span class="mi">3</span><span class="o">*</span><span class="n">a_slope</span><span class="o">*</span><span class="n">b_slope</span><span class="o">*</span><span class="n">c_slope</span><span class="o">*</span><span class="n">zb</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">zt</span><span class="o">/</span><span class="n">mi</span> <span class="o">-</span>
            <span class="n">a_slope</span><span class="o">*</span><span class="n">b_slope</span><span class="o">*</span><span class="n">c_slope</span><span class="o">*</span><span class="n">zb</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">/</span><span class="n">mi</span> <span class="o">+</span>
            <span class="mi">3</span><span class="o">*</span><span class="n">a_slope</span><span class="o">*</span><span class="n">b_slope</span><span class="o">*</span><span class="n">c_slope</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">zt</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="n">mi</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span>
            <span class="mi">6</span><span class="o">*</span><span class="n">a_slope</span><span class="o">*</span><span class="n">b_slope</span><span class="o">*</span><span class="n">c_slope</span><span class="o">*</span><span class="n">zb</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">zt</span><span class="o">/</span><span class="n">mi</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span>
            <span class="mi">3</span><span class="o">*</span><span class="n">a_slope</span><span class="o">*</span><span class="n">b_slope</span><span class="o">*</span><span class="n">c_slope</span><span class="o">*</span><span class="n">zb</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">/</span><span class="n">mi</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span>
            <span class="mi">6</span><span class="o">*</span><span class="n">a_slope</span><span class="o">*</span><span class="n">b_slope</span><span class="o">*</span><span class="n">c_slope</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">zt</span><span class="o">/</span><span class="n">mi</span><span class="o">**</span><span class="mi">3</span> <span class="o">+</span>
            <span class="mi">6</span><span class="o">*</span><span class="n">a_slope</span><span class="o">*</span><span class="n">b_slope</span><span class="o">*</span><span class="n">c_slope</span><span class="o">*</span><span class="n">zb</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">/</span><span class="n">mi</span><span class="o">**</span><span class="mi">3</span> <span class="o">-</span>
            <span class="mi">6</span><span class="o">*</span><span class="n">a_slope</span><span class="o">*</span><span class="n">b_slope</span><span class="o">*</span><span class="n">c_slope</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">/</span><span class="n">mi</span><span class="o">**</span><span class="mi">4</span> <span class="o">+</span> <span class="mi">6</span><span class="o">*</span><span class="n">a_slope</span><span class="o">*</span><span class="n">b_slope</span><span class="o">*</span><span class="n">c_slope</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zt</span><span class="p">)</span><span class="o">/</span><span class="n">mi</span><span class="o">**</span><span class="mi">4</span>
            <span class="o">-</span> <span class="n">a_slope</span><span class="o">*</span><span class="n">b_slope</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">zt</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">ct</span><span class="o">/</span><span class="n">mi</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">a_slope</span><span class="o">*</span><span class="n">b_slope</span><span class="o">*</span><span class="n">zb</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">zt</span><span class="o">*</span><span class="n">ct</span><span class="o">/</span><span class="n">mi</span> <span class="o">-</span>
            <span class="n">a_slope</span><span class="o">*</span><span class="n">b_slope</span><span class="o">*</span><span class="n">zb</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">ct</span><span class="o">/</span><span class="n">mi</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">a_slope</span><span class="o">*</span><span class="n">b_slope</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">zt</span><span class="o">*</span><span class="n">ct</span><span class="o">/</span><span class="n">mi</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span>
            <span class="mi">2</span><span class="o">*</span><span class="n">a_slope</span><span class="o">*</span><span class="n">b_slope</span><span class="o">*</span><span class="n">zb</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">ct</span><span class="o">/</span><span class="n">mi</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">a_slope</span><span class="o">*</span><span class="n">b_slope</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">ct</span><span class="o">/</span><span class="n">mi</span><span class="o">**</span><span class="mi">3</span> <span class="o">-</span>
            <span class="mi">2</span><span class="o">*</span><span class="n">a_slope</span><span class="o">*</span><span class="n">b_slope</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zt</span><span class="p">)</span><span class="o">*</span><span class="n">ct</span><span class="o">/</span><span class="n">mi</span><span class="o">**</span><span class="mi">3</span> <span class="o">-</span> <span class="n">a_slope</span><span class="o">*</span><span class="n">c_slope</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">zt</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">bt</span><span class="o">/</span><span class="n">mi</span> <span class="o">+</span>
            <span class="mi">2</span><span class="o">*</span><span class="n">a_slope</span><span class="o">*</span><span class="n">c_slope</span><span class="o">*</span><span class="n">zb</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">zt</span><span class="o">*</span><span class="n">bt</span><span class="o">/</span><span class="n">mi</span> <span class="o">-</span> <span class="n">a_slope</span><span class="o">*</span><span class="n">c_slope</span><span class="o">*</span><span class="n">zb</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">bt</span><span class="o">/</span><span class="n">mi</span> <span class="o">-</span>
            <span class="mi">2</span><span class="o">*</span><span class="n">a_slope</span><span class="o">*</span><span class="n">c_slope</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">zt</span><span class="o">*</span><span class="n">bt</span><span class="o">/</span><span class="n">mi</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">a_slope</span><span class="o">*</span><span class="n">c_slope</span><span class="o">*</span><span class="n">zb</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">bt</span><span class="o">/</span><span class="n">mi</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span>
            <span class="mi">2</span><span class="o">*</span><span class="n">a_slope</span><span class="o">*</span><span class="n">c_slope</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">bt</span><span class="o">/</span><span class="n">mi</span><span class="o">**</span><span class="mi">3</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">a_slope</span><span class="o">*</span><span class="n">c_slope</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zt</span><span class="p">)</span><span class="o">*</span><span class="n">bt</span><span class="o">/</span><span class="n">mi</span><span class="o">**</span><span class="mi">3</span> <span class="o">+</span>
            <span class="n">a_slope</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">zt</span><span class="o">*</span><span class="n">ct</span><span class="o">*</span><span class="n">bt</span><span class="o">/</span><span class="n">mi</span> <span class="o">-</span> <span class="n">a_slope</span><span class="o">*</span><span class="n">zb</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">ct</span><span class="o">*</span><span class="n">bt</span><span class="o">/</span><span class="n">mi</span> <span class="o">+</span>
            <span class="n">a_slope</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">ct</span><span class="o">*</span><span class="n">bt</span><span class="o">/</span><span class="n">mi</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">a_slope</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zt</span><span class="p">)</span><span class="o">*</span><span class="n">ct</span><span class="o">*</span><span class="n">bt</span><span class="o">/</span><span class="n">mi</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span>
            <span class="n">b_slope</span><span class="o">*</span><span class="n">c_slope</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">zt</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">at</span><span class="o">/</span><span class="n">mi</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">b_slope</span><span class="o">*</span><span class="n">c_slope</span><span class="o">*</span><span class="n">zb</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">zt</span><span class="o">*</span><span class="n">at</span><span class="o">/</span><span class="n">mi</span> <span class="o">-</span>
            <span class="n">b_slope</span><span class="o">*</span><span class="n">c_slope</span><span class="o">*</span><span class="n">zb</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">at</span><span class="o">/</span><span class="n">mi</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">b_slope</span><span class="o">*</span><span class="n">c_slope</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">zt</span><span class="o">*</span><span class="n">at</span><span class="o">/</span><span class="n">mi</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span>
            <span class="mi">2</span><span class="o">*</span><span class="n">b_slope</span><span class="o">*</span><span class="n">c_slope</span><span class="o">*</span><span class="n">zb</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">at</span><span class="o">/</span><span class="n">mi</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">b_slope</span><span class="o">*</span><span class="n">c_slope</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">at</span><span class="o">/</span><span class="n">mi</span><span class="o">**</span><span class="mi">3</span> <span class="o">-</span>
            <span class="mi">2</span><span class="o">*</span><span class="n">b_slope</span><span class="o">*</span><span class="n">c_slope</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zt</span><span class="p">)</span><span class="o">*</span><span class="n">at</span><span class="o">/</span><span class="n">mi</span><span class="o">**</span><span class="mi">3</span> <span class="o">+</span> <span class="n">b_slope</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">zt</span><span class="o">*</span><span class="n">ct</span><span class="o">*</span><span class="n">at</span><span class="o">/</span><span class="n">mi</span> <span class="o">-</span>
            <span class="n">b_slope</span><span class="o">*</span><span class="n">zb</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">ct</span><span class="o">*</span><span class="n">at</span><span class="o">/</span><span class="n">mi</span> <span class="o">+</span> <span class="n">b_slope</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">ct</span><span class="o">*</span><span class="n">at</span><span class="o">/</span><span class="n">mi</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span>
            <span class="n">b_slope</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zt</span><span class="p">)</span><span class="o">*</span><span class="n">ct</span><span class="o">*</span><span class="n">at</span><span class="o">/</span><span class="n">mi</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">c_slope</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">zt</span><span class="o">*</span><span class="n">bt</span><span class="o">*</span><span class="n">at</span><span class="o">/</span><span class="n">mi</span> <span class="o">-</span>
            <span class="n">c_slope</span><span class="o">*</span><span class="n">zb</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">bt</span><span class="o">*</span><span class="n">at</span><span class="o">/</span><span class="n">mi</span> <span class="o">+</span> <span class="n">c_slope</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">bt</span><span class="o">*</span><span class="n">at</span><span class="o">/</span><span class="n">mi</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span>
            <span class="n">c_slope</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zt</span><span class="p">)</span><span class="o">*</span><span class="n">bt</span><span class="o">*</span><span class="n">at</span><span class="o">/</span><span class="n">mi</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">cos</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">ct</span><span class="o">*</span><span class="n">bt</span><span class="o">*</span><span class="n">at</span><span class="o">/</span><span class="n">mi</span> <span class="o">+</span> <span class="n">cos</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zt</span><span class="p">)</span><span class="o">*</span><span class="n">ct</span><span class="o">*</span><span class="n">bt</span><span class="o">*</span><span class="n">at</span><span class="o">/</span><span class="n">mi</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>


    <span class="k">return</span> <span class="n">A</span></div>


<div class="viewcode-block" id="dim1sin_D_aDb_linear"><a class="viewcode-back" href="../../../api/geotecha.speccon.integrals.html#geotecha.speccon.integrals.dim1sin_D_aDb_linear">[docs]</a><span class="k">def</span> <span class="nf">dim1sin_D_aDb_linear</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">at</span><span class="p">,</span> <span class="n">ab</span><span class="p">,</span> <span class="n">bt</span><span class="p">,</span> <span class="n">bb</span><span class="p">,</span> <span class="n">zt</span><span class="p">,</span> <span class="n">zb</span><span class="p">,</span> <span class="n">implementation</span><span class="o">=</span><span class="s1">&#39;vectorized&#39;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Integrations of `sin(mi * z) * D[a(z) * D[b(z), z], z]`</span>
<span class="sd">    between ztop and zbot where a(z) is a piecewise linear function of z,</span>
<span class="sd">    and b(z) is a linear function of z.</span>

<span class="sd">    Calulation of integrals is performed at each element of a 1d array</span>
<span class="sd">    (size depends on size of `m`).</span>

<span class="sd">    .. warning::</span>
<span class="sd">        The functions produced are set up to accept the b(z) input as</span>
<span class="sd">        piecewise linear, i.e. zt, zb, bt, bb etc. It is up to the user to</span>
<span class="sd">        ensure that the bt and bb are such that they define a continuous</span>
<span class="sd">        linear function. eg. to define b(z)=z+1 then use</span>
<span class="sd">        zt=[0,0.4], zb=[0.4, 1], bt=[1,1.4], bb=[1.4,2].</span>


<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    m : ``list`` of ``float``</span>
<span class="sd">        eigenvlaues of BVP. generate with geoteca.speccon.m_from_sin_mx</span>
<span class="sd">    at : ``list`` of ``float``</span>
<span class="sd">        Property at top of each layer.</span>
<span class="sd">    ab : ``list`` of ``float``</span>
<span class="sd">        Property at bottom of each layer.</span>
<span class="sd">    bt : ``list`` of ``float``</span>
<span class="sd">        2nd property at top of each layer.</span>
<span class="sd">    bb : ``list`` of ``float``</span>
<span class="sd">        2nd property at bottom of each layer.</span>
<span class="sd">    zt : ``list`` of ``float``</span>
<span class="sd">        Normalised depth or z-coordinate at top of each layer. `zt[0]` = 0</span>
<span class="sd">    zb : ``list`` of ``float``</span>
<span class="sd">        Normalised depth or z-coordinate at bottom of each layer. `zt[-1]` = 1</span>
<span class="sd">    implementation : [&#39;vectorized&#39;, &#39;scalar&#39;, &#39;fortran&#39;], optional</span>
<span class="sd">        Functional implementation: &#39;scalar&#39; = python loops (slow),</span>
<span class="sd">        &#39;fortran&#39; = fortran code (fastest), &#39;vectorized&#39; = numpy(fast).</span>
<span class="sd">        Default implementation=&#39;vectorized&#39;.  If fortran extention module</span>
<span class="sd">        cannot be imported then &#39;vectorized&#39; version will be used.</span>
<span class="sd">        If anything other than &#39;fortran&#39; or &#39;scalar&#39; is used then</span>
<span class="sd">        default vectorized version will be used.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    A : numpy.ndarray</span>
<span class="sd">        A 1d array size determined by size of `m`. Treat as column</span>
<span class="sd">        vector</span>

<span class="sd">    See Also</span>
<span class="sd">    --------</span>
<span class="sd">    m_from_sin_mx : Used to generate &#39;m&#39; input parameter.</span>
<span class="sd">    geotecha.speccon.integrals_generate_code.dim1sin_D_aDb_linear_implementations : Generation</span>
<span class="sd">        of code for this function.</span>
<span class="sd">    pdim1sin_D_aDb_linear : Same function with PolyLine</span>
<span class="sd">        inputs.</span>
<span class="sd">    geotecha.speccon.ext_integrals.dim1sin_D_aDb_linear : Equivalent fortran</span>
<span class="sd">        function.</span>


<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    The `dim1sin_D_aDb_linear` which should be treated as a column vector,</span>
<span class="sd">    :math:`A` is given by:</span>

<span class="sd">    .. math:: \\mathbf{A}_{i}=\\int_{0}^1{\\frac{d}{dz}\\left({a\\left(z\\right)}\\frac{d}{dz}{b\\left(z\\right)}\\right)\\phi_i\\,dz}</span>

<span class="sd">    where the basis function :math:`\\phi_i` is given by:</span>

<span class="sd">    .. math:: \\phi_i\\left(z\\right)=\\sin\\left({m_i}z\\right)</span>

<span class="sd">    and :math:`a\\left(z\\right)` is a piecewise</span>
<span class="sd">    linear functions with respect to :math:`z`, that within a layer is defined by:</span>

<span class="sd">    .. math:: a\\left(z\\right) = a_t+\\frac{a_b-a_t}{z_b-z_t}\\left(z-z_t\\right)</span>

<span class="sd">    with :math:`t` and :math:`b` subscripts representing &#39;top&#39; and &#39;bottom&#39; of</span>
<span class="sd">    each layer respectively.</span>

<span class="sd">    :math:`b\\left(z\\right)` is a linear function of :math:`z` defined by</span>

<span class="sd">    .. math:: b\\left(z\\right) = b_t+\\left({b_b-b_t}\\right)z</span>

<span class="sd">    with :math:`t` and :math:`b` subscripts now representing &#39;top&#39; and</span>
<span class="sd">    &#39;bottom&#39; of the profile respectively.</span>

<span class="sd">    Using the product rule for differentiation the above integral can be split</span>
<span class="sd">    into:</span>

<span class="sd">    .. math:: \\mathbf{A}_{i}=\\int_{0}^1{\\frac{da\\left(z\\right)}{dz}\\frac{db\\left(z\\right)}{dz}\\phi_i\\,dz} +</span>
<span class="sd">                              \\int_{0}^1{a\\left(z\\right)\\frac{d^2b\\left(z\\right)}{dz^2}\\phi_i\\,dz}</span>

<span class="sd">    The right hand term is zero because :math:`b\\left(z\\right)` is a</span>
<span class="sd">    continuous linear function so it&#39;s second derivative is zero.  The</span>
<span class="sd">    first derivative of :math:`b\\left(z\\right)` is a constant so the</span>
<span class="sd">    left term can be integrated by parts to give:</span>

<span class="sd">    .. math:: \\mathbf{A}_{i}=\\frac{db\\left(z\\right)}{dz}\\left(</span>
<span class="sd">                \\left.\\phi_i{a\\left(z\\right)}\\right|_{z=0}^{z=1} -</span>
<span class="sd">                -\\int_{0}^1{{a\\left(z\\right)}\\frac{d\\phi_i}{dz}\\,dz}</span>
<span class="sd">                \\right)</span>


<span class="sd">    &quot;&quot;&quot;</span>


        <span class="c1">#import numpy as np #import this at module level</span>
    <span class="c1">#import math #import this at module level</span>

    <span class="n">m</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
    <span class="n">at</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">at</span><span class="p">)</span>
    <span class="n">ab</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">ab</span><span class="p">)</span>
    <span class="n">bt</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">bt</span><span class="p">)</span>
    <span class="n">bb</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">bb</span><span class="p">)</span>
    <span class="n">zt</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">zt</span><span class="p">)</span>
    <span class="n">zb</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">zb</span><span class="p">)</span>

    <span class="n">neig</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">implementation</span> <span class="o">==</span> <span class="s1">&#39;scalar&#39;</span><span class="p">:</span>
        <span class="n">sin</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">sin</span>
        <span class="n">cos</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">cos</span>
        <span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">neig</span><span class="p">,</span> <span class="nb">float</span><span class="p">)</span>
        <span class="n">nlayers</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">zt</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">layer</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nlayers</span><span class="p">):</span>
            <span class="n">a_slope</span> <span class="o">=</span> <span class="p">(</span><span class="n">ab</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span> <span class="o">-</span> <span class="n">at</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span> <span class="o">/</span> <span class="p">(</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span> <span class="o">-</span> <span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span>
            <span class="n">b_slope</span> <span class="o">=</span> <span class="p">(</span><span class="n">bb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span> <span class="o">-</span> <span class="n">bt</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span> <span class="o">/</span> <span class="p">(</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span> <span class="o">-</span> <span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">neig</span><span class="p">):</span>
                <span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+=</span> <span class="p">(</span><span class="n">b_slope</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">a_slope</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">+</span> <span class="n">at</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span> <span class="o">-</span>
                    <span class="n">b_slope</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">a_slope</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">+</span>
                    <span class="n">a_slope</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">-</span>
                    <span class="n">a_slope</span><span class="o">*</span><span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">+</span>
                    <span class="n">at</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">])))</span>

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">neig</span><span class="p">):</span>
            <span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+=</span> <span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">zb</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">zt</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">bb</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">bt</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">*</span><span class="n">at</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">zt</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">+</span> <span class="p">(</span><span class="n">zb</span><span class="p">[</span><span class="n">nlayers</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">zt</span><span class="p">[</span><span class="n">nlayers</span> <span class="o">-</span>
                <span class="mi">1</span><span class="p">])</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">bb</span><span class="p">[</span><span class="n">nlayers</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">bt</span><span class="p">[</span><span class="n">nlayers</span> <span class="o">-</span> <span class="mi">1</span><span class="p">])</span><span class="o">*</span><span class="n">ab</span><span class="p">[</span><span class="n">nlayers</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">zb</span><span class="p">[</span><span class="n">nlayers</span> <span class="o">-</span>
                <span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
    <span class="k">elif</span> <span class="n">implementation</span> <span class="o">==</span> <span class="s1">&#39;fortran&#39;</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">MUST_TRY_FORTRAN</span><span class="p">:</span>
            <span class="kn">import</span> <span class="nn">geotecha.speccon.ext_integrals</span> <span class="k">as</span> <span class="nn">ext_integ</span>
            <span class="n">A</span> <span class="o">=</span> <span class="n">ext_integ</span><span class="o">.</span><span class="n">dim1sin_d_adb_linear</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">at</span><span class="p">,</span> <span class="n">ab</span><span class="p">,</span> <span class="n">bt</span><span class="p">,</span> <span class="n">bb</span><span class="p">,</span> <span class="n">zt</span><span class="p">,</span> <span class="n">zb</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="kn">import</span> <span class="nn">geotecha.speccon.ext_integrals</span> <span class="k">as</span> <span class="nn">ext_integ</span>
                <span class="n">A</span> <span class="o">=</span> <span class="n">ext_integ</span><span class="o">.</span><span class="n">dim1sin_d_adb_linear</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">at</span><span class="p">,</span> <span class="n">ab</span><span class="p">,</span> <span class="n">bt</span><span class="p">,</span> <span class="n">bb</span><span class="p">,</span> <span class="n">zt</span><span class="p">,</span> <span class="n">zb</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
                <span class="n">A</span> <span class="o">=</span> <span class="n">dim1sin_D_aDb_linear</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">at</span><span class="p">,</span> <span class="n">ab</span><span class="p">,</span> <span class="n">bt</span><span class="p">,</span> <span class="n">bb</span><span class="p">,</span> <span class="n">zt</span><span class="p">,</span> <span class="n">zb</span><span class="p">,</span> <span class="n">implementation</span><span class="o">=</span><span class="s1">&#39;vectorized&#39;</span><span class="p">)</span>

    <span class="k">else</span><span class="p">:</span><span class="c1">#default is &#39;vectorized&#39; using numpy</span>
        <span class="n">sin</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span>
        <span class="n">cos</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span>
        <span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">neig</span><span class="p">,</span> <span class="nb">float</span><span class="p">)</span>

        <span class="n">a_slope</span> <span class="o">=</span> <span class="p">(</span><span class="n">ab</span> <span class="o">-</span> <span class="n">at</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">zb</span> <span class="o">-</span> <span class="n">zt</span><span class="p">)</span>
        <span class="n">b_slope</span> <span class="o">=</span> <span class="p">(</span><span class="n">bb</span> <span class="o">-</span> <span class="n">bt</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">zb</span> <span class="o">-</span> <span class="n">zt</span><span class="p">)</span>
        <span class="n">mi</span> <span class="o">=</span> <span class="n">m</span><span class="p">[:,</span> <span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">]</span>
        <span class="n">A</span><span class="p">[:]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">b_slope</span><span class="o">*</span><span class="n">mi</span><span class="o">*</span><span class="p">(</span><span class="n">a_slope</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zt</span><span class="p">)</span><span class="o">/</span><span class="n">mi</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">sin</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zt</span><span class="p">)</span><span class="o">*</span><span class="n">at</span><span class="o">/</span><span class="n">mi</span><span class="p">)</span> <span class="o">-</span> <span class="n">b_slope</span><span class="o">*</span><span class="n">mi</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">a_slope</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">zt</span><span class="o">/</span><span class="n">mi</span> <span class="o">+</span>
            <span class="n">a_slope</span><span class="o">*</span><span class="n">zb</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">/</span><span class="n">mi</span> <span class="o">+</span> <span class="n">a_slope</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">/</span><span class="n">mi</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">sin</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">at</span><span class="o">/</span><span class="n">mi</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">mi</span> <span class="o">=</span> <span class="n">m</span>
        <span class="n">A</span><span class="p">[:]</span><span class="o">+=</span> <span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">zb</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">zt</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zt</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">*</span><span class="p">(</span><span class="n">bb</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">bt</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">*</span><span class="n">at</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">sin</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span><span class="o">*</span><span class="p">(</span><span class="n">zb</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span>
            <span class="n">zt</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">bb</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">bt</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span><span class="o">*</span><span class="n">ab</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">A</span></div>


<div class="viewcode-block" id="Eload_linear"><a class="viewcode-back" href="../../../api/geotecha.speccon.integrals.html#geotecha.speccon.integrals.Eload_linear">[docs]</a><span class="k">def</span> <span class="nf">Eload_linear</span><span class="p">(</span><span class="n">loadtim</span><span class="p">,</span> <span class="n">loadmag</span><span class="p">,</span> <span class="n">eigs</span><span class="p">,</span> <span class="n">tvals</span><span class="p">,</span> <span class="n">dT</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">implementation</span><span class="o">=</span><span class="s1">&#39;vectorized&#39;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Integration of load(tau) * exp(dT * eig * (t-tau)) between [0, t], where</span>
<span class="sd">    load(tau) is piecewise linear.</span>

<span class="sd">    Performs integrations involving a piecewise linear load.  A 2d array of</span>
<span class="sd">    dimensions A[len(tvals), len(eigs)]</span>
<span class="sd">    is produced where the &#39;i&#39;th row of A contains the diagonal elements of the</span>
<span class="sd">    spectral &#39;E&#39; matrix calculated for the time value tvals[i]. i.e. rows of</span>
<span class="sd">    this matrix will be assembled into the diagonal matrix &#39;E&#39; elsewhere.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    loadtim : 1d numpy.ndarray</span>
<span class="sd">        List of times describing load application.</span>
<span class="sd">    loadmag : 1d numpy.ndarray</span>
<span class="sd">        List of load magnitudes.</span>
<span class="sd">    eigs : 1d numpy.ndarray</span>
<span class="sd">        List of eigenvalues.</span>
<span class="sd">    tvals : 1d numpy.ndarray`</span>
<span class="sd">        List of time values to calculate integral at.</span>
<span class="sd">    dT : ``float``, optional</span>
<span class="sd">        Time factor multiple (Default dT=1.0).</span>
<span class="sd">    implementation : [&#39;vectorized&#39;, &#39;scalar&#39;, &#39;fortran&#39;], optional</span>
<span class="sd">        Functional implementation: &#39;scalar&#39; = python loops (slow),</span>
<span class="sd">        &#39;fortran&#39; = fortran code (fastest), &#39;vectorized&#39; = numpy(fast).</span>
<span class="sd">        Default implementation=&#39;vectorized&#39;.  If fortran extention module</span>
<span class="sd">        cannot be imported then &#39;vectorized&#39; version will be used.</span>
<span class="sd">        If anything other than &#39;fortran&#39; or &#39;scalar&#39; is used then</span>
<span class="sd">        default vectorized version will be used.</span>


<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    A : numpy.ndarray</span>
<span class="sd">        A 2d array of dimesnions A[len(tvals), len(eigs)] (note dtype=complex.</span>
<span class="sd">        The &#39;i&#39;th row of A is the diagonal elements of the spectral &#39;E&#39; matrix</span>
<span class="sd">        calculated for the time tvals[i].</span>


<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    Assuming the load are formulated as the product of separate time and depth</span>
<span class="sd">    dependant functions:</span>

<span class="sd">    .. math:: \\sigma\\left({Z,t}\\right)=\\sigma\\left({Z}\\right)\\sigma\\left({t}\\right)</span>

<span class="sd">    the solution to the consolidation equation using the spectral method has</span>
<span class="sd">    the form:</span>

<span class="sd">    .. math:: u\\left(Z,t\\right)=\\mathbf{\\Phi v E}\\left(\\mathbf{\\Gamma v}\\right)^{-1}\\mathbf{\\theta}</span>

<span class="sd">    The matrix :math:`E` is a time dependent diagonal matrix due to time</span>
<span class="sd">    dependant loadings.  The version of :math:`E` calculated here in</span>
<span class="sd">    `Eload_linear` is from loading terms in the governing equation that are NOT</span>
<span class="sd">    differentiated wrt :math:`t`.</span>
<span class="sd">    The diagonal elements of :math:`E` are given by:</span>

<span class="sd">    .. math:: \\mathbf{E}_{i,i}=\\int_{0}^t{{\\sigma\\left(\\tau\\right)}{\exp\\left({(dT\\left(t-\\tau\\right)\\lambda_i}\\right)}\\,d\\tau}</span>

<span class="sd">    where</span>

<span class="sd">     :math:`\\lambda_i` is the `ith` eigenvalue of the problem,</span>
<span class="sd">     :math:`dT` is a time factor for numerical convienience,</span>
<span class="sd">     :math:`\\sigma\left(\\tau\\right)` is the time dependant portion of the loading function.</span>

<span class="sd">    When the time dependant loading term :math:`\\sigma\\left(\\tau\\right)` is</span>
<span class="sd">    piecewise in time. The contribution of each load segment is found by:</span>

<span class="sd">    .. math:: \\mathbf{E}_{i,i}=\\int_{t_s}^{t_f}{{\\sigma\\left(\\tau\\right)}\\exp\\left({dT\\left(t-\\tau\\right)*\\lambda_i}\\right)\\,d\\tau}</span>

<span class="sd">    where</span>

<span class="sd">    .. math:: t_s = \\min\\left(t,t_{increment\\:start}\\right)</span>

<span class="sd">    .. math:: t_f = \\min\\left(t,t_{increment\\:end}\\right)</span>

<span class="sd">    (note that this function,`Eload_linear`, rather than use :math:`t_s` and</span>
<span class="sd">    :math:`t_f`,</span>
<span class="sd">    explicitly finds increments that the current time falls in, falls after,</span>
<span class="sd">    and falls before and treates each case on it&#39;s own.)</span>

<span class="sd">    Each :math:`t` value of interest requires a separate diagonal matrix</span>
<span class="sd">    :math:`E`.  To use space more efficiently and to facilitate numpy</span>
<span class="sd">    broadcasting when using the results of the function, the diagonal elements</span>
<span class="sd">    of :math:`E` for each time value `t` value are stored in the rows of</span>
<span class="sd">    array :math:`A` returned by `Eload_linear`.  Thus:</span>

<span class="sd">    .. math:: \\mathbf{A}=\\left(\\begin{matrix}E_{0,0}(t_0)&amp;E_{1,1}(t_0)&amp; \cdots &amp; E_{neig-1,neig-1}(t_0)\\\ E_{0,0}(t_1)&amp;E_{1,1}(t_1)&amp; \\cdots &amp; E_{neig-1,neig-1}(t_1)\\\ \\vdots&amp;\\vdots&amp;\\ddots&amp;\\vdots \\\ E_{0,0}(t_m)&amp;E_{1,1}(t_m)&amp; \cdots &amp; E_{neig-1,neig-1}(t_m)\\end{matrix}\\right)</span>


<span class="sd">    See Also</span>
<span class="sd">    --------</span>
<span class="sd">    pEload_linear : Same function with PolyLine inputs.</span>
<span class="sd">    geotecha.speccon.ext_integrals.eload_linear : Equivalent fortran function.</span>
<span class="sd">    geotecha.speccon.integrals_generate_code.Eload_linear_implementations : Generation</span>
<span class="sd">        of code for this function.</span>
<span class="sd">    Eload_coslinear : Similar function with additional cosine term.</span>
<span class="sd">    EDload_linear : Similar function but the time dependent</span>
<span class="sd">        loading function is differentiated with respect to time.</span>


<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">loadtim</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">loadtim</span><span class="p">)</span>
    <span class="n">loadmag</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">loadmag</span><span class="p">)</span>
    <span class="n">eigs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">eigs</span><span class="p">)</span>
    <span class="n">tvals</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">tvals</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">implementation</span> <span class="o">==</span> <span class="s1">&#39;scalar&#39;</span><span class="p">:</span>
        <span class="n">sin</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span>
        <span class="n">cos</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span>
        <span class="n">exp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span>

        <span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="nb">len</span><span class="p">(</span><span class="n">tvals</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">eigs</span><span class="p">)],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">complex</span><span class="p">)</span>

        <span class="p">(</span><span class="n">ramps_less_than_t</span><span class="p">,</span> <span class="n">constants_less_than_t</span><span class="p">,</span> <span class="n">steps_less_than_t</span><span class="p">,</span>
            <span class="n">ramps_containing_t</span><span class="p">,</span> <span class="n">constants_containing_t</span><span class="p">)</span> <span class="o">=</span> <span class="n">segment_containing_also_segments_less_than_xi</span><span class="p">(</span><span class="n">loadtim</span><span class="p">,</span> <span class="n">loadmag</span><span class="p">,</span> <span class="n">tvals</span><span class="p">,</span> <span class="n">steps_or_equal_to</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">tvals</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">constants_containing_t</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span>
                <span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="n">eig</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">eigs</span><span class="p">):</span>
                    <span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">+=</span> <span class="p">(</span><span class="o">-</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">))</span>
            <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">constants_less_than_t</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span>
                <span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="n">eig</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">eigs</span><span class="p">):</span>
                    <span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">+=</span> <span class="p">(</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]))</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">))</span>
            <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">ramps_containing_t</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span>
                <span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="n">eig</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">eigs</span><span class="p">):</span>
                    <span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">+=</span> <span class="p">((</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">t</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span>
                        <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">t</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span>
                        <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span>
                        <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span>
                        <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">t</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span>
                        <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">t</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span>
                        <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">+</span>
                        <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">-</span>
                        <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span>
                        <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span>
                        <span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span>
                        <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">))</span>
            <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">ramps_less_than_t</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span>
                <span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="n">eig</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">eigs</span><span class="p">):</span>
                    <span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">+=</span> <span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">t</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">t</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span>
                        <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">+</span>
                        <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">-</span>
                        <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span>
                        <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span>
                        <span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span>
                        <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span>
                        <span class="o">+</span> <span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">t</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]))</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span>
                        <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">t</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]))</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span>
                        <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">])</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]))</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span>
                        <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">])</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]))</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span>
                        <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]))</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span>
                        <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]))</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">+</span>
                        <span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]))</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span>
                        <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]))</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">))</span>
    <span class="k">elif</span> <span class="n">implementation</span> <span class="o">==</span> <span class="s1">&#39;fortran&#39;</span><span class="p">:</span>
        <span class="c1">#note than all fortran subroutines are lowercase.</span>
        <span class="k">if</span> <span class="n">MUST_TRY_FORTRAN</span><span class="p">:</span>
            <span class="kn">from</span> <span class="nn">geotecha.speccon.ext_integrals</span> <span class="k">import</span> <span class="n">eload_linear</span> <span class="k">as</span> <span class="n">fn</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="kn">from</span> <span class="nn">geotecha.speccon.ext_integrals</span> <span class="k">import</span> <span class="n">eload_linear</span> <span class="k">as</span> <span class="n">fn</span>
            <span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
                <span class="n">fn</span> <span class="o">=</span> <span class="n">Eload_linear</span>
        <span class="n">A</span> <span class="o">=</span> <span class="n">fn</span><span class="p">(</span><span class="n">loadtim</span><span class="p">,</span> <span class="n">loadmag</span><span class="p">,</span> <span class="n">eigs</span><span class="p">,</span> <span class="n">tvals</span><span class="p">,</span> <span class="n">dT</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span><span class="c1">#default is &#39;vectorized&#39; using numpy</span>
        <span class="n">sin</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span>
        <span class="n">cos</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span>
        <span class="n">exp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span>

        <span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="nb">len</span><span class="p">(</span><span class="n">tvals</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">eigs</span><span class="p">)],</span><span class="n">dtype</span><span class="o">=</span><span class="nb">complex</span><span class="p">)</span>

        <span class="p">(</span><span class="n">ramps_less_than_t</span><span class="p">,</span> <span class="n">constants_less_than_t</span><span class="p">,</span> <span class="n">steps_less_than_t</span><span class="p">,</span>
            <span class="n">ramps_containing_t</span><span class="p">,</span> <span class="n">constants_containing_t</span><span class="p">)</span> <span class="o">=</span> <span class="n">segment_containing_also_segments_less_than_xi</span><span class="p">(</span><span class="n">loadtim</span><span class="p">,</span> <span class="n">loadmag</span><span class="p">,</span> <span class="n">tvals</span><span class="p">,</span> <span class="n">steps_or_equal_to</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>

        <span class="n">eig</span> <span class="o">=</span> <span class="n">eigs</span><span class="p">[:,</span> <span class="kc">None</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">tvals</span><span class="p">):</span>
            <span class="n">k</span> <span class="o">=</span> <span class="n">constants_containing_t</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">k</span><span class="p">):</span>
                <span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:]</span> <span class="o">+=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="o">-</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

            <span class="n">k</span> <span class="o">=</span> <span class="n">constants_less_than_t</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">k</span><span class="p">):</span>
                <span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:]</span> <span class="o">+=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]))</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

            <span class="n">k</span> <span class="o">=</span> <span class="n">ramps_containing_t</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">k</span><span class="p">):</span>
                <span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:]</span> <span class="o">+=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">((</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">t</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span>
                        <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">t</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span>
                        <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span>
                        <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span>
                        <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">t</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span>
                        <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">t</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span>
                        <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">+</span>
                        <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">-</span>
                        <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span>
                        <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span>
                        <span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span>
                        <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

            <span class="n">k</span> <span class="o">=</span> <span class="n">ramps_less_than_t</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">k</span><span class="p">):</span>
                <span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:]</span> <span class="o">+=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">t</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">t</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span>
                        <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">+</span>
                        <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">-</span>
                        <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span>
                        <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span>
                        <span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span>
                        <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span>
                        <span class="o">+</span> <span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">t</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]))</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span>
                        <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">t</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]))</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span>
                        <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">])</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]))</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span>
                        <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">])</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]))</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span>
                        <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]))</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span>
                        <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]))</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">+</span>
                        <span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]))</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span>
                        <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]))</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">A</span></div>


<div class="viewcode-block" id="EDload_linear"><a class="viewcode-back" href="../../../api/geotecha.speccon.integrals.html#geotecha.speccon.integrals.EDload_linear">[docs]</a><span class="k">def</span> <span class="nf">EDload_linear</span><span class="p">(</span><span class="n">loadtim</span><span class="p">,</span> <span class="n">loadmag</span><span class="p">,</span> <span class="n">eigs</span><span class="p">,</span> <span class="n">tvals</span><span class="p">,</span> <span class="n">dT</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">implementation</span><span class="o">=</span><span class="s1">&#39;vectorized&#39;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Integration of D[load(tau), tau] * exp(dT * eig * (t-tau)) between</span>
<span class="sd">    [0, t], where load(tau) is piecewise linear.</span>

<span class="sd">    Performs integrations involving a piecewise linear load.  A 2d array of</span>
<span class="sd">    dimensions A[len(tvals), len(eigs)]</span>
<span class="sd">    is produced where the &#39;i&#39;th row of A contains the diagonal elements of the</span>
<span class="sd">    spectral &#39;E&#39; matrix calculated for the time value tvals[i]. i.e. rows of</span>
<span class="sd">    this matrix will be assembled into the diagonal matrix &#39;E&#39; elsewhere.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    loadtim : 1d numpy.ndarray</span>
<span class="sd">        List of times describing load application.</span>
<span class="sd">    loadmag : 1d numpy.ndarray</span>
<span class="sd">        List of load magnitudes.</span>
<span class="sd">    eigs : 1d numpy.ndarray</span>
<span class="sd">        List of eigenvalues.</span>
<span class="sd">    tvals : 1d numpy.ndarray`</span>
<span class="sd">        List of time values to calculate integral at.</span>
<span class="sd">    dT : ``float``, optional</span>
<span class="sd">        Time factor multiple (Default dT=1.0).</span>
<span class="sd">    implementation : [&#39;vectorized&#39;, &#39;scalar&#39;, &#39;fortran&#39;], optional</span>
<span class="sd">        Functional implementation: &#39;scalar&#39; = python loops (slow),</span>
<span class="sd">        &#39;fortran&#39; = fortran code (fastest), &#39;vectorized&#39; = numpy(fast).</span>
<span class="sd">        Default implementation=&#39;vectorized&#39;.  If fortran extention module</span>
<span class="sd">        cannot be imported then &#39;vectorized&#39; version will be used.</span>
<span class="sd">        If anything other than &#39;fortran&#39; or &#39;scalar&#39; is used then</span>
<span class="sd">        default vectorized version will be used.</span>


<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    A : numpy.ndarray</span>
<span class="sd">        A 2d array of dimesnions A[len(tvals), len(eigs)].</span>
<span class="sd">        The &#39;i&#39;th row of A is the diagonal elements of the spectral &#39;E&#39; matrix</span>
<span class="sd">        calculated for the time tvals[i].</span>


<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    Assuming the load are formulated as the product of separate time and depth</span>
<span class="sd">    dependant functions:</span>

<span class="sd">    .. math:: \\sigma\\left({Z,t}\\right)=\\sigma\\left({Z}\\right)\\sigma\\left({t}\\right)</span>

<span class="sd">    the solution to the consolidation equation using the spectral method has</span>
<span class="sd">    the form:</span>

<span class="sd">    .. math:: u\\left(Z,t\\right)=\\mathbf{\\Phi v E}\\left(\\mathbf{\\Gamma v}\\right)^{-1}\\mathbf{\\theta}</span>

<span class="sd">    The matrix :math:`E` is a time dependent diagonal matrix due to time</span>
<span class="sd">    dependant loadings.  The version of :math:`E` calculated here in</span>
<span class="sd">    `EDload_linear` is from loading terms in the governing equation that are NOT</span>
<span class="sd">    differentiated wrt :math:`t`.</span>
<span class="sd">    The diagonal elements of :math:`E` are given by:</span>

<span class="sd">    .. math:: \\mathbf{E}_{i,i}=\\int_{0}^t{\\frac{d{\\sigma\\left(\\tau\\right)}}{d\\tau}{\\exp\\left({(dT\\left(t-\\tau\\right)\\lambda_i}\\right)}\\,d\\tau}</span>

<span class="sd">    where</span>

<span class="sd">     :math:`\\lambda_i` is the `ith` eigenvalue of the problem,</span>
<span class="sd">     :math:`dT` is a time factor for numerical convienience,</span>
<span class="sd">     :math:`\\sigma\left(\\tau\\right)` is the time dependant portion of the loading function.</span>

<span class="sd">    When the time dependant loading term :math:`\\sigma\\left(\\tau\\right)` is</span>
<span class="sd">    piecewise in time. The contribution of each load segment is found by:</span>

<span class="sd">    .. math:: \\mathbf{E}_{i,i}=\\int_{t_s}^{t_f}{\\frac{d{\\sigma\\left(\\tau\\right)}}{d\\tau}\\exp\\left({dT\\left(t-\\tau\\right)*\\lambda_i}\\right)\\,d\\tau}</span>

<span class="sd">    where</span>

<span class="sd">    .. math:: t_s = \\min\\left(t,t_{increment\\:start}\\right)</span>

<span class="sd">    .. math:: t_f = \\min\\left(t,t_{increment\\:end}\\right)</span>

<span class="sd">    (note that this function,`EDload_linear`, rather than use :math:`t_s` and</span>
<span class="sd">    :math:`t_f`,</span>
<span class="sd">    explicitly finds increments that the current time falls in, falls after,</span>
<span class="sd">    and falls before and treates each case on it&#39;s own.)</span>

<span class="sd">    Each :math:`t` value of interest requires a separate diagonal matrix</span>
<span class="sd">    :math:`E`.  To use space more efficiently and to facilitate numpy</span>
<span class="sd">    broadcasting when using the results of the function, the diagonal elements</span>
<span class="sd">    of :math:`E` for each time value `t` value are stored in the rows of</span>
<span class="sd">    array :math:`A` returned by `EDload_linear`.  Thus:</span>

<span class="sd">    .. math:: \\mathbf{A}=\\left(\\begin{matrix}E_{0,0}(t_0)&amp;E_{1,1}(t_0)&amp; \cdots &amp; E_{neig-1,neig-1}(t_0)\\\ E_{0,0}(t_1)&amp;E_{1,1}(t_1)&amp; \\cdots &amp; E_{neig-1,neig-1}(t_1)\\\ \\vdots&amp;\\vdots&amp;\\ddots&amp;\\vdots \\\ E_{0,0}(t_m)&amp;E_{1,1}(t_m)&amp; \cdots &amp; E_{neig-1,neig-1}(t_m)\\end{matrix}\\right)</span>


<span class="sd">    See Also</span>
<span class="sd">    --------</span>
<span class="sd">    pEDload_linear : Same function with PolyLine inputs.</span>
<span class="sd">    geotecha.speccon.ext_integrals.edload_linear : Equivalent fortran function.</span>
<span class="sd">    geotecha.speccon.integrals_generate_code.EDload_linear_implementations : Generation</span>
<span class="sd">        of code for this function.</span>
<span class="sd">    EDload_coslinear : Similar function with additional cosine term.</span>
<span class="sd">    Eload_linear : Similar function but the time dependent loading function</span>
<span class="sd">        is not differentiated with repect to time.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">loadtim</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">loadtim</span><span class="p">)</span>
    <span class="n">loadmag</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">loadmag</span><span class="p">)</span>
    <span class="n">eigs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">eigs</span><span class="p">)</span>
    <span class="n">tvals</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">tvals</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">implementation</span> <span class="o">==</span> <span class="s1">&#39;scalar&#39;</span><span class="p">:</span>
        <span class="n">sin</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">sin</span>
        <span class="n">cos</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">cos</span>
        <span class="n">exp</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">exp</span>

        <span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="nb">len</span><span class="p">(</span><span class="n">tvals</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">eigs</span><span class="p">)])</span>

        <span class="p">(</span><span class="n">ramps_less_than_t</span><span class="p">,</span> <span class="n">constants_less_than_t</span><span class="p">,</span> <span class="n">steps_less_than_t</span><span class="p">,</span>
            <span class="n">ramps_containing_t</span><span class="p">,</span> <span class="n">constants_containing_t</span><span class="p">)</span> <span class="o">=</span> <span class="n">segment_containing_also_segments_less_than_xi</span><span class="p">(</span><span class="n">loadtim</span><span class="p">,</span> <span class="n">loadmag</span><span class="p">,</span> <span class="n">tvals</span><span class="p">,</span> <span class="n">steps_or_equal_to</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">tvals</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">steps_less_than_t</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span>
                <span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="n">eig</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">eigs</span><span class="p">):</span>
                    <span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">+=</span> <span class="p">(</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="p">(</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span>
            <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">ramps_containing_t</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span>
                <span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="n">eig</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">eigs</span><span class="p">):</span>
                    <span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">+=</span> <span class="p">((</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="p">(</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">-</span>
                        <span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">))</span>
            <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">ramps_less_than_t</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span>
                <span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="n">eig</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">eigs</span><span class="p">):</span>
                    <span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">+=</span> <span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="p">(</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">-</span>
                        <span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]))</span><span class="o">*</span><span class="p">(</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">))</span>

    <span class="k">elif</span> <span class="n">implementation</span> <span class="o">==</span> <span class="s1">&#39;fortran&#39;</span><span class="p">:</span>
        <span class="c1">#note than all fortran subroutines are lowercase.</span>
        <span class="k">if</span> <span class="n">MUST_TRY_FORTRAN</span><span class="p">:</span>
            <span class="kn">from</span> <span class="nn">geotecha.speccon.ext_integrals</span> <span class="k">import</span> <span class="n">edload_linear</span> <span class="k">as</span> <span class="n">fn</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="kn">from</span> <span class="nn">geotecha.speccon.ext_integrals</span> <span class="k">import</span> <span class="n">edload_linear</span> <span class="k">as</span> <span class="n">fn</span>
            <span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
                <span class="n">fn</span> <span class="o">=</span> <span class="n">EDload_linear</span>
        <span class="n">A</span> <span class="o">=</span> <span class="n">fn</span><span class="p">(</span><span class="n">loadtim</span><span class="p">,</span> <span class="n">loadmag</span><span class="p">,</span> <span class="n">eigs</span><span class="p">,</span> <span class="n">tvals</span><span class="p">,</span> <span class="n">dT</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span><span class="c1">#default is &#39;vectorized&#39; using numpy</span>
        <span class="n">sin</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span>
        <span class="n">cos</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span>
        <span class="n">exp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span>

        <span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="nb">len</span><span class="p">(</span><span class="n">tvals</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">eigs</span><span class="p">)])</span>

        <span class="p">(</span><span class="n">ramps_less_than_t</span><span class="p">,</span> <span class="n">constants_less_than_t</span><span class="p">,</span> <span class="n">steps_less_than_t</span><span class="p">,</span>
            <span class="n">ramps_containing_t</span><span class="p">,</span> <span class="n">constants_containing_t</span><span class="p">)</span> <span class="o">=</span> <span class="n">segment_containing_also_segments_less_than_xi</span><span class="p">(</span><span class="n">loadtim</span><span class="p">,</span> <span class="n">loadmag</span><span class="p">,</span> <span class="n">tvals</span><span class="p">,</span> <span class="n">steps_or_equal_to</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>

        <span class="n">eig</span> <span class="o">=</span> <span class="n">eigs</span><span class="p">[:,</span> <span class="kc">None</span><span class="p">]</span>


        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">tvals</span><span class="p">):</span>
            <span class="n">k</span> <span class="o">=</span> <span class="n">steps_less_than_t</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">k</span><span class="p">):</span>
                <span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:]</span> <span class="o">+=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="p">(</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
            <span class="n">k</span> <span class="o">=</span> <span class="n">ramps_containing_t</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">k</span><span class="p">):</span>
                <span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:]</span> <span class="o">+=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">((</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="p">(</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">-</span>
                        <span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
            <span class="n">k</span> <span class="o">=</span> <span class="n">ramps_less_than_t</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">k</span><span class="p">):</span>
                <span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:]</span> <span class="o">+=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="p">(</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">-</span>
                        <span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]))</span><span class="o">*</span><span class="p">(</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">A</span></div>



<div class="viewcode-block" id="Eload_coslinear"><a class="viewcode-back" href="../../../api/geotecha.speccon.integrals.html#geotecha.speccon.integrals.Eload_coslinear">[docs]</a><span class="k">def</span> <span class="nf">Eload_coslinear</span><span class="p">(</span><span class="n">loadtim</span><span class="p">,</span> <span class="n">loadmag</span><span class="p">,</span> <span class="n">omega</span><span class="p">,</span> <span class="n">phase</span><span class="p">,</span> <span class="n">eigs</span><span class="p">,</span> <span class="n">tvals</span><span class="p">,</span> <span class="n">dT</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">implementation</span><span class="o">=</span><span class="s1">&#39;vectorized&#39;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Integration of cos(omega*tau+phase)*load(tau) * exp(dT * eig * (t-tau)) between [0, t], where</span>
<span class="sd">    load(tau) is piecewise linear.</span>

<span class="sd">    Performs integrations involving a piecewise linear load.  A 2d array of</span>
<span class="sd">    dimensions A[len(tvals), len(eigs)]</span>
<span class="sd">    is produced where the &#39;i&#39;th row of A contains the diagonal elements of the</span>
<span class="sd">    spectral &#39;E&#39; matrix calculated for the time value tvals[i]. i.e. rows of</span>
<span class="sd">    this matrix will be assembled into the diagonal matrix &#39;E&#39; elsewhere.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    loadtim : 1d numpy.ndarray</span>
<span class="sd">        List of times describing load application.</span>
<span class="sd">    loadmag : 1d numpy.ndarray</span>
<span class="sd">        List of load magnitudes.</span>
<span class="sd">    omega, phase : float</span>
<span class="sd">        Parameters that describe a cyclic load cos(omega * t + phase).</span>
<span class="sd">    eigs : 1d numpy.ndarray</span>
<span class="sd">        List of eigenvalues.</span>
<span class="sd">    tvals : 1d numpy.ndarray`</span>
<span class="sd">        List of time values to calculate integral at.</span>
<span class="sd">    dT : ``float``, optional</span>
<span class="sd">        Time factor multiple (Default dT=1.0).</span>
<span class="sd">    implementation : [&#39;vectorized&#39;, &#39;scalar&#39;, &#39;fortran&#39;], optional</span>
<span class="sd">        Functional implementation: &#39;scalar&#39; = python loops (slow),</span>
<span class="sd">        &#39;fortran&#39; = fortran code (fastest), &#39;vectorized&#39; = numpy(fast).</span>
<span class="sd">        Default implementation=&#39;vectorized&#39;.  If fortran extention module</span>
<span class="sd">        cannot be imported then &#39;vectorized&#39; version will be used.</span>
<span class="sd">        If anything other than &#39;fortran&#39; or &#39;scalar&#39; is used then</span>
<span class="sd">        default vectorized version will be used.</span>


<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    A : numpy.ndarray</span>
<span class="sd">        A 2d array of dimesnions A[len(tvals), len(eigs)].</span>
<span class="sd">        The &#39;i&#39;th row of A is the diagonal elements of the spectral &#39;E&#39; matrix</span>
<span class="sd">        calculated for the time tvals[i].</span>


<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    Assuming the load are formulated as the product of separate time and depth</span>
<span class="sd">    dependant functions:</span>

<span class="sd">    .. math:: \\sigma\\left({Z,t}\\right)=\\sigma\\left({Z}\\right)\\sigma\\left({t}\\right)</span>

<span class="sd">    the solution to the consolidation equation using the spectral method has</span>
<span class="sd">    the form:</span>

<span class="sd">    .. math:: u\\left(Z,t\\right)=\\mathbf{\\Phi v E}\\left(\\mathbf{\\Gamma v}\\right)^{-1}\\mathbf{\\theta}</span>

<span class="sd">    The matrix :math:`E` is a time dependent diagonal matrix due to time</span>
<span class="sd">    dependant loadings.  The version of :math:`E` calculated here in</span>
<span class="sd">    `Eload_coslinear` is from loading terms in the governing equation that are NOT</span>
<span class="sd">    differentiated wrt :math:`t`.</span>
<span class="sd">    The diagonal elements of :math:`E` are given by:</span>

<span class="sd">    .. math:: \\mathbf{E}_{i,i}=\\int_{0}^t{{\\cos\\left(\\omega\\tau+\\textrm{phase}\\right)}{\\sigma\\left(\\tau\\right)}{\exp\\left({(dT\\left(t-\\tau\\right)\\lambda_i}\\right)}\\,d\\tau}</span>

<span class="sd">    where</span>

<span class="sd">     :math:`\\lambda_i` is the `ith` eigenvalue of the problem,</span>
<span class="sd">     :math:`dT` is a time factor for numerical convienience,</span>
<span class="sd">     :math:`\\sigma\left(\\tau\\right)` is the time dependant portion of the loading function.</span>

<span class="sd">    When the time dependant loading term :math:`\\sigma\\left(\\tau\\right)` is</span>
<span class="sd">    piecewise in time. The contribution of each load segment is found by:</span>

<span class="sd">    .. math:: \\mathbf{E}_{i,i}=\\int_{t_s}^{t_f}{{\\cos\\left(\\omega\\tau+\\textrm{phase}\\right)}{\\sigma\\left(\\tau\\right)}\\exp\\left({dT\\left(t-\\tau\\right)*\\lambda_i}\\right)\\,d\\tau}</span>

<span class="sd">    where</span>

<span class="sd">    .. math:: t_s = \\min\\left(t,t_{increment\\:start}\\right)</span>

<span class="sd">    .. math:: t_f = \\min\\left(t,t_{increment\\:end}\\right)</span>

<span class="sd">    (note that this function,`Eload_coslinear`, rather than use :math:`t_s` and</span>
<span class="sd">    :math:`t_f`,</span>
<span class="sd">    explicitly finds increments that the current time falls in, falls after,</span>
<span class="sd">    and falls before and treates each case on it&#39;s own.)</span>

<span class="sd">    Each :math:`t` value of interest requires a separate diagonal matrix</span>
<span class="sd">    :math:`E`.  To use space more efficiently and to facilitate numpy</span>
<span class="sd">    broadcasting when using the results of the function, the diagonal elements</span>
<span class="sd">    of :math:`E` for each time value `t` value are stored in the rows of</span>
<span class="sd">    array :math:`A` returned by `Eload_coslinear`.  Thus:</span>

<span class="sd">    .. math:: \\mathbf{A}=\\left(\\begin{matrix}E_{0,0}(t_0)&amp;E_{1,1}(t_0)&amp; \cdots &amp; E_{neig-1,neig-1}(t_0)\\\ E_{0,0}(t_1)&amp;E_{1,1}(t_1)&amp; \\cdots &amp; E_{neig-1,neig-1}(t_1)\\\ \\vdots&amp;\\vdots&amp;\\ddots&amp;\\vdots \\\ E_{0,0}(t_m)&amp;E_{1,1}(t_m)&amp; \cdots &amp; E_{neig-1,neig-1}(t_m)\\end{matrix}\\right)</span>

<span class="sd">    See Also</span>
<span class="sd">    --------</span>
<span class="sd">    pEload_coslinear : Same function with PolyLine inputs.</span>
<span class="sd">    geotecha.speccon.ext_integrals.eload_coslinear : Equivalent fortran function.</span>
<span class="sd">    geotecha.speccon.integrals_generate_code.Eload_coslinear_implementations : Generation</span>
<span class="sd">        of code for this function.</span>
<span class="sd">    Eload_linear : Similar function with no cosine term.</span>
<span class="sd">    EDload_coslinear : Similar function but the combined</span>
<span class="sd">        loading function is differentiated with respect to time.</span>


<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">loadtim</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">loadtim</span><span class="p">)</span>
    <span class="n">loadmag</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">loadmag</span><span class="p">)</span>
    <span class="n">eigs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">eigs</span><span class="p">)</span>
    <span class="n">tvals</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">tvals</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">implementation</span> <span class="o">==</span> <span class="s1">&#39;scalar&#39;</span><span class="p">:</span>
        <span class="n">sin</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">sin</span>
        <span class="n">cos</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">cos</span>
        <span class="n">exp</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">exp</span>

        <span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="nb">len</span><span class="p">(</span><span class="n">tvals</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">eigs</span><span class="p">)])</span>

        <span class="p">(</span><span class="n">ramps_less_than_t</span><span class="p">,</span> <span class="n">constants_less_than_t</span><span class="p">,</span> <span class="n">steps_less_than_t</span><span class="p">,</span>
            <span class="n">ramps_containing_t</span><span class="p">,</span> <span class="n">constants_containing_t</span><span class="p">)</span> <span class="o">=</span> <span class="n">segment_containing_also_segments_less_than_xi</span><span class="p">(</span><span class="n">loadtim</span><span class="p">,</span> <span class="n">loadmag</span><span class="p">,</span> <span class="n">tvals</span><span class="p">,</span> <span class="n">steps_or_equal_to</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">tvals</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">constants_containing_t</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span>
                <span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="n">eig</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">eigs</span><span class="p">):</span>
                    <span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">+=</span> <span class="p">((</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span> <span class="o">+</span> <span class="n">omega</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">2</span><span class="p">))))</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span> <span class="o">+</span> <span class="n">omega</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">2</span><span class="p">))))</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">))</span>
            <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">constants_less_than_t</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span>
                <span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="n">eig</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">eigs</span><span class="p">):</span>
                    <span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">+=</span> <span class="p">((</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]))</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span> <span class="o">+</span> <span class="n">omega</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]))</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">2</span><span class="p">))))</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span> <span class="o">+</span> <span class="n">omega</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">2</span><span class="p">))))</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">))</span>
            <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">ramps_containing_t</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span>
                <span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="n">eig</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">eigs</span><span class="p">):</span>
                    <span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">+=</span> <span class="p">((</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">t</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span>
                        <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">t</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
                        <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">+</span>
                        <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">+</span>
                        <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">*</span><span class="n">t</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">*</span><span class="n">t</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">+</span>
                        <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">+</span> <span class="n">omega</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">+</span>
                        <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">+</span>
                        <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span>
                        <span class="o">-</span> <span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">t</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
                        <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">t</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
                        <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span>
                        <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span>
                        <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">t</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
                        <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">t</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
                        <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span>
                        <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span>
                        <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span>
                        <span class="o">-</span> <span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">t</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span>
                        <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">t</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span>
                        <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">+</span>
                        <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span>
                        <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">+</span>
                        <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">*</span><span class="n">t</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span>
                        <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span>
                        <span class="o">+</span> <span class="n">omega</span><span class="o">*</span><span class="n">t</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span>
                        <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span>
                        <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span>
                        <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span>
                        <span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span>
                        <span class="o">-</span> <span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">t</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">t</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span>
                        <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span>
                        <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span>
                        <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span>
                        <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">t</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span>
                        <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">omega</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">t</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span>
                        <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">omega</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span>
                        <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span>
                        <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span>
                        <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span>
                        <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">omega</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">))</span>
            <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">ramps_less_than_t</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span>
                <span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="n">eig</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">eigs</span><span class="p">):</span>
                    <span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">+=</span> <span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">t</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span>
                        <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">t</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span>
                        <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">+</span>
                        <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span>
                        <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">+</span>
                        <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">*</span><span class="n">t</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span>
                        <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span>
                        <span class="o">+</span> <span class="n">omega</span><span class="o">*</span><span class="n">t</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span>
                        <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span>
                        <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span>
                        <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span>
                        <span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span>
                        <span class="o">-</span> <span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">t</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">t</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span>
                        <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span>
                        <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span>
                        <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span>
                        <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">t</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span>
                        <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">omega</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">t</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span>
                        <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">omega</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span>
                        <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span>
                        <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span>
                        <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span>
                        <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">omega</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">t</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]))</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span>
                        <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">t</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span>
                        <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]))</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span>
                        <span class="o">+</span> <span class="mi">1</span><span class="p">])</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]))</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span> <span class="o">+</span>
                        <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]))</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span>
                        <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]))</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span>
                        <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]))</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">*</span><span class="n">t</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]))</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span>
                        <span class="o">+</span> <span class="mi">1</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">*</span><span class="n">t</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]))</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span>
                        <span class="o">+</span> <span class="mi">1</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">+</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span>
                        <span class="o">+</span> <span class="mi">1</span><span class="p">])</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]))</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]))</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">+</span> <span class="n">omega</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span>
                        <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]))</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span> <span class="o">+</span>
                        <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]))</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">+</span> <span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]))</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span>
                        <span class="o">-</span> <span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]))</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">t</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span>
                        <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]))</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">t</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span>
                        <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]))</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="n">t</span>
                        <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span> <span class="o">+</span>
                        <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]))</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span>
                        <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span> <span class="o">+</span>
                        <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]))</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span>
                        <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]))</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span> <span class="o">+</span>
                        <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]))</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span>
                        <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]))</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span>
                        <span class="o">+</span> <span class="mi">1</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]))</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span>
                        <span class="o">+</span> <span class="mi">1</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">t</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]))</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">t</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]))</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]))</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span>
                        <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span>
                        <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]))</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span>
                        <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span>
                        <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]))</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span>
                        <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]))</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span>
                        <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]))</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]))</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">))</span>
    <span class="k">elif</span> <span class="n">implementation</span> <span class="o">==</span> <span class="s1">&#39;fortran&#39;</span><span class="p">:</span>
        <span class="c1">#note than all fortran subroutines are lowercase.</span>
        <span class="k">if</span> <span class="n">MUST_TRY_FORTRAN</span><span class="p">:</span>
            <span class="kn">from</span> <span class="nn">geotecha.speccon.ext_integrals</span> <span class="k">import</span> <span class="n">eload_coslinear</span> <span class="k">as</span> <span class="n">fn</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="kn">from</span> <span class="nn">geotecha.speccon.ext_integrals</span> <span class="k">import</span> <span class="n">eload_coslinear</span> <span class="k">as</span> <span class="n">fn</span>
            <span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
                <span class="n">fn</span> <span class="o">=</span> <span class="n">Eload_coslinear</span>
        <span class="n">A</span> <span class="o">=</span> <span class="n">fn</span><span class="p">(</span><span class="n">loadtim</span><span class="p">,</span> <span class="n">loadmag</span><span class="p">,</span> <span class="n">omega</span><span class="p">,</span> <span class="n">phase</span><span class="p">,</span> <span class="n">eigs</span><span class="p">,</span> <span class="n">tvals</span><span class="p">,</span> <span class="n">dT</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span><span class="c1">#default is &#39;vectorized&#39; using numpy</span>
        <span class="n">sin</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span>
        <span class="n">cos</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span>
        <span class="n">exp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span>

        <span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="nb">len</span><span class="p">(</span><span class="n">tvals</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">eigs</span><span class="p">)])</span>

        <span class="p">(</span><span class="n">ramps_less_than_t</span><span class="p">,</span> <span class="n">constants_less_than_t</span><span class="p">,</span> <span class="n">steps_less_than_t</span><span class="p">,</span>
            <span class="n">ramps_containing_t</span><span class="p">,</span> <span class="n">constants_containing_t</span><span class="p">)</span> <span class="o">=</span> <span class="n">segment_containing_also_segments_less_than_xi</span><span class="p">(</span><span class="n">loadtim</span><span class="p">,</span> <span class="n">loadmag</span><span class="p">,</span> <span class="n">tvals</span><span class="p">,</span> <span class="n">steps_or_equal_to</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>

        <span class="n">eig</span> <span class="o">=</span> <span class="n">eigs</span><span class="p">[:,</span> <span class="kc">None</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">tvals</span><span class="p">):</span>
            <span class="n">k</span> <span class="o">=</span> <span class="n">constants_containing_t</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">k</span><span class="p">):</span>
                <span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:]</span> <span class="o">+=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">((</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span> <span class="o">+</span> <span class="n">omega</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">2</span><span class="p">))))</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span> <span class="o">+</span> <span class="n">omega</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">2</span><span class="p">))))</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

            <span class="n">k</span> <span class="o">=</span> <span class="n">constants_less_than_t</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">k</span><span class="p">):</span>
                <span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:]</span> <span class="o">+=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">((</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]))</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span> <span class="o">+</span> <span class="n">omega</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]))</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">2</span><span class="p">))))</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span> <span class="o">+</span> <span class="n">omega</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">2</span><span class="p">))))</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

            <span class="n">k</span> <span class="o">=</span> <span class="n">ramps_containing_t</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">k</span><span class="p">):</span>
                <span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:]</span> <span class="o">+=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">((</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">t</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span>
                        <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">t</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
                        <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">+</span>
                        <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">+</span>
                        <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">*</span><span class="n">t</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">*</span><span class="n">t</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">+</span>
                        <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">+</span> <span class="n">omega</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">+</span>
                        <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">+</span>
                        <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span>
                        <span class="o">-</span> <span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">t</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
                        <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">t</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
                        <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span>
                        <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span>
                        <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">t</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
                        <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">t</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
                        <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span>
                        <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span>
                        <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span>
                        <span class="o">-</span> <span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">t</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span>
                        <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">t</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span>
                        <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">+</span>
                        <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span>
                        <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">+</span>
                        <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">*</span><span class="n">t</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span>
                        <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span>
                        <span class="o">+</span> <span class="n">omega</span><span class="o">*</span><span class="n">t</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span>
                        <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span>
                        <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span>
                        <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span>
                        <span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span>
                        <span class="o">-</span> <span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">t</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">t</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span>
                        <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span>
                        <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span>
                        <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span>
                        <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">t</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span>
                        <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">omega</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">t</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span>
                        <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">omega</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span>
                        <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span>
                        <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span>
                        <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span>
                        <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">omega</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

            <span class="n">k</span> <span class="o">=</span> <span class="n">ramps_less_than_t</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">k</span><span class="p">):</span>
                <span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:]</span> <span class="o">+=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">t</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span>
                        <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">t</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span>
                        <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">+</span>
                        <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span>
                        <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">+</span>
                        <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">*</span><span class="n">t</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span>
                        <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span>
                        <span class="o">+</span> <span class="n">omega</span><span class="o">*</span><span class="n">t</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span>
                        <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span>
                        <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span>
                        <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span>
                        <span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span>
                        <span class="o">-</span> <span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">t</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">t</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span>
                        <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span>
                        <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span>
                        <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span>
                        <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">t</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span>
                        <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">omega</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">t</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span>
                        <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">omega</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span>
                        <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span>
                        <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span>
                        <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span>
                        <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">omega</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">t</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]))</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span>
                        <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">t</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span>
                        <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]))</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span>
                        <span class="o">+</span> <span class="mi">1</span><span class="p">])</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]))</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span> <span class="o">+</span>
                        <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]))</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span>
                        <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]))</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span>
                        <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]))</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">*</span><span class="n">t</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]))</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span>
                        <span class="o">+</span> <span class="mi">1</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">*</span><span class="n">t</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]))</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span>
                        <span class="o">+</span> <span class="mi">1</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">+</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span>
                        <span class="o">+</span> <span class="mi">1</span><span class="p">])</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]))</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]))</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">+</span> <span class="n">omega</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span>
                        <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]))</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span> <span class="o">+</span>
                        <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]))</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">+</span> <span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]))</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span>
                        <span class="o">-</span> <span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]))</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">t</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span>
                        <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]))</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">t</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span>
                        <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]))</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="n">t</span>
                        <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span> <span class="o">+</span>
                        <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]))</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span>
                        <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span> <span class="o">+</span>
                        <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]))</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span>
                        <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]))</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span> <span class="o">+</span>
                        <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]))</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span>
                        <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]))</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span>
                        <span class="o">+</span> <span class="mi">1</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]))</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span>
                        <span class="o">+</span> <span class="mi">1</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">t</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]))</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">t</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]))</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]))</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span>
                        <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span>
                        <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]))</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span>
                        <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span>
                        <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]))</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span>
                        <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]))</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span>
                        <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]))</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]))</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">A</span></div>


<div class="viewcode-block" id="EDload_coslinear"><a class="viewcode-back" href="../../../api/geotecha.speccon.integrals.html#geotecha.speccon.integrals.EDload_coslinear">[docs]</a><span class="k">def</span> <span class="nf">EDload_coslinear</span><span class="p">(</span><span class="n">loadtim</span><span class="p">,</span> <span class="n">loadmag</span><span class="p">,</span> <span class="n">omega</span><span class="p">,</span> <span class="n">phase</span><span class="p">,</span><span class="n">eigs</span><span class="p">,</span> <span class="n">tvals</span><span class="p">,</span> <span class="n">dT</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">implementation</span><span class="o">=</span><span class="s1">&#39;vectorized&#39;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Integration of D[cos(omega*tau+phase)*load(tau), tau] * exp(dT * eig * (t-tau)) between [0, t], where</span>
<span class="sd">    load(tau) is piecewise linear.</span>

<span class="sd">    Performs integrations involving a piecewise linear load.  A 2d array of</span>
<span class="sd">    dimensions A[len(tvals), len(eigs)]</span>
<span class="sd">    is produced where the &#39;i&#39;th row of A contains the diagonal elements of the</span>
<span class="sd">    spectral &#39;E&#39; matrix calculated for the time value tvals[i]. i.e. rows of</span>
<span class="sd">    this matrix will be assembled into the diagonal matrix &#39;E&#39; elsewhere.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    loadtim : 1d numpy.ndarray</span>
<span class="sd">        List of times describing load application.</span>
<span class="sd">    loadmag : 1d numpy.ndarray</span>
<span class="sd">        List of load magnitudes.</span>
<span class="sd">    omega, phase : float</span>
<span class="sd">        Parameters that describe a cyclic load cos(omega * t + phase).</span>
<span class="sd">    eigs : 1d numpy.ndarray</span>
<span class="sd">        List of eigenvalues.</span>
<span class="sd">    tvals : 1d numpy.ndarray`</span>
<span class="sd">        List of time values to calculate integral at.</span>
<span class="sd">    dT : ``float``, optional</span>
<span class="sd">        Time factor multiple (Default dT=1.0).</span>
<span class="sd">    implementation : [&#39;vectorized&#39;, &#39;scalar&#39;, &#39;fortran&#39;], optional</span>
<span class="sd">        Functional implementation: &#39;scalar&#39; = python loops (slow),</span>
<span class="sd">        &#39;fortran&#39; = fortran code (fastest), &#39;vectorized&#39; = numpy(fast).</span>
<span class="sd">        Default implementation=&#39;vectorized&#39;.  If fortran extention module</span>
<span class="sd">        cannot be imported then &#39;vectorized&#39; version will be used.</span>
<span class="sd">        If anything other than &#39;fortran&#39; or &#39;scalar&#39; is used then</span>
<span class="sd">        default vectorized version will be used.</span>


<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    A : numpy.ndarray</span>
<span class="sd">        A 2d array of dimesnions A[len(tvals), len(eigs)].</span>
<span class="sd">        The &#39;i&#39;th row of A is the diagonal elements of the spectral &#39;E&#39; matrix</span>
<span class="sd">        calculated for the time tvals[i].</span>


<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    Assuming the load are formulated as the product of separate time and depth</span>
<span class="sd">    dependant functions:</span>

<span class="sd">    .. math:: \\sigma\\left({Z,t}\\right)=\\sigma\\left({Z}\\right)\\sigma\\left({t}\\right)</span>

<span class="sd">    the solution to the consolidation equation using the spectral method has</span>
<span class="sd">    the form:</span>

<span class="sd">    .. math:: u\\left(Z,t\\right)=\\mathbf{\\Phi v E}\\left(\\mathbf{\\Gamma v}\\right)^{-1}\\mathbf{\\theta}</span>

<span class="sd">    The matrix :math:`E` is a time dependent diagonal matrix due to time</span>
<span class="sd">    dependant loadings.  The version of :math:`E` calculated here in</span>
<span class="sd">    `EDload_coslinear` is from loading terms in the governing equation that are NOT</span>
<span class="sd">    differentiated wrt :math:`t`.</span>
<span class="sd">    The diagonal elements of :math:`E` are given by:</span>

<span class="sd">    .. math:: \\mathbf{E}_{i,i}=\\int_{0}^t{\\frac{d{{\\cos\\left(\\omega\\tau+\\textrm{phase}\\right)}\\sigma\\left(\\tau\\right)}}{d\\tau}{\\exp\\left({(dT\\left(t-\\tau\\right)\\lambda_i}\\right)}\\,d\\tau}</span>

<span class="sd">    where</span>

<span class="sd">     :math:`\\lambda_i` is the `ith` eigenvalue of the problem,</span>
<span class="sd">     :math:`dT` is a time factor for numerical convienience,</span>
<span class="sd">     :math:`\\sigma\left(\\tau\\right)` is the time dependant portion of the loading function.</span>

<span class="sd">    When the time dependant loading term :math:`\\sigma\\left(\\tau\\right)` is</span>
<span class="sd">    piecewise in time. The contribution of each load segment is found by:</span>

<span class="sd">    .. math:: \\mathbf{E}_{i,i}=\\int_{t_s}^{t_f}{\\frac{d{{\\cos\\left(\\omega\\tau+\\textrm{phase}\\right)}\\sigma\\left(\\tau\\right)}}{d\\tau}\\exp\\left({dT\\left(t-\\tau\\right)*\\lambda_i}\\right)\\,d\\tau}</span>

<span class="sd">    where</span>

<span class="sd">    .. math:: t_s = \\min\\left(t,t_{increment\\:start}\\right)</span>

<span class="sd">    .. math:: t_f = \\min\\left(t,t_{increment\\:end}\\right)</span>

<span class="sd">    (note that this function,`EDload_coslinear`, rather than use :math:`t_s` and</span>
<span class="sd">    :math:`t_f`,</span>
<span class="sd">    explicitly finds increments that the current time falls in, falls after,</span>
<span class="sd">    and falls before and treates each case on it&#39;s own.)</span>

<span class="sd">    Each :math:`t` value of interest requires a separate diagonal matrix</span>
<span class="sd">    :math:`E`.  To use space more efficiently and to facilitate numpy</span>
<span class="sd">    broadcasting when using the results of the function, the diagonal elements</span>
<span class="sd">    of :math:`E` for each time value `t` value are stored in the rows of</span>
<span class="sd">    array :math:`A` returned by `EDload_coslinear`.  Thus:</span>

<span class="sd">    .. math:: \\mathbf{A}=\\left(\\begin{matrix}E_{0,0}(t_0)&amp;E_{1,1}(t_0)&amp; \cdots &amp; E_{neig-1,neig-1}(t_0)\\\ E_{0,0}(t_1)&amp;E_{1,1}(t_1)&amp; \\cdots &amp; E_{neig-1,neig-1}(t_1)\\\ \\vdots&amp;\\vdots&amp;\\ddots&amp;\\vdots \\\ E_{0,0}(t_m)&amp;E_{1,1}(t_m)&amp; \cdots &amp; E_{neig-1,neig-1}(t_m)\\end{matrix}\\right)</span>

<span class="sd">    See Also</span>
<span class="sd">    --------</span>
<span class="sd">    pEDload_coslinear : Same function with PolyLine inputs.</span>
<span class="sd">    geotecha.speccon.ext_integrals.edload_coslinear : Equivalent fortran function.</span>
<span class="sd">    geotecha.speccon.integrals_generate_code.EDload_coslinear_implementations : Generation</span>
<span class="sd">        of code for this function.</span>
<span class="sd">    EDload_linear : Similar function with no cosine term.</span>
<span class="sd">    Eload_coslinear : Similar function but the combined</span>
<span class="sd">        loading function is not differentiated with respect to time.</span>


<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">loadtim</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">loadtim</span><span class="p">)</span>
    <span class="n">loadmag</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">loadmag</span><span class="p">)</span>
    <span class="n">eigs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">eigs</span><span class="p">)</span>
    <span class="n">tvals</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">tvals</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">implementation</span> <span class="o">==</span> <span class="s1">&#39;scalar&#39;</span><span class="p">:</span>
        <span class="n">sin</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">sin</span>
        <span class="n">cos</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">cos</span>
        <span class="n">exp</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">exp</span>

        <span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="nb">len</span><span class="p">(</span><span class="n">tvals</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">eigs</span><span class="p">)])</span>

        <span class="p">(</span><span class="n">ramps_less_than_t</span><span class="p">,</span> <span class="n">constants_less_than_t</span><span class="p">,</span> <span class="n">steps_less_than_t</span><span class="p">,</span>
            <span class="n">ramps_containing_t</span><span class="p">,</span> <span class="n">constants_containing_t</span><span class="p">)</span> <span class="o">=</span> <span class="n">segment_containing_also_segments_less_than_xi</span><span class="p">(</span><span class="n">loadtim</span><span class="p">,</span> <span class="n">loadmag</span><span class="p">,</span> <span class="n">tvals</span><span class="p">,</span> <span class="n">steps_or_equal_to</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">tvals</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">steps_less_than_t</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span>
                <span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="n">eig</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">eigs</span><span class="p">):</span>
                    <span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">+=</span> <span class="p">(</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="p">(</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span>
            <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">ramps_containing_t</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span>
                <span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="n">eig</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">eigs</span><span class="p">):</span>
                    <span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">+=</span> <span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span>
                        <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="n">t</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">*</span><span class="n">t</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span>
                        <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span>
                        <span class="o">+</span> <span class="n">omega</span><span class="o">*</span><span class="n">t</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span>
                        <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span>
                        <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span>
                        <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">+</span>
                        <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span>
                        <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">-</span>
                        <span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">+</span>
                        <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">+</span>
                        <span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span>
                        <span class="o">-</span> <span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">t</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
                        <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">t</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
                        <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">t</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">t</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span>
                        <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span>
                        <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span>
                        <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span>
                        <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span>
                        <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span>
                        <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="n">omega</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">t</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">+</span>
                        <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">t</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span>
                        <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">t</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">omega</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">t</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span>
                        <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">omega</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span>
                        <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span>
                        <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span>
                        <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span>
                        <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span>
                        <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">omega</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span>
                        <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span>
                        <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
                        <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">t</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span>
                        <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">t</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
                        <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">t</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">t</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span>
                        <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span>
                        <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span>
                        <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span>
                        <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span>
            <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">ramps_less_than_t</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span>
                <span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="n">eig</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">eigs</span><span class="p">):</span>
                    <span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">+=</span> <span class="p">(</span><span class="o">-</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">*</span><span class="n">t</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span>
                        <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">*</span><span class="n">t</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]))</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span>
                        <span class="o">+</span> <span class="mi">1</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">*</span><span class="n">t</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]))</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span>
                        <span class="o">+</span> <span class="mi">1</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span>
                        <span class="o">+</span> <span class="mi">1</span><span class="p">])</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]))</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]))</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span>
                        <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]))</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span>
                        <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]))</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span>
                        <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span>
                        <span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span>
                        <span class="o">-</span> <span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span>
                        <span class="o">+</span> <span class="mi">1</span><span class="p">]))</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span>
                        <span class="o">+</span> <span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]))</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">t</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">t</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">t</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span>
                        <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]))</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">t</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span>
                        <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]))</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="n">t</span>
                        <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span> <span class="o">+</span>
                        <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]))</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span>
                        <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span> <span class="o">+</span>
                        <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]))</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span>
                        <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span>
                        <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span>
                        <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]))</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span> <span class="o">+</span>
                        <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]))</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span>
                        <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span>
                        <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span>
                        <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]))</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]))</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span>
                        <span class="o">+</span> <span class="mi">1</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">t</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">omega</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">t</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span>
                        <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">omega</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">t</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]))</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">t</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]))</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]))</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span>
                        <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span>
                        <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]))</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span>
                        <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span>
                        <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span>
                        <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span>
                        <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]))</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span> <span class="o">+</span>
                        <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span>
                        <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">omega</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]))</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span> <span class="o">+</span>
                        <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
                        <span class="o">+</span> <span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span>
                        <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]))</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]))</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">t</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">t</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span>
                        <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">t</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span> <span class="o">+</span>
                        <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]))</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span>
                        <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">t</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span>
                        <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]))</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span> <span class="o">+</span>
                        <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]))</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span>
                        <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span> <span class="o">+</span>
                        <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]))</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span>
                        <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span>
                        <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]))</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span>
                        <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span> <span class="o">+</span>
                        <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]))</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span>
                        <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span>
            <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">constants_containing_t</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span>
                <span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="n">eig</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">eigs</span><span class="p">):</span>
                    <span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">+=</span> <span class="p">(</span><span class="o">-</span><span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">2</span><span class="p">))))</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span>
                        <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">2</span><span class="p">))))</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">))</span>
            <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">constants_less_than_t</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span>
                <span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="n">eig</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">eigs</span><span class="p">):</span>
                    <span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">+=</span> <span class="p">(</span><span class="o">-</span><span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]))</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span> <span class="o">+</span>
                        <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]))</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">2</span><span class="p">))))</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span>
                        <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">2</span><span class="p">))))</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">))</span>

    <span class="k">elif</span> <span class="n">implementation</span> <span class="o">==</span> <span class="s1">&#39;fortran&#39;</span><span class="p">:</span>
        <span class="c1">#note than all fortran subroutines are lowercase.</span>
        <span class="k">if</span> <span class="n">MUST_TRY_FORTRAN</span><span class="p">:</span>
            <span class="kn">from</span> <span class="nn">geotecha.speccon.ext_integrals</span> <span class="k">import</span> <span class="n">edload_coslinear</span> <span class="k">as</span> <span class="n">fn</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="kn">from</span> <span class="nn">geotecha.speccon.ext_integrals</span> <span class="k">import</span> <span class="n">edload_coslinear</span> <span class="k">as</span> <span class="n">fn</span>
            <span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
                <span class="n">fn</span> <span class="o">=</span> <span class="n">EDload_coslinear</span>
        <span class="n">A</span> <span class="o">=</span> <span class="n">fn</span><span class="p">(</span><span class="n">loadtim</span><span class="p">,</span> <span class="n">loadmag</span><span class="p">,</span> <span class="n">omega</span><span class="p">,</span> <span class="n">phase</span><span class="p">,</span> <span class="n">eigs</span><span class="p">,</span> <span class="n">tvals</span><span class="p">,</span> <span class="n">dT</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span><span class="c1">#default is &#39;vectorized&#39; using numpy</span>
        <span class="n">sin</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span>
        <span class="n">cos</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span>
        <span class="n">exp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span>

        <span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="nb">len</span><span class="p">(</span><span class="n">tvals</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">eigs</span><span class="p">)])</span>

        <span class="p">(</span><span class="n">ramps_less_than_t</span><span class="p">,</span> <span class="n">constants_less_than_t</span><span class="p">,</span> <span class="n">steps_less_than_t</span><span class="p">,</span>
            <span class="n">ramps_containing_t</span><span class="p">,</span> <span class="n">constants_containing_t</span><span class="p">)</span> <span class="o">=</span> <span class="n">segment_containing_also_segments_less_than_xi</span><span class="p">(</span><span class="n">loadtim</span><span class="p">,</span> <span class="n">loadmag</span><span class="p">,</span> <span class="n">tvals</span><span class="p">,</span> <span class="n">steps_or_equal_to</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>

        <span class="n">eig</span> <span class="o">=</span> <span class="n">eigs</span><span class="p">[:,</span> <span class="kc">None</span><span class="p">]</span>


        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">tvals</span><span class="p">):</span>
            <span class="n">k</span> <span class="o">=</span> <span class="n">steps_less_than_t</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">k</span><span class="p">):</span>
                <span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:]</span> <span class="o">+=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="p">(</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
            <span class="n">k</span> <span class="o">=</span> <span class="n">ramps_containing_t</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">k</span><span class="p">):</span>
                <span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:]</span> <span class="o">+=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span>
                        <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="n">t</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">*</span><span class="n">t</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span>
                        <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span>
                        <span class="o">+</span> <span class="n">omega</span><span class="o">*</span><span class="n">t</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span>
                        <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span>
                        <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span>
                        <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">+</span>
                        <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span>
                        <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">-</span>
                        <span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">+</span>
                        <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">+</span>
                        <span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span>
                        <span class="o">-</span> <span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">t</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
                        <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">t</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
                        <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">t</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">t</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span>
                        <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span>
                        <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span>
                        <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span>
                        <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span>
                        <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span>
                        <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="n">omega</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">t</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">+</span>
                        <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">t</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span>
                        <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">t</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">omega</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">t</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span>
                        <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">omega</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span>
                        <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span>
                        <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span>
                        <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span>
                        <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span>
                        <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">omega</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span>
                        <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span>
                        <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
                        <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">t</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span>
                        <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">t</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
                        <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">t</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">t</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span>
                        <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span>
                        <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span>
                        <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span>
                        <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
            <span class="n">k</span> <span class="o">=</span> <span class="n">ramps_less_than_t</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">k</span><span class="p">):</span>
                <span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:]</span> <span class="o">+=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="o">-</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">*</span><span class="n">t</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span>
                        <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">*</span><span class="n">t</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]))</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span>
                        <span class="o">+</span> <span class="mi">1</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">*</span><span class="n">t</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]))</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span>
                        <span class="o">+</span> <span class="mi">1</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span>
                        <span class="o">+</span> <span class="mi">1</span><span class="p">])</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]))</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]))</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span>
                        <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]))</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span>
                        <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]))</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span>
                        <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span>
                        <span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span>
                        <span class="o">-</span> <span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span>
                        <span class="o">+</span> <span class="mi">1</span><span class="p">]))</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span>
                        <span class="o">+</span> <span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]))</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">t</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">t</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">t</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span>
                        <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]))</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">t</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span>
                        <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]))</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="n">t</span>
                        <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span> <span class="o">+</span>
                        <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]))</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span>
                        <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span> <span class="o">+</span>
                        <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]))</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span>
                        <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span>
                        <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span>
                        <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]))</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span> <span class="o">+</span>
                        <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]))</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span>
                        <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span>
                        <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span>
                        <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]))</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]))</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span>
                        <span class="o">+</span> <span class="mi">1</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">t</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">omega</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">t</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span>
                        <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">omega</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">t</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]))</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">t</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]))</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]))</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span>
                        <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span>
                        <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]))</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span>
                        <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span>
                        <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span>
                        <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span>
                        <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]))</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span> <span class="o">+</span>
                        <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span>
                        <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">omega</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]))</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span> <span class="o">+</span>
                        <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
                        <span class="o">+</span> <span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span>
                        <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]))</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]))</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">t</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">t</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span>
                        <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">t</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span> <span class="o">+</span>
                        <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]))</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span>
                        <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">t</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span>
                        <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]))</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span> <span class="o">+</span>
                        <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]))</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span>
                        <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span> <span class="o">+</span>
                        <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]))</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span>
                        <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span>
                        <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]))</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span>
                        <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span> <span class="o">+</span>
                        <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]))</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span>
                        <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
            <span class="n">k</span> <span class="o">=</span> <span class="n">constants_containing_t</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">k</span><span class="p">):</span>
                <span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">,:]</span> <span class="o">+=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="o">-</span><span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">2</span><span class="p">))))</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span>
                        <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">2</span><span class="p">))))</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
            <span class="n">k</span> <span class="o">=</span> <span class="n">constants_less_than_t</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">k</span><span class="p">):</span>
                <span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">,:]</span> <span class="o">+=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="o">-</span><span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]))</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span> <span class="o">+</span>
                        <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]))</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">2</span><span class="p">))))</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span>
                        <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">2</span><span class="p">))))</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">A</span></div>


<div class="viewcode-block" id="Eload_sinlinear"><a class="viewcode-back" href="../../../api/geotecha.speccon.integrals.html#geotecha.speccon.integrals.Eload_sinlinear">[docs]</a><span class="k">def</span> <span class="nf">Eload_sinlinear</span><span class="p">(</span><span class="n">loadtim</span><span class="p">,</span> <span class="n">loadmag</span><span class="p">,</span> <span class="n">omega</span><span class="p">,</span> <span class="n">phase</span><span class="p">,</span> <span class="n">eigs</span><span class="p">,</span> <span class="n">tvals</span><span class="p">,</span> <span class="n">dT</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">implementation</span><span class="o">=</span><span class="s1">&#39;vectorized&#39;</span><span class="p">):</span>

    <span class="n">loadtim</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">loadtim</span><span class="p">)</span>
    <span class="n">loadmag</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">loadmag</span><span class="p">)</span>
    <span class="n">eigs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">eigs</span><span class="p">)</span>
    <span class="n">tvals</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">tvals</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">implementation</span> <span class="o">==</span> <span class="s1">&#39;scalar&#39;</span><span class="p">:</span>
        <span class="n">sin</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span>
        <span class="n">cos</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span>
        <span class="n">exp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span>
        <span class="c1">#note that math module doesn&#39;t like complex numbers</span>

        <span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="nb">len</span><span class="p">(</span><span class="n">tvals</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">eigs</span><span class="p">)],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">complex</span><span class="p">)</span>

        <span class="p">(</span><span class="n">ramps_less_than_t</span><span class="p">,</span> <span class="n">constants_less_than_t</span><span class="p">,</span> <span class="n">steps_less_than_t</span><span class="p">,</span>
            <span class="n">ramps_containing_t</span><span class="p">,</span> <span class="n">constants_containing_t</span><span class="p">)</span> <span class="o">=</span> <span class="n">segment_containing_also_segments_less_than_xi</span><span class="p">(</span><span class="n">loadtim</span><span class="p">,</span> <span class="n">loadmag</span><span class="p">,</span> <span class="n">tvals</span><span class="p">,</span> <span class="n">steps_or_equal_to</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">tvals</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">constants_containing_t</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span>
                <span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="n">eig</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">eigs</span><span class="p">):</span>
                    <span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">+=</span> <span class="p">((</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">2</span><span class="p">))))</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span>
                        <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">2</span><span class="p">))))</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">))</span>
            <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">constants_less_than_t</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span>
                <span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="n">eig</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">eigs</span><span class="p">):</span>
                    <span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">+=</span> <span class="p">((</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]))</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span> <span class="o">+</span>
                        <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]))</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">2</span><span class="p">))))</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span>
                        <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">2</span><span class="p">))))</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">))</span>
            <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">ramps_containing_t</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span>
                <span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="n">eig</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">eigs</span><span class="p">):</span>
                    <span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">+=</span> <span class="p">((</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">t</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span>
                        <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">t</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
                        <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">+</span>
                        <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">+</span>
                        <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">*</span><span class="n">t</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">*</span><span class="n">t</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">+</span> <span class="n">omega</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">+</span>
                        <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">+</span>
                        <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">+</span>
                        <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span>
                        <span class="o">-</span> <span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">t</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
                        <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">t</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
                        <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span>
                        <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span>
                        <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">t</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
                        <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">t</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
                        <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span>
                        <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span>
                        <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span>
                        <span class="o">-</span> <span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">t</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span>
                        <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">t</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span>
                        <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span>
                        <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">+</span>
                        <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span>
                        <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">+</span>
                        <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">*</span><span class="n">t</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span>
                        <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="n">t</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span>
                        <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span>
                        <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span>
                        <span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span>
                        <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span>
                        <span class="o">-</span> <span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span>
                        <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">t</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">t</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span>
                        <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span>
                        <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span>
                        <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span>
                        <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span>
                        <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span>
                        <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="n">omega</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">t</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span>
                        <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">t</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
                        <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">omega</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">omega</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span>
                        <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">))</span>
            <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">ramps_less_than_t</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span>
                <span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="n">eig</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">eigs</span><span class="p">):</span>
                    <span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">+=</span> <span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">t</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span>
                        <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">t</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span>
                        <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span>
                        <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">+</span>
                        <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span>
                        <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">+</span>
                        <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">*</span><span class="n">t</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span>
                        <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="n">t</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span>
                        <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span>
                        <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span>
                        <span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span>
                        <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span>
                        <span class="o">-</span> <span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span>
                        <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">t</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">t</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span>
                        <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span>
                        <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span>
                        <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span>
                        <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span>
                        <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span>
                        <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="n">omega</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">t</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span>
                        <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">t</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
                        <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">omega</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">omega</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span>
                        <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">t</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]))</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span> <span class="o">+</span>
                        <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span>
                        <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">t</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]))</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span>
                        <span class="o">+</span> <span class="mi">1</span><span class="p">])</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]))</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]))</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span>
                        <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]))</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span> <span class="o">+</span>
                        <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span>
                        <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]))</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">+</span> <span class="n">omega</span><span class="o">*</span><span class="n">t</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]))</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span>
                        <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="n">t</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]))</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span>
                        <span class="o">+</span> <span class="mi">1</span><span class="p">])</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]))</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span> <span class="o">+</span>
                        <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]))</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span>
                        <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]))</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">omega</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]))</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">+</span> <span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]))</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span> <span class="o">+</span>
                        <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span>
                        <span class="o">-</span> <span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]))</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span>
                        <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span>
                        <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">t</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]))</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">t</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]))</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="n">t</span>
                        <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]))</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]))</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span>
                        <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span>
                        <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]))</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span>
                        <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]))</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span>
                        <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]))</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]))</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">t</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span>
                        <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]))</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">t</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span>
                        <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]))</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span> <span class="o">+</span>
                        <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]))</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span>
                        <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span> <span class="o">+</span>
                        <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]))</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span>
                        <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]))</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span> <span class="o">+</span>
                        <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]))</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span>
                        <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]))</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]))</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">))</span>
    <span class="k">elif</span> <span class="n">implementation</span> <span class="o">==</span> <span class="s1">&#39;fortran&#39;</span><span class="p">:</span>
        <span class="c1">#note than all fortran subroutines are lowercase.</span>
        <span class="k">if</span> <span class="n">MUST_TRY_FORTRAN</span><span class="p">:</span>
            <span class="kn">from</span> <span class="nn">geotecha.speccon.ext_integrals</span> <span class="k">import</span> <span class="n">eload_sinlinear</span> <span class="k">as</span> <span class="n">fn</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="kn">from</span> <span class="nn">geotecha.speccon.ext_integrals</span> <span class="k">import</span> <span class="n">eload_sinlinear</span> <span class="k">as</span> <span class="n">fn</span>
            <span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
                <span class="n">fn</span> <span class="o">=</span> <span class="n">Eload_sinlinear</span>
        <span class="n">A</span> <span class="o">=</span> <span class="n">fn</span><span class="p">(</span><span class="n">loadtim</span><span class="p">,</span> <span class="n">loadmag</span><span class="p">,</span> <span class="n">omega</span><span class="p">,</span> <span class="n">phase</span><span class="p">,</span> <span class="n">eigs</span><span class="p">,</span> <span class="n">tvals</span><span class="p">,</span> <span class="n">dT</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span><span class="c1">#default is &#39;vectorized&#39; using numpy</span>
        <span class="n">sin</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span>
        <span class="n">cos</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span>
        <span class="n">exp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span>

        <span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="nb">len</span><span class="p">(</span><span class="n">tvals</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">eigs</span><span class="p">)],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">complex</span><span class="p">)</span>

        <span class="p">(</span><span class="n">ramps_less_than_t</span><span class="p">,</span> <span class="n">constants_less_than_t</span><span class="p">,</span> <span class="n">steps_less_than_t</span><span class="p">,</span>
            <span class="n">ramps_containing_t</span><span class="p">,</span> <span class="n">constants_containing_t</span><span class="p">)</span> <span class="o">=</span> <span class="n">segment_containing_also_segments_less_than_xi</span><span class="p">(</span><span class="n">loadtim</span><span class="p">,</span> <span class="n">loadmag</span><span class="p">,</span> <span class="n">tvals</span><span class="p">,</span> <span class="n">steps_or_equal_to</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>

        <span class="n">eig</span> <span class="o">=</span> <span class="n">eigs</span><span class="p">[:,</span> <span class="kc">None</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">tvals</span><span class="p">):</span>
            <span class="n">k</span> <span class="o">=</span> <span class="n">constants_containing_t</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">k</span><span class="p">):</span>
                <span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:]</span> <span class="o">+=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">((</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">2</span><span class="p">))))</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span>
                        <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">2</span><span class="p">))))</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

            <span class="n">k</span> <span class="o">=</span> <span class="n">constants_less_than_t</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">k</span><span class="p">):</span>
                <span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:]</span> <span class="o">+=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">((</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]))</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span> <span class="o">+</span>
                        <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]))</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">2</span><span class="p">))))</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span>
                        <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">2</span><span class="p">))))</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

            <span class="n">k</span> <span class="o">=</span> <span class="n">ramps_containing_t</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">k</span><span class="p">):</span>
                <span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:]</span> <span class="o">+=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">((</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">t</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span>
                        <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">t</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
                        <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">+</span>
                        <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">+</span>
                        <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">*</span><span class="n">t</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">*</span><span class="n">t</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">+</span> <span class="n">omega</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">+</span>
                        <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">+</span>
                        <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">+</span>
                        <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span>
                        <span class="o">-</span> <span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">t</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
                        <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">t</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
                        <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span>
                        <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span>
                        <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">t</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
                        <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">t</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
                        <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span>
                        <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span>
                        <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span>
                        <span class="o">-</span> <span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">t</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span>
                        <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">t</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span>
                        <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span>
                        <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">+</span>
                        <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span>
                        <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">+</span>
                        <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">*</span><span class="n">t</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span>
                        <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="n">t</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span>
                        <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span>
                        <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span>
                        <span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span>
                        <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span>
                        <span class="o">-</span> <span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span>
                        <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">t</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">t</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span>
                        <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span>
                        <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span>
                        <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span>
                        <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span>
                        <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span>
                        <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="n">omega</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">t</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span>
                        <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">t</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
                        <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">omega</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">omega</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span>
                        <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

            <span class="n">k</span> <span class="o">=</span> <span class="n">ramps_less_than_t</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">k</span><span class="p">):</span>
                <span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:]</span> <span class="o">+=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">t</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span>
                        <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">t</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span>
                        <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span>
                        <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">+</span>
                        <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span>
                        <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">+</span>
                        <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">*</span><span class="n">t</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span>
                        <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="n">t</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span>
                        <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span>
                        <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span>
                        <span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span>
                        <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span>
                        <span class="o">-</span> <span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span>
                        <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">t</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">t</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span>
                        <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span>
                        <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span>
                        <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span>
                        <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span>
                        <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span>
                        <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="n">omega</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">t</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span>
                        <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">t</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
                        <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">omega</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">omega</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span>
                        <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">t</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]))</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span> <span class="o">+</span>
                        <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span>
                        <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">t</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]))</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span>
                        <span class="o">+</span> <span class="mi">1</span><span class="p">])</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]))</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]))</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span>
                        <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]))</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span> <span class="o">+</span>
                        <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span>
                        <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]))</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">+</span> <span class="n">omega</span><span class="o">*</span><span class="n">t</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]))</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span>
                        <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="n">t</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]))</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span>
                        <span class="o">+</span> <span class="mi">1</span><span class="p">])</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]))</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span> <span class="o">+</span>
                        <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]))</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span>
                        <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]))</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">omega</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]))</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">+</span> <span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]))</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span> <span class="o">+</span>
                        <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span>
                        <span class="o">-</span> <span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]))</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span>
                        <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span>
                        <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span>
                        <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">t</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]))</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">t</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]))</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="n">t</span>
                        <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]))</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]))</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span>
                        <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span>
                        <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]))</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span>
                        <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]))</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span>
                        <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]))</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]))</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">t</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span>
                        <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]))</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">t</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span>
                        <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]))</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span> <span class="o">+</span>
                        <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]))</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span>
                        <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span> <span class="o">+</span>
                        <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]))</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span>
                        <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]))</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span> <span class="o">+</span>
                        <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]))</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span>
                        <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]))</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]))</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span>
                        <span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">omega</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">loadtim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">loadmag</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">eig</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">dT</span><span class="o">*</span><span class="n">eig</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">A</span></div>

<div class="viewcode-block" id="pdim1sin_DD_abDDf_linear"><a class="viewcode-back" href="../../../api/geotecha.speccon.integrals.html#geotecha.speccon.integrals.pdim1sin_DD_abDDf_linear">[docs]</a><span class="k">def</span> <span class="nf">pdim1sin_DD_abDDf_linear</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Integration of sin(mi * z) * D[a(z) * b(z) D[sin(mj * z),z,2],z,2]</span>
<span class="sd">    between ztop and zbot where a(z) &amp; b(z) is piecewise linear functions of z.</span>

<span class="sd">    Wrapper for dim1sin_DD_abDDf_linear to allow PolyLine inputs.</span>


<span class="sd">    Calulation of integrals is performed at each element of a square symmetric</span>
<span class="sd">    matrix (size depends on size of `m`).</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    m : ``list`` of ``float``</span>
<span class="sd">        eigenvlaues of BVP. generate with geoteca.speccon.m_from_sin_mx</span>
<span class="sd">    a, b : PolyLine object</span>
<span class="sd">        PolyLine defining piecewise linear relationship.</span>
<span class="sd">    implementation : [&#39;vectorized&#39;, &#39;scalar&#39;, &#39;fortran&#39;], optional</span>
<span class="sd">        Functional implementation: &#39;scalar&#39; = python loops (slow),</span>
<span class="sd">        &#39;fortran&#39; = fortran code (fastest), &#39;vectorized&#39; = numpy(fast).</span>
<span class="sd">        Default implementation=&#39;vectorized&#39;.  If fortran extention module</span>
<span class="sd">        cannot be imported then &#39;vectorized&#39; version will be used.</span>
<span class="sd">        If anything other than &#39;fortran&#39; or &#39;scalar&#39; is used then</span>
<span class="sd">        default vectorized version will be used.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    A : numpy.ndarray</span>
<span class="sd">        A square symmetric matrix, size determined by size of `m`.</span>

<span class="sd">    See Also</span>
<span class="sd">    -------</span>
<span class="sd">    dim1sin_DD_abDDf_linear : Wrapped function.</span>


<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    The `dim1sin_DD_abDDf_linear` matrix, :math:`A` is given by:</span>

<span class="sd">    .. math:: \\mathbf{A}_{i,j}=\\int_{0}^1{\\frac{d^2}{dz^2}\\left({a\\left(z\\right)}{b\\left(z\\right)}\\frac{d^2\\phi_j}{dz^2}\\right)\\phi_i\\,dz}</span>

<span class="sd">    where the basis function :math:`\\phi_i` is given by:</span>

<span class="sd">    .. math:: \\phi_i\\left(z\\right)=\\sin\\left({m_i}z\\right)</span>

<span class="sd">    and :math:`a\\left(z\\right)` and :math:`b\\left(z\\right)` are piecewise</span>
<span class="sd">    linear functions with respect to :math:`z`, that within a layer is defined by:</span>

<span class="sd">    .. math:: a\\left(z\\right) = a_t+\\frac{a_b-a_t}{z_b-z_t}\\left(z-z_t\\right)</span>

<span class="sd">    with :math:`t` and :math:`b` subscripts representing &#39;top&#39; and &#39;bottom&#39; of</span>
<span class="sd">    each layer respectively.</span>

<span class="sd">    To make the above integration simpler we integate by parts to get:</span>

<span class="sd">    .. math:: \\mathbf{A}_{i,j}= \\left.{\\frac{d}{dz}\\left({a\\left(z\\right)}{b\\left(z\\right)}\\frac{d^2\\phi_j}{dz^2}\\right)\\phi_i}\\right|_{z=0}^{z=1}</span>
<span class="sd">                    - \\left.{{a\\left(z\\right)}{b\\left(z\\right)}\\frac{d^2\\phi_j}{dz^2}\\frac{d\\phi_i}{dz}}\\right|_{z=0}^{z=1}</span>
<span class="sd">               +\\int_{0}^1{{a\\left(z\\right)}{b\\left(z\\right)}\\frac{d^2\\phi_j}{dz^2}\\frac{d^2\\phi_i}{dz^2}\\,dz}</span>

<span class="sd">    In this case the sine basis functions means the end point terms in the above</span>
<span class="sd">    equation are zero, leaving us with</span>

<span class="sd">    .. math:: \\mathbf{A}_{i,j}= \\int_{0}^1{{a\\left(z\\right)}{b\\left(z\\right)}\\frac{d^2\\phi_j}{dz^2}\\frac{d^2\\phi_i}{dz^2}\\,dz}</span>


<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="n">pwise</span><span class="o">.</span><span class="n">polyline_make_x_common</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">dim1sin_DD_abDDf_linear</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">a</span><span class="o">.</span><span class="n">y1</span><span class="p">,</span> <span class="n">a</span><span class="o">.</span><span class="n">y2</span><span class="p">,</span> <span class="n">b</span><span class="o">.</span><span class="n">y1</span><span class="p">,</span> <span class="n">b</span><span class="o">.</span><span class="n">y2</span><span class="p">,</span> <span class="n">a</span><span class="o">.</span><span class="n">x1</span><span class="p">,</span> <span class="n">a</span><span class="o">.</span><span class="n">x2</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>


<div class="viewcode-block" id="dim1sin_DD_abDDf_linear"><a class="viewcode-back" href="../../../api/geotecha.speccon.integrals.html#geotecha.speccon.integrals.dim1sin_DD_abDDf_linear">[docs]</a><span class="k">def</span> <span class="nf">dim1sin_DD_abDDf_linear</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">at</span><span class="p">,</span> <span class="n">ab</span><span class="p">,</span> <span class="n">bt</span><span class="p">,</span> <span class="n">bb</span><span class="p">,</span>  <span class="n">zt</span><span class="p">,</span> <span class="n">zb</span><span class="p">,</span> <span class="n">implementation</span><span class="o">=</span><span class="s1">&#39;vectorized&#39;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Integration of sin(mi * z) * D[a(z) * b(z) D[sin(mj * z),z,2],z,2]</span>
<span class="sd">    between ztop and zbot where a(z) &amp; b(z) is piecewise linear functions of z.</span>

<span class="sd">    Calulation of integrals is performed at each element of a square symmetric</span>
<span class="sd">    matrix (size depends on size of `m`).</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    m : ``list`` of ``float``</span>
<span class="sd">        eigenvlaues of BVP. generate with geoteca.speccon.m_from_sin_mx</span>
<span class="sd">    at : ``list`` of ``float``</span>
<span class="sd">        Property at top of each layer.</span>
<span class="sd">    ab : ``list`` of ``float``</span>
<span class="sd">        Property at bottom of each layer.</span>
<span class="sd">    bt : ``list`` of ``float``</span>
<span class="sd">        2nd property at top of each layer.</span>
<span class="sd">    bb : ``list`` of ``float``</span>
<span class="sd">        2nd property at bottom of each layer.</span>
<span class="sd">    zt : ``list`` of ``float``</span>
<span class="sd">        Normalised depth or z-coordinate at top of each layer. `zt[0]` = 0</span>
<span class="sd">    zb : ``list`` of ``float``</span>
<span class="sd">        Normalised depth or z-coordinate at bottom of each layer. `zt[-1]` = 1</span>
<span class="sd">    implementation : [&#39;vectorized&#39;, &#39;scalar&#39;, &#39;fortran&#39;], optional</span>
<span class="sd">        Functional implementation: &#39;scalar&#39; = python loops (slow),</span>
<span class="sd">        &#39;fortran&#39; = fortran code (fastest), &#39;vectorized&#39; = numpy(fast).</span>
<span class="sd">        Default implementation=&#39;vectorized&#39;.  If fortran extention module</span>
<span class="sd">        cannot be imported then &#39;vectorized&#39; version will be used.</span>
<span class="sd">        If anything other than &#39;fortran&#39; or &#39;scalar&#39; is used then</span>
<span class="sd">        default vectorized version will be used.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    A : numpy.ndarray</span>
<span class="sd">        A square symmetric matrix, size determined by size of `m`.</span>

<span class="sd">    See Also</span>
<span class="sd">    --------</span>
<span class="sd">    m_from_sin_mx : Used to generate &#39;m&#39; input parameter.</span>
<span class="sd">    geotecha.integrals_generate_code.dim1sin_DD_abDDf_linear_implementations : Generation</span>
<span class="sd">        of code for this function.</span>
<span class="sd">    pdim1sin_DD_abDDf_linear : Same function with PolyLine</span>
<span class="sd">        inputs.</span>
<span class="sd">    geotecha.speccon.ext_integrals.dim1sin_dd_abddf_linear : Equivalent fortran</span>
<span class="sd">        function.</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    The `dim1sin_DD_abDDf_linear` matrix, :math:`A` is given by:</span>

<span class="sd">    .. math:: \\mathbf{A}_{i,j}=\\int_{0}^1{\\frac{d^2}{dz^2}\\left({a\\left(z\\right)}{b\\left(z\\right)}\\frac{d^2\\phi_j}{dz^2}\\right)\\phi_i\\,dz}</span>

<span class="sd">    where the basis function :math:`\\phi_i` is given by:</span>

<span class="sd">    .. math:: \\phi_i\\left(z\\right)=\\sin\\left({m_i}z\\right)</span>

<span class="sd">    and :math:`a\\left(z\\right)` and :math:`b\\left(z\\right)` are piecewise</span>
<span class="sd">    linear functions with respect to :math:`z`, that within a layer is defined by:</span>

<span class="sd">    .. math:: a\\left(z\\right) = a_t+\\frac{a_b-a_t}{z_b-z_t}\\left(z-z_t\\right)</span>

<span class="sd">    with :math:`t` and :math:`b` subscripts representing &#39;top&#39; and &#39;bottom&#39; of</span>
<span class="sd">    each layer respectively.</span>

<span class="sd">    To make the above integration simpler we integate by parts to get:</span>

<span class="sd">    .. math:: \\mathbf{A}_{i,j}= \\left.{\\frac{d}{dz}\\left({a\\left(z\\right)}{b\\left(z\\right)}\\frac{d^2\\phi_j}{dz^2}\\right)\\phi_i}\\right|_{z=0}^{z=1}</span>
<span class="sd">                    - \\left.{{a\\left(z\\right)}{b\\left(z\\right)}\\frac{d^2\\phi_j}{dz^2}\\frac{d\\phi_i}{dz}}\\right|_{z=0}^{z=1}</span>
<span class="sd">               +\\int_{0}^1{{a\\left(z\\right)}{b\\left(z\\right)}\\frac{d^2\\phi_j}{dz^2}\\frac{d^2\\phi_i}{dz^2}\\,dz}</span>

<span class="sd">    In this case the sine basis functions means the end point terms in the above</span>
<span class="sd">    equation are zero, leaving us with</span>

<span class="sd">    .. math:: \\mathbf{A}_{i,j}= \\int_{0}^1{{a\\left(z\\right)}{b\\left(z\\right)}\\frac{d^2\\phi_j}{dz^2}\\frac{d^2\\phi_i}{dz^2}\\,dz}</span>


<span class="sd">    &quot;&quot;&quot;</span>


    <span class="c1">#import numpy as np #import this at module level</span>
    <span class="c1">#import math #import this at module level</span>

    <span class="n">m</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
    <span class="n">at</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">at</span><span class="p">)</span>
    <span class="n">ab</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">ab</span><span class="p">)</span>
    <span class="n">bt</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">bt</span><span class="p">)</span>
    <span class="n">bb</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">bb</span><span class="p">)</span>
    <span class="n">zt</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">zt</span><span class="p">)</span>
    <span class="n">zb</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">zb</span><span class="p">)</span>

    <span class="n">neig</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">implementation</span> <span class="o">==</span> <span class="s1">&#39;scalar&#39;</span><span class="p">:</span>
        <span class="n">sin</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">sin</span>
        <span class="n">cos</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">cos</span>
        <span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="n">neig</span><span class="p">,</span> <span class="n">neig</span><span class="p">],</span> <span class="nb">float</span><span class="p">)</span>
        <span class="n">nlayers</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">zt</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">layer</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nlayers</span><span class="p">):</span>
            <span class="n">a_slope</span> <span class="o">=</span> <span class="p">(</span><span class="n">ab</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span> <span class="o">-</span> <span class="n">at</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span> <span class="o">/</span> <span class="p">(</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span> <span class="o">-</span> <span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span>
            <span class="n">b_slope</span> <span class="o">=</span> <span class="p">(</span><span class="n">bb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span> <span class="o">-</span> <span class="n">bt</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span> <span class="o">/</span> <span class="p">(</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span> <span class="o">-</span> <span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">])</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">neig</span><span class="p">):</span>
                <span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span> <span class="o">+=</span> <span class="p">(</span><span class="o">-</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="p">(</span><span class="n">a_slope</span><span class="o">*</span><span class="n">b_slope</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">/</span><span class="mi">4</span> <span class="o">+</span>
                    <span class="n">a_slope</span><span class="o">*</span><span class="n">b_slope</span><span class="o">*</span><span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="mi">4</span> <span class="o">+</span>
                    <span class="n">a_slope</span><span class="o">*</span><span class="n">b_slope</span><span class="o">*</span><span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="mi">4</span> <span class="o">+</span>
                    <span class="n">a_slope</span><span class="o">*</span><span class="n">b_slope</span><span class="o">*</span><span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="mi">6</span> <span class="o">+</span>
                    <span class="n">a_slope</span><span class="o">*</span><span class="n">b_slope</span><span class="o">*</span><span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="mi">6</span> <span class="o">-</span>
                    <span class="n">a_slope</span><span class="o">*</span><span class="n">bt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="mi">4</span> <span class="o">-</span>
                    <span class="n">a_slope</span><span class="o">*</span><span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">bt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="mi">4</span> <span class="o">-</span>
                    <span class="n">a_slope</span><span class="o">*</span><span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">bt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="mi">4</span> <span class="o">-</span>
                    <span class="n">b_slope</span><span class="o">*</span><span class="n">at</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="mi">4</span> <span class="o">-</span>
                    <span class="n">b_slope</span><span class="o">*</span><span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">at</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="mi">4</span> <span class="o">-</span>
                    <span class="n">b_slope</span><span class="o">*</span><span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">at</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="mi">4</span> <span class="o">-</span>
                    <span class="n">bt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">at</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">/</span><span class="mi">2</span> <span class="o">+</span>
                    <span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">bt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">at</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="mi">2</span> <span class="o">+</span>
                    <span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">bt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">at</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span>
                    <span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="p">(</span><span class="n">a_slope</span><span class="o">*</span><span class="n">b_slope</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">/</span><span class="mi">4</span> <span class="o">+</span>
                    <span class="n">a_slope</span><span class="o">*</span><span class="n">b_slope</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="mi">4</span> <span class="o">-</span>
                    <span class="n">a_slope</span><span class="o">*</span><span class="n">b_slope</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="mi">4</span> <span class="o">+</span>
                    <span class="n">a_slope</span><span class="o">*</span><span class="n">b_slope</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                    <span class="o">+</span> <span class="n">a_slope</span><span class="o">*</span><span class="n">b_slope</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="mi">2</span> <span class="o">+</span>
                    <span class="n">a_slope</span><span class="o">*</span><span class="n">b_slope</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="mi">2</span> <span class="o">-</span>
                    <span class="n">a_slope</span><span class="o">*</span><span class="n">b_slope</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">/</span><span class="mi">2</span>
                    <span class="o">-</span> <span class="n">a_slope</span><span class="o">*</span><span class="n">b_slope</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="mi">2</span> <span class="o">-</span>
                    <span class="n">a_slope</span><span class="o">*</span><span class="n">b_slope</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="mi">2</span> <span class="o">+</span>
                    <span class="n">a_slope</span><span class="o">*</span><span class="n">b_slope</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="mi">6</span> <span class="o">+</span>
                    <span class="n">a_slope</span><span class="o">*</span><span class="n">b_slope</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="mi">6</span> <span class="o">+</span>
                    <span class="n">a_slope</span><span class="o">*</span><span class="n">b_slope</span><span class="o">*</span><span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="mi">2</span> <span class="o">-</span>
                    <span class="n">a_slope</span><span class="o">*</span><span class="n">b_slope</span><span class="o">*</span><span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">/</span><span class="mi">2</span>
                    <span class="o">-</span> <span class="n">a_slope</span><span class="o">*</span><span class="n">bt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="mi">4</span> <span class="o">-</span>
                    <span class="n">a_slope</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">bt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">/</span><span class="mi">2</span>
                    <span class="o">-</span> <span class="n">a_slope</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">bt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="mi">2</span> <span class="o">-</span>
                    <span class="n">a_slope</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">bt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="mi">2</span> <span class="o">+</span>
                    <span class="n">a_slope</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">bt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="mi">4</span> <span class="o">+</span>
                    <span class="n">a_slope</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">bt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="mi">4</span> <span class="o">+</span>
                    <span class="n">a_slope</span><span class="o">*</span><span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">bt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">/</span><span class="mi">2</span>
                    <span class="o">-</span> <span class="n">b_slope</span><span class="o">*</span><span class="n">at</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="mi">4</span> <span class="o">-</span>
                    <span class="n">b_slope</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">at</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">/</span><span class="mi">2</span>
                    <span class="o">-</span> <span class="n">b_slope</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">at</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="mi">2</span> <span class="o">-</span>
                    <span class="n">b_slope</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">at</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="mi">2</span> <span class="o">+</span>
                    <span class="n">b_slope</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">at</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="mi">4</span> <span class="o">+</span>
                    <span class="n">b_slope</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">at</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="mi">4</span> <span class="o">+</span>
                    <span class="n">b_slope</span><span class="o">*</span><span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">at</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">/</span><span class="mi">2</span>
                    <span class="o">-</span> <span class="n">bt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">at</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">/</span><span class="mi">2</span> <span class="o">+</span>
                    <span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">bt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">at</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="mi">2</span> <span class="o">+</span>
                    <span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">bt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">at</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="mi">2</span><span class="p">))</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">neig</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
                <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">neig</span><span class="p">):</span>
                    <span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">+=</span> <span class="p">(</span><span class="o">-</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">a_slope</span><span class="o">*</span><span class="n">b_slope</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">])</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span> <span class="o">+</span>
                        <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">-</span>
                        <span class="mi">6</span><span class="o">*</span><span class="n">a_slope</span><span class="o">*</span><span class="n">b_slope</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">])</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span>
                        <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">+</span>
                        <span class="mi">6</span><span class="o">*</span><span class="n">a_slope</span><span class="o">*</span><span class="n">b_slope</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">])</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span>
                        <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">a_slope</span><span class="o">*</span><span class="n">b_slope</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">])</span><span class="o">*</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span> <span class="o">+</span>
                        <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">+</span>
                        <span class="n">a_slope</span><span class="o">*</span><span class="n">bt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">])</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span> <span class="o">+</span>
                        <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">+</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">a_slope</span><span class="o">*</span><span class="n">bt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">])</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span>
                        <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">a_slope</span><span class="o">*</span><span class="n">bt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">])</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span>
                        <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">-</span>
                        <span class="n">a_slope</span><span class="o">*</span><span class="n">bt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">])</span><span class="o">*</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span> <span class="o">+</span>
                        <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">+</span>
                        <span class="n">b_slope</span><span class="o">*</span><span class="n">at</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">])</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span> <span class="o">+</span>
                        <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">+</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">b_slope</span><span class="o">*</span><span class="n">at</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">])</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span>
                        <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">b_slope</span><span class="o">*</span><span class="n">at</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">])</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span>
                        <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">-</span>
                        <span class="n">b_slope</span><span class="o">*</span><span class="n">at</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">])</span><span class="o">*</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span> <span class="o">+</span>
                        <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">-</span>
                        <span class="n">bt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">at</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">])</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">5</span><span class="o">*</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span>
                        <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">+</span>
                        <span class="n">bt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">at</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">])</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span>
                        <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">+</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">bt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">at</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">])</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span>
                        <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">bt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">at</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">])</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span>
                        <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">-</span>
                        <span class="n">bt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">at</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">])</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span>
                        <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">+</span>
                        <span class="n">bt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">at</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">5</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">])</span><span class="o">*</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span>
                        <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span> <span class="o">+</span>
                        <span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">a_slope</span><span class="o">*</span><span class="n">b_slope</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">])</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span>
                        <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">-</span>
                        <span class="mi">6</span><span class="o">*</span><span class="n">a_slope</span><span class="o">*</span><span class="n">b_slope</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">])</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span>
                        <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">+</span>
                        <span class="mi">6</span><span class="o">*</span><span class="n">a_slope</span><span class="o">*</span><span class="n">b_slope</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">])</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span>
                        <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">a_slope</span><span class="o">*</span><span class="n">b_slope</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">])</span><span class="o">*</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span> <span class="o">+</span>
                        <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">+</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">a_slope</span><span class="o">*</span><span class="n">b_slope</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">])</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span>
                        <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">+</span>
                        <span class="mi">4</span><span class="o">*</span><span class="n">a_slope</span><span class="o">*</span><span class="n">b_slope</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">])</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span>
                        <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">-</span>
                        <span class="mi">4</span><span class="o">*</span><span class="n">a_slope</span><span class="o">*</span><span class="n">b_slope</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">])</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span>
                        <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">a_slope</span><span class="o">*</span><span class="n">b_slope</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">])</span><span class="o">*</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span>
                        <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">+</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">a_slope</span><span class="o">*</span><span class="n">b_slope</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">])</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">5</span><span class="o">*</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span>
                        <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">a_slope</span><span class="o">*</span><span class="n">b_slope</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">])</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span>
                        <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                        <span class="o">-</span>
                        <span class="mi">4</span><span class="o">*</span><span class="n">a_slope</span><span class="o">*</span><span class="n">b_slope</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">])</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span>
                        <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                        <span class="o">+</span>
                        <span class="mi">4</span><span class="o">*</span><span class="n">a_slope</span><span class="o">*</span><span class="n">b_slope</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">])</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span>
                        <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                        <span class="o">+</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">a_slope</span><span class="o">*</span><span class="n">b_slope</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">])</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span>
                        <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                        <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">a_slope</span><span class="o">*</span><span class="n">b_slope</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">5</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">])</span><span class="o">*</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span>
                        <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                        <span class="o">-</span> <span class="n">a_slope</span><span class="o">*</span><span class="n">b_slope</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">])</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">5</span><span class="o">*</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span>
                        <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">+</span>
                        <span class="n">a_slope</span><span class="o">*</span><span class="n">b_slope</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">])</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span>
                        <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">+</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">a_slope</span><span class="o">*</span><span class="n">b_slope</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">])</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span>
                        <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                        <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">a_slope</span><span class="o">*</span><span class="n">b_slope</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">])</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span>
                        <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                        <span class="o">-</span> <span class="n">a_slope</span><span class="o">*</span><span class="n">b_slope</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">])</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span>
                        <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">+</span>
                        <span class="n">a_slope</span><span class="o">*</span><span class="n">b_slope</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">5</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">])</span><span class="o">*</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span>
                        <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">a_slope</span><span class="o">*</span><span class="n">b_slope</span><span class="o">*</span><span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">])</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span>
                        <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">-</span>
                        <span class="mi">4</span><span class="o">*</span><span class="n">a_slope</span><span class="o">*</span><span class="n">b_slope</span><span class="o">*</span><span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">])</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span>
                        <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">+</span>
                        <span class="mi">4</span><span class="o">*</span><span class="n">a_slope</span><span class="o">*</span><span class="n">b_slope</span><span class="o">*</span><span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">])</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span>
                        <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">+</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">a_slope</span><span class="o">*</span><span class="n">b_slope</span><span class="o">*</span><span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">])</span><span class="o">*</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span>
                        <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">-</span>
                        <span class="n">a_slope</span><span class="o">*</span><span class="n">b_slope</span><span class="o">*</span><span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">])</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">5</span><span class="o">*</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span>
                        <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">+</span>
                        <span class="n">a_slope</span><span class="o">*</span><span class="n">b_slope</span><span class="o">*</span><span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">])</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span>
                        <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">+</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">a_slope</span><span class="o">*</span><span class="n">b_slope</span><span class="o">*</span><span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">])</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span>
                        <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                        <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">a_slope</span><span class="o">*</span><span class="n">b_slope</span><span class="o">*</span><span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">])</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span>
                        <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                        <span class="o">-</span> <span class="n">a_slope</span><span class="o">*</span><span class="n">b_slope</span><span class="o">*</span><span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">])</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span>
                        <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">+</span>
                        <span class="n">a_slope</span><span class="o">*</span><span class="n">b_slope</span><span class="o">*</span><span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">5</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">])</span><span class="o">*</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span>
                        <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">+</span>
                        <span class="n">a_slope</span><span class="o">*</span><span class="n">bt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">])</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span> <span class="o">+</span>
                        <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">+</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">a_slope</span><span class="o">*</span><span class="n">bt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">])</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span>
                        <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">a_slope</span><span class="o">*</span><span class="n">bt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">])</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span>
                        <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">-</span>
                        <span class="n">a_slope</span><span class="o">*</span><span class="n">bt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">])</span><span class="o">*</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span> <span class="o">+</span>
                        <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">-</span>
                        <span class="n">a_slope</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">bt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">])</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">5</span><span class="o">*</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span>
                        <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">+</span>
                        <span class="n">a_slope</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">bt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">])</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span>
                        <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">+</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">a_slope</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">bt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">])</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span>
                        <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">a_slope</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">bt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">])</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span>
                        <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">-</span>
                        <span class="n">a_slope</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">bt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">])</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span>
                        <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">+</span>
                        <span class="n">a_slope</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">bt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">5</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">])</span><span class="o">*</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span>
                        <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">+</span>
                        <span class="n">a_slope</span><span class="o">*</span><span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">bt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">])</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">5</span><span class="o">*</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span>
                        <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">-</span>
                        <span class="n">a_slope</span><span class="o">*</span><span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">bt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">])</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span>
                        <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">a_slope</span><span class="o">*</span><span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">bt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">])</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span>
                        <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">+</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">a_slope</span><span class="o">*</span><span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">bt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">])</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span>
                        <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">+</span>
                        <span class="n">a_slope</span><span class="o">*</span><span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">bt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">])</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span>
                        <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">-</span>
                        <span class="n">a_slope</span><span class="o">*</span><span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">bt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">5</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">])</span><span class="o">*</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span>
                        <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">+</span>
                        <span class="n">b_slope</span><span class="o">*</span><span class="n">at</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">])</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span> <span class="o">+</span>
                        <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">+</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">b_slope</span><span class="o">*</span><span class="n">at</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">])</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span>
                        <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">b_slope</span><span class="o">*</span><span class="n">at</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">])</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span>
                        <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">-</span>
                        <span class="n">b_slope</span><span class="o">*</span><span class="n">at</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">])</span><span class="o">*</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span> <span class="o">+</span>
                        <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">-</span>
                        <span class="n">b_slope</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">at</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">])</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">5</span><span class="o">*</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span>
                        <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">+</span>
                        <span class="n">b_slope</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">at</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">])</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span>
                        <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">+</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">b_slope</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">at</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">])</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span>
                        <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">b_slope</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">at</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">])</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span>
                        <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">-</span>
                        <span class="n">b_slope</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">at</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">])</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span>
                        <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">+</span>
                        <span class="n">b_slope</span><span class="o">*</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">at</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">5</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">])</span><span class="o">*</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span>
                        <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">+</span>
                        <span class="n">b_slope</span><span class="o">*</span><span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">at</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">])</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">5</span><span class="o">*</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span>
                        <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">-</span>
                        <span class="n">b_slope</span><span class="o">*</span><span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">at</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">])</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span>
                        <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">b_slope</span><span class="o">*</span><span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">at</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">])</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span>
                        <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">+</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">b_slope</span><span class="o">*</span><span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">at</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">])</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span>
                        <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">+</span>
                        <span class="n">b_slope</span><span class="o">*</span><span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">at</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">])</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span>
                        <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">-</span>
                        <span class="n">b_slope</span><span class="o">*</span><span class="n">zt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">at</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">5</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">])</span><span class="o">*</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span>
                        <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">-</span>
                        <span class="n">bt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">at</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">])</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">5</span><span class="o">*</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span>
                        <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">+</span>
                        <span class="n">bt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">at</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">])</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span>
                        <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">+</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">bt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">at</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">])</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span>
                        <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">-</span>
                        <span class="mi">2</span><span class="o">*</span><span class="n">bt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">at</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">])</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span>
                        <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">-</span>
                        <span class="n">bt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">at</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">])</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span>
                        <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">+</span>
                        <span class="n">bt</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">at</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">5</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">])</span><span class="o">*</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span>
                        <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">zb</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">])))</span>

        <span class="c1">#A is symmetric</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">neig</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">neig</span><span class="p">):</span>
                <span class="n">A</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span>

    <span class="k">elif</span> <span class="n">implementation</span> <span class="o">==</span> <span class="s1">&#39;fortran&#39;</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">MUST_TRY_FORTRAN</span><span class="p">:</span>
            <span class="kn">import</span> <span class="nn">geotecha.speccon.ext_integrals</span> <span class="k">as</span> <span class="nn">ext_integ</span>
            <span class="n">A</span> <span class="o">=</span> <span class="n">ext_integ</span><span class="o">.</span><span class="n">dim1sin_dd_abddf_linear</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">at</span><span class="p">,</span> <span class="n">ab</span><span class="p">,</span> <span class="n">bt</span><span class="p">,</span> <span class="n">bb</span><span class="p">,</span> <span class="n">zt</span><span class="p">,</span> <span class="n">zb</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="kn">import</span> <span class="nn">geotecha.speccon.ext_integrals</span> <span class="k">as</span> <span class="nn">ext_integ</span>
                <span class="n">A</span> <span class="o">=</span> <span class="n">ext_integ</span><span class="o">.</span><span class="n">dim1sin_dd_abddf_linear</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">at</span><span class="p">,</span> <span class="n">ab</span><span class="p">,</span> <span class="n">bt</span><span class="p">,</span> <span class="n">bb</span><span class="p">,</span> <span class="n">zt</span><span class="p">,</span> <span class="n">zb</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
                <span class="n">A</span> <span class="o">=</span> <span class="n">dim1sin_DD_abDDf_linear</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">at</span><span class="p">,</span> <span class="n">ab</span><span class="p">,</span> <span class="n">bt</span><span class="p">,</span> <span class="n">bb</span><span class="p">,</span> <span class="n">zt</span><span class="p">,</span> <span class="n">zb</span><span class="p">,</span> <span class="n">implementation</span><span class="o">=</span><span class="s1">&#39;vectorized&#39;</span><span class="p">)</span>

    <span class="k">else</span><span class="p">:</span><span class="c1">#default is &#39;vectorized&#39; using numpy</span>
        <span class="n">sin</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span>
        <span class="n">cos</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span>
        <span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="n">neig</span><span class="p">,</span> <span class="n">neig</span><span class="p">],</span> <span class="nb">float</span><span class="p">)</span>

        <span class="n">diag</span> <span class="o">=</span>  <span class="n">np</span><span class="o">.</span><span class="n">diag_indices</span><span class="p">(</span><span class="n">neig</span><span class="p">)</span>
        <span class="n">triu</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">triu_indices</span><span class="p">(</span><span class="n">neig</span><span class="p">,</span> <span class="n">k</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">tril</span> <span class="o">=</span> <span class="p">(</span><span class="n">triu</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">triu</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

        <span class="n">a_slope</span> <span class="o">=</span> <span class="p">(</span><span class="n">ab</span> <span class="o">-</span> <span class="n">at</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">zb</span> <span class="o">-</span> <span class="n">zt</span><span class="p">)</span>
        <span class="n">b_slope</span> <span class="o">=</span> <span class="p">(</span><span class="n">bb</span> <span class="o">-</span> <span class="n">bt</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">zb</span> <span class="o">-</span> <span class="n">zt</span><span class="p">)</span>

        <span class="n">mi</span> <span class="o">=</span> <span class="n">m</span><span class="p">[:,</span> <span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">]</span>
        <span class="n">A</span><span class="p">[</span><span class="n">diag</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="o">-</span><span class="n">mi</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="p">(</span><span class="n">a_slope</span><span class="o">*</span><span class="n">b_slope</span><span class="o">*</span><span class="n">zt</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zt</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="mi">6</span> <span class="o">+</span> <span class="n">a_slope</span><span class="o">*</span><span class="n">b_slope</span><span class="o">*</span><span class="n">zt</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zt</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="mi">6</span> <span class="o">+</span>
            <span class="n">a_slope</span><span class="o">*</span><span class="n">b_slope</span><span class="o">*</span><span class="n">zt</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zt</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="p">(</span><span class="mi">4</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">a_slope</span><span class="o">*</span><span class="n">b_slope</span><span class="o">*</span><span class="n">zt</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zt</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="p">(</span><span class="mi">4</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
            <span class="o">+</span> <span class="n">a_slope</span><span class="o">*</span><span class="n">b_slope</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zt</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zt</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mi">4</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">-</span> <span class="n">a_slope</span><span class="o">*</span><span class="n">zt</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zt</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">bt</span><span class="o">/</span><span class="mi">4</span> <span class="o">-</span>
            <span class="n">a_slope</span><span class="o">*</span><span class="n">zt</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zt</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">bt</span><span class="o">/</span><span class="mi">4</span> <span class="o">-</span> <span class="n">a_slope</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zt</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">bt</span><span class="o">/</span><span class="p">(</span><span class="mi">4</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span>
            <span class="n">b_slope</span><span class="o">*</span><span class="n">zt</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zt</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">at</span><span class="o">/</span><span class="mi">4</span> <span class="o">-</span> <span class="n">b_slope</span><span class="o">*</span><span class="n">zt</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zt</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">at</span><span class="o">/</span><span class="mi">4</span> <span class="o">-</span>
            <span class="n">b_slope</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zt</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">at</span><span class="o">/</span><span class="p">(</span><span class="mi">4</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">zt</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zt</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">bt</span><span class="o">*</span><span class="n">at</span><span class="o">/</span><span class="mi">2</span> <span class="o">+</span> <span class="n">zt</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zt</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">bt</span><span class="o">*</span><span class="n">at</span><span class="o">/</span><span class="mi">2</span>
            <span class="o">-</span> <span class="n">cos</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zt</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zt</span><span class="p">)</span><span class="o">*</span><span class="n">bt</span><span class="o">*</span><span class="n">at</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">mi</span><span class="p">))</span> <span class="o">+</span> <span class="n">mi</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="p">(</span><span class="n">a_slope</span><span class="o">*</span><span class="n">b_slope</span><span class="o">*</span><span class="n">zb</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">zt</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="mi">2</span>
            <span class="o">+</span> <span class="n">a_slope</span><span class="o">*</span><span class="n">b_slope</span><span class="o">*</span><span class="n">zb</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">zt</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="mi">2</span> <span class="o">-</span> <span class="n">a_slope</span><span class="o">*</span><span class="n">b_slope</span><span class="o">*</span><span class="n">zb</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">zt</span><span class="o">/</span><span class="mi">2</span> <span class="o">-</span>
            <span class="n">a_slope</span><span class="o">*</span><span class="n">b_slope</span><span class="o">*</span><span class="n">zb</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">zt</span><span class="o">/</span><span class="mi">2</span> <span class="o">+</span> <span class="n">a_slope</span><span class="o">*</span><span class="n">b_slope</span><span class="o">*</span><span class="n">zb</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="mi">6</span> <span class="o">+</span>
            <span class="n">a_slope</span><span class="o">*</span><span class="n">b_slope</span><span class="o">*</span><span class="n">zb</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="mi">6</span> <span class="o">-</span>
            <span class="n">a_slope</span><span class="o">*</span><span class="n">b_slope</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">zt</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">mi</span><span class="p">)</span> <span class="o">+</span>
            <span class="n">a_slope</span><span class="o">*</span><span class="n">b_slope</span><span class="o">*</span><span class="n">zb</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">zt</span><span class="o">/</span><span class="n">mi</span> <span class="o">-</span>
            <span class="n">a_slope</span><span class="o">*</span><span class="n">b_slope</span><span class="o">*</span><span class="n">zb</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">mi</span><span class="p">)</span> <span class="o">+</span>
            <span class="n">a_slope</span><span class="o">*</span><span class="n">b_slope</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">zt</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">a_slope</span><span class="o">*</span><span class="n">b_slope</span><span class="o">*</span><span class="n">zb</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="p">(</span><span class="mi">4</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
            <span class="o">-</span> <span class="n">a_slope</span><span class="o">*</span><span class="n">b_slope</span><span class="o">*</span><span class="n">zb</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="p">(</span><span class="mi">4</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span>
            <span class="n">a_slope</span><span class="o">*</span><span class="n">b_slope</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mi">4</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">-</span> <span class="n">a_slope</span><span class="o">*</span><span class="n">zb</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">zt</span><span class="o">*</span><span class="n">bt</span><span class="o">/</span><span class="mi">2</span> <span class="o">-</span>
            <span class="n">a_slope</span><span class="o">*</span><span class="n">zb</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">zt</span><span class="o">*</span><span class="n">bt</span><span class="o">/</span><span class="mi">2</span> <span class="o">+</span> <span class="n">a_slope</span><span class="o">*</span><span class="n">zb</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">bt</span><span class="o">/</span><span class="mi">4</span> <span class="o">+</span>
            <span class="n">a_slope</span><span class="o">*</span><span class="n">zb</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">bt</span><span class="o">/</span><span class="mi">4</span> <span class="o">+</span> <span class="n">a_slope</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">zt</span><span class="o">*</span><span class="n">bt</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">mi</span><span class="p">)</span> <span class="o">-</span>
            <span class="n">a_slope</span><span class="o">*</span><span class="n">zb</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">bt</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">mi</span><span class="p">)</span> <span class="o">-</span> <span class="n">a_slope</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">bt</span><span class="o">/</span><span class="p">(</span><span class="mi">4</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span>
            <span class="n">b_slope</span><span class="o">*</span><span class="n">zb</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">zt</span><span class="o">*</span><span class="n">at</span><span class="o">/</span><span class="mi">2</span> <span class="o">-</span> <span class="n">b_slope</span><span class="o">*</span><span class="n">zb</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">zt</span><span class="o">*</span><span class="n">at</span><span class="o">/</span><span class="mi">2</span> <span class="o">+</span>
            <span class="n">b_slope</span><span class="o">*</span><span class="n">zb</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">at</span><span class="o">/</span><span class="mi">4</span> <span class="o">+</span> <span class="n">b_slope</span><span class="o">*</span><span class="n">zb</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">at</span><span class="o">/</span><span class="mi">4</span> <span class="o">+</span>
            <span class="n">b_slope</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">zt</span><span class="o">*</span><span class="n">at</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">mi</span><span class="p">)</span> <span class="o">-</span> <span class="n">b_slope</span><span class="o">*</span><span class="n">zb</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">at</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">mi</span><span class="p">)</span>
            <span class="o">-</span> <span class="n">b_slope</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">at</span><span class="o">/</span><span class="p">(</span><span class="mi">4</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">zb</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">bt</span><span class="o">*</span><span class="n">at</span><span class="o">/</span><span class="mi">2</span> <span class="o">+</span>
            <span class="n">zb</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">bt</span><span class="o">*</span><span class="n">at</span><span class="o">/</span><span class="mi">2</span> <span class="o">-</span> <span class="n">cos</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">bt</span><span class="o">*</span><span class="n">at</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">mi</span><span class="p">)),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

        <span class="n">mi</span> <span class="o">=</span> <span class="n">m</span><span class="p">[</span><span class="n">triu</span><span class="p">[</span><span class="mi">0</span><span class="p">]][:,</span> <span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">]</span>
        <span class="n">mj</span> <span class="o">=</span> <span class="n">m</span><span class="p">[</span><span class="n">triu</span><span class="p">[</span><span class="mi">1</span><span class="p">]][:,</span> <span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">]</span>
        <span class="n">A</span><span class="p">[</span><span class="n">triu</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="o">-</span><span class="n">mi</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">a_slope</span><span class="o">*</span><span class="n">b_slope</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zt</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mj</span><span class="o">*</span><span class="n">zt</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">mi</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">4</span> <span class="o">-</span>
            <span class="n">mj</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span> <span class="o">-</span> <span class="mi">6</span><span class="o">*</span><span class="n">a_slope</span><span class="o">*</span><span class="n">b_slope</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">mj</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mj</span><span class="o">*</span><span class="n">zt</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zt</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">mi</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span>
            <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">4</span> <span class="o">-</span> <span class="n">mj</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span> <span class="o">+</span> <span class="mi">6</span><span class="o">*</span><span class="n">a_slope</span><span class="o">*</span><span class="n">b_slope</span><span class="o">*</span><span class="n">mi</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zt</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mj</span><span class="o">*</span><span class="n">zt</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">mi</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span>
            <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">4</span> <span class="o">-</span> <span class="n">mj</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span> <span class="o">-</span>
            <span class="mi">2</span><span class="o">*</span><span class="n">a_slope</span><span class="o">*</span><span class="n">b_slope</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mj</span><span class="o">*</span><span class="n">zt</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zt</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">mi</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">4</span> <span class="o">-</span>
            <span class="n">mj</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span> <span class="o">+</span> <span class="n">a_slope</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zt</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mj</span><span class="o">*</span><span class="n">zt</span><span class="p">)</span><span class="o">*</span><span class="n">bt</span><span class="o">/</span><span class="p">(</span><span class="n">mi</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">4</span> <span class="o">-</span>
            <span class="n">mj</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">a_slope</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">mj</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zt</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mj</span><span class="o">*</span><span class="n">zt</span><span class="p">)</span><span class="o">*</span><span class="n">bt</span><span class="o">/</span><span class="p">(</span><span class="n">mi</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span>
            <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">4</span> <span class="o">-</span> <span class="n">mj</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">a_slope</span><span class="o">*</span><span class="n">mi</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zt</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mj</span><span class="o">*</span><span class="n">zt</span><span class="p">)</span><span class="o">*</span><span class="n">bt</span><span class="o">/</span><span class="p">(</span><span class="n">mi</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span>
            <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">4</span> <span class="o">-</span> <span class="n">mj</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span> <span class="o">-</span> <span class="n">a_slope</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zt</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mj</span><span class="o">*</span><span class="n">zt</span><span class="p">)</span><span class="o">*</span><span class="n">bt</span><span class="o">/</span><span class="p">(</span><span class="n">mi</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span>
            <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">4</span> <span class="o">-</span> <span class="n">mj</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span> <span class="o">+</span> <span class="n">b_slope</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zt</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mj</span><span class="o">*</span><span class="n">zt</span><span class="p">)</span><span class="o">*</span><span class="n">at</span><span class="o">/</span><span class="p">(</span><span class="n">mi</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span>
            <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">4</span> <span class="o">-</span> <span class="n">mj</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span> <span class="o">+</span>
            <span class="mi">2</span><span class="o">*</span><span class="n">b_slope</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">mj</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zt</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mj</span><span class="o">*</span><span class="n">zt</span><span class="p">)</span><span class="o">*</span><span class="n">at</span><span class="o">/</span><span class="p">(</span><span class="n">mi</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">4</span> <span class="o">-</span>
            <span class="n">mj</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">b_slope</span><span class="o">*</span><span class="n">mi</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zt</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mj</span><span class="o">*</span><span class="n">zt</span><span class="p">)</span><span class="o">*</span><span class="n">at</span><span class="o">/</span><span class="p">(</span><span class="n">mi</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span>
            <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">4</span> <span class="o">-</span> <span class="n">mj</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span> <span class="o">-</span> <span class="n">b_slope</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zt</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mj</span><span class="o">*</span><span class="n">zt</span><span class="p">)</span><span class="o">*</span><span class="n">at</span><span class="o">/</span><span class="p">(</span><span class="n">mi</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span>
            <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">4</span> <span class="o">-</span> <span class="n">mj</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span> <span class="o">-</span> <span class="n">mi</span><span class="o">**</span><span class="mi">5</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zt</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mj</span><span class="o">*</span><span class="n">zt</span><span class="p">)</span><span class="o">*</span><span class="n">bt</span><span class="o">*</span><span class="n">at</span><span class="o">/</span><span class="p">(</span><span class="n">mi</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span>
            <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">4</span> <span class="o">-</span> <span class="n">mj</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span> <span class="o">+</span> <span class="n">mi</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">mj</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mj</span><span class="o">*</span><span class="n">zt</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zt</span><span class="p">)</span><span class="o">*</span><span class="n">bt</span><span class="o">*</span><span class="n">at</span><span class="o">/</span><span class="p">(</span><span class="n">mi</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span>
            <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">4</span> <span class="o">-</span> <span class="n">mj</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zt</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mj</span><span class="o">*</span><span class="n">zt</span><span class="p">)</span><span class="o">*</span><span class="n">bt</span><span class="o">*</span><span class="n">at</span><span class="o">/</span><span class="p">(</span><span class="n">mi</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span>
            <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">4</span> <span class="o">-</span> <span class="n">mj</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span> <span class="o">-</span>
            <span class="mi">2</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mj</span><span class="o">*</span><span class="n">zt</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zt</span><span class="p">)</span><span class="o">*</span><span class="n">bt</span><span class="o">*</span><span class="n">at</span><span class="o">/</span><span class="p">(</span><span class="n">mi</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">4</span> <span class="o">-</span>
            <span class="n">mj</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span> <span class="o">-</span> <span class="n">mi</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zt</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mj</span><span class="o">*</span><span class="n">zt</span><span class="p">)</span><span class="o">*</span><span class="n">bt</span><span class="o">*</span><span class="n">at</span><span class="o">/</span><span class="p">(</span><span class="n">mi</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">4</span> <span class="o">-</span>
            <span class="n">mj</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span> <span class="o">+</span> <span class="n">mj</span><span class="o">**</span><span class="mi">5</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mj</span><span class="o">*</span><span class="n">zt</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zt</span><span class="p">)</span><span class="o">*</span><span class="n">bt</span><span class="o">*</span><span class="n">at</span><span class="o">/</span><span class="p">(</span><span class="n">mi</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">4</span> <span class="o">-</span>
            <span class="n">mj</span><span class="o">**</span><span class="mi">6</span><span class="p">))</span> <span class="o">+</span> <span class="n">mi</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">a_slope</span><span class="o">*</span><span class="n">b_slope</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">5</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mj</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">zt</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="p">(</span><span class="n">mi</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span>
            <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">4</span> <span class="o">-</span> <span class="n">mj</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span> <span class="o">+</span>
            <span class="mi">2</span><span class="o">*</span><span class="n">a_slope</span><span class="o">*</span><span class="n">b_slope</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">5</span><span class="o">*</span><span class="n">zb</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mj</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">zt</span><span class="o">/</span><span class="p">(</span><span class="n">mi</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span>
            <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">4</span> <span class="o">-</span> <span class="n">mj</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span> <span class="o">-</span> <span class="n">a_slope</span><span class="o">*</span><span class="n">b_slope</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">5</span><span class="o">*</span><span class="n">zb</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mj</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">mi</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span>
            <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">4</span> <span class="o">-</span> <span class="n">mj</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span> <span class="o">+</span>
            <span class="n">a_slope</span><span class="o">*</span><span class="n">b_slope</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">mj</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mj</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">zt</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="p">(</span><span class="n">mi</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span>
            <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">4</span> <span class="o">-</span> <span class="n">mj</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">a_slope</span><span class="o">*</span><span class="n">b_slope</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">mj</span><span class="o">*</span><span class="n">zb</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mj</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">zt</span><span class="o">/</span><span class="p">(</span><span class="n">mi</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span>
            <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">4</span> <span class="o">-</span> <span class="n">mj</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span> <span class="o">+</span>
            <span class="n">a_slope</span><span class="o">*</span><span class="n">b_slope</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">mj</span><span class="o">*</span><span class="n">zb</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mj</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">mi</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span>
            <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">4</span> <span class="o">-</span> <span class="n">mj</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">a_slope</span><span class="o">*</span><span class="n">b_slope</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mj</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">zt</span><span class="o">/</span><span class="p">(</span><span class="n">mi</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span>
            <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">4</span> <span class="o">-</span> <span class="n">mj</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span> <span class="o">+</span>
            <span class="mi">2</span><span class="o">*</span><span class="n">a_slope</span><span class="o">*</span><span class="n">b_slope</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">zb</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mj</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">mi</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">4</span>
            <span class="o">-</span> <span class="n">mj</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">a_slope</span><span class="o">*</span><span class="n">b_slope</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mj</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">zt</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="p">(</span><span class="n">mi</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span>
            <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">4</span> <span class="o">-</span> <span class="n">mj</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span> <span class="o">-</span>
            <span class="mi">4</span><span class="o">*</span><span class="n">a_slope</span><span class="o">*</span><span class="n">b_slope</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">zb</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mj</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">zt</span><span class="o">/</span><span class="p">(</span><span class="n">mi</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span>
            <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">4</span> <span class="o">-</span> <span class="n">mj</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span> <span class="o">+</span>
            <span class="mi">2</span><span class="o">*</span><span class="n">a_slope</span><span class="o">*</span><span class="n">b_slope</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">zb</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mj</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">mi</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span>
            <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">4</span> <span class="o">-</span> <span class="n">mj</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span> <span class="o">-</span> <span class="mi">4</span><span class="o">*</span><span class="n">a_slope</span><span class="o">*</span><span class="n">b_slope</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">mj</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mj</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">zt</span><span class="o">/</span><span class="p">(</span><span class="n">mi</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span>
            <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">4</span> <span class="o">-</span> <span class="n">mj</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span> <span class="o">+</span>
            <span class="mi">4</span><span class="o">*</span><span class="n">a_slope</span><span class="o">*</span><span class="n">b_slope</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">mj</span><span class="o">*</span><span class="n">zb</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mj</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">mi</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span>
            <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">4</span> <span class="o">-</span> <span class="n">mj</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">a_slope</span><span class="o">*</span><span class="n">b_slope</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mj</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">mi</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span>
            <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">4</span> <span class="o">-</span> <span class="n">mj</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span> <span class="o">-</span>
            <span class="mi">2</span><span class="o">*</span><span class="n">a_slope</span><span class="o">*</span><span class="n">b_slope</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mj</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">zt</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="p">(</span><span class="n">mi</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span>
            <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">4</span> <span class="o">-</span> <span class="n">mj</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span> <span class="o">+</span>
            <span class="mi">4</span><span class="o">*</span><span class="n">a_slope</span><span class="o">*</span><span class="n">b_slope</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">zb</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mj</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">zt</span><span class="o">/</span><span class="p">(</span><span class="n">mi</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span>
            <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">4</span> <span class="o">-</span> <span class="n">mj</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span> <span class="o">-</span>
            <span class="mi">2</span><span class="o">*</span><span class="n">a_slope</span><span class="o">*</span><span class="n">b_slope</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">zb</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mj</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">mi</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span>
            <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">4</span> <span class="o">-</span> <span class="n">mj</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span> <span class="o">-</span> <span class="mi">6</span><span class="o">*</span><span class="n">a_slope</span><span class="o">*</span><span class="n">b_slope</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">mj</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mj</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">mi</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span>
            <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">4</span> <span class="o">-</span> <span class="n">mj</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span> <span class="o">-</span>
            <span class="n">a_slope</span><span class="o">*</span><span class="n">b_slope</span><span class="o">*</span><span class="n">mi</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mj</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">zt</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="p">(</span><span class="n">mi</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span>
            <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">4</span> <span class="o">-</span> <span class="n">mj</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">a_slope</span><span class="o">*</span><span class="n">b_slope</span><span class="o">*</span><span class="n">mi</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">zb</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mj</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">zt</span><span class="o">/</span><span class="p">(</span><span class="n">mi</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span>
            <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">4</span> <span class="o">-</span> <span class="n">mj</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span> <span class="o">-</span>
            <span class="n">a_slope</span><span class="o">*</span><span class="n">b_slope</span><span class="o">*</span><span class="n">mi</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">zb</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mj</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">mi</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span>
            <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">4</span> <span class="o">-</span> <span class="n">mj</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span> <span class="o">+</span> <span class="mi">4</span><span class="o">*</span><span class="n">a_slope</span><span class="o">*</span><span class="n">b_slope</span><span class="o">*</span><span class="n">mi</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mj</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">zt</span><span class="o">/</span><span class="p">(</span><span class="n">mi</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span>
            <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">4</span> <span class="o">-</span> <span class="n">mj</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span> <span class="o">-</span>
            <span class="mi">4</span><span class="o">*</span><span class="n">a_slope</span><span class="o">*</span><span class="n">b_slope</span><span class="o">*</span><span class="n">mi</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">zb</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mj</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">mi</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span>
            <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">4</span> <span class="o">-</span> <span class="n">mj</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span> <span class="o">+</span> <span class="mi">6</span><span class="o">*</span><span class="n">a_slope</span><span class="o">*</span><span class="n">b_slope</span><span class="o">*</span><span class="n">mi</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mj</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">mi</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span>
            <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">4</span> <span class="o">-</span> <span class="n">mj</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span> <span class="o">+</span>
            <span class="n">a_slope</span><span class="o">*</span><span class="n">b_slope</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">5</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mj</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">zt</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="p">(</span><span class="n">mi</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">4</span>
            <span class="o">-</span> <span class="n">mj</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">a_slope</span><span class="o">*</span><span class="n">b_slope</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">5</span><span class="o">*</span><span class="n">zb</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mj</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">zt</span><span class="o">/</span><span class="p">(</span><span class="n">mi</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span>
            <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">4</span> <span class="o">-</span> <span class="n">mj</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span> <span class="o">+</span> <span class="n">a_slope</span><span class="o">*</span><span class="n">b_slope</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">5</span><span class="o">*</span><span class="n">zb</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mj</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">mi</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span>
            <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">4</span> <span class="o">-</span> <span class="n">mj</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span> <span class="o">+</span>
            <span class="mi">2</span><span class="o">*</span><span class="n">a_slope</span><span class="o">*</span><span class="n">b_slope</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mj</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">zt</span><span class="o">/</span><span class="p">(</span><span class="n">mi</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">4</span>
            <span class="o">-</span> <span class="n">mj</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">a_slope</span><span class="o">*</span><span class="n">b_slope</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">zb</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mj</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">mi</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span>
            <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">4</span> <span class="o">-</span> <span class="n">mj</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">a_slope</span><span class="o">*</span><span class="n">b_slope</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mj</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">mi</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span>
            <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">4</span> <span class="o">-</span> <span class="n">mj</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span> <span class="o">+</span>
            <span class="n">a_slope</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">5</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mj</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">zt</span><span class="o">*</span><span class="n">bt</span><span class="o">/</span><span class="p">(</span><span class="n">mi</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">4</span> <span class="o">-</span>
            <span class="n">mj</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span> <span class="o">-</span> <span class="n">a_slope</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">5</span><span class="o">*</span><span class="n">zb</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mj</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">bt</span><span class="o">/</span><span class="p">(</span><span class="n">mi</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span>
            <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">4</span> <span class="o">-</span> <span class="n">mj</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span> <span class="o">-</span> <span class="n">a_slope</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">mj</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mj</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">zt</span><span class="o">*</span><span class="n">bt</span><span class="o">/</span><span class="p">(</span><span class="n">mi</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span>
            <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">4</span> <span class="o">-</span> <span class="n">mj</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span> <span class="o">+</span>
            <span class="n">a_slope</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">mj</span><span class="o">*</span><span class="n">zb</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mj</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">bt</span><span class="o">/</span><span class="p">(</span><span class="n">mi</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">4</span> <span class="o">-</span>
            <span class="n">mj</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span> <span class="o">+</span> <span class="n">a_slope</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mj</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">bt</span><span class="o">/</span><span class="p">(</span><span class="n">mi</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">4</span> <span class="o">-</span>
            <span class="n">mj</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">a_slope</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mj</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">zt</span><span class="o">*</span><span class="n">bt</span><span class="o">/</span><span class="p">(</span><span class="n">mi</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span>
            <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">4</span> <span class="o">-</span> <span class="n">mj</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">a_slope</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">zb</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mj</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">bt</span><span class="o">/</span><span class="p">(</span><span class="n">mi</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span>
            <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">4</span> <span class="o">-</span> <span class="n">mj</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span> <span class="o">+</span>
            <span class="mi">2</span><span class="o">*</span><span class="n">a_slope</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">mj</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mj</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">bt</span><span class="o">/</span><span class="p">(</span><span class="n">mi</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">4</span> <span class="o">-</span>
            <span class="n">mj</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">a_slope</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mj</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">zt</span><span class="o">*</span><span class="n">bt</span><span class="o">/</span><span class="p">(</span><span class="n">mi</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span>
            <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">4</span> <span class="o">-</span> <span class="n">mj</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">a_slope</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">zb</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mj</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">bt</span><span class="o">/</span><span class="p">(</span><span class="n">mi</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span>
            <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">4</span> <span class="o">-</span> <span class="n">mj</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span> <span class="o">+</span>
            <span class="n">a_slope</span><span class="o">*</span><span class="n">mi</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mj</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">zt</span><span class="o">*</span><span class="n">bt</span><span class="o">/</span><span class="p">(</span><span class="n">mi</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">4</span> <span class="o">-</span>
            <span class="n">mj</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span> <span class="o">-</span> <span class="n">a_slope</span><span class="o">*</span><span class="n">mi</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">zb</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mj</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">bt</span><span class="o">/</span><span class="p">(</span><span class="n">mi</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span>
            <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">4</span> <span class="o">-</span> <span class="n">mj</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">a_slope</span><span class="o">*</span><span class="n">mi</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mj</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">bt</span><span class="o">/</span><span class="p">(</span><span class="n">mi</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span>
            <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">4</span> <span class="o">-</span> <span class="n">mj</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span> <span class="o">-</span>
            <span class="n">a_slope</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">5</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mj</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">zt</span><span class="o">*</span><span class="n">bt</span><span class="o">/</span><span class="p">(</span><span class="n">mi</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">4</span> <span class="o">-</span>
            <span class="n">mj</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span> <span class="o">+</span> <span class="n">a_slope</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">5</span><span class="o">*</span><span class="n">zb</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mj</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">bt</span><span class="o">/</span><span class="p">(</span><span class="n">mi</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span>
            <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">4</span> <span class="o">-</span> <span class="n">mj</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span> <span class="o">-</span> <span class="n">a_slope</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mj</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">bt</span><span class="o">/</span><span class="p">(</span><span class="n">mi</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span>
            <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">4</span> <span class="o">-</span> <span class="n">mj</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span> <span class="o">+</span> <span class="n">b_slope</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">5</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mj</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">zt</span><span class="o">*</span><span class="n">at</span><span class="o">/</span><span class="p">(</span><span class="n">mi</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span>
            <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">4</span> <span class="o">-</span> <span class="n">mj</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span> <span class="o">-</span>
            <span class="n">b_slope</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">5</span><span class="o">*</span><span class="n">zb</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mj</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">at</span><span class="o">/</span><span class="p">(</span><span class="n">mi</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">4</span> <span class="o">-</span>
            <span class="n">mj</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span> <span class="o">-</span> <span class="n">b_slope</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">mj</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mj</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">zt</span><span class="o">*</span><span class="n">at</span><span class="o">/</span><span class="p">(</span><span class="n">mi</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span>
            <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">4</span> <span class="o">-</span> <span class="n">mj</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span> <span class="o">+</span> <span class="n">b_slope</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">mj</span><span class="o">*</span><span class="n">zb</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mj</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">at</span><span class="o">/</span><span class="p">(</span><span class="n">mi</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span>
            <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">4</span> <span class="o">-</span> <span class="n">mj</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span> <span class="o">+</span> <span class="n">b_slope</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mj</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">at</span><span class="o">/</span><span class="p">(</span><span class="n">mi</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span>
            <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">4</span> <span class="o">-</span> <span class="n">mj</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span> <span class="o">-</span>
            <span class="mi">2</span><span class="o">*</span><span class="n">b_slope</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mj</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">zt</span><span class="o">*</span><span class="n">at</span><span class="o">/</span><span class="p">(</span><span class="n">mi</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">4</span>
            <span class="o">-</span> <span class="n">mj</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">b_slope</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">zb</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mj</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">at</span><span class="o">/</span><span class="p">(</span><span class="n">mi</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span>
            <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">4</span> <span class="o">-</span> <span class="n">mj</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">b_slope</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">mj</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mj</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">at</span><span class="o">/</span><span class="p">(</span><span class="n">mi</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span>
            <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">4</span> <span class="o">-</span> <span class="n">mj</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span> <span class="o">+</span>
            <span class="mi">2</span><span class="o">*</span><span class="n">b_slope</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mj</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">zt</span><span class="o">*</span><span class="n">at</span><span class="o">/</span><span class="p">(</span><span class="n">mi</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">4</span>
            <span class="o">-</span> <span class="n">mj</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">b_slope</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">zb</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mj</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">at</span><span class="o">/</span><span class="p">(</span><span class="n">mi</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span>
            <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">4</span> <span class="o">-</span> <span class="n">mj</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span> <span class="o">+</span> <span class="n">b_slope</span><span class="o">*</span><span class="n">mi</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mj</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">zt</span><span class="o">*</span><span class="n">at</span><span class="o">/</span><span class="p">(</span><span class="n">mi</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span>
            <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">4</span> <span class="o">-</span> <span class="n">mj</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span> <span class="o">-</span>
            <span class="n">b_slope</span><span class="o">*</span><span class="n">mi</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">zb</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mj</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">at</span><span class="o">/</span><span class="p">(</span><span class="n">mi</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">4</span> <span class="o">-</span>
            <span class="n">mj</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">b_slope</span><span class="o">*</span><span class="n">mi</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mj</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">at</span><span class="o">/</span><span class="p">(</span><span class="n">mi</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span>
            <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">4</span> <span class="o">-</span> <span class="n">mj</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span> <span class="o">-</span> <span class="n">b_slope</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">5</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mj</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">zt</span><span class="o">*</span><span class="n">at</span><span class="o">/</span><span class="p">(</span><span class="n">mi</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span>
            <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">4</span> <span class="o">-</span> <span class="n">mj</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span> <span class="o">+</span>
            <span class="n">b_slope</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">5</span><span class="o">*</span><span class="n">zb</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mj</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">at</span><span class="o">/</span><span class="p">(</span><span class="n">mi</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">4</span> <span class="o">-</span>
            <span class="n">mj</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span> <span class="o">-</span> <span class="n">b_slope</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mj</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">at</span><span class="o">/</span><span class="p">(</span><span class="n">mi</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">4</span> <span class="o">-</span>
            <span class="n">mj</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span> <span class="o">-</span> <span class="n">mi</span><span class="o">**</span><span class="mi">5</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mj</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">bt</span><span class="o">*</span><span class="n">at</span><span class="o">/</span><span class="p">(</span><span class="n">mi</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">4</span> <span class="o">-</span>
            <span class="n">mj</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span> <span class="o">+</span> <span class="n">mi</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">mj</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mj</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">bt</span><span class="o">*</span><span class="n">at</span><span class="o">/</span><span class="p">(</span><span class="n">mi</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">4</span> <span class="o">-</span>
            <span class="n">mj</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mj</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">bt</span><span class="o">*</span><span class="n">at</span><span class="o">/</span><span class="p">(</span><span class="n">mi</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span>
            <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">4</span> <span class="o">-</span> <span class="n">mj</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mj</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">bt</span><span class="o">*</span><span class="n">at</span><span class="o">/</span><span class="p">(</span><span class="n">mi</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span>
            <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">4</span> <span class="o">-</span> <span class="n">mj</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span> <span class="o">-</span> <span class="n">mi</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mj</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">bt</span><span class="o">*</span><span class="n">at</span><span class="o">/</span><span class="p">(</span><span class="n">mi</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span>
            <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">4</span> <span class="o">-</span> <span class="n">mj</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span> <span class="o">+</span> <span class="n">mj</span><span class="o">**</span><span class="mi">5</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">mj</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">mi</span><span class="o">*</span><span class="n">zb</span><span class="p">)</span><span class="o">*</span><span class="n">bt</span><span class="o">*</span><span class="n">at</span><span class="o">/</span><span class="p">(</span><span class="n">mi</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span>
            <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">mi</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">mj</span><span class="o">**</span><span class="mi">4</span> <span class="o">-</span> <span class="n">mj</span><span class="o">**</span><span class="mi">6</span><span class="p">)),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="c1">#A is symmetric</span>
        <span class="n">A</span><span class="p">[</span><span class="n">tril</span><span class="p">]</span> <span class="o">=</span> <span class="n">A</span><span class="p">[</span><span class="n">triu</span><span class="p">]</span>

    <span class="k">return</span> <span class="n">A</span></div>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="kn">import</span> <span class="nn">nose</span>
    <span class="n">nose</span><span class="o">.</span><span class="n">runmodule</span><span class="p">(</span><span class="n">argv</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;nose&#39;</span><span class="p">,</span> <span class="s1">&#39;--verbosity=3&#39;</span><span class="p">,</span> <span class="s1">&#39;--with-doctest&#39;</span><span class="p">])</span>
<span class="c1">#    nose.runmodule(argv=[&#39;nose&#39;, &#39;--verbosity=3&#39;])</span>
</pre></div>

          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2014, Rohan Walker.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 1.7.4</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.10</a>
      
    </div>

    

    
  </body>
</html>