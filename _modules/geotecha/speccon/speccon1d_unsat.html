
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>geotecha.speccon.speccon1d_unsat &#8212; geotecha 0.2.1 documentation</title>
    <link rel="stylesheet" href="../../../_static/default.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    <script type="text/javascript" src="../../../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../../_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
   
  <link rel="stylesheet" href="../../../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>

<div style="background-color: white; text-align: left; padding: 10px 10px 15px 15px">
<a href="../../../index.html"><img src="../../../_static/logo.png" border="0" alt="py4sci"/></a>
</div>



      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper"><div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../../../index.html">Documentation overview</a><ul>
  <li><a href="../../index.html">Module code</a><ul>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <h1>Source code for geotecha.speccon.speccon1d_unsat</h1><div class="highlight"><pre>
<span></span><span class="ch">#!/usr/bin/env python</span>
<span class="c1"># geotecha - A software suite for geotechncial engineering</span>
<span class="c1"># Copyright (C) 2018  Rohan T. Walker (rtrwalker@gmail.com)</span>
<span class="c1">#</span>
<span class="c1"># This program is free software: you can redistribute it and/or modify</span>
<span class="c1"># it under the terms of the GNU General Public License as published by</span>
<span class="c1"># the Free Software Foundation, either version 3 of the License, or</span>
<span class="c1"># (at your option) any later version.</span>
<span class="c1">#</span>
<span class="c1"># This program is distributed in the hope that it will be useful,</span>
<span class="c1"># but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<span class="c1"># MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span>
<span class="c1"># GNU General Public License for more details.</span>
<span class="c1">#</span>
<span class="c1"># You should have received a copy of the GNU General Public License</span>
<span class="c1"># along with this program.  If not, see http://www.gnu.org/licenses/gpl.html.</span>

<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Multilayer consolidation of unsaturated soil using the spectral Galerkin</span>
<span class="sd">method.</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="kn">from</span> <span class="nn">__future__</span> <span class="k">import</span> <span class="n">division</span><span class="p">,</span> <span class="n">print_function</span>

<span class="kn">import</span> <span class="nn">geotecha.plotting.one_d</span> <span class="c1">#import MarkersDashesColors as MarkersDashesColors</span>
<span class="kn">import</span> <span class="nn">time</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="kn">import</span> <span class="nn">geotecha.speccon.speccon1d</span> <span class="k">as</span> <span class="nn">speccon1d</span>
<span class="kn">import</span> <span class="nn">geotecha.piecewise.piecewise_linear_1d</span> <span class="k">as</span> <span class="nn">pwise</span>
<span class="kn">from</span> <span class="nn">geotecha.piecewise.piecewise_linear_1d</span> <span class="k">import</span> <span class="n">PolyLine</span>
<span class="kn">import</span> <span class="nn">geotecha.speccon.integrals</span> <span class="k">as</span> <span class="nn">integ</span>
<span class="kn">import</span> <span class="nn">geotecha.mathematics.transformations</span> <span class="k">as</span> <span class="nn">transformations</span>
<span class="kn">from</span> <span class="nn">geotecha.inputoutput.inputoutput</span> <span class="k">import</span> <span class="n">GenericInputFileArgParser</span>



<div class="viewcode-block" id="Speccon1dUnsat"><a class="viewcode-back" href="../../../api/geotecha.speccon.speccon1d_unsat.html#geotecha.speccon.speccon1d_unsat.Speccon1dUnsat">[docs]</a><span class="k">class</span> <span class="nc">Speccon1dUnsat</span><span class="p">(</span><span class="n">speccon1d</span><span class="o">.</span><span class="n">Speccon1d</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Multilayer consolidation of unsaturated soil</span>

<span class="sd">    Features:</span>

<span class="sd">     - Multiple layers.</span>
<span class="sd">     - Unsaturated vertical drainage only.</span>
<span class="sd">     - Water and air phases.</span>
<span class="sd">     - Material properties that are constant in time but piecewsie linear with</span>
<span class="sd">       depth.</span>
<span class="sd">     - Surcharge loading.</span>
<span class="sd">     - Independent non-zero top and bottom pore air and pore water pressure</span>
<span class="sd">       boundary conditions.</span>
<span class="sd">     - Surcharge/Boundary Conditions vary</span>
<span class="sd">       with time in a piecewise-linear function multiplied by a cosine</span>
<span class="sd">       function of time.</span>

<span class="sd">       - Surcharge can also vary piecewise linear with depth.</span>
<span class="sd">         The depth dependence does not vary with time.</span>
<span class="sd">       - Mulitple loads will be combined using superposition.</span>
<span class="sd">     - Subset of Python syntax available in input files/strings allowing</span>
<span class="sd">       basic calculations within input files.</span>
<span class="sd">     - Output:</span>

<span class="sd">       - Excess pore air and pore water pressure at depth</span>
<span class="sd">       - Average excess pore air and pore water pressure between depths.</span>
<span class="sd">       - Settlement between depths of air phase, water phase and overall.</span>
<span class="sd">       - Charts and csv output available.</span>
<span class="sd">     - Program can be run as script or in a python interpreter.</span>
<span class="sd">     - Note there is no pumping or fixed pore pressure functionality.</span>


<span class="sd">    .. warning::</span>
<span class="sd">        The &#39;Parameters&#39; and &#39;Attributes&#39; sections below require further</span>
<span class="sd">        explanation.  The parameters listed below are not used to explicitly</span>
<span class="sd">        initialize the object.  Rather they are defined in either a</span>
<span class="sd">        multi-line string or a file-like object using python syntax; the</span>
<span class="sd">        file/string is then used to initialize the object using the</span>
<span class="sd">        `reader` parameter. As well as simple assignment statements</span>
<span class="sd">        (H = 1, drn = 0 etc.), the input file/string can contain basic</span>
<span class="sd">        calculations (z = np.linspace(0, H, 20) etc.).  Not all of the</span>
<span class="sd">        listed parameters are needed. The user should pick an appropriate</span>
<span class="sd">        combination of attributes for their analysis (minimal explicit</span>
<span class="sd">        checks on input data will be performed).</span>
<span class="sd">        Each  &#39;parameter&#39; will be turned into an attribute that</span>
<span class="sd">        can be accessed using conventional python dot notation, after the</span>
<span class="sd">        object has been initialised.  The attributes listed below are</span>
<span class="sd">        calculated values (i.e. they could be interpreted as results) which</span>
<span class="sd">        are accessible using dot notation after all calculations are</span>
<span class="sd">        complete.</span>


<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    H : float, optional</span>
<span class="sd">        Total height of soil profile. Default H=1.0. Note that even though</span>
<span class="sd">        this program deals with normalised depth values it is important to</span>
<span class="sd">        enter the correct H valu, as it is used when plotting, outputing</span>
<span class="sd">        data and in normalising gradient boundary conditions (see</span>
<span class="sd">        `bot_vs_time` below)</span>
<span class="sd">    mvref : float, optional</span>
<span class="sd">        Reference value of volume compressibility mv (used with `H` in</span>
<span class="sd">        settlement calculations). Default mvref=1.0.  Note this is used to</span>
<span class="sd">        normalise all the unsaturated volume compressibilities. It is also</span>
<span class="sd">        used in the porosity/saturation term.</span>
<span class="sd">    kwref : float, optional</span>
<span class="sd">        Reference value of water phase vertical permeability kw in soil</span>
<span class="sd">        (only used for pretty output). Default kwref=1.0.</span>
<span class="sd">    Daref : float, optional</span>
<span class="sd">        Reference value of coefficeint of transmission for the air phase</span>
<span class="sd">        (only used for pretty output). Default Daref=1.0. (note ka=Da*g).</span>
<span class="sd">    drn : {0, 1}, optional</span>
<span class="sd">        drainage boundary condition. Default drn=0.</span>
<span class="sd">        0 = Pervious top pervious bottom (PTPB).</span>
<span class="sd">        1 = Pervious top impoervious bottom (PTIB).</span>
<span class="sd">    dT : float, optional</span>
<span class="sd">        Convienient normaliser for time factor multiplier. Default dT=1.0.</span>
<span class="sd">    neig : int, optional</span>
<span class="sd">        Number of series terms to use in solution. Default neig=2. Don&#39;t use</span>
<span class="sd">        neig=1.</span>
<span class="sd">    dTw : float</span>
<span class="sd">        Vertical reference time factor multiplier for water phase.</span>
<span class="sd">        dTw is calculated with the chosen reference values of kw and mv:</span>
<span class="sd">        dTw = kwref /(mvref*gamw) / H ^ 2</span>
<span class="sd">    dTa : float</span>
<span class="sd">        Vertical reference time factor multiplier for air phase.</span>
<span class="sd">        dTa is calculated with the chosen reference values of Da and mv:</span>
<span class="sd">        dTa = Daref / (mvref) / (wa/(R*T)/ua_ / H ^ 2. Where wa=molecular</span>
<span class="sd">        mass of air= 28.966e-3 kg/mol for air, R=universal gas</span>
<span class="sd">        constant=8.31432 J/(mol.K), T = absolute</span>
<span class="sd">        temperature in Kelvin=273.16+t0 (K), t0=temperature in celsius, ua_=</span>
<span class="sd">        absolute air pressure=ua+uatm (kPa), ua=guage air pressure, uatm=</span>
<span class="sd">        atmospheric air pressure=101 kPa.  When ua is small or rapidly</span>
<span class="sd">        dissipates during consolidation ua_ can be considered a constant;</span>
<span class="sd">        so let ua_=uatm</span>
<span class="sd">    m1ka : PolyLine</span>
<span class="sd">        Normalised coefficient of air volume change with respect to a change</span>
<span class="sd">        in the net normal stress (dsig-dua), PolyLine(depth, m1ka).</span>
<span class="sd">    m1kw : PolyLine</span>
<span class="sd">        Normalised coefficient of water volume change with respect to a change</span>
<span class="sd">        in the net normal stress (dsig-dua), PolyLine(depth, m1kw).</span>
<span class="sd">    m2a : PolyLine</span>
<span class="sd">        Normalised coefficient of air volume change with respect to a change</span>
<span class="sd">        in the matirx suction (duw-dua), PolyLine(depth, m2a).</span>
<span class="sd">    m2w : PolyLine</span>
<span class="sd">        Normalised coefficient of water volume change with respect to a change</span>
<span class="sd">        in the matirx suction (duw-dua), PolyLine(depth, m2w).</span>
<span class="sd">    kw : PolyLine</span>
<span class="sd">        Normalised vertical permeability PolyLine(depth, kw).</span>
<span class="sd">    Da : PolyLine</span>
<span class="sd">        Normalised coefficeint of transmission for the air phase</span>
<span class="sd">        PolyLine(depth, Da).</span>
<span class="sd">    n : PolyLine</span>
<span class="sd">        Porosity PolyLine(depth, n). Porosity must be between 0 and 1.</span>
<span class="sd">    S : PolyLine</span>
<span class="sd">        Degree of saturation, PolyLine(depth, S). Degree of saturation</span>
<span class="sd">        must be between 0 and 1.</span>
<span class="sd">    ua_ : float, optional</span>
<span class="sd">        Absolute pore air pressure, assumed constant usually at</span>
<span class="sd">        atmospheric pressure. Default ua_=101 kPa.  This is used in the</span>
<span class="sd">        porosity-saturation term.</span>
<span class="sd">    surcharge_vs_depth : list of Polyline, optional</span>
<span class="sd">        Surcharge variation with depth. PolyLine(depth, multiplier).</span>
<span class="sd">    surcharge_vs_time : list of Polyline, optional</span>
<span class="sd">        Surcharge magnitude variation with time. PolyLine(time, magnitude).</span>
<span class="sd">    surcharge_omega_phase : list of 2 element tuples, optional</span>
<span class="sd">        (omega, phase) to define cyclic variation of surcharge. i.e.</span>
<span class="sd">        mag_vs_time * cos(omega*t + phase). If surcharge_omega_phase is None</span>
<span class="sd">        then cyclic component will be ignored.  If surcharge_omega_phase is a</span>
<span class="sd">        list then if any member is None then cyclic component will not be</span>
<span class="sd">        applied for that load combo.</span>
<span class="sd">    atop_vs_time, wtop_vs_time : list of Polyline, optional</span>
<span class="sd">        Top air and water p.press variation with time.</span>
<span class="sd">        Polyline(time, magnitude).</span>
<span class="sd">    atop_omega_phase, wtop_omega_phase : list of 2 element tuples, optional</span>
<span class="sd">        (omega, phase) to define cyclic variation of top air and water BC. i.e.</span>
<span class="sd">        mag_vs_time * cos(omega*t + phase). If top_omega_phase is None</span>
<span class="sd">        then cyclic component will be ignored.  If top_omega_phase is a</span>
<span class="sd">        list then if any member is None then cyclic component will not be</span>
<span class="sd">        applied for that load combo.</span>
<span class="sd">    abot_vs_time, wbot_vs_time : list of Polyline, optional</span>
<span class="sd">        Bottom air and water p.press variation with time.</span>
<span class="sd">        Polyline(time, magnitude).</span>
<span class="sd">        When drn=1, i.e. PTIB, bot_vs_time is equivilent to saying</span>
<span class="sd">        D[u(H,t), z] = bot_vs_time. Within the program the actual gradient</span>
<span class="sd">        will be normalised with depth by multiplying H.</span>
<span class="sd">    abot_omega_phase, wbot_omega_phase : list of 2 element tuples, optional</span>
<span class="sd">        (omega, phase) to define cyclic variation of bot air and water BC. i.e.</span>
<span class="sd">        mag_vs_time * cos(omega*t + phase). If bot_omega_phase is None</span>
<span class="sd">        then cyclic component will be ignored.  If bot_omega_phase is a</span>
<span class="sd">        list then if any member is None then cyclic component will not be</span>
<span class="sd">        applied for that load combo.</span>
<span class="sd">    ppress_z : list_like of float, optional</span>
<span class="sd">        Normalised z to calculate pore pressure at.</span>
<span class="sd">    avg_ppress_z_pairs : list of two element list of float, optional</span>
<span class="sd">        Nomalised zs to calculate average pore pressure between</span>
<span class="sd">        e.g. average of all profile is [[0,1]].</span>
<span class="sd">    settlement_z_pairs : list of two element list of float, optional</span>
<span class="sd">        Normalised depths to calculate normalised settlement between.</span>
<span class="sd">        e.g. surface settlement would be [[0, 1]].</span>
<span class="sd">    tvals : list of float</span>
<span class="sd">        Times to calculate output at.</span>
<span class="sd">    ppress_z_tval_indexes : list/array of int, slice, optional</span>
<span class="sd">        Indexes of `tvals` at which to calculate ppress_z. i.e. only calculate</span>
<span class="sd">        ppress_z at a subset of the `tvals` values.</span>
<span class="sd">        Default ppress_z_tval_indexes=slice(None, None) i.e. use all the</span>
<span class="sd">        `tvals`.</span>
<span class="sd">    avg_ppress_z_pairs_tval_indexes : list/array of int, slice, optional</span>
<span class="sd">        Indexes of `tvals` at which to calculate avg_ppress_z_pairs.</span>
<span class="sd">        i.e. only calc avg_ppress_z_pairs at a subset of the `tvals` values.</span>
<span class="sd">        Default avg_ppress_z_pairs_tval_indexes=slice(None, None) i.e. use</span>
<span class="sd">        all the `tvals`.</span>
<span class="sd">    settlement_z_pairs_tval_indexes : list/array of int, slice, optional</span>
<span class="sd">        Indexes of `tvals` at which to calculate settlement_z_pairs.</span>
<span class="sd">        i.e. only calc settlement_z_pairs at a subset of the `tvals` values.</span>
<span class="sd">        Default settlement_z_pairs_tval_indexes=slice(None, None) i.e. use</span>
<span class="sd">        all the `tvals`.</span>
<span class="sd">    implementation : [&#39;scalar&#39;, &#39;vectorized&#39;,&#39;fortran&#39;], optional</span>
<span class="sd">        Where possible use the stated implementation type.  &#39;scalar&#39;=</span>
<span class="sd">        python loops (slowest), &#39;vectorized&#39; = numpy (fast), &#39;fortran&#39; =</span>
<span class="sd">        fortran extension (fastest).  Note only some functions have multiple</span>
<span class="sd">        implementations.</span>
<span class="sd">    RLzero : float, optional</span>
<span class="sd">        Reduced level of the top of the soil layer.  If RLzero is not None</span>
<span class="sd">        then all depths (in plots and results) will be transformed to an RL</span>
<span class="sd">        by RL = RLzero - z*H.  If RLzero is None (i.e. the default) then all</span>
<span class="sd">        depths will be reported  z*H (i.e. positive numbers).</span>
<span class="sd">    plot_properties : dict of dict, optional</span>
<span class="sd">        Dictionary that overrides some of the plot properties.</span>
<span class="sd">        Each member of `plot_properties` will correspond to one of the plots.</span>

<span class="sd">        ==================  ============================================</span>
<span class="sd">        plot_properties     description</span>
<span class="sd">        ==================  ============================================</span>
<span class="sd">        porw                dict of prop to pass to water pore pressure</span>
<span class="sd">                            plot.</span>
<span class="sd">        pora                dict of prop to pass to air pore pressure</span>
<span class="sd">                            plot.</span>
<span class="sd">        avpw                dict of prop to pass to average</span>
<span class="sd">                            water pore pressure plot.</span>
<span class="sd">        avpa                dict of prop to pass to average</span>
<span class="sd">                            air pore pressure plot.</span>
<span class="sd">        set                 dict of prop to pass to settlement plot.</span>
<span class="sd">        seta                dict of prop to pass to air settlement</span>
<span class="sd">                            plot.</span>
<span class="sd">        setw                dict of prop to pass to water settlement</span>
<span class="sd">                            plot.</span>
<span class="sd">        load                dict of prop to pass to loads plot.</span>
<span class="sd">        material            dict of prop to pass to materials plot.</span>
<span class="sd">        ==================  ============================================</span>
<span class="sd">        see geotecha.plotting.one_d.plot_vs_depth and</span>
<span class="sd">        geotecha.plotting.one_d.plot_vs_time for options to specify in</span>
<span class="sd">        each plot dict.</span>
<span class="sd">    save_data_to_file : True/False, optional</span>
<span class="sd">        If True data will be saved to file.  Default save_data_to_file=False</span>
<span class="sd">    save_figures_to_file : True/False</span>
<span class="sd">        If True then figures will be saved to file.</span>
<span class="sd">        Default save_figures_to_file=False</span>
<span class="sd">    show_figures : True/False, optional</span>
<span class="sd">        If True the after calculation figures will be shown on screen.</span>
<span class="sd">        Default show_figures=False.</span>
<span class="sd">    directory : string, optional</span>
<span class="sd">        Path to directory where files should be stored.</span>
<span class="sd">        Default directory=None which</span>
<span class="sd">        will use the current working directory.  Note if you keep getting</span>
<span class="sd">        directory does not exist errors then try putting an r before the</span>
<span class="sd">        string definition. i.e. directory = r&#39;C:\\Users\\...&#39;</span>
<span class="sd">    overwrite : True/False, optional</span>
<span class="sd">        If True then existing files will be overwritten.</span>
<span class="sd">        Default overwrite=False.</span>
<span class="sd">    prefix : string, optional</span>
<span class="sd">         Filename prefix for all output files.  Default prefix= &#39;out&#39;</span>
<span class="sd">    create_directory : True/Fase, optional</span>
<span class="sd">        If True a new sub-folder with name based on  `prefix` and an</span>
<span class="sd">        incremented number will contain the output</span>
<span class="sd">        files. Default create_directory=True.</span>
<span class="sd">    data_ext : string, optional</span>
<span class="sd">        File extension for data files. Default data_ext=&#39;.csv&#39;</span>
<span class="sd">    input_ext : string, optional</span>
<span class="sd">        File extension for original and parsed input files. default = &quot;.py&quot;</span>
<span class="sd">    figure_ext : string, optional</span>
<span class="sd">        File extension for figures.  Can be any valid matplotlib option for</span>
<span class="sd">        savefig. Default figure_ext=&quot;.eps&quot;. Others include &#39;pdf&#39;, &#39;png&#39;.</span>
<span class="sd">    title : str, optional</span>
<span class="sd">        A title for the input file.  This will appear at the top of data files.</span>
<span class="sd">        Default title=None, i.e. no title.</span>
<span class="sd">    author : str, optional</span>
<span class="sd">        Author of analysis. Default author=&#39;unknown&#39;.</span>


<span class="sd">    Attributes</span>
<span class="sd">    ----------</span>
<span class="sd">    porw, pora : ndarray, only present if ppress_z is input</span>
<span class="sd">        Calculated pore pressure at depths corresponding to `ppress_z` and</span>
<span class="sd">        times corresponding to `tvals`.  This is an output array of</span>
<span class="sd">        size (len(ppress_z), len(tvals[ppress_z_tval_indexes])). porw and</span>
<span class="sd">        pora are pore pressure in water and air.</span>
<span class="sd">    avpw, avpa : ndarray, only present if avg_ppress_z_pairs is input</span>
<span class="sd">        Calculated average pore pressure between depths corresponding to</span>
<span class="sd">        `avg_ppress_z_pairs` and times corresponding to `tvals`.  This is an</span>
<span class="sd">        output array of size</span>
<span class="sd">        (len(avg_ppress_z_pairs), len(tvals[avg_ppress_z_pairs_tval_indexes])).</span>
<span class="sd">        avpw and avas are average pore pressure in water and air.</span>
<span class="sd">    set, setw, seta : ndarray, only present if settlement_z_pairs is input</span>
<span class="sd">        Settlement between depths corresponding to `settlement_z_pairs` and</span>
<span class="sd">        times corresponding to `tvals`.  This is an output array of size</span>
<span class="sd">        (len(avg_ppress_z_pairs), len(tvals[settlement_z_pairs_tval_indexes])).</span>
<span class="sd">        setw and sets are settlement in water and air. set is water + air.</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    **Gotchas**</span>

<span class="sd">    All the loading terms e.g. surcharge_vs_time, surcharge_vs_depth,</span>
<span class="sd">    surcharge_omega_phase can be either a single value or a list of values.</span>
<span class="sd">    The corresponding lists that define a load must have the same length</span>
<span class="sd">    e.g. if specifying multiple surcharge loads then surcharge_vs_time and</span>
<span class="sd">    surcharge_vs_depth must be lists of the same length such that</span>
<span class="sd">    surcharge_vs_time[0] can be paired with surcharge_vs_depth[0],</span>
<span class="sd">    surcharge_vs_time[1] can be paired with surcharge_vs_depth[1], etc.</span>

<span class="sd">    **Material and geometric properties**</span>

<span class="sd">     - :math:`\\sigma - u_a` is net normal stress.</span>
<span class="sd">     - :math:`u_a - u_w` is matric suction.</span>
<span class="sd">     - :math:`u_a` is air pressure.</span>
<span class="sd">     - :math:`u_w` is water pressure.</span>
<span class="sd">     - :math:`m_{1k}^a` is coefficient of air volume change with respect to a</span>
<span class="sd">       change in the net normal stress.</span>
<span class="sd">     - :math:`m_{1k}^w` is coefficient of awater volume change with respect to a</span>
<span class="sd">       change in the net normal stress.</span>
<span class="sd">     - :math:`m_2^a` is coefficient of air volume change with respect to a</span>
<span class="sd">       change in the matric suction.</span>
<span class="sd">     - :math:`m_2^a` is coefficient of air volume change with respect to a</span>
<span class="sd">       change in the matric suction.</span>
<span class="sd">     - :math:`k_w` is vertical water permeability.</span>
<span class="sd">     - :math:`D_a` is coefficeint of transmission for the air phase.</span>
<span class="sd">       :math:`D_a = k_a g`.</span>
<span class="sd">     - :math:`n` is porosity :math:`0&gt;n&gt;1`.</span>
<span class="sd">     - :math:`S` is degree of saturation :math:`0&gt;S&gt;1`.</span>
<span class="sd">     - :math:`\\overline{u}_a` is the absolute air pressure.</span>
<span class="sd">       :math:`\\overline{u}_a = u_{atm}+u_a`.</span>
<span class="sd">     - :math:`u_{atm}` is absolute atmospheric air pressure.</span>
<span class="sd">     - :math:`\\gamma_w` is the unit weight of water.</span>
<span class="sd">     - :math:`Z` is the nomalised depth (:math:`Z=z/H`).</span>
<span class="sd">     - :math:`H` is the total height of the soil profile.</span>
<span class="sd">     - :math:`T` is the absolute temperature in kelvin.</span>
<span class="sd">     - :math:`\\omega` is the molecular mass of air often taken as</span>
<span class="sd">       29e-3 kg/mol.</span>
<span class="sd">     - :math:`R` is the universal gas constant 8.314 J/(mol.K).</span>


<span class="sd">    **Governing equation**</span>

<span class="sd">    Overall strain :math:`\\varepsilon` is the sum of the air strain,</span>
<span class="sd">    :math:`\\varepsilon_a` and the water strain :math:`\\varepsilon_w`:</span>

<span class="sd">    .. math::</span>
<span class="sd">         \\varepsilon = \\varepsilon_a + \\varepsilon_w</span>

<span class="sd">    The water and air strain components are:</span>

<span class="sd">    .. math::</span>
<span class="sd">        \\varepsilon_a =</span>
<span class="sd">            m_{1k}^a\\left({\\sigma - u_a}\\right)</span>
<span class="sd">            + m_2^a\\left({u_a - u_w}\\right)</span>

<span class="sd">    .. math::</span>
<span class="sd">        \\varepsilon_w =</span>
<span class="sd">            m_{1k}^w\\left({\\sigma - u_a}\\right)</span>
<span class="sd">            + m_2^w\\left({u_a - u_w}\\right)</span>

<span class="sd">    Both pore air and pore water pressures are functions of normalised depth</span>
<span class="sd">    :math:`Z` and time :math:`t`, :math:`u\\left({Z, t}\\right)`.  The water</span>
<span class="sd">    and air phase partial differential equations are:</span>

<span class="sd">    .. math::</span>
<span class="sd">        \\left({\\overline{m}_{1k}^w - \\overline{m}_2^w}\\right) u_a,_t</span>
<span class="sd">        +  \\overline{m}_2^w u_w,_t</span>
<span class="sd">        + dT_w\\left({\\overline{k}_w u_w,_Z}\\right),_Z</span>
<span class="sd">        = \\overline{m}_{1k}^w \\sigma,_t</span>

<span class="sd">    .. math::</span>
<span class="sd">        \\left({\\overline{m}_{1k}^a</span>
<span class="sd">               - \\overline{m}_2^a</span>
<span class="sd">               - \\frac{\\left({1-S}\\right)n}{\\overline{u}_a m_{\\textrm{ref}}}</span>
<span class="sd">               }\\right) u_a,_t</span>
<span class="sd">        +  \\overline{m}_2^a u_w,_t</span>
<span class="sd">        + dT_a\\left({\\overline{D}_a u_a,_Z}\\right),_Z</span>
<span class="sd">        = \\overline{m}_{1k}^a \\sigma,_t</span>


<span class="sd">    where</span>

<span class="sd">    .. math::</span>
<span class="sd">        dT_w = \\frac{k_{w\\textrm{ref}}}</span>
<span class="sd">                     {H^2 m_{v\\textrm{ref}} \\gamma_w}</span>

<span class="sd">    .. math::</span>
<span class="sd">        dT_a = \\frac{D_{a\\textrm{ref}}}</span>
<span class="sd">                     {\\left({\\omega R T}\\right)</span>
<span class="sd">                      \\overline{u}_a m_{\\textrm{ref}}}</span>


<span class="sd">    The overline notation represents a depth dependent property normalised</span>
<span class="sd">    by the relevant reference property. e.g.</span>
<span class="sd">    :math:`\\overline{k}_w = k_w\\left({z}\\right) / k_{w\\textrm{ref}}`.</span>

<span class="sd">    A comma followed by a subscript represents differentiation with respect to</span>
<span class="sd">    the subscripted variable e.g.</span>
<span class="sd">    :math:`u,_Z = u\\left({Z,t}\\right) / \\partial Z`.</span>

<span class="sd">    **Non-zero Boundary conditions**</span>

<span class="sd">    The following two sorts of boundary conditions for the air and water</span>
<span class="sd">    phases can be modelled independently using:</span>

<span class="sd">    .. math::</span>
<span class="sd">        \\left.u\\left({Z,t}\\right)\\right|_{Z=0} = u^{\\textrm{top}}\\left({t}\\right)</span>
<span class="sd">        \\textrm{ and }</span>
<span class="sd">        \\left.u\\left({Z,t}\\right)\\right|_{Z=1} = u^{\\textrm{bot}}\\left({t}\\right)</span>


<span class="sd">    .. math::</span>
<span class="sd">        \\left.u\\left({Z,t}\\right)\\right|_{Z=0} = u^{\\textrm{top}}\\left({t}\\right)</span>
<span class="sd">        \\textrm{ and }</span>
<span class="sd">        \\left.u\\left({Z,t}\\right),_Z\\right|_{Z=1} = u^{\\textrm{bot}}\\left({t}\\right)</span>


<span class="sd">    The boundary conditions are incorporated by homogenising the governing</span>
<span class="sd">    equation with the following substitution:</span>

<span class="sd">    .. math::</span>
<span class="sd">        u\\left({Z,t}\\right)</span>
<span class="sd">        = \\hat{u}\\left({Z,t}\\right) + u_b\\left({Z,t}\\right)</span>

<span class="sd">    where for the two types of non zero boundary boundary conditions:</span>

<span class="sd">    .. math::</span>
<span class="sd">        u_b\\left({Z,t}\\right)</span>
<span class="sd">        = u^{\\textrm{top}}\\left({t}\\right) \\left({1-Z}\\right)</span>
<span class="sd">        + u^{\\textrm{bot}}\\left({t}\\right) Z</span>

<span class="sd">    .. math::</span>
<span class="sd">        u_b\\left({Z,t}\\right)</span>
<span class="sd">        = u^{\\textrm{top}}\\left({t}\\right)</span>
<span class="sd">        + u^{\\textrm{bot}}\\left({t}\\right) Z</span>

<span class="sd">    **Time and depth dependence of loads/material properties**</span>

<span class="sd">    Soil properties do not vary with time.</span>


<span class="sd">    Loads are formulated as the product of separate time and depth</span>
<span class="sd">    dependant functions as well as a cyclic component:</span>

<span class="sd">    .. math:: \\sigma\\left({Z,t}\\right)=</span>
<span class="sd">                \\sigma\\left({Z}\\right)</span>
<span class="sd">                \\sigma\\left({t}\\right)</span>
<span class="sd">                \\cos\\left(\\omega t + \\phi\\right)</span>

<span class="sd">    :math:`\\sigma\\left(t\\right)` is a piecewise linear function of time</span>
<span class="sd">    that within the kth loading stage is defined by the load magnitude at</span>
<span class="sd">    the start and end of the stage:</span>

<span class="sd">    .. math::</span>
<span class="sd">        \\sigma\\left(t\\right)</span>
<span class="sd">        = \\sigma_k^{\\textrm{start}}</span>
<span class="sd">        + \\frac{\\sigma_k^{\\textrm{end}}</span>
<span class="sd">                 - \\sigma_k^{\\textrm{start}}}</span>
<span class="sd">                {t_k^{\\textrm{end}}</span>
<span class="sd">                 - t_k^{\\textrm{start}}}</span>
<span class="sd">        \\left(t - t_k^{\\textrm{start}}\\right)</span>

<span class="sd">    The depth dependence of loads and material property</span>
<span class="sd">    :math:`a\\left(Z\\right)` is a piecewise linear function</span>
<span class="sd">    with respect to :math:`Z`, that within a layer are defined by:</span>

<span class="sd">    .. math::</span>
<span class="sd">        a\\left(z\\right)</span>
<span class="sd">        = a_t + \\frac{a_b - a_t}{z_b - z_t}\\left(z - z_t\\right)</span>

<span class="sd">    with :math:`t` and :math:`b` subscripts representing &#39;top&#39; and &#39;bottom&#39; of</span>
<span class="sd">    each layer respectively.</span>



<span class="sd">    References</span>
<span class="sd">    ----------</span>
<span class="sd">    The genesis of this work is from research carried out by</span>
<span class="sd">    Dr. Rohan Walker, Prof. Buddhima Indraratna and others</span>
<span class="sd">    at the University of Wollongong, NSW, Austrlia, [1]_, [2]_, [3]_, [4]_.</span>

<span class="sd">    .. [1] Walker, Rohan. 2006. &#39;Analytical Solutions for Modeling Soft</span>
<span class="sd">           Soil Consolidation by Vertical Drains&#39;. PhD Thesis, Wollongong,</span>
<span class="sd">           NSW, Australia: University of Wollongong.</span>
<span class="sd">    .. [2] Walker, R., and B. Indraratna. 2009. &#39;Consolidation Analysis of</span>
<span class="sd">           a Stratified Soil with Vertical and Horizontal Drainage Using the</span>
<span class="sd">           Spectral Method&#39;. Geotechnique 59 (5) (January): 439-449.</span>
<span class="sd">           doi:10.1680/geot.2007.00019.</span>
<span class="sd">    .. [3] Walker, Rohan, Buddhima Indraratna, and Nagaratnam Sivakugan. 2009.</span>
<span class="sd">           &#39;Vertical and Radial Consolidation Analysis of Multilayered</span>
<span class="sd">           Soil Using the Spectral Method&#39;. Journal of Geotechnical and</span>
<span class="sd">           Geoenvironmental Engineering 135 (5) (May): 657-663.</span>
<span class="sd">           doi:10.1061/(ASCE)GT.1943-5606.0000075.</span>
<span class="sd">    .. [4] Walker, Rohan T. 2011. Vertical Drain Consolidation Analysis</span>
<span class="sd">           in One, Two and Three Dimensions&#39;. Computers and</span>
<span class="sd">           Geotechnics 38 (8) (December): 1069-1077.</span>
<span class="sd">           doi:10.1016/j.compgeo.2011.07.006.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">_setup</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_attributes</span> <span class="o">=</span> <span class="p">(</span>
            <span class="s1">&#39;H drn dT neig &#39;</span>
            <span class="s1">&#39;mvref kwref Daref &#39;</span>
            <span class="s1">&#39;dTw dTa &#39;</span>
            <span class="s1">&#39;m1ka m1kw m2a m2w kw Da &#39;</span>
            <span class="s1">&#39;surcharge_vs_depth surcharge_vs_time &#39;</span>
            <span class="s1">&#39;atop_vs_time abot_vs_time &#39;</span>
            <span class="s1">&#39;wtop_vs_time wbot_vs_time &#39;</span>
            <span class="s1">&#39;ppress_z avg_ppress_z_pairs settlement_z_pairs tvals &#39;</span>
            <span class="s1">&#39;implementation ppress_z_tval_indexes &#39;</span>
            <span class="s1">&#39;avg_ppress_z_pairs_tval_indexes settlement_z_pairs_tval_indexes &#39;</span>
            <span class="s1">&#39;surcharge_omega_phase &#39;</span>
            <span class="s1">&#39;atop_omega_phase abot_omega_phase &#39;</span>
            <span class="s1">&#39;wtop_omega_phase wbot_omega_phase &#39;</span>
            <span class="s1">&#39;RLzero &#39;</span>
            <span class="s1">&#39;prefix &#39;</span>
            <span class="s1">&#39;plot_properties &#39;</span>
            <span class="s1">&#39;ua_ n S&#39;</span>
            <span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_attribute_defaults</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;H&#39;</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">,</span> <span class="s1">&#39;drn&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;dT&#39;</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">,</span> <span class="s1">&#39;neig&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;mvref&#39;</span><span class="p">:</span><span class="mf">1.0</span><span class="p">,</span>
            <span class="s1">&#39;kwref&#39;</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">,</span> <span class="s1">&#39;Daref&#39;</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">,</span>
            <span class="s1">&#39;implementation&#39;</span><span class="p">:</span> <span class="s1">&#39;vectorized&#39;</span><span class="p">,</span>
            <span class="s1">&#39;ppress_z_tval_indexes&#39;</span><span class="p">:</span> <span class="nb">slice</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
            <span class="s1">&#39;avg_ppress_z_pairs_tval_indexes&#39;</span><span class="p">:</span> <span class="nb">slice</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
            <span class="s1">&#39;settlement_z_pairs_tval_indexes&#39;</span><span class="p">:</span> <span class="nb">slice</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
            <span class="s1">&#39;prefix&#39;</span><span class="p">:</span> <span class="s1">&#39;speccon1dunsat_&#39;</span><span class="p">,</span>
            <span class="s1">&#39;ua_&#39;</span><span class="p">:</span> <span class="mi">101</span>
            <span class="p">}</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_attributes_that_should_be_lists</span><span class="o">=</span> <span class="p">(</span>
            <span class="s1">&#39;surcharge_vs_depth surcharge_vs_time surcharge_omega_phase &#39;</span>
            <span class="s1">&#39;atop_vs_time atop_omega_phase &#39;</span>
            <span class="s1">&#39;abot_vs_time abot_omega_phase &#39;</span>
            <span class="s1">&#39;wtop_vs_time wtop_omega_phase &#39;</span>
            <span class="s1">&#39;wbot_vs_time wbot_omega_phase&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_attributes_that_should_have_same_x_limits</span> <span class="o">=</span> <span class="p">[</span>
            <span class="s1">&#39;m1ka m1kw m2a m2w kw Da surcharge_vs_depth n S&#39;</span><span class="o">.</span><span class="n">split</span><span class="p">()]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_attributes_that_should_have_same_len_pairs</span> <span class="o">=</span> <span class="p">[</span>
            <span class="s1">&#39;surcharge_vs_depth surcharge_vs_time&#39;</span><span class="o">.</span><span class="n">split</span><span class="p">(),</span>
            <span class="s1">&#39;surcharge_vs_time surcharge_omega_phase&#39;</span><span class="o">.</span><span class="n">split</span><span class="p">(),</span>
            <span class="s1">&#39;atop_vs_time atop_omega_phase&#39;</span><span class="o">.</span><span class="n">split</span><span class="p">(),</span>
            <span class="s1">&#39;abot_vs_time abot_omega_phase&#39;</span><span class="o">.</span><span class="n">split</span><span class="p">(),</span>
            <span class="s1">&#39;wtop_vs_time wtop_omega_phase&#39;</span><span class="o">.</span><span class="n">split</span><span class="p">(),</span>
            <span class="s1">&#39;wbot_vs_time wbot_omega_phase&#39;</span><span class="o">.</span><span class="n">split</span><span class="p">(),]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_attributes_to_force_same_len</span> <span class="o">=</span> <span class="p">[</span>
            <span class="s2">&quot;surcharge_vs_time surcharge_omega_phase&quot;</span><span class="o">.</span><span class="n">split</span><span class="p">(),</span>
            <span class="s2">&quot;atop_vs_time atop_omega_phase&quot;</span><span class="o">.</span><span class="n">split</span><span class="p">(),</span>
            <span class="s2">&quot;abot_vs_time abot_omega_phase&quot;</span><span class="o">.</span><span class="n">split</span><span class="p">(),</span>
            <span class="s2">&quot;wtop_vs_time wtop_omega_phase&quot;</span><span class="o">.</span><span class="n">split</span><span class="p">(),</span>
            <span class="s2">&quot;wbot_vs_time wbot_omega_phase&quot;</span><span class="o">.</span><span class="n">split</span><span class="p">(),]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_zero_or_all</span> <span class="o">=</span> <span class="p">[</span>
            <span class="s1">&#39;surcharge_vs_depth surcharge_vs_time&#39;</span><span class="o">.</span><span class="n">split</span><span class="p">(),</span>
            <span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_at_least_one</span> <span class="o">=</span> <span class="p">[</span>
            <span class="p">[</span><span class="s1">&#39;dTw&#39;</span><span class="p">],</span>
            <span class="p">[</span><span class="s1">&#39;dTa&#39;</span><span class="p">],</span>
            <span class="p">[</span><span class="s1">&#39;m1ka&#39;</span><span class="p">],</span>
            <span class="p">[</span><span class="s1">&#39;m1kw&#39;</span><span class="p">],</span>
            <span class="p">[</span><span class="s1">&#39;m2a&#39;</span><span class="p">],</span>
            <span class="p">[</span><span class="s1">&#39;m2w&#39;</span><span class="p">],</span>
            <span class="p">[</span><span class="s1">&#39;kw&#39;</span><span class="p">],</span>
            <span class="p">[</span><span class="s1">&#39;Da&#39;</span><span class="p">],</span>
            <span class="p">[</span><span class="s1">&#39;n&#39;</span><span class="p">],</span>
            <span class="p">[</span><span class="s1">&#39;S&#39;</span><span class="p">],</span>
            <span class="p">(</span><span class="s1">&#39;surcharge_vs_time atop_vs_time &#39;</span>
                <span class="s1">&#39;abot_vs_time wtop_vs_time wbot_vs_time&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(),</span>
            <span class="p">[</span><span class="s1">&#39;tvals&#39;</span><span class="p">],</span>
            <span class="s1">&#39;ppress_z avg_ppress_z_pairs settlement_z_pairs&#39;</span><span class="o">.</span><span class="n">split</span><span class="p">()]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_one_implies_others</span> <span class="o">=</span> <span class="p">[</span>
            <span class="p">(</span><span class="s1">&#39;surcharge_omega_phase surcharge_vs_depth &#39;</span>
                <span class="s1">&#39;surcharge_vs_time&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(),</span>
            <span class="s1">&#39;atop_omega_phase atop_vs_time&#39;</span><span class="o">.</span><span class="n">split</span><span class="p">(),</span>
            <span class="s1">&#39;abot_omega_phase abot_vs_time&#39;</span><span class="o">.</span><span class="n">split</span><span class="p">(),</span>
            <span class="s1">&#39;wtop_omega_phase wtop_vs_time&#39;</span><span class="o">.</span><span class="n">split</span><span class="p">(),</span>
            <span class="s1">&#39;wbot_omega_phase wbot_vs_time&#39;</span><span class="o">.</span><span class="n">split</span><span class="p">(),]</span>


        <span class="c1">#these explicit initializations are just to make coding easier</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">H</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_attribute_defaults</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;H&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">drn</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_attribute_defaults</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;drn&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dT</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_attribute_defaults</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;dT&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">neig</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_attribute_defaults</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;neig&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mvref</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_attribute_defaults</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;mvref&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">kwref</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_attribute_defaults</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;kwref&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Daref</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_attribute_defaults</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Daref&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dTw</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dTa</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">m1ka</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">m1kw</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">m2a</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">m2w</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">kw</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Da</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">surcharge_vs_depth</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">surcharge_vs_time</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">atop_vs_time</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">abot_vs_time</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">wtop_vs_time</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">wbot_vs_time</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ppress_z</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">avg_ppress_z_pairs</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">settlement_z_pairs</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tvals</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">implementation</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_attribute_defaults</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;implementation&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ppress_z_tval_indexes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_attribute_defaults</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;ppress_z_tval_indexes&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">avg_ppress_z_pairs_tval_indexes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_attribute_defaults</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;avg_ppress_z_pairs_tval_indexes&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">settlement_z_pairs_tval_indexes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_attribute_defaults</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;settlement_z_pairs_tval_indexes&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">surcharge_omega_phase</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">atop_omega_phase</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">abot_omega_phase</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">wtop_omega_phase</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">wbot_omega_phase</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">RLzero</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">prefix</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_attribute_defaults</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;prefix&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ua_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_attribute_defaults</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;ua_&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">n</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">S</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">plot_properties</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_attribute_defaults</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;plot_properties&#39;</span><span class="p">,</span>
                                                            <span class="kc">None</span><span class="p">)</span>



        <span class="k">return</span>

<div class="viewcode-block" id="Speccon1dUnsat.make_time_independent_arrays"><a class="viewcode-back" href="../../../api/geotecha.speccon.speccon1d_unsat.html#geotecha.speccon.speccon1d_unsat.Speccon1dUnsat.make_time_independent_arrays">[docs]</a>    <span class="k">def</span> <span class="nf">make_time_independent_arrays</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;make all time independent arrays</span>


<span class="sd">        See Also</span>
<span class="sd">        --------</span>
<span class="sd">        self._make_m : make the basis function eigenvalues</span>
<span class="sd">        self._make_gam : make the mv dependent gamma matrix</span>
<span class="sd">        self._make_psi : make the kv, kh, et dependent psi matrix</span>
<span class="sd">        self._make_eigs_and_v : make eigenvalues, eigenvectors and I_gamv</span>

<span class="sd">        &quot;&quot;&quot;</span>


        <span class="bp">self</span><span class="o">.</span><span class="n">_make_m</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_make_gam</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_make_psi</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_make_eigs_and_v</span><span class="p">()</span>

        <span class="k">return</span></div>

<div class="viewcode-block" id="Speccon1dUnsat.make_time_dependent_arrays"><a class="viewcode-back" href="../../../api/geotecha.speccon.speccon1d_unsat.html#geotecha.speccon.speccon1d_unsat.Speccon1dUnsat.make_time_dependent_arrays">[docs]</a>    <span class="k">def</span> <span class="nf">make_time_dependent_arrays</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;make all time dependent arrays</span>

<span class="sd">        See Also</span>
<span class="sd">        --------</span>
<span class="sd">        self.make_E_Igamv_the()</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tvals</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tvals</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">ppress_z</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ppress_z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ppress_z</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">make_E_Igamv_the</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">v_E_Igamv_the</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">v</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">E_Igamv_the</span><span class="p">)</span>
        <span class="k">return</span></div>





<div class="viewcode-block" id="Speccon1dUnsat.make_output"><a class="viewcode-back" href="../../../api/geotecha.speccon.speccon1d_unsat.html#geotecha.speccon.speccon1d_unsat.Speccon1dUnsat.make_output">[docs]</a>    <span class="k">def</span> <span class="nf">make_output</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;make all output&quot;&quot;&quot;</span>

        <span class="n">header1</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;program: speccon1d_unsat; geotecha version: &quot;</span>
            <span class="s2">&quot;</span><span class="si">{}</span><span class="s2">; author: </span><span class="si">{}</span><span class="s2">; date: </span><span class="si">{}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">version</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">author</span><span class="p">,</span> <span class="n">time</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s1">&#39;%Y/%m/</span><span class="si">%d</span><span class="s1"> %H:%M:%S&#39;</span><span class="p">))</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">title</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">header1</span><span class="o">+=</span> <span class="s2">&quot;</span><span class="si">{}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">title</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_grid_data_dicts</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">ppress_z</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_make_por</span><span class="p">()</span>
            <span class="n">z</span> <span class="o">=</span> <span class="n">transformations</span><span class="o">.</span><span class="n">depth_to_reduced_level</span><span class="p">(</span>
                <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ppress_z</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">H</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">RLzero</span><span class="p">)</span>
            <span class="n">labels</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;</span><span class="si">{:.3g}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">z</span><span class="p">]</span>
            <span class="n">d</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;_data_porw&#39;</span><span class="p">,</span>
                 <span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">porw</span><span class="o">.</span><span class="n">T</span><span class="p">,</span>
                 <span class="s1">&#39;row_labels&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">tvals</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">ppress_z_tval_indexes</span><span class="p">],</span>
                 <span class="s1">&#39;row_labels_label&#39;</span><span class="p">:</span> <span class="s1">&#39;Time&#39;</span><span class="p">,</span>
                 <span class="s1">&#39;column_labels&#39;</span><span class="p">:</span> <span class="n">labels</span><span class="p">,</span>
                 <span class="s1">&#39;header&#39;</span><span class="p">:</span> <span class="n">header1</span> <span class="o">+</span> <span class="s1">&#39;Pore water pressure at depth&#39;</span><span class="p">}</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_grid_data_dicts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>

            <span class="n">d</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;_data_pora&#39;</span><span class="p">,</span>
                 <span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">pora</span><span class="o">.</span><span class="n">T</span><span class="p">,</span>
                 <span class="s1">&#39;row_labels&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">tvals</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">ppress_z_tval_indexes</span><span class="p">],</span>
                 <span class="s1">&#39;row_labels_label&#39;</span><span class="p">:</span> <span class="s1">&#39;Time&#39;</span><span class="p">,</span>
                 <span class="s1">&#39;column_labels&#39;</span><span class="p">:</span> <span class="n">labels</span><span class="p">,</span>
                 <span class="s1">&#39;header&#39;</span><span class="p">:</span> <span class="n">header1</span> <span class="o">+</span> <span class="s1">&#39;Pore air pressure at depth&#39;</span><span class="p">}</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_grid_data_dicts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">avg_ppress_z_pairs</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_make_avp</span><span class="p">()</span>
            <span class="n">z_pairs</span> <span class="o">=</span> <span class="n">transformations</span><span class="o">.</span><span class="n">depth_to_reduced_level</span><span class="p">(</span>
                <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">avg_ppress_z_pairs</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">H</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">RLzero</span><span class="p">)</span>
            <span class="n">labels</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;</span><span class="si">{:.3g}</span><span class="s1"> to </span><span class="si">{:.3g}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">z1</span><span class="p">,</span> <span class="n">z2</span><span class="p">)</span> <span class="k">for</span> <span class="n">z1</span><span class="p">,</span> <span class="n">z2</span> <span class="ow">in</span> <span class="n">z_pairs</span><span class="p">]</span>
            <span class="n">d</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;_data_avpw&#39;</span><span class="p">,</span>
                 <span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">avpw</span><span class="o">.</span><span class="n">T</span><span class="p">,</span>
                 <span class="s1">&#39;row_labels&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">tvals</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">avg_ppress_z_pairs_tval_indexes</span><span class="p">],</span>
                 <span class="s1">&#39;row_labels_label&#39;</span><span class="p">:</span> <span class="s1">&#39;Time&#39;</span><span class="p">,</span>
                 <span class="s1">&#39;column_labels&#39;</span><span class="p">:</span> <span class="n">labels</span><span class="p">,</span>
                 <span class="s1">&#39;header&#39;</span><span class="p">:</span> <span class="n">header1</span> <span class="o">+</span> <span class="s1">&#39;Average pore water pressure between depths&#39;</span><span class="p">}</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_grid_data_dicts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>

            <span class="n">d</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;_data_avpa&#39;</span><span class="p">,</span>
                 <span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">avpa</span><span class="o">.</span><span class="n">T</span><span class="p">,</span>
                 <span class="s1">&#39;row_labels&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">tvals</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">avg_ppress_z_pairs_tval_indexes</span><span class="p">],</span>
                 <span class="s1">&#39;row_labels_label&#39;</span><span class="p">:</span> <span class="s1">&#39;Time&#39;</span><span class="p">,</span>
                 <span class="s1">&#39;column_labels&#39;</span><span class="p">:</span> <span class="n">labels</span><span class="p">,</span>
                 <span class="s1">&#39;header&#39;</span><span class="p">:</span> <span class="n">header1</span> <span class="o">+</span> <span class="s1">&#39;Average pore air pressure between depths&#39;</span><span class="p">}</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_grid_data_dicts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">settlement_z_pairs</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_make_set</span><span class="p">()</span>
            <span class="n">z_pairs</span> <span class="o">=</span> <span class="n">transformations</span><span class="o">.</span><span class="n">depth_to_reduced_level</span><span class="p">(</span>
                <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">settlement_z_pairs</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">H</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">RLzero</span><span class="p">)</span>
            <span class="n">labels</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;</span><span class="si">{:.3g}</span><span class="s1"> to </span><span class="si">{:.3g}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">z1</span><span class="p">,</span> <span class="n">z2</span><span class="p">)</span> <span class="k">for</span> <span class="n">z1</span><span class="p">,</span> <span class="n">z2</span> <span class="ow">in</span> <span class="n">z_pairs</span><span class="p">]</span>
            <span class="n">d</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;_data_set&#39;</span><span class="p">,</span>
                 <span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">set</span><span class="o">.</span><span class="n">T</span><span class="p">,</span>
                 <span class="s1">&#39;row_labels&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">tvals</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">settlement_z_pairs_tval_indexes</span><span class="p">],</span>
                 <span class="s1">&#39;row_labels_label&#39;</span><span class="p">:</span> <span class="s1">&#39;Time&#39;</span><span class="p">,</span>
                 <span class="s1">&#39;column_labels&#39;</span><span class="p">:</span> <span class="n">labels</span><span class="p">,</span>
                 <span class="s1">&#39;header&#39;</span><span class="p">:</span> <span class="n">header1</span> <span class="o">+</span> <span class="s1">&#39;Settlement between depths&#39;</span><span class="p">}</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_grid_data_dicts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>

            <span class="n">d</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;_data_setw&#39;</span><span class="p">,</span>
                 <span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">setw</span><span class="o">.</span><span class="n">T</span><span class="p">,</span>
                 <span class="s1">&#39;row_labels&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">tvals</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">settlement_z_pairs_tval_indexes</span><span class="p">],</span>
                 <span class="s1">&#39;row_labels_label&#39;</span><span class="p">:</span> <span class="s1">&#39;Time&#39;</span><span class="p">,</span>
                 <span class="s1">&#39;column_labels&#39;</span><span class="p">:</span> <span class="n">labels</span><span class="p">,</span>
                 <span class="s1">&#39;header&#39;</span><span class="p">:</span> <span class="n">header1</span> <span class="o">+</span> <span class="s1">&#39;Water settlement between depths&#39;</span><span class="p">}</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_grid_data_dicts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>

            <span class="n">d</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;_data_seta&#39;</span><span class="p">,</span>
                 <span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">seta</span><span class="o">.</span><span class="n">T</span><span class="p">,</span>
                 <span class="s1">&#39;row_labels&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">tvals</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">settlement_z_pairs_tval_indexes</span><span class="p">],</span>
                 <span class="s1">&#39;row_labels_label&#39;</span><span class="p">:</span> <span class="s1">&#39;Time&#39;</span><span class="p">,</span>
                 <span class="s1">&#39;column_labels&#39;</span><span class="p">:</span> <span class="n">labels</span><span class="p">,</span>
                 <span class="s1">&#39;header&#39;</span><span class="p">:</span> <span class="n">header1</span> <span class="o">+</span> <span class="s1">&#39;Air settlement between depths&#39;</span><span class="p">}</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_grid_data_dicts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
        <span class="k">return</span></div>


    <span class="k">def</span> <span class="nf">_make_m</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;make the basis function eigenvalues</span>

<span class="sd">        m in u = sin(m * Z)</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>

<span class="sd">        .. math:: m_i =\\pi*\\left(i+1-drn/2\\right)</span>

<span class="sd">        for :math:`i = 1\:to\:neig-1`</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="nb">sum</span><span class="p">(</span><span class="n">v</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">neig</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">drn</span><span class="p">])</span><span class="o">!=</span><span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;neig and/or drn is not defined&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">m</span> <span class="o">=</span> <span class="n">integ</span><span class="o">.</span><span class="n">m_from_sin_mx</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">neig</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">drn</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">m_block</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">neig</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">m_block</span><span class="p">[:</span><span class="bp">self</span><span class="o">.</span><span class="n">neig</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">m</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">m_block</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">neig</span><span class="p">:]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">m</span>
        <span class="k">return</span>


    <span class="k">def</span> <span class="nf">_make_gam</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;make the mv dependant gam matrix</span>

<span class="sd">        &quot;&quot;&quot;</span>

<span class="c1">#        self.gam = integ.pdim1sin_af_linear(</span>
<span class="c1">#                        self.m, self.mv, implementation=self.implementation)</span>
        <span class="n">gam_1kw</span> <span class="o">=</span> <span class="n">integ</span><span class="o">.</span><span class="n">pdim1sin_af_linear</span><span class="p">(</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">m1kw</span><span class="p">,</span> <span class="n">implementation</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">implementation</span><span class="p">)</span>
        <span class="n">gam_1ka</span> <span class="o">=</span> <span class="n">integ</span><span class="o">.</span><span class="n">pdim1sin_af_linear</span><span class="p">(</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">m1ka</span><span class="p">,</span> <span class="n">implementation</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">implementation</span><span class="p">)</span>
        <span class="n">gam_2w</span> <span class="o">=</span> <span class="n">integ</span><span class="o">.</span><span class="n">pdim1sin_af_linear</span><span class="p">(</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">m2w</span><span class="p">,</span> <span class="n">implementation</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">implementation</span><span class="p">)</span>
        <span class="n">gam_2a</span> <span class="o">=</span> <span class="n">integ</span><span class="o">.</span><span class="n">pdim1sin_af_linear</span><span class="p">(</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">m2a</span><span class="p">,</span> <span class="n">implementation</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">implementation</span><span class="p">)</span>
        <span class="n">gam_n</span> <span class="o">=</span> <span class="n">integ</span><span class="o">.</span><span class="n">pdim1sin_af_linear</span><span class="p">(</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">n</span><span class="p">,</span> <span class="n">implementation</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">implementation</span><span class="p">)</span>
        <span class="n">gam_n</span><span class="o">/=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ua_</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">mvref</span>
        <span class="n">gam_sn</span> <span class="o">=</span> <span class="n">integ</span><span class="o">.</span><span class="n">pdim1sin_abf_linear</span><span class="p">(</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">n</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">S</span><span class="p">,</span> <span class="n">implementation</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">implementation</span><span class="p">)</span>
        <span class="n">gam_sn</span><span class="o">/=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ua_</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">mvref</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">gam</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">2</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">neig</span><span class="p">,</span> <span class="mi">2</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">neig</span><span class="p">))</span>


        <span class="bp">self</span><span class="o">.</span><span class="n">gam</span><span class="p">[:</span><span class="bp">self</span><span class="o">.</span><span class="n">neig</span><span class="p">,</span> <span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">neig</span><span class="p">]</span> <span class="o">=</span> <span class="n">gam_2w</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gam</span><span class="p">[:</span><span class="bp">self</span><span class="o">.</span><span class="n">neig</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">neig</span><span class="p">:]</span> <span class="o">=</span> <span class="p">(</span><span class="n">gam_1kw</span> <span class="o">-</span> <span class="n">gam_2w</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gam</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">neig</span><span class="p">:,</span> <span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">neig</span><span class="p">]</span> <span class="o">=</span> <span class="n">gam_2a</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gam</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">neig</span><span class="p">:,</span> <span class="bp">self</span><span class="o">.</span><span class="n">neig</span><span class="p">:]</span> <span class="o">=</span> <span class="p">(</span><span class="n">gam_1ka</span> <span class="o">-</span> <span class="n">gam_2a</span> <span class="o">-</span> <span class="n">gam_n</span>
                                                  <span class="o">+</span> <span class="n">gam_sn</span><span class="p">)</span>


        <span class="bp">self</span><span class="o">.</span><span class="n">gam</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gam</span><span class="p">)</span><span class="o">&lt;</span><span class="mf">1e-8</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.0</span>


        <span class="k">return</span>


    <span class="k">def</span> <span class="nf">_make_psi</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;make all the kv, kh, kvc, khc, et dependant psi matrices</span>

<span class="sd">        &quot;&quot;&quot;</span>


        <span class="n">psi_wv</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dTw</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">dT</span> <span class="o">*</span>
                <span class="n">integ</span><span class="o">.</span><span class="n">pdim1sin_D_aDf_linear</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">kw</span><span class="p">,</span>
                    <span class="n">implementation</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">implementation</span><span class="p">))</span>
        <span class="n">psi_av</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dTa</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">dT</span> <span class="o">*</span>
                <span class="n">integ</span><span class="o">.</span><span class="n">pdim1sin_D_aDf_linear</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">Da</span><span class="p">,</span>
                    <span class="n">implementation</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">implementation</span><span class="p">))</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">psi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">2</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">neig</span><span class="p">,</span> <span class="mi">2</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">neig</span><span class="p">))</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">psi</span> <span class="p">[:</span><span class="bp">self</span><span class="o">.</span><span class="n">neig</span><span class="p">,</span> <span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">neig</span><span class="p">]</span> <span class="o">=</span> <span class="n">psi_wv</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">psi</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">neig</span><span class="p">:,</span> <span class="bp">self</span><span class="o">.</span><span class="n">neig</span><span class="p">:]</span> <span class="o">=</span> <span class="n">psi_av</span>



<span class="c1">#        self.psi[np.abs(self.psi)&lt;1e-8] = 0.0</span>



        <span class="k">return</span>

    <span class="k">def</span> <span class="nf">_make_eigs_and_v</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;make Igam_psi, v and eigs, and Igamv</span>



<span class="sd">        Finds the eigenvalues, `self.eigs`, and eigenvectors, `self.v` of</span>
<span class="sd">        inverse(gam)*psi.  Once found the matrix inverse(gamma*v), `self.Igamv`</span>
<span class="sd">        is determined.</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        From the original equation</span>

<span class="sd">        .. math:: \\mathbf{\\Gamma}\\mathbf{A}&#39;=\\mathbf{\\Psi A}+loading\\:terms</span>

<span class="sd">        `self.eigs` and `self.v` are the eigenvalues and eigenvegtors of the matrix `self.Igam_psi`</span>

<span class="sd">        .. math:: \\left(\\mathbf{\\Gamma}^{-1}\\mathbf{\\Psi}\\right)</span>

<span class="sd">        &quot;&quot;&quot;</span>

<span class="c1">#        self.psi[np.abs(self.psi) &lt; 1e-8] = 0.0</span>
        <span class="n">Igam_psi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">inv</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gam</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">psi</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">eigs</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">v</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">eig</span><span class="p">(</span><span class="n">Igam_psi</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">v</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">v</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Igamv</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">inv</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gam</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">v</span><span class="p">))</span>

<div class="viewcode-block" id="Speccon1dUnsat.print_eigs"><a class="viewcode-back" href="../../../api/geotecha.speccon.speccon1d_unsat.html#geotecha.speccon.speccon1d_unsat.Speccon1dUnsat.print_eigs">[docs]</a>    <span class="k">def</span> <span class="nf">print_eigs</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;print eigenvalues to stdout&quot;&quot;&quot;</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;eigs&#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">eigs</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">i</span><span class="o">&lt;</span><span class="bp">self</span><span class="o">.</span><span class="n">neig</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;water </span><span class="si">{0}</span><span class="s1">, </span><span class="si">{1:3.3f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">x</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>

                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;air </span><span class="si">{0}</span><span class="s1">, </span><span class="si">{1:3.3f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">neig</span><span class="p">,</span> <span class="n">x</span><span class="p">))</span>
        <span class="k">return</span></div>
<div class="viewcode-block" id="Speccon1dUnsat.make_E_Igamv_the"><a class="viewcode-back" href="../../../api/geotecha.speccon.speccon1d_unsat.html#geotecha.speccon.speccon1d_unsat.Speccon1dUnsat.make_E_Igamv_the">[docs]</a>    <span class="k">def</span> <span class="nf">make_E_Igamv_the</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;sum contributions from all loads</span>

<span class="sd">        Calculates all contributions to E*inverse(gam*v)*theta part of solution</span>
<span class="sd">        u=phi*vE*inverse(gam*v)*theta. i.e. surcharge, vacuum, top and bottom</span>
<span class="sd">        pore pressure boundary conditions. `make_load_matrices will create</span>
<span class="sd">        `self.E_Igamv_the`.  `self.E_Igamv_the`  is an array</span>
<span class="sd">        of size (neig, len(tvals)). So the columns are the column array</span>
<span class="sd">        E*inverse(gam*v)*theta calculated at each output time.  This will allow</span>
<span class="sd">        us later to do u = phi*v*self.E_Igamv_the</span>

<span class="sd">        See Also</span>
<span class="sd">        --------</span>
<span class="sd">        _make_E_Igamv_the_surcharge :  surchage contribution</span>
<span class="sd">        _make_E_Igamv_the_BC : top boundary pore pressure contribution</span>
<span class="sd">        _make_E_Igamv_the_bot : bottom boundary pore pressure contribution</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">E_Igamv_the</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">2</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">neig</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tvals</span><span class="p">)))</span>

        <span class="k">if</span> <span class="nb">sum</span><span class="p">([</span><span class="n">v</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">for</span>
                <span class="n">v</span> <span class="ow">in</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">surcharge_vs_depth</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">surcharge_vs_time</span><span class="p">]])</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_make_E_Igamv_the_surcharge</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">E_Igamv_the</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">E_Igamv_the_surcharge</span>
        <span class="k">if</span> <span class="nb">sum</span><span class="p">(</span><span class="n">v</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">atop_vs_time</span><span class="p">,</span>
                                  <span class="bp">self</span><span class="o">.</span><span class="n">abot_vs_time</span><span class="p">,</span>
                                  <span class="bp">self</span><span class="o">.</span><span class="n">wtop_vs_time</span><span class="p">,</span>
                                  <span class="bp">self</span><span class="o">.</span><span class="n">wbot_vs_time</span><span class="p">])</span><span class="o">!=</span><span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_make_E_Igamv_the_BC</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">E_Igamv_the</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">E_Igamv_the_BC</span>

        <span class="k">return</span></div>

    <span class="k">def</span> <span class="nf">_make_E_Igamv_the_surcharge</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;make the surcharge loading matrices</span>

<span class="sd">        Make the E*inverse(gam*v)*theta part of solution u=phi*vE*inverse(gam*v)*theta.</span>
<span class="sd">        The contribution of each surcharge load is added and put in</span>
<span class="sd">        `self.E_Igamv_the_surcharge`. `self.E_Igamv_the_surcharge` is an array</span>
<span class="sd">        of size (neig, len(tvals)). So the columns are the column array</span>
<span class="sd">        E*inverse(gam*v)*theta calculated at each output time.  This will allow</span>
<span class="sd">        us later to do u = phi*v*self.E_Igamv_the_surcharge</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        Assuming the load are formulated as the product of separate time and depth</span>
<span class="sd">        dependant functions:</span>

<span class="sd">        .. math:: \\sigma\\left({Z,t}\\right)=\\sigma\\left({Z}\\right)\\sigma\\left({t}\\right)</span>

<span class="sd">        the solution to the consolidation equation using the spectral method has</span>
<span class="sd">        the form:</span>

<span class="sd">        .. math:: u\\left(Z,t\\right)=\\mathbf{\\Phi v E}\\left(\\mathbf{\\Gamma v}\\right)^{-1}\\mathbf{\\theta}</span>

<span class="sd">        `_make_E_Igamv_the_surcharge` will create `self.E_Igamv_the_surcharge` which is</span>
<span class="sd">        the :math:`\\mathbf{E}\\left(\\mathbf{\\Gamma v}\\right)^{-1}\\mathbf{\\theta}`</span>
<span class="sd">        part of the solution for all surcharge loads</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">E_Igamv_the_surcharge</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">speccon1d</span><span class="o">.</span><span class="n">dim1sin_E_Igamv_the_aDmagDt_bilinear</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">m_block</span><span class="p">,</span>
                   <span class="bp">self</span><span class="o">.</span><span class="n">eigs</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">tvals</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">Igamv</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">m1kw</span><span class="p">,</span>
                   <span class="bp">self</span><span class="o">.</span><span class="n">surcharge_vs_depth</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">surcharge_vs_time</span><span class="p">,</span>
                   <span class="bp">self</span><span class="o">.</span><span class="n">surcharge_omega_phase</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dT</span><span class="p">,</span>
                   <span class="n">theta_zero_indexes</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">neig</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
                   <span class="n">implementation</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">implementation</span><span class="p">))</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">E_Igamv_the_surcharge</span> <span class="o">+=</span> <span class="p">(</span>
            <span class="n">speccon1d</span><span class="o">.</span><span class="n">dim1sin_E_Igamv_the_aDmagDt_bilinear</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">m_block</span><span class="p">,</span>
                   <span class="bp">self</span><span class="o">.</span><span class="n">eigs</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">tvals</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">Igamv</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">m1ka</span><span class="p">,</span>
                   <span class="bp">self</span><span class="o">.</span><span class="n">surcharge_vs_depth</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">surcharge_vs_time</span><span class="p">,</span>
                   <span class="bp">self</span><span class="o">.</span><span class="n">surcharge_omega_phase</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dT</span><span class="p">,</span>
                   <span class="n">theta_zero_indexes</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">neig</span><span class="p">),</span>
                   <span class="n">implementation</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">implementation</span><span class="p">))</span>
        <span class="k">return</span>




    <span class="k">def</span> <span class="nf">_normalised_bot_vs_time</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Normalise bot_vs_time when drn=1, i.e. bot_vs_time is a gradient</span>

<span class="sd">        Multiplie each bot_vs_time PolyLine by self.H</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        bot_vs_time : list of Polylines, or None</span>
<span class="sd">            bot_vs_time normalised by H</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">wbot_vs_time</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">drn</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">wbot_vs_time</span> <span class="o">=</span> <span class="p">([</span><span class="n">vs_time</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">H</span> <span class="k">for</span>
                                <span class="n">vs_time</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">wbot_vs_time</span><span class="p">])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">wbot_vs_time</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">wbot_vs_time</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">wbot_vs_time</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">abot_vs_time</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">drn</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">abot_vs_time</span> <span class="o">=</span> <span class="p">([</span><span class="n">vs_time</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">H</span> <span class="k">for</span>
                                <span class="n">vs_time</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">abot_vs_time</span><span class="p">])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">abot_vs_time</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">abot_vs_time</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">abot_vs_time</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="k">return</span> <span class="n">wbot_vs_time</span><span class="p">,</span> <span class="n">abot_vs_time</span>

    <span class="k">def</span> <span class="nf">_make_E_Igamv_the_BC</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;make the boundary condition loading matrices</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">E_Igamv_the_BC</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">2</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">neig</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tvals</span><span class="p">)))</span>
        <span class="n">wbot_vs_time</span><span class="p">,</span> <span class="n">abot_vs_time</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_normalised_bot_vs_time</span><span class="p">()</span>

        <span class="n">botzero</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">neig</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="n">topzero</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">neig</span><span class="p">)</span>

        <span class="c1"># top row of block</span>
        <span class="c1">#m2w * duw/dt component</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">E_Igamv_the_BC</span> <span class="o">-=</span> <span class="p">(</span>
            <span class="n">speccon1d</span><span class="o">.</span><span class="n">dim1sin_E_Igamv_the_BC_aDfDt_linear</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">drn</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">m_block</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">eigs</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">tvals</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">Igamv</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">m2w</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">wtop_vs_time</span><span class="p">,</span> <span class="n">wbot_vs_time</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">wtop_omega_phase</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">wbot_omega_phase</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dT</span><span class="p">,</span>
                <span class="n">theta_zero_indexes</span><span class="o">=</span><span class="n">botzero</span><span class="p">,</span>
                <span class="n">implementation</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">implementation</span><span class="p">))</span>
        <span class="c1">#m1kw * dua/dt component</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">E_Igamv_the_BC</span> <span class="o">-=</span> <span class="p">(</span>
            <span class="n">speccon1d</span><span class="o">.</span><span class="n">dim1sin_E_Igamv_the_BC_aDfDt_linear</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">drn</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">m_block</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">eigs</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">tvals</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">Igamv</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">m1kw</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">atop_vs_time</span><span class="p">,</span> <span class="n">abot_vs_time</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">atop_omega_phase</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">abot_omega_phase</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dT</span><span class="p">,</span>
                <span class="n">theta_zero_indexes</span><span class="o">=</span><span class="n">botzero</span><span class="p">,</span>
                <span class="n">implementation</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">implementation</span><span class="p">))</span>
        <span class="c1">#m2w * dua/dt component</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">E_Igamv_the_BC</span> <span class="o">+=</span> <span class="p">(</span>
            <span class="n">speccon1d</span><span class="o">.</span><span class="n">dim1sin_E_Igamv_the_BC_aDfDt_linear</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">drn</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">m_block</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">eigs</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">tvals</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">Igamv</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">m2w</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">atop_vs_time</span><span class="p">,</span> <span class="n">abot_vs_time</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">atop_omega_phase</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">abot_omega_phase</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dT</span><span class="p">,</span>
                <span class="n">theta_zero_indexes</span><span class="o">=</span><span class="n">botzero</span><span class="p">,</span>
                <span class="n">implementation</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">implementation</span><span class="p">))</span>
<span class="c1">#        #(m1kw * dua/dt - m2w * dua/dt) component</span>
<span class="c1">#        self.E_Igamv_the_BC -= (</span>
<span class="c1">#            speccon1d.dim1sin_E_Igamv_the_BC_aDfDt_linear(</span>
<span class="c1">#                self.drn, self.m_block, self.eigs, self.tvals,</span>
<span class="c1">#                self.Igamv, self.m1kw-self.m2w,</span>
<span class="c1">#                self.atop_vs_time, abot_vs_time,</span>
<span class="c1">#                self.atop_omega_phase, self.abot_omega_phase,</span>
<span class="c1">#                self.dT,theta_zero_indexes=botzero,</span>
<span class="c1">#                implementation=self.implementation))</span>
        <span class="c1">#dTw * d/dZ(kw * duw/dZ) component</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dTw</span><span class="o">!=</span><span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">E_Igamv_the_BC</span> <span class="o">-=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dTw</span> <span class="o">*</span>
                <span class="n">speccon1d</span><span class="o">.</span><span class="n">dim1sin_E_Igamv_the_BC_D_aDf_linear</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">drn</span><span class="p">,</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">m_block</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">eigs</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">tvals</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">Igamv</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">kw</span><span class="p">,</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">wtop_vs_time</span><span class="p">,</span> <span class="n">wbot_vs_time</span><span class="p">,</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">wtop_omega_phase</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">wbot_omega_phase</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dT</span><span class="p">,</span>
                    <span class="n">theta_zero_indexes</span><span class="o">=</span><span class="n">botzero</span><span class="p">,</span>
                    <span class="n">implementation</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">implementation</span><span class="p">))</span>

        <span class="c1"># bottom row of block</span>
        <span class="c1">#m2a * duw/dt component</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">E_Igamv_the_BC</span> <span class="o">-=</span> <span class="p">(</span>
            <span class="n">speccon1d</span><span class="o">.</span><span class="n">dim1sin_E_Igamv_the_BC_aDfDt_linear</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">drn</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">m_block</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">eigs</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">tvals</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">Igamv</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">m2a</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">wtop_vs_time</span><span class="p">,</span> <span class="n">wbot_vs_time</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">wtop_omega_phase</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">wbot_omega_phase</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dT</span><span class="p">,</span>
                <span class="n">theta_zero_indexes</span><span class="o">=</span><span class="n">topzero</span><span class="p">,</span>
                <span class="n">implementation</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">implementation</span><span class="p">))</span>
        <span class="c1">#m1ka * dua/dt component</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">E_Igamv_the_BC</span> <span class="o">-=</span> <span class="p">(</span>
            <span class="n">speccon1d</span><span class="o">.</span><span class="n">dim1sin_E_Igamv_the_BC_aDfDt_linear</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">drn</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">m_block</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">eigs</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">tvals</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">Igamv</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">m1ka</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">atop_vs_time</span><span class="p">,</span> <span class="n">abot_vs_time</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">atop_omega_phase</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">abot_omega_phase</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dT</span><span class="p">,</span>
                <span class="n">theta_zero_indexes</span><span class="o">=</span><span class="n">topzero</span><span class="p">,</span>
                <span class="n">implementation</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">implementation</span><span class="p">))</span>
        <span class="c1">#m2a * dua/dt component</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">E_Igamv_the_BC</span> <span class="o">+=</span> <span class="p">(</span>
            <span class="n">speccon1d</span><span class="o">.</span><span class="n">dim1sin_E_Igamv_the_BC_aDfDt_linear</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">drn</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">m_block</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">eigs</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">tvals</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">Igamv</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">m2a</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">atop_vs_time</span><span class="p">,</span> <span class="n">abot_vs_time</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">atop_omega_phase</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">abot_omega_phase</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dT</span><span class="p">,</span>
                <span class="n">theta_zero_indexes</span><span class="o">=</span><span class="n">topzero</span><span class="p">,</span>
                <span class="n">implementation</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">implementation</span><span class="p">))</span>
        <span class="c1">#n * dua/dt / mvref/ ua_ component</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">E_Igamv_the_BC</span> <span class="o">+=</span> <span class="p">(</span>
            <span class="n">speccon1d</span><span class="o">.</span><span class="n">dim1sin_E_Igamv_the_BC_aDfDt_linear</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">drn</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">m_block</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">eigs</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">tvals</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">Igamv</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">n</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">atop_vs_time</span><span class="p">,</span> <span class="n">abot_vs_time</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">atop_omega_phase</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">abot_omega_phase</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dT</span><span class="p">,</span>
                <span class="n">theta_zero_indexes</span><span class="o">=</span><span class="n">topzero</span><span class="p">,</span>
                <span class="n">implementation</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">implementation</span><span class="p">))</span><span class="o">/</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mvref</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">ua_</span><span class="p">)</span>
<span class="c1">#       #(m1ka * dua/dt - m2a * dua/dt - n * dua/dt / mvref/ ua_) component</span>
<span class="c1">#        self.E_Igamv_the_BC -= (</span>
<span class="c1">#            speccon1d.dim1sin_E_Igamv_the_BC_aDfDt_linear(</span>
<span class="c1">#                self.drn, self.m_block, self.eigs, self.tvals,</span>
<span class="c1">#                self.Igamv, self.m1ka - self.m2a - self.n/self.mvref/self.ua_,</span>
<span class="c1">#                self.atop_vs_time, abot_vs_time,</span>
<span class="c1">#                self.atop_omega_phase, self.abot_omega_phase,</span>
<span class="c1">#                self.dT, theta_zero_indexes=topzero,</span>
<span class="c1">#                implementation=self.implementation))</span>
        <span class="c1">#S*n * dua/dt component</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">E_Igamv_the_BC</span> <span class="o">-=</span> <span class="p">(</span>
            <span class="n">speccon1d</span><span class="o">.</span><span class="n">dim1sin_E_Igamv_the_BC_abDfDt_linear</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">drn</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">m_block</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">eigs</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">tvals</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">Igamv</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">S</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">n</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">atop_vs_time</span><span class="p">,</span> <span class="n">abot_vs_time</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">atop_omega_phase</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">abot_omega_phase</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dT</span><span class="p">,</span>
                <span class="n">theta_zero_indexes</span><span class="o">=</span><span class="n">topzero</span><span class="p">,</span>
                <span class="n">implementation</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">implementation</span><span class="p">))</span><span class="o">/</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mvref</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">ua_</span><span class="p">)</span>
        <span class="c1">#dTa * d/dZ(Da * du/dZ) component</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dTw</span><span class="o">!=</span><span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">E_Igamv_the_BC</span> <span class="o">-=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dTa</span> <span class="o">*</span>
                <span class="n">speccon1d</span><span class="o">.</span><span class="n">dim1sin_E_Igamv_the_BC_D_aDf_linear</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">drn</span><span class="p">,</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">m_block</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">eigs</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">tvals</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">Igamv</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">Da</span><span class="p">,</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">atop_vs_time</span><span class="p">,</span> <span class="n">abot_vs_time</span><span class="p">,</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">atop_omega_phase</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">abot_omega_phase</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dT</span><span class="p">,</span>
                    <span class="n">theta_zero_indexes</span><span class="o">=</span><span class="n">topzero</span><span class="p">,</span>
                <span class="n">implementation</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">implementation</span><span class="p">))</span>

        <span class="k">return</span>



    <span class="k">def</span> <span class="nf">_make_por</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;make the pore pressure output, ua and uw</span>

<span class="sd">        makes `self.por`, the average pore pressure at depths corresponding to</span>
<span class="sd">        self.ppress_z and times corresponding to self.tvals.  `self.por`  has size</span>
<span class="sd">        (len(ppress_z), len(tvals)).</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        Solution to consolidation equation with spectral method for pore pressure at depth is :</span>

<span class="sd">        .. math:: u\\left(Z,t\\right)=\\mathbf{\\Phi v E}\\left(\\mathbf{\\Gamma v}\\right)^{-1}\\mathbf{\\theta}+u_{top}\\left({t}\\right)\\left({1-Z}\\right)+u_{bot}\\left({t}\\right)\\left({Z}\\right)</span>

<span class="sd">        For pore pressure :math:`\\Phi` is simply :math:`sin\\left({mZ}\\right)` for each value of m</span>


<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">wbot_vs_time</span><span class="p">,</span> <span class="n">abot_vs_time</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_normalised_bot_vs_time</span><span class="p">()</span>
        <span class="n">tvals</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tvals</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">ppress_z_tval_indexes</span><span class="p">]</span>

        <span class="c1">#water pore pressure at depth</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">porw</span> <span class="o">=</span> <span class="n">speccon1d</span><span class="o">.</span><span class="n">dim1sin_f</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ppress_z</span><span class="p">,</span>
            <span class="n">tvals</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">v_E_Igamv_the</span><span class="p">[:</span><span class="bp">self</span><span class="o">.</span><span class="n">neig</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ppress_z_tval_indexes</span><span class="p">],</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">drn</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">wtop_vs_time</span><span class="p">,</span> <span class="n">wbot_vs_time</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">wtop_omega_phase</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">wbot_omega_phase</span><span class="p">)</span>

        <span class="c1">#air pore pressure at depth</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pora</span> <span class="o">=</span> <span class="n">speccon1d</span><span class="o">.</span><span class="n">dim1sin_f</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ppress_z</span><span class="p">,</span>
            <span class="n">tvals</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">v_E_Igamv_the</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">neig</span><span class="p">:,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ppress_z_tval_indexes</span><span class="p">],</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">drn</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">atop_vs_time</span><span class="p">,</span> <span class="n">abot_vs_time</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">atop_omega_phase</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">abot_omega_phase</span><span class="p">)</span>

        <span class="k">return</span>




    <span class="k">def</span> <span class="nf">_make_avp</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;calculate average pore pressure, for us uc and u</span>

<span class="sd">        makes `self.avp`, the average pore pressure at depths corresponding to</span>
<span class="sd">        self.avg_ppress_z_pairs and times corresponding to self.tvals.  `self.avp`  has size</span>
<span class="sd">        (len(ppress_z), len(tvals)).</span>


<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        The average pore pressure between Z1 and Z2 is given by:</span>

<span class="sd">        .. math:: \\overline{u}\\left(\\left({Z_1,Z_2}\\right),t\\right)=\\int_{Z_1}^{Z_2}{\\mathbf{\\Phi v E}\\left(\\mathbf{\\Gamma v}\\right)^{-1}\\mathbf{\\theta}+u_{top}\\left({t}\\right)\\left({1-Z}\\right)+u_{bot}\\left({t}\\right)\\left({Z}\\right)\,dZ}/\\left({Z_2-Z_1}\\right)</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">wbot_vs_time</span><span class="p">,</span> <span class="n">abot_vs_time</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_normalised_bot_vs_time</span><span class="p">()</span>
        <span class="n">tvals</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tvals</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">avg_ppress_z_pairs_tval_indexes</span><span class="p">]</span>

        <span class="c1">#water pore pressure at depth</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">avpw</span> <span class="o">=</span> <span class="n">speccon1d</span><span class="o">.</span><span class="n">dim1sin_avgf</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">avg_ppress_z_pairs</span><span class="p">,</span>
            <span class="n">tvals</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">v_E_Igamv_the</span><span class="p">[:</span><span class="bp">self</span><span class="o">.</span><span class="n">neig</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">avg_ppress_z_pairs_tval_indexes</span><span class="p">],</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">drn</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">wtop_vs_time</span><span class="p">,</span> <span class="n">wbot_vs_time</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">wtop_omega_phase</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">wbot_omega_phase</span><span class="p">)</span>

        <span class="c1">#air pore pressure at depth</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">avpa</span> <span class="o">=</span> <span class="n">speccon1d</span><span class="o">.</span><span class="n">dim1sin_avgf</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">avg_ppress_z_pairs</span><span class="p">,</span>
            <span class="n">tvals</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">v_E_Igamv_the</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">neig</span><span class="p">:,</span> <span class="bp">self</span><span class="o">.</span><span class="n">avg_ppress_z_pairs_tval_indexes</span><span class="p">],</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">drn</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">atop_vs_time</span><span class="p">,</span> <span class="n">abot_vs_time</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">atop_omega_phase</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">abot_omega_phase</span><span class="p">)</span>

        <span class="k">return</span>

    <span class="k">def</span> <span class="nf">_make_set</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;calculate settlement</span>

<span class="sd">        makes `self.set`, the average pore pressure at depths corresponding to</span>
<span class="sd">        self.settlement_z_pairs and times corresponding to self.tvals.  `self.set`  has size</span>
<span class="sd">        (len(ppress_z), len(tvals)).</span>


<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        The average settlement between Z1 and Z2 is given by:</span>

<span class="sd">        .. math:: \\overline{\\rho}\\left(\\left({Z_1,Z_2}\\right),t\\right)=\\int_{Z_1}^{Z_2}{m_v\\left({Z}\\right)\\left({\\sigma\\left({Z,t}\\right)-u\\left({Z,t}\\right)}\\right)\\,dZ}</span>


<span class="sd">        .. math:: \\overline{\\rho}\\left(\\left({Z_1,Z_2}\\right),t\\right)=\\int_{Z_1}^{Z_2}{m_v\\left({Z}\\right)\\sigma\\left({Z,t}\\right)\\,dZ}+\\int_{Z_1}^{Z_2}{m_v\\left({Z}\\right)\\left({\\mathbf{\\Phi v E}\\left(\\mathbf{\\Gamma v}\\right)^{-1}\\mathbf{\\theta}+u_{top}\\left({t}\\right)\\left({1-Z}\\right)+u_{bot}\\left({t}\\right)\\left({Z}\\right)}\\right)\\,dZ}</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">wbot_vs_time</span><span class="p">,</span> <span class="n">abot_vs_time</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_normalised_bot_vs_time</span><span class="p">()</span>
        <span class="n">z1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">settlement_z_pairs</span><span class="p">)[:,</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">z2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">settlement_z_pairs</span><span class="p">)[:,</span><span class="mi">1</span><span class="p">]</span>

        <span class="c1"># setw ua part</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setw</span> <span class="o">=</span> <span class="n">speccon1d</span><span class="o">.</span><span class="n">dim1sin_integrate_af</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="p">,</span>
                     <span class="bp">self</span><span class="o">.</span><span class="n">settlement_z_pairs</span><span class="p">,</span>
                     <span class="bp">self</span><span class="o">.</span><span class="n">tvals</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">settlement_z_pairs_tval_indexes</span><span class="p">],</span>
                     <span class="bp">self</span><span class="o">.</span><span class="n">v_E_Igamv_the</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">neig</span><span class="p">:</span> <span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">settlement_z_pairs_tval_indexes</span><span class="p">],</span>
                     <span class="bp">self</span><span class="o">.</span><span class="n">drn</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">m2w</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">m1kw</span><span class="p">,</span>
                     <span class="bp">self</span><span class="o">.</span><span class="n">atop_vs_time</span><span class="p">,</span> <span class="n">abot_vs_time</span><span class="p">,</span>
                     <span class="bp">self</span><span class="o">.</span><span class="n">atop_omega_phase</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">abot_omega_phase</span><span class="p">)</span>
        <span class="c1"># setw uw part</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setw</span> <span class="o">-=</span> <span class="n">speccon1d</span><span class="o">.</span><span class="n">dim1sin_integrate_af</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="p">,</span>
                     <span class="bp">self</span><span class="o">.</span><span class="n">settlement_z_pairs</span><span class="p">,</span>
                     <span class="bp">self</span><span class="o">.</span><span class="n">tvals</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">settlement_z_pairs_tval_indexes</span><span class="p">],</span>
                     <span class="bp">self</span><span class="o">.</span><span class="n">v_E_Igamv_the</span><span class="p">[:</span><span class="bp">self</span><span class="o">.</span><span class="n">neig</span> <span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">settlement_z_pairs_tval_indexes</span><span class="p">],</span>
                     <span class="bp">self</span><span class="o">.</span><span class="n">drn</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">m2w</span><span class="p">,</span>
                     <span class="bp">self</span><span class="o">.</span><span class="n">wtop_vs_time</span><span class="p">,</span> <span class="n">wbot_vs_time</span><span class="p">,</span>
                     <span class="bp">self</span><span class="o">.</span><span class="n">wtop_omega_phase</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">wbot_omega_phase</span><span class="p">)</span>

        <span class="c1"># seta ua part</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">seta</span> <span class="o">=</span> <span class="n">speccon1d</span><span class="o">.</span><span class="n">dim1sin_integrate_af</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="p">,</span>
                     <span class="bp">self</span><span class="o">.</span><span class="n">settlement_z_pairs</span><span class="p">,</span>
                     <span class="bp">self</span><span class="o">.</span><span class="n">tvals</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">settlement_z_pairs_tval_indexes</span><span class="p">],</span>
                     <span class="bp">self</span><span class="o">.</span><span class="n">v_E_Igamv_the</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">neig</span><span class="p">:</span> <span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">settlement_z_pairs_tval_indexes</span><span class="p">],</span>
                     <span class="bp">self</span><span class="o">.</span><span class="n">drn</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">m2a</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">m1ka</span><span class="p">,</span>
                     <span class="bp">self</span><span class="o">.</span><span class="n">atop_vs_time</span><span class="p">,</span> <span class="n">abot_vs_time</span><span class="p">,</span>
                     <span class="bp">self</span><span class="o">.</span><span class="n">atop_omega_phase</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">abot_omega_phase</span><span class="p">)</span>
        <span class="c1"># seta uw part</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setw</span> <span class="o">-=</span> <span class="n">speccon1d</span><span class="o">.</span><span class="n">dim1sin_integrate_af</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="p">,</span>
                     <span class="bp">self</span><span class="o">.</span><span class="n">settlement_z_pairs</span><span class="p">,</span>
                     <span class="bp">self</span><span class="o">.</span><span class="n">tvals</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">settlement_z_pairs_tval_indexes</span><span class="p">],</span>
                     <span class="bp">self</span><span class="o">.</span><span class="n">v_E_Igamv_the</span><span class="p">[:</span><span class="bp">self</span><span class="o">.</span><span class="n">neig</span> <span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">settlement_z_pairs_tval_indexes</span><span class="p">],</span>
                     <span class="bp">self</span><span class="o">.</span><span class="n">drn</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">m2a</span><span class="p">,</span>
                     <span class="bp">self</span><span class="o">.</span><span class="n">wtop_vs_time</span><span class="p">,</span> <span class="n">wbot_vs_time</span><span class="p">,</span>
                     <span class="bp">self</span><span class="o">.</span><span class="n">wtop_omega_phase</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">wbot_omega_phase</span><span class="p">)</span>



        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">surcharge_vs_time</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="c1">#setw surcharge part</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">setw</span> <span class="o">+=</span> <span class="p">(</span>
                <span class="n">pwise</span><span class="o">.</span><span class="n">pxa_ya_cos_multiply_integrate_x1b_x2b_y1b_y2b_multiply_x1c_x2c_y1c_y2c_between_super</span><span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">surcharge_vs_time</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">surcharge_vs_depth</span><span class="p">,</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">m1kw</span><span class="p">,</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">tvals</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">settlement_z_pairs_tval_indexes</span><span class="p">],</span> <span class="n">z1</span><span class="p">,</span> <span class="n">z2</span><span class="p">,</span>
                    <span class="n">omega_phase</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">surcharge_omega_phase</span><span class="p">,</span>
                    <span class="n">achoose_max</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
            <span class="c1">#seta surcharge part</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">seta</span> <span class="o">+=</span> <span class="p">(</span>
                <span class="n">pwise</span><span class="o">.</span><span class="n">pxa_ya_cos_multiply_integrate_x1b_x2b_y1b_y2b_multiply_x1c_x2c_y1c_y2c_between_super</span><span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">surcharge_vs_time</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">surcharge_vs_depth</span><span class="p">,</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">m1ka</span><span class="p">,</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">tvals</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">settlement_z_pairs_tval_indexes</span><span class="p">],</span> <span class="n">z1</span><span class="p">,</span> <span class="n">z2</span><span class="p">,</span>
                    <span class="n">omega_phase</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">surcharge_omega_phase</span><span class="p">,</span>
                    <span class="n">achoose_max</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">setw</span> <span class="o">*=</span> <span class="bp">self</span><span class="o">.</span><span class="n">H</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">mvref</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">seta</span> <span class="o">*=</span> <span class="bp">self</span><span class="o">.</span><span class="n">H</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">mvref</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">seta</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">setw</span>

        <span class="k">return</span>


    <span class="k">def</span> <span class="nf">_plot_porw</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;plot depth vs pore water pressure for various times</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">t</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tvals</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">ppress_z_tval_indexes</span><span class="p">]</span>
        <span class="n">line_labels</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;</span><span class="si">{:.3g}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">t</span><span class="p">]</span>
        <span class="n">porw_prop</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">plot_properties</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;porw&#39;</span><span class="p">,</span> <span class="nb">dict</span><span class="p">())</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="s1">&#39;xlabel&#39;</span> <span class="ow">in</span> <span class="n">porw_prop</span><span class="p">:</span>
            <span class="n">porw_prop</span><span class="p">[</span><span class="s1">&#39;xlabel&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;Pore water pressure&#39;</span>

        <span class="c1">#to do</span>
        <span class="n">fig_porw</span> <span class="o">=</span> <span class="n">geotecha</span><span class="o">.</span><span class="n">plotting</span><span class="o">.</span><span class="n">one_d</span><span class="o">.</span><span class="n">plot_vs_depth</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">porw</span><span class="p">,</span>
                                                        <span class="bp">self</span><span class="o">.</span><span class="n">ppress_z</span><span class="p">,</span>
                                      <span class="n">line_labels</span><span class="o">=</span><span class="n">line_labels</span><span class="p">,</span> <span class="n">H</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">H</span><span class="p">,</span>
                                      <span class="n">RLzero</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">RLzero</span><span class="p">,</span>
                                      <span class="n">prop_dict</span><span class="o">=</span><span class="n">porw_prop</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">fig_porw</span>
    <span class="k">def</span> <span class="nf">_plot_pora</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;plot depth vs pore air pressure for various times</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">t</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tvals</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">ppress_z_tval_indexes</span><span class="p">]</span>
        <span class="n">line_labels</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;</span><span class="si">{:.3g}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">t</span><span class="p">]</span>
        <span class="n">pora_prop</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">plot_properties</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;pora&#39;</span><span class="p">,</span> <span class="nb">dict</span><span class="p">())</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="s1">&#39;xlabel&#39;</span> <span class="ow">in</span> <span class="n">pora_prop</span><span class="p">:</span>
            <span class="n">pora_prop</span><span class="p">[</span><span class="s1">&#39;xlabel&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;Pore air pressure&#39;</span>

        <span class="c1">#to do</span>
        <span class="n">fig_pora</span> <span class="o">=</span> <span class="n">geotecha</span><span class="o">.</span><span class="n">plotting</span><span class="o">.</span><span class="n">one_d</span><span class="o">.</span><span class="n">plot_vs_depth</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pora</span><span class="p">,</span>
                                                         <span class="bp">self</span><span class="o">.</span><span class="n">ppress_z</span><span class="p">,</span>
                                      <span class="n">line_labels</span><span class="o">=</span><span class="n">line_labels</span><span class="p">,</span> <span class="n">H</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">H</span><span class="p">,</span>
                                      <span class="n">RLzero</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">RLzero</span><span class="p">,</span>
                                      <span class="n">prop_dict</span><span class="o">=</span><span class="n">pora_prop</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">fig_pora</span>


    <span class="k">def</span> <span class="nf">_plot_avpw</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;plot average pore water pressure vs time for various depth intervals</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">t</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tvals</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">avg_ppress_z_pairs_tval_indexes</span><span class="p">]</span>
        <span class="n">z_pairs</span> <span class="o">=</span> <span class="n">transformations</span><span class="o">.</span><span class="n">depth_to_reduced_level</span><span class="p">(</span>
            <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">avg_ppress_z_pairs</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">H</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">RLzero</span><span class="p">)</span>
        <span class="n">line_labels</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;</span><span class="si">{:.3g}</span><span class="s1"> to </span><span class="si">{:.3g}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">z1</span><span class="p">,</span> <span class="n">z2</span><span class="p">)</span> <span class="k">for</span> <span class="n">z1</span><span class="p">,</span> <span class="n">z2</span> <span class="ow">in</span> <span class="n">z_pairs</span><span class="p">]</span>

        <span class="n">avpw_prop</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">plot_properties</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;avpw&#39;</span><span class="p">,</span> <span class="nb">dict</span><span class="p">())</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="s1">&#39;ylabel&#39;</span> <span class="ow">in</span> <span class="n">avpw_prop</span><span class="p">:</span>
            <span class="n">avpw_prop</span><span class="p">[</span><span class="s1">&#39;ylabel&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;Average pore water pressure&#39;</span>
        <span class="n">fig_avpw</span> <span class="o">=</span> <span class="n">geotecha</span><span class="o">.</span><span class="n">plotting</span><span class="o">.</span><span class="n">one_d</span><span class="o">.</span><span class="n">plot_vs_time</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">avpw</span><span class="o">.</span><span class="n">T</span><span class="p">,</span>
                           <span class="n">line_labels</span><span class="o">=</span><span class="n">line_labels</span><span class="p">,</span>
                           <span class="n">prop_dict</span><span class="o">=</span><span class="n">avpw_prop</span><span class="p">)</span>
        <span class="n">fig_avpw</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">set_xscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">fig_avpw</span>

    <span class="k">def</span> <span class="nf">_plot_avpa</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;plot average pore air pressure vs time for various depth intervals</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">t</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tvals</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">avg_ppress_z_pairs_tval_indexes</span><span class="p">]</span>
        <span class="n">z_pairs</span> <span class="o">=</span> <span class="n">transformations</span><span class="o">.</span><span class="n">depth_to_reduced_level</span><span class="p">(</span>
            <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">avg_ppress_z_pairs</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">H</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">RLzero</span><span class="p">)</span>
        <span class="n">line_labels</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;</span><span class="si">{:.3g}</span><span class="s1"> to </span><span class="si">{:.3g}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">z1</span><span class="p">,</span> <span class="n">z2</span><span class="p">)</span> <span class="k">for</span> <span class="n">z1</span><span class="p">,</span> <span class="n">z2</span> <span class="ow">in</span> <span class="n">z_pairs</span><span class="p">]</span>

        <span class="n">avpa_prop</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">plot_properties</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;avpa&#39;</span><span class="p">,</span> <span class="nb">dict</span><span class="p">())</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="s1">&#39;ylabel&#39;</span> <span class="ow">in</span> <span class="n">avpa_prop</span><span class="p">:</span>
            <span class="n">avpa_prop</span><span class="p">[</span><span class="s1">&#39;ylabel&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;Average pore air pressure&#39;</span>
        <span class="n">fig_avpa</span> <span class="o">=</span> <span class="n">geotecha</span><span class="o">.</span><span class="n">plotting</span><span class="o">.</span><span class="n">one_d</span><span class="o">.</span><span class="n">plot_vs_time</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">avpa</span><span class="o">.</span><span class="n">T</span><span class="p">,</span>
                           <span class="n">line_labels</span><span class="o">=</span><span class="n">line_labels</span><span class="p">,</span>
                           <span class="n">prop_dict</span><span class="o">=</span><span class="n">avpa_prop</span><span class="p">)</span>
        <span class="n">fig_avpa</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">set_xscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">fig_avpa</span>

    <span class="k">def</span> <span class="nf">_plot_set</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;plot settlement vs time for various depth intervals</span>


<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">t</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tvals</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">settlement_z_pairs_tval_indexes</span><span class="p">]</span>
        <span class="n">z_pairs</span> <span class="o">=</span> <span class="n">transformations</span><span class="o">.</span><span class="n">depth_to_reduced_level</span><span class="p">(</span>
            <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">settlement_z_pairs</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">H</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">RLzero</span><span class="p">)</span>
        <span class="n">line_labels</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;</span><span class="si">{:.3g}</span><span class="s1"> to </span><span class="si">{:.3g}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">z1</span><span class="p">,</span> <span class="n">z2</span><span class="p">)</span> <span class="k">for</span> <span class="n">z1</span><span class="p">,</span> <span class="n">z2</span> <span class="ow">in</span> <span class="n">z_pairs</span><span class="p">]</span>

        <span class="n">set_prop</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">plot_properties</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;set&#39;</span><span class="p">,</span> <span class="nb">dict</span><span class="p">())</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="s1">&#39;ylabel&#39;</span> <span class="ow">in</span> <span class="n">set_prop</span><span class="p">:</span>
            <span class="n">set_prop</span><span class="p">[</span><span class="s1">&#39;ylabel&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;Settlement&#39;</span>
        <span class="n">fig_set</span> <span class="o">=</span> <span class="n">geotecha</span><span class="o">.</span><span class="n">plotting</span><span class="o">.</span><span class="n">one_d</span><span class="o">.</span><span class="n">plot_vs_time</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">set</span><span class="o">.</span><span class="n">T</span><span class="p">,</span>
                           <span class="n">line_labels</span><span class="o">=</span><span class="n">line_labels</span><span class="p">,</span>
                           <span class="n">prop_dict</span><span class="o">=</span><span class="n">set_prop</span><span class="p">)</span>
<span class="c1">#        fig_set.gca().invert_yaxis()</span>
        <span class="n">fig_set</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">set_xscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">fig_set</span>

    <span class="k">def</span> <span class="nf">_plot_setw</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;plot water settlement vs time for various depth intervals</span>


<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">t</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tvals</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">settlement_z_pairs_tval_indexes</span><span class="p">]</span>
        <span class="n">z_pairs</span> <span class="o">=</span> <span class="n">transformations</span><span class="o">.</span><span class="n">depth_to_reduced_level</span><span class="p">(</span>
            <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">settlement_z_pairs</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">H</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">RLzero</span><span class="p">)</span>
        <span class="n">line_labels</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;</span><span class="si">{:.3g}</span><span class="s1"> to </span><span class="si">{:.3g}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">z1</span><span class="p">,</span> <span class="n">z2</span><span class="p">)</span> <span class="k">for</span> <span class="n">z1</span><span class="p">,</span> <span class="n">z2</span> <span class="ow">in</span> <span class="n">z_pairs</span><span class="p">]</span>

        <span class="n">set_prop</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">plot_properties</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;setw&#39;</span><span class="p">,</span> <span class="nb">dict</span><span class="p">())</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="s1">&#39;ylabel&#39;</span> <span class="ow">in</span> <span class="n">set_prop</span><span class="p">:</span>
            <span class="n">set_prop</span><span class="p">[</span><span class="s1">&#39;ylabel&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;Water settlement&#39;</span>
        <span class="n">fig_set</span> <span class="o">=</span> <span class="n">geotecha</span><span class="o">.</span><span class="n">plotting</span><span class="o">.</span><span class="n">one_d</span><span class="o">.</span><span class="n">plot_vs_time</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">setw</span><span class="o">.</span><span class="n">T</span><span class="p">,</span>
                           <span class="n">line_labels</span><span class="o">=</span><span class="n">line_labels</span><span class="p">,</span>
                           <span class="n">prop_dict</span><span class="o">=</span><span class="n">set_prop</span><span class="p">)</span>
<span class="c1">#        fig_set.gca().invert_yaxis()</span>
        <span class="n">fig_set</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">set_xscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">fig_set</span>

    <span class="k">def</span> <span class="nf">_plot_seta</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;plot air settlement vs time for various depth intervals</span>


<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">t</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tvals</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">settlement_z_pairs_tval_indexes</span><span class="p">]</span>
        <span class="n">z_pairs</span> <span class="o">=</span> <span class="n">transformations</span><span class="o">.</span><span class="n">depth_to_reduced_level</span><span class="p">(</span>
            <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">settlement_z_pairs</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">H</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">RLzero</span><span class="p">)</span>
        <span class="n">line_labels</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;</span><span class="si">{:.3g}</span><span class="s1"> to </span><span class="si">{:.3g}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">z1</span><span class="p">,</span> <span class="n">z2</span><span class="p">)</span> <span class="k">for</span> <span class="n">z1</span><span class="p">,</span> <span class="n">z2</span> <span class="ow">in</span> <span class="n">z_pairs</span><span class="p">]</span>

        <span class="n">set_prop</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">plot_properties</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;seta&#39;</span><span class="p">,</span> <span class="nb">dict</span><span class="p">())</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="s1">&#39;ylabel&#39;</span> <span class="ow">in</span> <span class="n">set_prop</span><span class="p">:</span>
            <span class="n">set_prop</span><span class="p">[</span><span class="s1">&#39;ylabel&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;Air settlement&#39;</span>
        <span class="n">fig_set</span> <span class="o">=</span> <span class="n">geotecha</span><span class="o">.</span><span class="n">plotting</span><span class="o">.</span><span class="n">one_d</span><span class="o">.</span><span class="n">plot_vs_time</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">seta</span><span class="o">.</span><span class="n">T</span><span class="p">,</span>
                           <span class="n">line_labels</span><span class="o">=</span><span class="n">line_labels</span><span class="p">,</span>
                           <span class="n">prop_dict</span><span class="o">=</span><span class="n">set_prop</span><span class="p">)</span>
<span class="c1">#        fig_set.gca().invert_yaxis()</span>
        <span class="n">fig_set</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">set_xscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">fig_set</span>

<div class="viewcode-block" id="Speccon1dUnsat.produce_plots"><a class="viewcode-back" href="../../../api/geotecha.speccon.speccon1d_unsat.html#geotecha.speccon.speccon1d_unsat.Speccon1dUnsat.produce_plots">[docs]</a>    <span class="k">def</span> <span class="nf">produce_plots</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;produce plots of analysis&quot;&quot;&quot;</span>

        <span class="n">geotecha</span><span class="o">.</span><span class="n">plotting</span><span class="o">.</span><span class="n">one_d</span><span class="o">.</span><span class="n">pleasing_defaults</span><span class="p">()</span>

<span class="c1">#        matplotlib.rcParams[&#39;figure.dpi&#39;] = 80</span>
<span class="c1">#        matplotlib.rcParams[&#39;savefig.dpi&#39;] = 80</span>

        <span class="n">matplotlib</span><span class="o">.</span><span class="n">rcParams</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s1">&#39;font.size&#39;</span><span class="p">:</span> <span class="mi">11</span><span class="p">})</span>
        <span class="n">matplotlib</span><span class="o">.</span><span class="n">rcParams</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s1">&#39;font.family&#39;</span><span class="p">:</span> <span class="s1">&#39;serif&#39;</span><span class="p">})</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_figures</span><span class="o">=</span><span class="p">[]</span>
        <span class="c1">#por and porwell</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">ppress_z</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">f</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_plot_porw</span><span class="p">()</span>
            <span class="n">title</span> <span class="o">=</span> <span class="s1">&#39;fig_porw&#39;</span>
            <span class="n">f</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="n">title</span><span class="p">)</span>
            <span class="n">f</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">manager</span><span class="o">.</span><span class="n">set_window_title</span><span class="p">(</span><span class="n">title</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_figures</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>

            <span class="n">f</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_plot_pora</span><span class="p">()</span>
            <span class="n">title</span> <span class="o">=</span> <span class="s1">&#39;fig_pora&#39;</span>
            <span class="n">f</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="n">title</span><span class="p">)</span>
            <span class="n">f</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">manager</span><span class="o">.</span><span class="n">set_window_title</span><span class="p">(</span><span class="n">title</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_figures</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">avg_ppress_z_pairs</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>

            <span class="n">f</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_plot_avpw</span><span class="p">()</span>
            <span class="n">title</span> <span class="o">=</span> <span class="s1">&#39;fig_avpw&#39;</span>
            <span class="n">f</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="n">title</span><span class="p">)</span>
            <span class="n">f</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">manager</span><span class="o">.</span><span class="n">set_window_title</span><span class="p">(</span><span class="n">title</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_figures</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>

            <span class="n">f</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_plot_avpa</span><span class="p">()</span>
            <span class="n">title</span> <span class="o">=</span> <span class="s1">&#39;fig_avpa&#39;</span>
            <span class="n">f</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="n">title</span><span class="p">)</span>
            <span class="n">f</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">manager</span><span class="o">.</span><span class="n">set_window_title</span><span class="p">(</span><span class="n">title</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_figures</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>

        <span class="c1">#settle</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">settlement_z_pairs</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">f</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_plot_set</span><span class="p">()</span>
            <span class="n">title</span> <span class="o">=</span> <span class="s1">&#39;fig_set&#39;</span>
            <span class="n">f</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="n">title</span><span class="p">)</span>
            <span class="n">f</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">manager</span><span class="o">.</span><span class="n">set_window_title</span><span class="p">(</span><span class="n">title</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_figures</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>

            <span class="n">f</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_plot_setw</span><span class="p">()</span>
            <span class="n">title</span> <span class="o">=</span> <span class="s1">&#39;fig_setw&#39;</span>
            <span class="n">f</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="n">title</span><span class="p">)</span>
            <span class="n">f</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">manager</span><span class="o">.</span><span class="n">set_window_title</span><span class="p">(</span><span class="n">title</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_figures</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>

            <span class="n">f</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_plot_seta</span><span class="p">()</span>
            <span class="n">title</span> <span class="o">=</span> <span class="s1">&#39;fig_seta&#39;</span>
            <span class="n">f</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="n">title</span><span class="p">)</span>
            <span class="n">f</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">manager</span><span class="o">.</span><span class="n">set_window_title</span><span class="p">(</span><span class="n">title</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_figures</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>

        <span class="c1">#loads</span>
        <span class="n">f</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_plot_loads</span><span class="p">()</span>
        <span class="n">title</span> <span class="o">=</span> <span class="s1">&#39;fig_loads&#39;</span>
        <span class="n">f</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="n">title</span><span class="p">)</span>
        <span class="n">f</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">manager</span><span class="o">.</span><span class="n">set_window_title</span><span class="p">(</span><span class="n">title</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_figures</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>

        <span class="c1">#materials</span>
        <span class="n">f</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_plot_materials</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_figures</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
        <span class="n">title</span> <span class="o">=</span> <span class="s1">&#39;fig_materials&#39;</span>
        <span class="n">f</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="n">title</span><span class="p">)</span>
        <span class="n">f</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">manager</span><span class="o">.</span><span class="n">set_window_title</span><span class="p">(</span><span class="n">title</span><span class="p">)</span></div>

    <span class="k">def</span> <span class="nf">_plot_materials</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

        <span class="n">material_prop</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">plot_properties</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;material&#39;</span><span class="p">,</span> <span class="nb">dict</span><span class="p">())</span>

        <span class="n">z_x</span><span class="o">=</span><span class="p">[]</span>
        <span class="n">xlabels</span><span class="o">=</span><span class="p">[]</span>


        <span class="n">z_x</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">m1kw</span><span class="p">)</span>
        <span class="n">xlabels</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;$m_{{1k}}^w/</span><span class="se">\\</span><span class="s1">overline{{m}}_v$, $</span><span class="se">\\</span><span class="s1">left&#39;</span>
            <span class="s1">&#39;(</span><span class="se">\\</span><span class="s1">overline{{m}}_v=</span><span class="si">{:g}</span><span class="se">\\</span><span class="s1">right)$&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mvref</span><span class="p">))</span>
        <span class="n">z_x</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">m2w</span><span class="p">)</span>
        <span class="n">xlabels</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;$m_{{2}}^w/</span><span class="se">\\</span><span class="s1">overline{{m}}_v$, $</span><span class="se">\\</span><span class="s1">left&#39;</span>
            <span class="s1">&#39;(</span><span class="se">\\</span><span class="s1">overline{{m}}_v=</span><span class="si">{:g}</span><span class="se">\\</span><span class="s1">right)$&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mvref</span><span class="p">))</span>
        <span class="n">z_x</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">m1ka</span><span class="p">)</span>
        <span class="n">xlabels</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;$m_{{1k}}^a/</span><span class="se">\\</span><span class="s1">overline{{m}}_v$, $</span><span class="se">\\</span><span class="s1">left&#39;</span>
            <span class="s1">&#39;(</span><span class="se">\\</span><span class="s1">overline{{m}}_v=</span><span class="si">{:g}</span><span class="se">\\</span><span class="s1">right)$&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mvref</span><span class="p">))</span>
        <span class="n">z_x</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">m2a</span><span class="p">)</span>
        <span class="n">xlabels</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;$m_{{2}}^a/</span><span class="se">\\</span><span class="s1">overline{{m}}_v$, $</span><span class="se">\\</span><span class="s1">left&#39;</span>
            <span class="s1">&#39;(</span><span class="se">\\</span><span class="s1">overline{{m}}_v=</span><span class="si">{:g}</span><span class="se">\\</span><span class="s1">right)$&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mvref</span><span class="p">))</span>
        <span class="n">z_x</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kw</span><span class="p">)</span>
        <span class="n">xlabels</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;$k_w/</span><span class="se">\\</span><span class="s1">overline{{k}}_w$, $</span><span class="se">\\</span><span class="s1">left&#39;</span>
            <span class="s1">&#39;(</span><span class="se">\\</span><span class="s1">overline{{k}}_w=</span><span class="si">{:g}</span><span class="se">\\</span><span class="s1">right)$&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kwref</span><span class="p">))</span>
        <span class="n">z_x</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Da</span><span class="p">)</span>
        <span class="n">xlabels</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;$D_a^</span><span class="se">\\</span><span class="s1">ast/</span><span class="se">\\</span><span class="s1">overline{{D}}_a^</span><span class="se">\\</span><span class="s1">ast$, $</span><span class="se">\\</span><span class="s1">left&#39;</span>
            <span class="s1">&#39;(</span><span class="se">\\</span><span class="s1">overline{{k}}_w=</span><span class="si">{:g}</span><span class="se">\\</span><span class="s1">right)$&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Daref</span><span class="p">))</span>
        <span class="n">z_x</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">S</span><span class="p">)</span>
        <span class="n">xlabels</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;Saturation, $S_r$&#39;</span><span class="p">)</span>
        <span class="n">z_x</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n</span><span class="p">)</span>
        <span class="n">xlabels</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;Porosity, $n$&#39;</span><span class="p">)</span>

        <span class="k">return</span> <span class="p">(</span><span class="n">geotecha</span><span class="o">.</span><span class="n">plotting</span><span class="o">.</span><span class="n">one_d</span><span class="o">.</span><span class="n">plot_single_material_vs_depth</span><span class="p">(</span><span class="n">z_x</span><span class="p">,</span>
                            <span class="n">xlabels</span><span class="p">,</span> <span class="n">H</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">H</span><span class="p">,</span>
                            <span class="n">RLzero</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">RLzero</span><span class="p">,</span><span class="n">prop_dict</span> <span class="o">=</span> <span class="n">material_prop</span><span class="p">))</span>
    <span class="k">def</span> <span class="nf">_plot_loads</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;plot loads</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">load_prop</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">plot_properties</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;load&#39;</span><span class="p">,</span> <span class="nb">dict</span><span class="p">())</span>
        <span class="n">load_triples</span><span class="o">=</span><span class="p">[]</span>
        <span class="n">load_names</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">ylabels</span><span class="o">=</span><span class="p">[]</span>
        <span class="c1">#surcharge</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">surcharge_vs_time</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">load_names</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;surch&#39;</span><span class="p">)</span>
            <span class="n">ylabels</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;Surcharge&#39;</span><span class="p">)</span>
            <span class="n">load_triples</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                <span class="p">[(</span><span class="n">vs_time</span><span class="p">,</span> <span class="n">vs_depth</span><span class="p">,</span> <span class="n">omega_phase</span><span class="p">)</span> <span class="k">for</span>
                    <span class="n">vs_time</span><span class="p">,</span> <span class="n">vs_depth</span><span class="p">,</span> <span class="n">omega_phase</span>  <span class="ow">in</span>
                    <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">surcharge_vs_time</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">surcharge_vs_depth</span><span class="p">,</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">surcharge_omega_phase</span><span class="p">)])</span>


        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">wtop_vs_time</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">load_names</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;wtop&#39;</span><span class="p">)</span>
            <span class="n">ylabels</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;Top water boundary&#39;</span><span class="p">)</span>
            <span class="n">load_triples</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                <span class="p">[(</span><span class="n">vs_time</span><span class="p">,</span> <span class="p">([</span><span class="mi">0</span><span class="p">],[</span><span class="mi">1</span><span class="p">]),</span> <span class="n">omega_phase</span><span class="p">)</span> <span class="k">for</span>
                    <span class="n">vs_time</span><span class="p">,</span> <span class="n">omega_phase</span>  <span class="ow">in</span>
                    <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">wtop_vs_time</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">wtop_omega_phase</span><span class="p">)])</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">wbot_vs_time</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="c1">#TODO: maybe if drn = 1, multiply bot_vs_time by H to give actual</span>
            <span class="c1"># gradient rather than normalised.</span>
            <span class="n">load_names</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;wbot&#39;</span><span class="p">)</span>
            <span class="n">ylabels</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;Bot water boundary&#39;</span><span class="p">)</span>
            <span class="n">load_triples</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                <span class="p">[(</span><span class="n">vs_time</span><span class="p">,</span> <span class="p">([</span><span class="mi">1</span><span class="p">],[</span><span class="mi">1</span><span class="p">]),</span> <span class="n">omega_phase</span><span class="p">)</span> <span class="k">for</span>
                    <span class="n">vs_time</span><span class="p">,</span> <span class="n">omega_phase</span>  <span class="ow">in</span>
                    <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">wbot_vs_time</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">wbot_omega_phase</span><span class="p">)])</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">atop_vs_time</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">load_names</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;atop&#39;</span><span class="p">)</span>
            <span class="n">ylabels</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;Top air boundary&#39;</span><span class="p">)</span>
            <span class="n">load_triples</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                <span class="p">[(</span><span class="n">vs_time</span><span class="p">,</span> <span class="p">([</span><span class="mi">0</span><span class="p">],[</span><span class="mi">1</span><span class="p">]),</span> <span class="n">omega_phase</span><span class="p">)</span> <span class="k">for</span>
                    <span class="n">vs_time</span><span class="p">,</span> <span class="n">omega_phase</span>  <span class="ow">in</span>
                    <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">atop_vs_time</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">atop_omega_phase</span><span class="p">)])</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">abot_vs_time</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="c1">#TODO: maybe if drn = 1, multiply bot_vs_time by H to give actual</span>
            <span class="c1"># gradient rather than normalised.</span>
            <span class="n">load_names</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;abot&#39;</span><span class="p">)</span>
            <span class="n">ylabels</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;Bot air boundary&#39;</span><span class="p">)</span>
            <span class="n">load_triples</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                <span class="p">[(</span><span class="n">vs_time</span><span class="p">,</span> <span class="p">([</span><span class="mi">1</span><span class="p">],[</span><span class="mi">1</span><span class="p">]),</span> <span class="n">omega_phase</span><span class="p">)</span> <span class="k">for</span>
                    <span class="n">vs_time</span><span class="p">,</span> <span class="n">omega_phase</span>  <span class="ow">in</span>
                    <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">abot_vs_time</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">abot_omega_phase</span><span class="p">)])</span>

        <span class="k">return</span> <span class="p">(</span><span class="n">geotecha</span><span class="o">.</span><span class="n">plotting</span><span class="o">.</span><span class="n">one_d</span><span class="o">.</span><span class="n">plot_generic_loads</span><span class="p">(</span><span class="n">load_triples</span><span class="p">,</span> <span class="n">load_names</span><span class="p">,</span>
                    <span class="n">ylabels</span><span class="o">=</span><span class="n">ylabels</span><span class="p">,</span> <span class="n">H</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">H</span><span class="p">,</span> <span class="n">RLzero</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">RLzero</span><span class="p">,</span>
                    <span class="n">prop_dict</span><span class="o">=</span><span class="n">load_prop</span><span class="p">))</span></div>


<div class="viewcode-block" id="main"><a class="viewcode-back" href="../../../api/geotecha.speccon.speccon1d_unsat.html#geotecha.speccon.speccon1d_unsat.main">[docs]</a><span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;Run speccon1d_unsat as scipt&quot;&quot;&quot;</span>
    <span class="n">a</span> <span class="o">=</span> <span class="n">GenericInputFileArgParser</span><span class="p">(</span><span class="n">obj</span><span class="o">=</span><span class="n">Speccon1dUnsat</span><span class="p">,</span>
                                  <span class="n">methods</span><span class="o">=</span><span class="p">[(</span><span class="s1">&#39;make_all&#39;</span><span class="p">,</span> <span class="p">[],</span> <span class="p">{})],</span>
                                 <span class="n">pass_open_file</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="n">a</span><span class="o">.</span><span class="n">main</span><span class="p">()</span></div>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="kn">import</span> <span class="nn">nose</span>
    <span class="n">nose</span><span class="o">.</span><span class="n">runmodule</span><span class="p">(</span><span class="n">argv</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;nose&#39;</span><span class="p">,</span> <span class="s1">&#39;--verbosity=3&#39;</span><span class="p">,</span> <span class="s1">&#39;--with-doctest&#39;</span><span class="p">])</span>
<span class="c1">#    nose.runmodule(argv=[&#39;nose&#39;, &#39;--verbosity=3&#39;])</span>
    <span class="n">main</span><span class="p">()</span>



</pre></div>

          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2014, Rohan Walker.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 1.7.4</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.10</a>
      
    </div>

    

    
  </body>
</html>